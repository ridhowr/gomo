!function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=function(t){function e(t){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",t)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(t):"undefined"!=typeof eval?eval.call(null,t):e("EvalError: No eval function available")}catch(t){e(t)}}},function(t,e,n){n(2),n(4),n(6),n(8),n(10),n(12),n(14),n(16),n(18),n(20),n(22),n(24),n(26),n(28),n(30),n(32),n(34),n(36),n(38),n(40),n(42),n(44),n(46),n(48),n(50),n(52),n(54),n(56),n(58),n(60),n(62),n(64),n(66),n(68),n(70),n(72),n(74),n(76),n(78),n(80),n(82),n(84),n(86),n(88),n(90),n(92),n(94),n(96),n(98),n(100),n(102),n(104),n(106),n(108),n(110),n(112),n(114),n(116),n(118),n(120),n(122),n(124),n(126),n(128),n(130),n(132),n(134),n(136),n(138),n(140),n(142),n(144),n(146),n(148),n(150),n(152),t.exports=n(154)},function(t,e,n){n(0)(n(3))},function(t,e){t.exports='"function"!==typeof Object.create&&(Object.create=function(f){function g(){}g.prototype=f;return new g});\n(function(f,g,k){var l={init:function(a,b){this.$elem=f(b);this.options=f.extend({},f.fn.owlCarousel.options,this.$elem.data(),a);this.userOptions=a;this.loadContent()},loadContent:function(){function a(a){var d,e="";if("function"===typeof b.options.jsonSuccess)b.options.jsonSuccess.apply(this,[a]);else{for(d in a.owl)a.owl.hasOwnProperty(d)&&(e+=a.owl[d].item);b.$elem.html(e)}b.logIn()}var b=this,e;"function"===typeof b.options.beforeInit&&b.options.beforeInit.apply(this,[b.$elem]);"string"===typeof b.options.jsonPath?\n(e=b.options.jsonPath,f.getJSON(e,a)):b.logIn()},logIn:function(){this.$elem.data("owl-originalStyles",this.$elem.attr("style"));this.$elem.data("owl-originalClasses",this.$elem.attr("class"));this.$elem.css({opacity:0});this.orignalItems=this.options.items;this.checkBrowser();this.wrapperWidth=0;this.checkVisible=null;this.setVars()},setVars:function(){if(0===this.$elem.children().length)return!1;this.baseClass();this.eventTypes();this.$userItems=this.$elem.children();this.itemsAmount=this.$userItems.length;\nthis.wrapItems();this.$owlItems=this.$elem.find(".owl-item");this.$owlWrapper=this.$elem.find(".owl-wrapper");this.playDirection="next";this.prevItem=0;this.prevArr=[0];this.currentItem=0;this.customEvents();this.onStartup()},onStartup:function(){this.updateItems();this.calculateAll();this.buildControls();this.updateControls();this.response();this.moveEvents();this.stopOnHover();this.owlStatus();!1!==this.options.transitionStyle&&this.transitionTypes(this.options.transitionStyle);!0===this.options.autoPlay&&\n(this.options.autoPlay=5E3);this.play();this.$elem.find(".owl-wrapper").css("display","block");this.$elem.is(":visible")?this.$elem.css("opacity",1):this.watchVisibility();this.onstartup=!1;this.eachMoveUpdate();"function"===typeof this.options.afterInit&&this.options.afterInit.apply(this,[this.$elem])},eachMoveUpdate:function(){!0===this.options.lazyLoad&&this.lazyLoad();!0===this.options.autoHeight&&this.autoHeight();this.onVisibleItems();"function"===typeof this.options.afterAction&&this.options.afterAction.apply(this,\n[this.$elem])},updateVars:function(){"function"===typeof this.options.beforeUpdate&&this.options.beforeUpdate.apply(this,[this.$elem]);this.watchVisibility();this.updateItems();this.calculateAll();this.updatePosition();this.updateControls();this.eachMoveUpdate();"function"===typeof this.options.afterUpdate&&this.options.afterUpdate.apply(this,[this.$elem])},reload:function(){var a=this;g.setTimeout(function(){a.updateVars()},0)},watchVisibility:function(){var a=this;if(!1===a.$elem.is(":visible"))a.$elem.css({opacity:0}),\ng.clearInterval(a.autoPlayInterval),g.clearInterval(a.checkVisible);else return!1;a.checkVisible=g.setInterval(function(){a.$elem.is(":visible")&&(a.reload(),a.$elem.animate({opacity:1},200),g.clearInterval(a.checkVisible))},500)},wrapItems:function(){this.$userItems.wrapAll(\'<div class="owl-wrapper">\').wrap(\'<div class="owl-item"></div>\');this.$elem.find(".owl-wrapper").wrap(\'<div class="owl-wrapper-outer">\');this.wrapperOuter=this.$elem.find(".owl-wrapper-outer");this.$elem.css("display","block")},\nbaseClass:function(){var a=this.$elem.hasClass(this.options.baseClass),b=this.$elem.hasClass(this.options.theme);a||this.$elem.addClass(this.options.baseClass);b||this.$elem.addClass(this.options.theme)},updateItems:function(){var a,b;if(!1===this.options.responsive)return!1;if(!0===this.options.singleItem)return this.options.items=this.orignalItems=1,this.options.itemsCustom=!1,this.options.itemsDesktop=!1,this.options.itemsDesktopSmall=!1,this.options.itemsTablet=!1,this.options.itemsTabletSmall=\n!1,this.options.itemsMobile=!1;a=f(this.options.responsiveBaseWidth).width();a>(this.options.itemsDesktop[0]||this.orignalItems)&&(this.options.items=this.orignalItems);if(!1!==this.options.itemsCustom)for(this.options.itemsCustom.sort(function(a,b){return a[0]-b[0]}),b=0;b<this.options.itemsCustom.length;b+=1)this.options.itemsCustom[b][0]<=a&&(this.options.items=this.options.itemsCustom[b][1]);else a<=this.options.itemsDesktop[0]&&!1!==this.options.itemsDesktop&&(this.options.items=this.options.itemsDesktop[1]),\na<=this.options.itemsDesktopSmall[0]&&!1!==this.options.itemsDesktopSmall&&(this.options.items=this.options.itemsDesktopSmall[1]),a<=this.options.itemsTablet[0]&&!1!==this.options.itemsTablet&&(this.options.items=this.options.itemsTablet[1]),a<=this.options.itemsTabletSmall[0]&&!1!==this.options.itemsTabletSmall&&(this.options.items=this.options.itemsTabletSmall[1]),a<=this.options.itemsMobile[0]&&!1!==this.options.itemsMobile&&(this.options.items=this.options.itemsMobile[1]);this.options.items>this.itemsAmount&&\n!0===this.options.itemsScaleUp&&(this.options.items=this.itemsAmount)},response:function(){var a=this,b,e;if(!0!==a.options.responsive)return!1;e=f(g).width();a.resizer=function(){f(g).width()!==e&&(!1!==a.options.autoPlay&&g.clearInterval(a.autoPlayInterval),g.clearTimeout(b),b=g.setTimeout(function(){e=f(g).width();a.updateVars()},a.options.responsiveRefreshRate))};f(g).resize(a.resizer)},updatePosition:function(){this.jumpTo(this.currentItem);!1!==this.options.autoPlay&&this.checkAp()},appendItemsSizes:function(){var a=\nthis,b=0,e=a.itemsAmount-a.options.items;a.$owlItems.each(function(c){var d=f(this);d.css({width:a.itemWidth}).data("owl-item",Number(c));if(0===c%a.options.items||c===e)c>e||(b+=1);d.data("owl-roundPages",b)})},appendWrapperSizes:function(){this.$owlWrapper.css({width:this.$owlItems.length*this.itemWidth*2,left:0});this.appendItemsSizes()},calculateAll:function(){this.calculateWidth();this.appendWrapperSizes();this.loops();this.max()},calculateWidth:function(){this.itemWidth=Math.round(this.$elem.width()/\nthis.options.items)},max:function(){var a=-1*(this.itemsAmount*this.itemWidth-this.options.items*this.itemWidth);this.options.items>this.itemsAmount?this.maximumPixels=a=this.maximumItem=0:(this.maximumItem=this.itemsAmount-this.options.items,this.maximumPixels=a);return a},min:function(){return 0},loops:function(){var a=0,b=0,e,c;this.positionsInArray=[0];this.pagesInArray=[];for(e=0;e<this.itemsAmount;e+=1)b+=this.itemWidth,this.positionsInArray.push(-b),!0===this.options.scrollPerPage&&(c=f(this.$owlItems[e]),\nc=c.data("owl-roundPages"),c!==a&&(this.pagesInArray[a]=this.positionsInArray[e],a=c))},buildControls:function(){if(!0===this.options.navigation||!0===this.options.pagination)this.owlControls=f(\'<div class="owl-controls"/>\').toggleClass("clickable",!this.browser.isTouch).appendTo(this.$elem);!0===this.options.pagination&&this.buildPagination();!0===this.options.navigation&&this.buildButtons()},buildButtons:function(){var a=this,b=f(\'<div class="owl-buttons"/>\');a.owlControls.append(b);a.buttonPrev=\nf("<div/>",{"class":"owl-prev",html:a.options.navigationText[0]||""});a.buttonNext=f("<div/>",{"class":"owl-next",html:a.options.navigationText[1]||""});b.append(a.buttonPrev).append(a.buttonNext);b.on("touchstart.owlControls mousedown.owlControls",\'div[class^="owl"]\',function(a){a.preventDefault()});b.on("touchend.owlControls mouseup.owlControls",\'div[class^="owl"]\',function(b){b.preventDefault();f(this).hasClass("owl-next")?a.next():a.prev()})},buildPagination:function(){var a=this;a.paginationWrapper=\nf(\'<div class="owl-pagination"/>\');a.owlControls.append(a.paginationWrapper);a.paginationWrapper.on("touchend.owlControls mouseup.owlControls",".owl-page",function(b){b.preventDefault();Number(f(this).data("owl-page"))!==a.currentItem&&a.goTo(Number(f(this).data("owl-page")),!0)})},updatePagination:function(){var a,b,e,c,d,g;if(!1===this.options.pagination)return!1;this.paginationWrapper.html("");a=0;b=this.itemsAmount-this.itemsAmount%this.options.items;for(c=0;c<this.itemsAmount;c+=1)0===c%this.options.items&&\n(a+=1,b===c&&(e=this.itemsAmount-this.options.items),d=f("<div/>",{"class":"owl-page"}),g=f("<span></span>",{text:!0===this.options.paginationNumbers?a:"","class":!0===this.options.paginationNumbers?"owl-numbers":""}),d.append(g),d.data("owl-page",b===c?e:c),d.data("owl-roundPages",a),this.paginationWrapper.append(d));this.checkPagination()},checkPagination:function(){var a=this;if(!1===a.options.pagination)return!1;a.paginationWrapper.find(".owl-page").each(function(){f(this).data("owl-roundPages")===\nf(a.$owlItems[a.currentItem]).data("owl-roundPages")&&(a.paginationWrapper.find(".owl-page").removeClass("active"),f(this).addClass("active"))})},checkNavigation:function(){if(!1===this.options.navigation)return!1;!1===this.options.rewindNav&&(0===this.currentItem&&0===this.maximumItem?(this.buttonPrev.addClass("disabled"),this.buttonNext.addClass("disabled")):0===this.currentItem&&0!==this.maximumItem?(this.buttonPrev.addClass("disabled"),this.buttonNext.removeClass("disabled")):this.currentItem===\nthis.maximumItem?(this.buttonPrev.removeClass("disabled"),this.buttonNext.addClass("disabled")):0!==this.currentItem&&this.currentItem!==this.maximumItem&&(this.buttonPrev.removeClass("disabled"),this.buttonNext.removeClass("disabled")))},updateControls:function(){this.updatePagination();this.checkNavigation();this.owlControls&&(this.options.items>=this.itemsAmount?this.owlControls.hide():this.owlControls.show())},destroyControls:function(){this.owlControls&&this.owlControls.remove()},next:function(a){if(this.isTransition)return!1;\nthis.currentItem+=!0===this.options.scrollPerPage?this.options.items:1;if(this.currentItem>this.maximumItem+(!0===this.options.scrollPerPage?this.options.items-1:0))if(!0===this.options.rewindNav)this.currentItem=0,a="rewind";else return this.currentItem=this.maximumItem,!1;this.goTo(this.currentItem,a)},prev:function(a){if(this.isTransition)return!1;this.currentItem=!0===this.options.scrollPerPage&&0<this.currentItem&&this.currentItem<this.options.items?0:this.currentItem-(!0===this.options.scrollPerPage?\nthis.options.items:1);if(0>this.currentItem)if(!0===this.options.rewindNav)this.currentItem=this.maximumItem,a="rewind";else return this.currentItem=0,!1;this.goTo(this.currentItem,a)},goTo:function(a,b,e){var c=this;if(c.isTransition)return!1;"function"===typeof c.options.beforeMove&&c.options.beforeMove.apply(this,[c.$elem]);a>=c.maximumItem?a=c.maximumItem:0>=a&&(a=0);c.currentItem=c.owl.currentItem=a;if(!1!==c.options.transitionStyle&&"drag"!==e&&1===c.options.items&&!0===c.browser.support3d)return c.swapSpeed(0),\n!0===c.browser.support3d?c.transition3d(c.positionsInArray[a]):c.css2slide(c.positionsInArray[a],1),c.afterGo(),c.singleItemTransition(),!1;a=c.positionsInArray[a];!0===c.browser.support3d?(c.isCss3Finish=!1,!0===b?(c.swapSpeed("paginationSpeed"),g.setTimeout(function(){c.isCss3Finish=!0},c.options.paginationSpeed)):"rewind"===b?(c.swapSpeed(c.options.rewindSpeed),g.setTimeout(function(){c.isCss3Finish=!0},c.options.rewindSpeed)):(c.swapSpeed("slideSpeed"),g.setTimeout(function(){c.isCss3Finish=!0},\nc.options.slideSpeed)),c.transition3d(a)):!0===b?c.css2slide(a,c.options.paginationSpeed):"rewind"===b?c.css2slide(a,c.options.rewindSpeed):c.css2slide(a,c.options.slideSpeed);c.afterGo()},jumpTo:function(a){"function"===typeof this.options.beforeMove&&this.options.beforeMove.apply(this,[this.$elem]);a>=this.maximumItem||-1===a?a=this.maximumItem:0>=a&&(a=0);this.swapSpeed(0);!0===this.browser.support3d?this.transition3d(this.positionsInArray[a]):this.css2slide(this.positionsInArray[a],1);this.currentItem=\nthis.owl.currentItem=a;this.afterGo()},afterGo:function(){this.prevArr.push(this.currentItem);this.prevItem=this.owl.prevItem=this.prevArr[this.prevArr.length-2];this.prevArr.shift(0);this.prevItem!==this.currentItem&&(this.checkPagination(),this.checkNavigation(),this.eachMoveUpdate(),!1!==this.options.autoPlay&&this.checkAp());"function"===typeof this.options.afterMove&&this.prevItem!==this.currentItem&&this.options.afterMove.apply(this,[this.$elem])},stop:function(){this.apStatus="stop";g.clearInterval(this.autoPlayInterval)},\ncheckAp:function(){"stop"!==this.apStatus&&this.play()},play:function(){var a=this;a.apStatus="play";if(!1===a.options.autoPlay)return!1;g.clearInterval(a.autoPlayInterval);a.autoPlayInterval=g.setInterval(function(){a.next(!0)},a.options.autoPlay)},swapSpeed:function(a){"slideSpeed"===a?this.$owlWrapper.css(this.addCssSpeed(this.options.slideSpeed)):"paginationSpeed"===a?this.$owlWrapper.css(this.addCssSpeed(this.options.paginationSpeed)):"string"!==typeof a&&this.$owlWrapper.css(this.addCssSpeed(a))},\naddCssSpeed:function(a){return{"-webkit-transition":"all "+a+"ms ease","-moz-transition":"all "+a+"ms ease","-o-transition":"all "+a+"ms ease",transition:"all "+a+"ms ease"}},removeTransition:function(){return{"-webkit-transition":"","-moz-transition":"","-o-transition":"",transition:""}},doTranslate:function(a){return{"-webkit-transform":"translate3d("+a+"px, 0px, 0px)","-moz-transform":"translate3d("+a+"px, 0px, 0px)","-o-transform":"translate3d("+a+"px, 0px, 0px)","-ms-transform":"translate3d("+\na+"px, 0px, 0px)",transform:"translate3d("+a+"px, 0px,0px)"}},transition3d:function(a){this.$owlWrapper.css(this.doTranslate(a))},css2move:function(a){this.$owlWrapper.css({left:a})},css2slide:function(a,b){var e=this;e.isCssFinish=!1;e.$owlWrapper.stop(!0,!0).animate({left:a},{duration:b||e.options.slideSpeed,complete:function(){e.isCssFinish=!0}})},checkBrowser:function(){var a=k.createElement("div");a.style.cssText="  -moz-transform:translate3d(0px, 0px, 0px); -ms-transform:translate3d(0px, 0px, 0px); -o-transform:translate3d(0px, 0px, 0px); -webkit-transform:translate3d(0px, 0px, 0px); transform:translate3d(0px, 0px, 0px)";\na=a.style.cssText.match(/translate3d\\(0px, 0px, 0px\\)/g);this.browser={support3d:null!==a&&1===a.length,isTouch:"ontouchstart"in g||g.navigator.msMaxTouchPoints}},moveEvents:function(){if(!1!==this.options.mouseDrag||!1!==this.options.touchDrag)this.gestures(),this.disabledEvents()},eventTypes:function(){var a=["s","e","x"];this.ev_types={};!0===this.options.mouseDrag&&!0===this.options.touchDrag?a=["touchstart.owl mousedown.owl","touchmove.owl mousemove.owl","touchend.owl touchcancel.owl mouseup.owl"]:\n!1===this.options.mouseDrag&&!0===this.options.touchDrag?a=["touchstart.owl","touchmove.owl","touchend.owl touchcancel.owl"]:!0===this.options.mouseDrag&&!1===this.options.touchDrag&&(a=["mousedown.owl","mousemove.owl","mouseup.owl"]);this.ev_types.start=a[0];this.ev_types.move=a[1];this.ev_types.end=a[2]},disabledEvents:function(){this.$elem.on("dragstart.owl",function(a){a.preventDefault()});this.$elem.on("mousedown.disableTextSelect",function(a){return f(a.target).is("input, textarea, select, option")})},\ngestures:function(){function a(a){if(void 0!==a.touches)return{x:a.touches[0].pageX,y:a.touches[0].pageY};if(void 0===a.touches){if(void 0!==a.pageX)return{x:a.pageX,y:a.pageY};if(void 0===a.pageX)return{x:a.clientX,y:a.clientY}}}function b(a){"on"===a?(f(k).on(d.ev_types.move,e),f(k).on(d.ev_types.end,c)):"off"===a&&(f(k).off(d.ev_types.move),f(k).off(d.ev_types.end))}function e(b){b=b.originalEvent||b||g.event;d.newPosX=a(b).x-h.offsetX;d.newPosY=a(b).y-h.offsetY;d.newRelativeX=d.newPosX-h.relativePos;\n"function"===typeof d.options.startDragging&&!0!==h.dragging&&0!==d.newRelativeX&&(h.dragging=!0,d.options.startDragging.apply(d,[d.$elem]));(8<d.newRelativeX||-8>d.newRelativeX)&&!0===d.browser.isTouch&&(void 0!==b.preventDefault?b.preventDefault():b.returnValue=!1,h.sliding=!0);(10<d.newPosY||-10>d.newPosY)&&!1===h.sliding&&f(k).off("touchmove.owl");d.newPosX=Math.max(Math.min(d.newPosX,d.newRelativeX/5),d.maximumPixels+d.newRelativeX/5);!0===d.browser.support3d?d.transition3d(d.newPosX):d.css2move(d.newPosX)}\nfunction c(a){a=a.originalEvent||a||g.event;var c;a.target=a.target||a.srcElement;h.dragging=!1;!0!==d.browser.isTouch&&d.$owlWrapper.removeClass("grabbing");d.dragDirection=0>d.newRelativeX?d.owl.dragDirection="left":d.owl.dragDirection="right";0!==d.newRelativeX&&(c=d.getNewPosition(),d.goTo(c,!1,"drag"),h.targetElement===a.target&&!0!==d.browser.isTouch&&(f(a.target).on("click.disable",function(a){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();f(a.target).off("click.disable")}),\na=f._data(a.target,"events").click,c=a.pop(),a.splice(0,0,c)));b("off")}var d=this,h={offsetX:0,offsetY:0,baseElWidth:0,relativePos:0,position:null,minSwipe:null,maxSwipe:null,sliding:null,dargging:null,targetElement:null};d.isCssFinish=!0;d.$elem.on(d.ev_types.start,".owl-wrapper",function(c){c=c.originalEvent||c||g.event;var e;if(3===c.which)return!1;if(!(d.itemsAmount<=d.options.items)){if(!1===d.isCssFinish&&!d.options.dragBeforeAnimFinish||!1===d.isCss3Finish&&!d.options.dragBeforeAnimFinish)return!1;\n!1!==d.options.autoPlay&&g.clearInterval(d.autoPlayInterval);!0===d.browser.isTouch||d.$owlWrapper.hasClass("grabbing")||d.$owlWrapper.addClass("grabbing");d.newPosX=0;d.newRelativeX=0;f(this).css(d.removeTransition());e=f(this).position();h.relativePos=e.left;h.offsetX=a(c).x-e.left;h.offsetY=a(c).y-e.top;b("on");h.sliding=!1;h.targetElement=c.target||c.srcElement}})},getNewPosition:function(){var a=this.closestItem();a>this.maximumItem?a=this.currentItem=this.maximumItem:0<=this.newPosX&&(this.currentItem=\na=0);return a},closestItem:function(){var a=this,b=!0===a.options.scrollPerPage?a.pagesInArray:a.positionsInArray,e=a.newPosX,c=null;f.each(b,function(d,g){e-a.itemWidth/20>b[d+1]&&e-a.itemWidth/20<g&&"left"===a.moveDirection()?(c=g,a.currentItem=!0===a.options.scrollPerPage?f.inArray(c,a.positionsInArray):d):e+a.itemWidth/20<g&&e+a.itemWidth/20>(b[d+1]||b[d]-a.itemWidth)&&"right"===a.moveDirection()&&(!0===a.options.scrollPerPage?(c=b[d+1]||b[b.length-1],a.currentItem=f.inArray(c,a.positionsInArray)):\n(c=b[d+1],a.currentItem=d+1))});return a.currentItem},moveDirection:function(){var a;0>this.newRelativeX?(a="right",this.playDirection="next"):(a="left",this.playDirection="prev");return a},customEvents:function(){var a=this;a.$elem.on("owl.next",function(){a.next()});a.$elem.on("owl.prev",function(){a.prev()});a.$elem.on("owl.play",function(b,e){a.options.autoPlay=e;a.play();a.hoverStatus="play"});a.$elem.on("owl.stop",function(){a.stop();a.hoverStatus="stop"});a.$elem.on("owl.goTo",function(b,e){a.goTo(e)});\na.$elem.on("owl.jumpTo",function(b,e){a.jumpTo(e)})},stopOnHover:function(){var a=this;!0===a.options.stopOnHover&&!0!==a.browser.isTouch&&!1!==a.options.autoPlay&&(a.$elem.on("mouseover",function(){a.stop()}),a.$elem.on("mouseout",function(){"stop"!==a.hoverStatus&&a.play()}))},lazyLoad:function(){var a,b,e,c,d;if(!1===this.options.lazyLoad)return!1;for(a=0;a<this.itemsAmount;a+=1)b=f(this.$owlItems[a]),"loaded"!==b.data("owl-loaded")&&(e=b.data("owl-item"),c=b.find(".lazyOwl"),"string"!==typeof c.data("src")?\nb.data("owl-loaded","loaded"):(void 0===b.data("owl-loaded")&&(c.hide(),b.addClass("loading").data("owl-loaded","checked")),(d=!0===this.options.lazyFollow?e>=this.currentItem:!0)&&e<this.currentItem+this.options.items&&c.length&&this.lazyPreload(b,c)))},lazyPreload:function(a,b){function e(){a.data("owl-loaded","loaded").removeClass("loading");b.removeAttr("data-src");"fade"===d.options.lazyEffect?b.fadeIn(400):b.show();"function"===typeof d.options.afterLazyLoad&&d.options.afterLazyLoad.apply(this,\n[d.$elem])}function c(){f+=1;d.completeImg(b.get(0))||!0===k?e():100>=f?g.setTimeout(c,100):e()}var d=this,f=0,k;"DIV"===b.prop("tagName")?(b.css("background-image","url("+b.data("src")+")"),k=!0):b[0].src=b.data("src");c()},autoHeight:function(){function a(){var a=f(e.$owlItems[e.currentItem]).height();e.wrapperOuter.css("height",a+"px");e.wrapperOuter.hasClass("autoHeight")||g.setTimeout(function(){e.wrapperOuter.addClass("autoHeight")},0)}function b(){d+=1;e.completeImg(c.get(0))?a():100>=d?g.setTimeout(b,\n100):e.wrapperOuter.css("height","")}var e=this,c=f(e.$owlItems[e.currentItem]).find("img"),d;void 0!==c.get(0)?(d=0,b()):a()},completeImg:function(a){return!a.complete||"undefined"!==typeof a.naturalWidth&&0===a.naturalWidth?!1:!0},onVisibleItems:function(){var a;!0===this.options.addClassActive&&this.$owlItems.removeClass("active");this.visibleItems=[];for(a=this.currentItem;a<this.currentItem+this.options.items;a+=1)this.visibleItems.push(a),!0===this.options.addClassActive&&f(this.$owlItems[a]).addClass("active");\nthis.owl.visibleItems=this.visibleItems},transitionTypes:function(a){this.outClass="owl-"+a+"-out";this.inClass="owl-"+a+"-in"},singleItemTransition:function(){var a=this,b=a.outClass,e=a.inClass,c=a.$owlItems.eq(a.currentItem),d=a.$owlItems.eq(a.prevItem),f=Math.abs(a.positionsInArray[a.currentItem])+a.positionsInArray[a.prevItem],g=Math.abs(a.positionsInArray[a.currentItem])+a.itemWidth/2;a.isTransition=!0;a.$owlWrapper.addClass("owl-origin").css({"-webkit-transform-origin":g+"px","-moz-perspective-origin":g+\n"px","perspective-origin":g+"px"});d.css({position:"relative",left:f+"px"}).addClass(b).on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){a.endPrev=!0;d.off("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend");a.clearTransStyle(d,b)});c.addClass(e).on("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",function(){a.endCurrent=!0;c.off("webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend");a.clearTransStyle(c,e)})},clearTransStyle:function(a,\nb){a.css({position:"",left:""}).removeClass(b);this.endPrev&&this.endCurrent&&(this.$owlWrapper.removeClass("owl-origin"),this.isTransition=this.endCurrent=this.endPrev=!1)},owlStatus:function(){this.owl={userOptions:this.userOptions,baseElement:this.$elem,userItems:this.$userItems,owlItems:this.$owlItems,currentItem:this.currentItem,prevItem:this.prevItem,visibleItems:this.visibleItems,isTouch:this.browser.isTouch,browser:this.browser,dragDirection:this.dragDirection}},clearEvents:function(){this.$elem.off(".owl owl mousedown.disableTextSelect");\nf(k).off(".owl owl");f(g).off("resize",this.resizer)},unWrap:function(){0!==this.$elem.children().length&&(this.$owlWrapper.unwrap(),this.$userItems.unwrap().unwrap(),this.owlControls&&this.owlControls.remove());this.clearEvents();this.$elem.attr("style",this.$elem.data("owl-originalStyles")||"").attr("class",this.$elem.data("owl-originalClasses"))},destroy:function(){this.stop();g.clearInterval(this.checkVisible);this.unWrap();this.$elem.removeData()},reinit:function(a){a=f.extend({},this.userOptions,\na);this.unWrap();this.init(a,this.$elem)},addItem:function(a,b){var e;if(!a)return!1;if(0===this.$elem.children().length)return this.$elem.append(a),this.setVars(),!1;this.unWrap();e=void 0===b||-1===b?-1:b;e>=this.$userItems.length||-1===e?this.$userItems.eq(-1).after(a):this.$userItems.eq(e).before(a);this.setVars()},removeItem:function(a){if(0===this.$elem.children().length)return!1;a=void 0===a||-1===a?-1:a;this.unWrap();this.$userItems.eq(a).remove();this.setVars()}};f.fn.owlCarousel=function(a){return this.each(function(){if(!0===\nf(this).data("owl-init"))return!1;f(this).data("owl-init",!0);var b=Object.create(l);b.init(a,this);f.data(this,"owlCarousel",b)})};f.fn.owlCarousel.options={items:5,itemsCustom:!1,itemsDesktop:[1199,4],itemsDesktopSmall:[979,3],itemsTablet:[768,2],itemsTabletSmall:!1,itemsMobile:[479,1],singleItem:!1,itemsScaleUp:!1,slideSpeed:200,paginationSpeed:800,rewindSpeed:1E3,autoPlay:!1,stopOnHover:!1,navigation:!1,navigationText:["prev","next"],rewindNav:!0,scrollPerPage:!1,pagination:!0,paginationNumbers:!1,\nresponsive:!0,responsiveRefreshRate:200,responsiveBaseWidth:g,baseClass:"owl-carousel",theme:"owl-theme",lazyLoad:!1,lazyFollow:!0,lazyEffect:"fade",autoHeight:!1,jsonPath:!1,jsonSuccess:!1,dragBeforeAnimFinish:!0,mouseDrag:!0,touchDrag:!0,addClassActive:!1,transitionStyle:!1,beforeUpdate:!1,afterUpdate:!1,beforeInit:!1,afterInit:!1,beforeMove:!1,afterMove:!1,afterAction:!1,startDragging:!1,afterLazyLoad:!1}})(jQuery,window,document);'},function(t,e,n){n(0)(n(5))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(7))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(9))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(11))},function(t,e){t.exports='window.JSON||(window.JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?\'"\'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+\'"\':\'"\'+a+\'"\'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\\n"+gap+h.join(",\\n"+gap)+"\\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d=="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\\n"+gap+h.join(",\\n"+gap)+"\\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var JSON=window.JSON,cx=/[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,escapable=/[\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,gap,indent,meta={"\\b":"\\\\b","\\t":"\\\\t","\\n":"\\\\n","\\f":"\\\\f","\\r":"\\\\r",\'"\':\'\\\\"\',"\\\\":"\\\\\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\\],:{}\\s]*$/.test(text.replace(/\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g,"]").replace(/(?:^|:|,)(?:\\s*\\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b){"use strict";var c=a.History=a.History||{},d=a.jQuery;if(typeof c.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){d(a)}},typeof c.init!="undefined"&&c.init()}(window),function(a,b){"use strict";var c=a.document,d=a.setTimeout||d,e=a.clearTimeout||e,f=a.setInterval||f,g=a.History=a.History||{};if(typeof g.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");g.initHtml4=function(){if(typeof g.initHtml4.initialized!="undefined")return!1;g.initHtml4.initialized=!0,g.enabled=!0,g.savedHashes=[],g.isLastHash=function(a){var b=g.getHashByIndex(),c;return c=a===b,c},g.saveHash=function(a){return g.isLastHash(a)?!1:(g.savedHashes.push(a),!0)},g.getHashByIndex=function(a){var b=null;return typeof a=="undefined"?b=g.savedHashes[g.savedHashes.length-1]:a<0?b=g.savedHashes[g.savedHashes.length+a]:b=g.savedHashes[a],b},g.discardedHashes={},g.discardedStates={},g.discardState=function(a,b,c){var d=g.getHashByState(a),e;return e={discardedState:a,backState:c,forwardState:b},g.discardedStates[d]=e,!0},g.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};return g.discardedHashes[a]=d,!0},g.discardedState=function(a){var b=g.getHashByState(a),c;return c=g.discardedStates[b]||!1,c},g.discardedHash=function(a){var b=g.discardedHashes[a]||!1;return b},g.recycleState=function(a){var b=g.getHashByState(a);return g.discardedState(a)&&delete g.discardedStates[b],!0},g.emulated.hashChange&&(g.hashChangeInit=function(){g.checkerFunction=null;var b="",d,e,h,i;return g.isInternetExplorer()?(d="historyjs-iframe",e=c.createElement("iframe"),e.setAttribute("id",d),e.style.display="none",c.body.appendChild(e),e.contentWindow.document.open(),e.contentWindow.document.close(),h="",i=!1,g.checkerFunction=function(){if(i)return!1;i=!0;var c=g.getHash()||"",d=g.unescapeHash(e.contentWindow.document.location.hash)||"";return c!==b?(b=c,d!==c&&(h=d=c,e.contentWindow.document.open(),e.contentWindow.document.close(),e.contentWindow.document.location.hash=g.escapeHash(c)),g.Adapter.trigger(a,"hashchange")):d!==h&&(h=d,g.setHash(d,!1)),i=!1,!0}):g.checkerFunction=function(){var c=g.getHash();return c!==b&&(b=c,g.Adapter.trigger(a,"hashchange")),!0},g.intervalList.push(f(g.checkerFunction,g.options.hashChangeInterval)),!0},g.Adapter.onDomLoad(g.hashChangeInit)),g.emulated.pushState&&(g.onHashChange=function(b){var d=b&&b.newURL||c.location.href,e=g.getHashByUrl(d),f=null,h=null,i=null,j;return g.isLastHash(e)?(g.busy(!1),!1):(g.doubleCheckComplete(),g.saveHash(e),e&&g.isTraditionalAnchor(e)?(g.Adapter.trigger(a,"anchorchange"),g.busy(!1),!1):(f=g.extractState(g.getFullUrl(e||c.location.href,!1),!0),g.isLastSavedState(f)?(g.busy(!1),!1):(h=g.getHashByState(f),j=g.discardedState(f),j?(g.getHashByIndex(-2)===g.getHashByState(j.forwardState)?g.back(!1):g.forward(!1),!1):(g.pushState(f.data,f.title,f.url,!1),!0))))},g.Adapter.bind(a,"hashchange",g.onHashChange),g.pushState=function(b,d,e,f){if(g.getHashByUrl(e))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(f!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:f}),!1;g.busy(!0);var h=g.createStateObject(b,d,e),i=g.getHashByState(h),j=g.getState(!1),k=g.getHashByState(j),l=g.getHash();return g.storeState(h),g.expectedStateId=h.id,g.recycleState(h),g.setTitle(h),i===k?(g.busy(!1),!1):i!==l&&i!==g.getShortUrl(c.location.href)?(g.setHash(i,!1),!1):(g.saveState(h),g.Adapter.trigger(a,"statechange"),g.busy(!1),!0)},g.replaceState=function(a,b,c,d){if(g.getHashByUrl(c))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(d!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:d}),!1;g.busy(!0);var e=g.createStateObject(a,b,c),f=g.getState(!1),h=g.getStateByIndex(-2);return g.discardState(f,e,h),g.pushState(e.data,e.title,e.url,!1),!0}),g.emulated.pushState&&g.getHash()&&!g.emulated.hashChange&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(a,"hashchange")})},typeof g.init!="undefined"&&g.init()}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode;if(typeof m.init!="undefined")throw new Error("History.js Core has already been loaded...");m.init=function(){return typeof m.Adapter=="undefined"?!1:(typeof m.initCore!="undefined"&&m.initCore(),typeof m.initHtml4!="undefined"&&m.initHtml4(),!0)},m.initCore=function(){if(typeof m.initCore.initialized!="undefined")return!1;m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if(typeof b!="undefined"&&b!==null){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a=typeof c!="undefined"&&typeof c.log!="undefined"&&typeof c.log.apply!="undefined",b=d.getElementById("log"),e,f,g,h,i;a?(h=Array.prototype.slice.call(arguments),e=h.shift(),typeof c.debug!="undefined"?c.debug.apply(c,[e,h]):c.log.apply(c,[e,h])):e="\\n"+arguments[0]+"\\n";for(f=1,g=arguments.length;f<g;++f){i=arguments[f];if(typeof i=="object"&&typeof k!="undefined")try{i=k.stringify(i)}catch(j){}e+="\\n"+i+"\\n"}return b?(b.value+=e+"\\n-----\\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||l(e),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached=typeof m.getInternetExplorerMajorVersion.cached!="undefined"?m.getInternetExplorerMajorVersion.cached:function(){var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");while((b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e")&&c[0]);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached=typeof m.isInternetExplorer.cached!="undefined"?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);if(d.location.port||!1)a+=":"+d.location.port;return a+="/",a},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return a.length===1&&(b=a[0],c=b.href.replace(/[^\\/]+$/,"")),c=c.replace(/\\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a=m.getState(!1,!1),b=(a||{}).url||d.location.href,c;return c=b.replace(/\\/+$/,"").replace(/[^\\/]+$/,function(a,b,c){return/\\./.test(a)?a:a+"/"}),c},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\\?].*/,"").replace(/[^\\/]+$/,function(a,b,c){return/[^\\/]$/.test(a)?"":a}).replace(/\\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b=typeof b=="undefined"?!0:b,/[a-z]+\\:\\/\\//.test(a)||(d==="/"?c=m.getRootUrl()+a.replace(/^\\/+/,""):d==="#"?c=m.getPageUrl().replace(/#.*/,"")+a:d==="?"?c=m.getPageUrl().replace(/[\\?#].*/,"")+a:b?c=m.getBaseUrl()+a.replace(/^(\\.\\/)+/,""):c=m.getBasePageUrl()+a.replace(/^(\\.\\/)+/,"")),c.replace(/\\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\\.\\/)+/g,"./").replace(/\\#$/,""),b},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){typeof a=="undefined"&&(a=!0),typeof b=="undefined"&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b=m.extractId(a.url),c;if(!b){c=m.getStateString(a);if(typeof m.stateToId[c]!="undefined")b=m.stateToId[c];else if(typeof m.store.stateToId[c]!="undefined")b=m.store.stateToId[c];else{for(;;){b=(new Date).getTime()+String(Math.random()).replace(/\\D/g,"");if(typeof m.idToState[b]=="undefined"&&typeof m.store.idToState[b]=="undefined")break}m.stateToId[c]=b,m.idToState[b]=a}}return b},m.normalizeState=function(a){var b,c;if(!a||typeof a!="object")a={};if(typeof a.normalized!="undefined")return a;if(!a.data||typeof a.data!="object")a.data={};b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\\??\\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data);if(b.title||c)b.hash=m.getShortUrl(b.url).replace(/\\??\\&_suid.*/,""),/\\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id;return b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d),d},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c),d},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id,c},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash,c},m.extractId=function(a){var b,c,d;return c=/(.*)\\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\\/\\?\\.]/.test(a);return b},m.extractState=function(a,b){var c=null,d,e;return b=b||!1,d=m.extractId(a),d&&(c=m.getStateById(d)),c||(e=m.getFullUrl(a),d=m.getIdByUrl(e)||!1,d&&(c=m.getStateById(d)),!c&&b&&!m.isTraditionalAnchor(a)&&(c=m.createStateObject(null,null,e))),c},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b=!1,c;return c=m.extractState(a.url),b=c&&c.id!==a.id,b},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b=!1,c,d,e;return m.savedStates.length&&(c=a.id,d=m.getLastSavedState(),e=d.id,b=c===e),b},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return typeof a=="undefined"?b=m.savedStates[m.savedStates.length-1]:a<0?b=m.savedStates[m.savedStates.length+a]:b=m.savedStates[a],b},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){var c=b,d;for(;;){d=a.unescape(c);if(d===c)break;c=d}return c},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b),b},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\\%21/g,"!").replace(/\\%26/g,"&").replace(/\\%3D/g,"=").replace(/\\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b),b},m.setTitle=function(a){var b=a.title,c;b||(c=m.getStateByIndex(0),c&&c.url===a.url&&(b=c.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=b,m},m.queues=[],m.busy=function(a){typeof a!="undefined"?m.busy.flag=a:typeof m.busy.flag=="undefined"&&(m.busy.flag=!1);if(!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(m.busy.flag)return;for(a=m.queues.length-1;a>=0;--a){c=m.queues[a];if(c.length===0)continue;d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay)}};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return typeof a=="function"&&(a={callback:a}),typeof b!="undefined"&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b=m.extractState(d.location.href),c;if(!m.isLastSavedState(b))c=b;else return;return c||(c=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)m.forward(b);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m};if(m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var e=!1,f=!1,g,h;return m.doubleCheckComplete(),g=m.getHash(),g?(h=m.extractState(g||d.location.href,!0),h?m.replaceState(h.data,h.title,h.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(e=m.Adapter.extractEventData("state",b,c)||!1,e?f=m.getStateById(e):m.expectedStateId?f=m.getStateById(m.expectedStateId):f=m.extractState(d.location.href),f||(f=m.createStateObject(null,null,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(f)?(m.busy(!1),!1):(m.storeState(f),m.saveState(f),m.setTitle(f),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState){if(!m.idToState.hasOwnProperty(b))continue;a.idToState[b]=m.idToState[b]}for(b in m.urlToId){if(!m.urlToId.hasOwnProperty(b))continue;a.urlToId[b]=m.urlToId[b]}for(b in m.stateToId){if(!m.stateToId.hasOwnProperty(b))continue;a.stateToId[b]=m.stateToId[b]}m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload));if(!m.emulated.pushState){m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval));if(e.vendor==="Apple Computer, Inc."||(e.appCodeName||"")==="Mozilla")m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})}},m.init()}(window)'},function(t,e,n){n(0)(n(13))},function(t,e){t.exports='/**\n * jQuery Masonry v2.1.05\n * A dynamic layout plugin for jQuery\n * The flip-side of CSS Floats\n * http://masonry.desandro.com\n *\n * Licensed under the MIT license.\n * Copyright 2012 David DeSandro\n */\n(function(a,b,c){"use strict";var d=b.event,e;d.special.smartresize={setup:function(){b(this).bind("resize",d.special.smartresize.handler)},teardown:function(){b(this).unbind("resize",d.special.smartresize.handler)},handler:function(a,c){var d=this,f=arguments;a.type="smartresize",e&&clearTimeout(e),e=setTimeout(function(){b.event.dispatch.apply(d,f)},c==="execAsap"?0:50)}},b.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])},b.Mason=function(a,c){this.element=b(c),this._create(a),this._init()},b.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},b.Mason.prototype={_filterFindBricks:function(a){var b=this.options.itemSelector;return b?a.filter(b).add(a.find(b)):a},_getBricks:function(a){var b=this._filterFindBricks(a).css({position:"absolute"}).addClass("masonry-brick");return b},_create:function(c){this.options=b.extend(!0,{},b.Mason.settings,c),this.styleQueue=[];var d=this.element[0].style;this.originalStyle={height:d.height||""};var e=this.options.containerStyle;for(var f in e)this.originalStyle[f]=d[f]||"";this.element.css(e),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={x:parseInt(this.element.css("padding-"+this.horizontalDirection),10),y:parseInt(this.element.css("padding-top"),10)},this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var g=this;setTimeout(function(){g.element.addClass("masonry")},0),this.options.isResizable&&b(a).bind("smartresize.masonry",function(){g.resize()}),this.reloadItems()},_init:function(a){this._getColumns(),this._reLayout(a)},option:function(a,c){b.isPlainObject(a)&&(this.options=b.extend(!0,this.options,a))},layout:function(a,b){for(var c=0,d=a.length;c<d;c++)this._placeBrick(a[c]);var e={};e.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var f=0;c=this.cols;while(--c){if(this.colYs[c]!==0)break;f++}e.width=(this.cols-f)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:e});var g=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",h=this.options.animationOptions,i;for(c=0,d=this.styleQueue.length;c<d;c++)i=this.styleQueue[c],i.$el[g](i.style,h);this.styleQueue=[],b&&b.call(a),this.isLaidOut=!0},_getColumns:function(){var a=this.options.isFitWidth?this.element.parent():this.element,b=a.width();this.columnWidth=this.isFluid?this.options.columnWidth(b):this.options.columnWidth||this.$bricks.outerWidth(!0)||b,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((b+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(a){var c=b(a),d,e,f,g,h;d=Math.ceil(c.outerWidth(!0)/this.columnWidth),d=Math.min(d,this.cols);if(d===1)f=this.colYs;else{e=this.cols+1-d,f=[];for(h=0;h<e;h++)g=this.colYs.slice(h,h+d),f[h]=Math.max.apply(Math,g)}var i=Math.min.apply(Math,f),j=0;for(var k=0,l=f.length;k<l;k++)if(f[k]===i){j=k;break}var m={top:i+this.offset.y};m[this.horizontalDirection]=this.columnWidth*j+this.offset.x,this.styleQueue.push({$el:c,style:m});var n=i+c.outerHeight(!0),o=this.cols+1-l;for(k=0;k<o;k++)this.colYs[j+k]=n},resize:function(){var a=this.cols;this._getColumns(),(this.isFluid||this.cols!==a)&&this._reLayout()},_reLayout:function(a){var b=this.cols;this.colYs=[];while(b--)this.colYs.push(0);this.layout(this.$bricks,a)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(a){this.reloadItems(),this._init(a)},appended:function(a,b,c){if(b){this._filterFindBricks(a).css({top:this.element.height()});var d=this;setTimeout(function(){d._appended(a,c)},1)}else this._appended(a,c)},_appended:function(a,b){var c=this._getBricks(a);this.$bricks=this.$bricks.add(c),this.layout(c,b)},remove:function(a){this.$bricks=this.$bricks.not(a),a.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var c=this.element[0].style;for(var d in this.originalStyle)c[d]=this.originalStyle[d];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),b(a).unbind(".masonry")}},b.fn.imagesLoaded=function(a){function h(){a.call(c,d)}function i(a){var c=a.target;c.src!==f&&b.inArray(c,g)===-1&&(g.push(c),--e<=0&&(setTimeout(h),d.unbind(".imagesLoaded",i)))}var c=this,d=c.find("img").add(c.filter("img")),e=d.length,f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",g=[];return e||h(),d.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var a=this.src;this.src=f,this.src=a}),c};var f=function(b){a.console&&a.console.error(b)};b.fn.masonry2_1_05=function(a){if(typeof a=="string"){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=b.data(this,"masonry");if(!d){f("cannot call methods on masonry prior to initialization; attempted to call method \'"+a+"\'");return}if(!b.isFunction(d[a])||a.charAt(0)==="_"){f("no such method \'"+a+"\' for masonry instance");return}d[a].apply(d,c)})}else this.each(function(){var c=b.data(this,"masonry");c?(c.option(a||{}),c._init()):b.data(this,"masonry",new b.Mason(a,this))});return this}})(window,jQuery);'},function(t,e,n){n(0)(n(15))},function(t,e){t.exports='(function() {\n\n\tvar event = jQuery.event,\n\n\t\t//helper that finds handlers by type and calls back a function, this is basically handle\n\t\t// events - the events object\n\t\t// types - an array of event types to look for\n\t\t// callback(type, handlerFunc, selector) - a callback\n\t\t// selector - an optional selector to filter with, if there, matches by selector\n\t\t//     if null, matches anything, otherwise, matches with no selector\n\t\tfindHelper = function( events, types, callback, selector ) {\n\t\t\tvar t, type, typeHandlers, all, h, handle, \n\t\t\t\tnamespaces, namespace,\n\t\t\t\tmatch;\n\t\t\tfor ( t = 0; t < types.length; t++ ) {\n\t\t\t\ttype = types[t];\n\t\t\t\tall = type.indexOf(".") < 0;\n\t\t\t\tif (!all ) {\n\t\t\t\t\tnamespaces = type.split(".");\n\t\t\t\t\ttype = namespaces.shift();\n\t\t\t\t\tnamespace = new RegExp("(^|\\\\.)" + namespaces.slice(0).sort().join("\\\\.(?:.*\\\\.)?") + "(\\\\.|$)");\n\t\t\t\t}\n\t\t\t\ttypeHandlers = (events[type] || []).slice(0);\n\n\t\t\t\tfor ( h = 0; h < typeHandlers.length; h++ ) {\n\t\t\t\t\thandle = typeHandlers[h];\n\t\t\t\t\t\n\t\t\t\t\tmatch = (all || namespace.test(handle.namespace));\n\t\t\t\t\t\n\t\t\t\t\tif(match){\n\t\t\t\t\t\tif(selector){\n\t\t\t\t\t\t\tif (handle.selector === selector  ) {\n\t\t\t\t\t\t\t\tcallback(type, handle.origHandler || handle.handler);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (selector === null){\n\t\t\t\t\t\t\tcallback(type, handle.origHandler || handle.handler, handle.selector);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (!handle.selector ) {\n\t\t\t\t\t\t\tcallback(type, handle.origHandler || handle.handler);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t/**\n\t * Finds event handlers of a given type on an element.\n\t * @param {HTMLElement} el\n\t * @param {Array} types an array of event names\n\t * @param {String} [selector] optional selector\n\t * @return {Array} an array of event handlers\n\t */\n\tevent.find = function( el, types, selector ) {\n\t\tvar events = ( $._data(el) || {} ).events,\n\t\t\thandlers = [],\n\t\t\tt, liver, live;\n\n\t\tif (!events ) {\n\t\t\treturn handlers;\n\t\t}\n\t\tfindHelper(events, types, function( type, handler ) {\n\t\t\thandlers.push(handler);\n\t\t}, selector);\n\t\treturn handlers;\n\t};\n\t/**\n\t * Finds all events.  Group by selector.\n\t * @param {HTMLElement} el the element\n\t * @param {Array} types event types\n\t */\n\tevent.findBySelector = function( el, types ) {\n\t\tvar events = $._data(el).events,\n\t\t\tselectors = {},\n\t\t\t//adds a handler for a given selector and event\n\t\t\tadd = function( selector, event, handler ) {\n\t\t\t\tvar select = selectors[selector] || (selectors[selector] = {}),\n\t\t\t\t\tevents = select[event] || (select[event] = []);\n\t\t\t\tevents.push(handler);\n\t\t\t};\n\n\t\tif (!events ) {\n\t\t\treturn selectors;\n\t\t}\n\t\t//first check live:\n\t\t/*$.each(events.live || [], function( i, live ) {\n\t\t\tif ( $.inArray(live.origType, types) !== -1 ) {\n\t\t\t\tadd(live.selector, live.origType, live.origHandler || live.handler);\n\t\t\t}\n\t\t});*/\n\t\t//then check straight binds\n\t\tfindHelper(events, types, function( type, handler, selector ) {\n\t\t\tadd(selector || "", type, handler);\n\t\t}, null);\n\n\t\treturn selectors;\n\t};\n\tevent.supportTouch = "ontouchend" in document;\n\t\n\t$.fn.respondsTo = function( events ) {\n\t\tif (!this.length ) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\t//add default ?\n\t\t\treturn event.find(this[0], $.isArray(events) ? events : [events]).length > 0;\n\t\t}\n\t};\n\t$.fn.triggerHandled = function( event, data ) {\n\t\tevent = (typeof event == "string" ? $.Event(event) : event);\n\t\tthis.trigger(event, data);\n\t\treturn event.handled;\n\t};\n\t/**\n\t * Only attaches one event handler for all types ...\n\t * @param {Array} types llist of types that will delegate here\n\t * @param {Object} startingEvent the first event to start listening to\n\t * @param {Object} onFirst a function to call \n\t */\n\tevent.setupHelper = function( types, startingEvent, onFirst ) {\n\t\tif (!onFirst ) {\n\t\t\tonFirst = startingEvent;\n\t\t\tstartingEvent = null;\n\t\t}\n\t\tvar add = function( handleObj ) {\n\n\t\t\tvar bySelector, selector = handleObj.selector || "";\n\t\t\tif ( selector ) {\n\t\t\t\tbySelector = event.find(this, types, selector);\n\t\t\t\tif (!bySelector.length ) {\n\t\t\t\t\t$(this).delegate(selector, startingEvent, onFirst);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//var bySelector = event.find(this, types, selector);\n\t\t\t\tif (!event.find(this, types, selector).length ) {\n\t\t\t\t\tevent.add(this, startingEvent, onFirst, {\n\t\t\t\t\t\tselector: selector,\n\t\t\t\t\t\tdelegate: this\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\t\t\tremove = function( handleObj ) {\n\t\t\t\tvar bySelector, selector = handleObj.selector || "";\n\t\t\t\tif ( selector ) {\n\t\t\t\t\tbySelector = event.find(this, types, selector);\n\t\t\t\t\tif (!bySelector.length ) {\n\t\t\t\t\t\t$(this).undelegate(selector, startingEvent, onFirst);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!event.find(this, types, selector).length ) {\n\t\t\t\t\t\tevent.remove(this, startingEvent, onFirst, {\n\t\t\t\t\t\t\tselector: selector,\n\t\t\t\t\t\t\tdelegate: this\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t$.each(types, function() {\n\t\t\tevent.special[this] = {\n\t\t\t\tadd: add,\n\t\t\t\tremove: remove,\n\t\t\t\tsetup: function() {},\n\t\t\t\tteardown: function() {}\n\t\t\t};\n\t\t});\n\t};\n})(jQuery);\n(function($){\nvar isPhantom = /Phantom/.test(navigator.userAgent),\n\tsupportTouch = !isPhantom && "ontouchend" in document,\n\tscrollEvent = "touchmove scroll",\n\t// Use touch events or map it to mouse events\n\ttouchStartEvent = supportTouch ? "touchstart" : "mousedown",\n\ttouchStopEvent = supportTouch ? "touchend" : "mouseup",\n\ttouchMoveEvent = supportTouch ? "touchmove" : "mousemove",\n\tdata = function(event){\n\t\tvar d = event.originalEvent.touches ?\n\t\t\tevent.originalEvent.touches[ 0 ] :\n\t\t\tevent;\n\t\treturn {\n\t\t\ttime: (new Date).getTime(),\n\t\t\tcoords: [ d.pageX, d.pageY ],\n\t\t\torigin: $( event.target )\n\t\t};\n\t};\n\n/**\n * @add jQuery.event.swipe\n */\nvar swipe = $.event.swipe = {\n\t/**\n\t * @attribute delay\n\t * Delay is the upper limit of time the swipe motion can take in milliseconds.  This defaults to 500.\n\t * \n\t * A user must perform the swipe motion in this much time.\n\t */\n\tdelay : 500,\n\t/**\n\t * @attribute max\n\t * The maximum distance the pointer must travel in pixels.  The default is 75 pixels.\n\t */\n\tmax : 75,\n\t/**\n\t * @attribute min\n\t * The minimum distance the pointer must travel in pixels.  The default is 30 pixels.\n\t */\n\tmin : 30\n};\n\n$.event.setupHelper( [\n\n/**\n * @hide\n * @attribute swipe\n */\n"swipe",\n/**\n * @hide\n * @attribute swipeleft\n */\n\'swipeleft\',\n/**\n * @hide\n * @attribute swiperight\n */\n\'swiperight\',\n/**\n * @hide\n * @attribute swipeup\n */\n\'swipeup\',\n/**\n * @hide\n * @attribute swipedown\n */\n\'swipedown\'], touchStartEvent, function(ev){\n\tvar\n\t\t// update with data when the event was started\n\t\tstart = data(ev),\n\t\tstop,\n\t\tdelegate = ev.delegateTarget || ev.currentTarget,\n\t\tselector = ev.handleObj.selector,\n\t\tentered = this;\n\t\n\tfunction moveHandler(event){\n\t\tif ( !start ) {\n\t\t\treturn;\n\t\t}\n\t\t// update stop with the data from the current event\n\t\tstop = data(event);\n\n\t\t// prevent scrolling\n\t\tif ( Math.abs( start.coords[0] - stop.coords[0] ) > 10 ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t};\n\n\t// Attach to the touch move events\n\t$(document.documentElement).bind(touchMoveEvent, moveHandler)\n\t\t.one(touchStopEvent, function(event){\n\t\t\t$(this).unbind( touchMoveEvent, moveHandler);\n\t\t\t// if start and stop contain data figure out if we have a swipe event\n\t\t\tif ( start && stop ) {\n\t\t\t\t// calculate the distance between start and stop data\n\t\t\t\tvar deltaX = Math.abs(start.coords[0] - stop.coords[0]),\n\t\t\t\t\tdeltaY = Math.abs(start.coords[1] - stop.coords[1]),\n\t\t\t\t\tdistance = Math.sqrt(deltaX*deltaX+deltaY*deltaY);\n\n\t\t\t\t// check if the delay and distance are matched\n\t\t\t\tif ( stop.time - start.time < swipe.delay && distance >= swipe.min ) {\n\t\t\t\t\tvar events = [\'swipe\'];\n\t\t\t\t\t// check if we moved horizontally\n\t\t\t\t\tif( deltaX >= swipe.min && deltaY < swipe.min) {\n\t\t\t\t\t\t// based on the x coordinate check if we moved left or right\n\t\t\t\t\t\tevents.push( start.coords[0] > stop.coords[0] ? "swipeleft" : "swiperight" );\n\t\t\t\t\t} else\n\t\t\t\t\t// check if we moved vertically\n\t\t\t\t\tif(deltaY >= swipe.min && deltaX < swipe.min){\n\t\t\t\t\t\t// based on the y coordinate check if we moved up or down\n\t\t\t\t\t\tevents.push( start.coords[1] < stop.coords[1] ? "swipedown" : "swipeup" );\n\t\t\t\t\t}\n\n\t\t\t\t\t// trigger swipe events on this guy\n\t\t\t\t\t$.each($.event.find(delegate, events, selector), function(){\n\t\t\t\t\t\tthis.call(entered, ev, {start : start, end: stop})\n\t\t\t\t\t})\n\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t// reset start and stop\n\t\t\tstart = stop = undefined;\n\t\t})\n});\n\n})(jQuery)'},function(t,e,n){n(0)(n(17))},function(t,e){t.exports='/* url() v1.7.2 - http://github.com/websanova/js-url */window.url=(function(){function b(c){return !isNaN(parseFloat(c))&&isFinite(c)}return function a(p,d){var c=d||window.location.toString();if(c.substring(0,2)==="//"){c="http:"+c}else{if(c.split("://").length===1){c="http://"+c}}d=c.split("/");var g={auth:""},o=d[2].split("@");if(o.length===1){o=o[0].split(":")}else{g.auth=o[0];o=o[1].split(":")}g.protocol=d[0],g.hostname=o[0],g.port=(o[1]||"80"),g.pathname="/"+d.slice(3,d.length).join("/").split("?")[0].split("#")[0];var e=g.pathname;if(e.split(".").length===1&&e[e.length-1]!=="/"){e+="/"}var k=g.hostname,l=k.split("."),m=e.split("/");if(!p){return c}else{if(p==="hostname"){return k}else{if(p==="domain"){return l.slice(-2).join(".")}else{if(p==="tld"){return l.slice(-1).join(".")}else{if(p==="sub"){return l.slice(0,l.length-2).join(".")}else{if(p==="port"){return g.port||"80"}else{if(p==="protocol"){return g.protocol.split(":")[0]}else{if(p==="auth"){return g.auth}else{if(p==="user"){return g.auth.split(":")[0]}else{if(p==="pass"){return g.auth.split(":")[1]||""}else{if(p==="path"){return e}else{if(p[0]==="."){p=p.substring(1);if(b(p)){p=parseInt(p);return l[p<0?l.length+p:p-1]||""}}else{if(b(p)){p=parseInt(p);return m[p<0?m.length-1+p:p]||""}else{if(p==="file"){return m.slice(-1)[0]}else{if(p==="filename"){return m.slice(-1)[0].split(".")[0]}else{if(p==="fileext"){return m.slice(-1)[0].split(".")[1]||""}else{if(p[0]==="?"||p[0]==="#"){var h=c,f=null;if(p[0]==="?"){h=(h.split("?")[1]||"").split("#")[0]}else{if(p[0]==="#"){h=(h.split("#")[1]||"")}}if(!p[1]){return h}p=p.substring(1);h=h.split("&");for(var j=0,n=h.length;j<n;j++){f=h[j].split("=");if(f[0]===p){return f[1]}}}}}}}}}}}}}}}}}}}return""}})();'},function(t,e,n){n(0)(n(19))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(21))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(23))},function(t,e){t.exports="/**\n * gamma.js v1.0.0\n * http://www.codrops.com\n *\n * Licensed under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n *\n * Copyright 2012, Codrops\n * http://www.codrops.com\n */\n\n/**\n * Return a new JSON object of the old string.\n * Turns:\n * \t\tfile.js?a=1&amp;b.c=3.0&b.d=four&a_false_value=false&a_null_value=null\n * Into:\n * \t\t{\"a\":1,\"b\":{\"c\":3,\"d\":\"four\"},\"a_false_value\":false,\"a_null_value\":null}\n * @version 1.1.0\n * @date July 16, 2010\n * @since 1.0.0, June 30, 2010\n * @package jquery-sparkle {@link http://www.balupton/projects/jquery-sparkle}\n * @author Benjamin \"balupton\" Lupton {@link http://www.balupton.com}\n * @copyright (c) 2009-2010 Benjamin Arthur Lupton {@link http://www.balupton.com}\n * @license GNU Affero General Public License version 3 {@link http://www.gnu.org/licenses/agpl-3.0.html}\n */\nString.prototype.queryStringToJSON = String.prototype.queryStringToJSON || function ( )\n{\t// Turns a params string or url into an array of params\n\t// Prepare\n\tvar params = String(this);\n\t// Remove url if need be\n\tparams = params.substring(params.indexOf('?')+1);\n\t// params = params.substring(params.indexOf('#')+1);\n\t// Change + to %20, the %20 is fixed up later with the decode\n\tparams = params.replace(/\\+/g, '%20');\n\t// Do we have JSON string\n\tif ( params.substring(0,1) === '{' && params.substring(params.length-1) === '}' )\n\t{\t// We have a JSON string\n\t\treturn eval(decodeURIComponent(params));\n\t}\n\t// We have a params string\n\tparams = params.split(/\\&(amp\\;)?/);\n\tvar json = {};\n\t// We have params\n\tfor ( var i = 0, n = params.length; i < n; ++i )\n\t{\n\t\t// Adjust\n\t\tvar param = params[i] || null;\n\t\tif ( param === null ) { continue; }\n\t\tparam = param.split('=');\n\t\tif ( param === null ) { continue; }\n\t\t// ^ We now have \"var=blah\" into [\"var\",\"blah\"]\n\n\t\t// Get\n\t\tvar key = param[0] || null;\n\t\tif ( key === null ) { continue; }\n\t\tif ( typeof param[1] === 'undefined' ) { continue; }\n\t\tvar value = param[1];\n\t\t// ^ We now have the parts\n\n\t\t// Fix\n\t\tkey = decodeURIComponent(key);\n\t\tvalue = decodeURIComponent(value);\n\t\ttry {\n\t\t    // value can be converted\n\t\t    value = eval(value);\n\t\t} catch ( e ) {\n\t\t    // value is a normal string\n\t\t}\n\n\t\t// Set\n\t\t// window.console.log({'key':key,'value':value}, split);\n\t\tvar keys = key.split('.');\n\t\tif ( keys.length === 1 )\n\t\t{\t// Simple\n\t\t\tjson[key] = value;\n\t\t}\n\t\telse\n\t\t{\t// Advanced (Recreating an object)\n\t\t\tvar path = '',\n\t\t\t\tcmd = '';\n\t\t\t// Ensure Path Exists\n\t\t\t$.each(keys,function(ii,key){\n\t\t\t\tpath += '[\"'+key.replace(/\"/g,'\\\\\"')+'\"]';\n\t\t\t\tjsonCLOSUREGLOBAL = json; // we have made this a global as closure compiler struggles with evals\n\t\t\t\tcmd = 'if ( typeof jsonCLOSUREGLOBAL'+path+' === \"undefined\" ) jsonCLOSUREGLOBAL'+path+' = {}';\n\t\t\t\teval(cmd);\n\t\t\t\tjson = jsonCLOSUREGLOBAL;\n\t\t\t\tdelete jsonCLOSUREGLOBAL;\n\t\t\t});\n\t\t\t// Apply Value\n\t\t\tjsonCLOSUREGLOBAL = json; // we have made this a global as closure compiler struggles with evals\n\t\t\tvalueCLOSUREGLOBAL = value; // we have made this a global as closure compiler struggles with evals\n\t\t\tcmd = 'jsonCLOSUREGLOBAL'+path+' = valueCLOSUREGLOBAL';\n\t\t\teval(cmd);\n\t\t\tjson = jsonCLOSUREGLOBAL;\n\t\t\tdelete jsonCLOSUREGLOBAL;\n\t\t\tdelete valueCLOSUREGLOBAL;\n\t\t}\n\t\t// ^ We now have the parts added to your JSON object\n\t}\n\treturn json;\n};\n\n// checks if an element is partially inside the viewport\n// inspired by James Padolsey's snippet (http://remysharp.com/2009/01/26/element-in-view-event-plugin/#comment-127058)\n$.extend( $.expr[':'], {\n\n\tinViewport : function( el ) {\n\n\t\tvar scrollTop = ( document.documentElement.scrollTop || document.body.scrollTop ),\n\t\t\telOffsetTop = $( el ).offset().top,\n\t\t\telH = $( el ).height()\n\t\t\twinH = ( window.innerHeight && window.innerHeight < $( window ).height() ) ? window.innerHeight : $( window ).height();\n\n\t\treturn ( elOffsetTop + elH ) > scrollTop && elOffsetTop < ( scrollTop + winH );\n\n\t}\n\n});\n\n// HTML5 PageVisibility API\n// http://www.html5rocks.com/en/tutorials/pagevisibility/intro/\n// by Joe Marini (@joemarini)\nfunction getHiddenProp(){\n    var prefixes = ['webkit','moz','ms','o'];\n\n    // if 'hidden' is natively supported just return it\n    if ('hidden' in document) return 'hidden';\n\n    // otherwise loop over all the known prefixes until we find one\n    for (var i = 0; i < prefixes.length; i++){\n        if ((prefixes[i] + 'Hidden') in document)\n            return prefixes[i] + 'Hidden';\n    }\n\n    // otherwise it's not supported\n    return null;\n}\nfunction isHidden() {\n    var prop = getHiddenProp();\n    if (!prop) return false;\n\n    return document[prop];\n}\n\nvar Gamma = (function() {\n\n\tvar $window = $( window ),\n\t\t$body = $( 'body' ),\n\t\t$document = $( document ),\n\t\tModernizr = window.Modernizr,\n\t\t// https://github.com/twitter/bootstrap/issues/2870\n\t\ttransEndEventNames = {\n\t\t\t'WebkitTransition' : 'webkitTransitionEnd',\n\t\t\t'MozTransition' : 'transitionend',\n\t\t\t'OTransition' : 'oTransitionEnd',\n\t\t\t'msTransition' : 'MSTransitionEnd',\n\t\t\t'transition' : 'transitionend'\n\t\t},\n\t\ttransEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],\n\t\t// default settings\n\t\tdefaults = {\n\t\t\t// default value for masonry column count\n\t\t\tcolumns : 4,\n\t\t\t// transition properties for the images in ms (transition to/from singleview)\n\t\t\tspeed : 300,\n\t\t\teasing : 'ease',\n\t\t\t// if set to true the overlay's opacity will animate (transition to/from singleview)\n\t\t\toverlayAnimated : true,\n\t\t\t// if true, the navigate next function is called when the image (singleview) is clicked\n\t\t\tnextOnClickImage : true,\n\t\t\t// circular navigation\n\t\t\tcircular : true,\n\t\t\t// transition settings for the image in the single view.\n\t\t\t// These includes:\n\t\t\t// - ajusting its position and size when the window is resized\n\t\t\t// - fading out the image when navigating\n\t\t\tsvImageTransitionSpeedFade : 300,\n\t\t\tsvImageTransitionEasingFade : 'ease-in-out',\n\t\t\tsvImageTransitionSpeedResize : 300,\n\t\t\tsvImageTransitionEasingResize : 'ease-in-out',\n\t\t\tsvMarginsVH : {\n\t\t\t\tvertical : 140,\n\t\t\t\thorizontal : 120\n\t\t\t},\n\t\t\t// allow keybord and swipe navigation\n\t\t\tkeyboard : true,\n\t\t\tswipe : true,\n\t\t\t// slideshow interval (ms)\n\t\t\tinterval : 4000,\n\t\t\t// if History API is not supported this value will turn false\n\t\t\thistoryapi : true\n\t\t},\n\n\t\tsetTransEndEventName = function ( transEventName ){\n\t\t\ttransEndEventName = transEventName;\n\t\t},\n\t\t\n\t\tinit = function( settings, callback ) {\n\n\t\t\tGamma.settings = $.extend( true, {}, defaults, settings );\n\n\t\t\t// cache some elements..\n\t\t\t_config();\n\t\t\t// build the layout\n\t\t\t_layout();\n\t\t\t// init masonry\n\t\t\t_initMasonry( function() {\n\n\t\t\t\t// remove loading status\n\t\t\t\tGamma.container.removeClass( 'gamma-loading' );\n\t\t\t\t// show items\n\t\t\t\tGamma.items.show();\n\n\t\t\t\t// opens the single view if an image id is passed in the url\n\t\t\t\t// we will assume for this demo that the id is the index of the item\n\t\t\t\t// where the image is\n\t\t\t\t// example: http://www.sitename.com/gamma/?img=12\n\t\t\t\tif( Gamma.settings.historyapi ) {\n\n\t\t\t\t\t_goto();\n\n\t\t\t\t}\n\n\t\t\t\t// init window events\n\t\t\t\t_initEvents( 'window' );\n\n\t\t\t\tif( callback ) {\n\n\t\t\t\t\tcallback.call();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t},\n\t\t_config = function() {\n\n\t\t\tGamma.container = $( Gamma.settings.elementId );\n\t\t\tGamma.overlay = Gamma.container.find( 'div.gamma-overlay' );\n\t\t\tGamma.controls = Gamma.container.children( 'div.gamma-options' );\n\t\t\tGamma.gallery = Gamma.container.children( 'ul.gamma-gallery' );\n\t\t\tGamma.items = Gamma.gallery.children();\n\t\t\tGamma.itemsCount = Gamma.items.length;\n\t\t\tGamma.columns = Gamma.settings.columns;\n\t\t\t// true if any animation (including preloading an image) running\n\t\t\tGamma.isAnimating = true;\n\t\t\tGamma.svMargins = Gamma.settings.svMarginsVH;\n\t\t\tvar History = window.History; // Note: We are using a capital H instead of a lower h\n\t\t\tif ( !History.enabled && Gamma.settings.historyapi ) {\n\n\t\t\t\tGamma.settings.historyapi = false;\n\n\t\t\t}\n\t\t\tGamma.supportTransitions = Modernizr.csstransitions;\n\n\t\t},\n\t\t_createSingleView = function() {\n\n\t\t\t// the single view will include the image, navigation buttons and close, play, and pause buttons\n\n\t\t\tif( !Gamma.singleview ) {\n\n\t\t\t\t$( '<div class=\"gamma-single-view\"><div class=\"gamma-options gamma-options-single\"><div class=\"gamma-buttons\"><button class=\"gamma-btn-close\"></button></div></div></div>' )\n\t\t\t\t.appendTo( Gamma.container );\n\n\t\t\t\tGamma.singleview = Gamma.container.children( 'div.gamma-single-view' );\n\t\t\t\tGamma.svclose = Gamma.singleview.find( 'button.gamma-btn-close' );\n\n\t\t\t\t_initEvents( 'singleview' );\n\n\t\t\t\t_createSingleViewNavigation();\n\n\t\t\t}\n\t\t\telse if( !Gamma.nav ) {\n\n\t\t\t\t_createSingleViewNavigation();\n\n\t\t\t}\n\n\t\t},\n\t\t_createSingleViewNavigation = function() {\n\n\t\t\tif( Gamma.itemsCount > 1 ) {\n\n\t\t\t\tGamma.svplay = $( '<button class=\"gamma-btn-ssplay\"></button>' ).insertAfter( Gamma.svclose );\n\t\t\t\tGamma.nav = $( '<nav class=\"gamma-nav\"><span class=\"gamma-prev\"></span><span class=\"gamma-next\"></span></nav>' ).appendTo( Gamma.singleview );\n\t\t\t\tGamma.svnavnext = Gamma.nav.find( 'span.gamma-next' );\n\t\t\t\tGamma.svnavprev = Gamma.nav.find( 'span.gamma-prev' );\n\n\t\t\t\t_initEvents( 'singleviewnavigation' );\n\n\t\t\t}\n\n\t\t},\n\t\t// controller: \"goes to\" a specific image or back to the grid\n\t\t_goto = function( anim, id ) {\n\n\t\t\tif( Gamma.settings.historyapi ) {\n\n\t\t\t\t// get the url from history state (e.g. id=3) and extract the id\n\t\t\t\tid = id || History.getState().url.queryStringToJSON().id;\n\n\t\t\t}\n\n\t\t\tvar isSingleview = ( id != undefined ),\n\t\t\t\tanim = anim || false;\n\n\t\t\t// back history to a state with no id\n\t\t\tif( Gamma.settings.historyapi && Gamma.isSV && id === undefined ) {\n\n\t\t\t\t_closesingleview();\n\n\t\t\t}\n\n\t\t\tif( isSingleview ) {\n\n\t\t\t\tvar $item = Gamma.items.eq( Math.abs( id ) );\n\n\t\t\t\tif( $item.length ) {\n\n\t\t\t\t\tif( Gamma.svImage ) {\n\n\t\t\t\t\t\t// navigating\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t\t\t_setTransition( Gamma.svImage , 'all', Gamma.settings.svImageTransitionSpeedFade , Gamma.settings.svImageTransitionEasingFade );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_applyAnimation( Gamma.svImage, { opacity : 0 }, Gamma.settings.svImageTransitionSpeedFade, Gamma.supportTransitions, function() {\n\n\t\t\t\t\t\t\t$( this ).remove();\n\t\t\t\t\t\t\tanim = false;\n\t\t\t\t\t\t\t_singleviewitem( $item, anim );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tif( Gamma.svDescription ) {\n\n\t\t\t\t\t\t\t_applyAnimation( Gamma.svDescription, { opacity : 0 }, 400, Gamma.supportTransitions );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\n\t\t\t\t\t\tif( Gamma.svDescription ) {\n\n\t\t\t\t\t\t\tGamma.svDescription.empty();\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_singleviewitem( $item, anim );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\t\t// saves the history state / or if history not supported goes to specific image\n\t\t_saveState = function( id ) {\n\n\t\t\tif( !Gamma.settings.historyapi && id != undefined ) {\n\n\t\t\t\tGamma.isSV ? _goto( false, id ) : _goto( true, id );\n\n\t\t\t}\n\t\t\telse if( id === undefined ) {\n\n\t\t\t\tHistory.pushState(\n\t\t\t\t\tnull,\n\t\t\t\t\tnull,\n\t\t\t\t\turl('protocol') + '://' + url('hostname') + ((url('port') != 80)?':' + url('port'):'') + url('path')\n\t\t\t\t);\n\n\t\t\t}\n\t\t\t// adds a new state to the history object\n\t\t\t// this will trigger the statechange on the window\n\t\t\telse if( History.getState().url.queryStringToJSON().id !== id ) {\n\n\t\t\t\tHistory.pushState( null, null, '?id=' + id );\n\n\t\t\t}\n\n\t\t},\n\t\t// transform initial html structure into a list of images (well mostly)\n\t\t_layout = function( $items ) {\n\n\t\t\tif( Gamma.itemsCount > 0 ) {\n\n\t\t\t\t_createSingleView();\n\n\t\t\t}\n\n\t\t\t_setMasonry();\n\n\t\t\tvar $items = $items || Gamma.items.hide();\n\n\t\t\t// replace each div element with an image element with the right source\n\t\t\t$items.each( function() {\n\n\t\t\t\tvar $item = $( this ),\n\t\t\t\t\t$picEl = $item.children(),\n\t\t\t\t\tsources = _getImgSources( $picEl ),\n\t\t\t\t\tsource = _chooseImgSource( sources, $item.outerWidth( true ) ),\n\t\t\t\t\tdescription = $picEl.data( 'description' );\n\n\t\t\t\t// data is saved in the <li> element\n\t\t\t\t$item.data( {\n\t\t\t\t\tdescription : description,\n\t\t\t\t\tsource : sources,\n\t\t\t\t\tmaxwidth : $picEl.data( 'maxWidth' ),\n\t\t\t\t\tmaxheight : $picEl.data( 'maxHeight' )\n\t\t\t\t} );\n\n\t\t\t\t$( '<div/>' ).addClass( 'gamma-description' ).html( description ).insertAfter( $picEl );\n\n\t\t\t\t$( '<img/>' ).attr( {\n\t\t\t\t\talt : $picEl.data( 'alt' ),\n\t\t\t\t\ttitle : $picEl.data( 'title' ),\n\t\t\t\t\tsrc : source.src\n\t\t\t\t} ).insertAfter( $picEl );\n\n\t\t\t\t$picEl.remove();\n\n\t\t\t} );\n\n\t\t},\n\t\t// gets all possible image sources of an element\n\t\t_getImgSources = function( $el ) {\n\n\t\t\tvar theSources = [];\n\t\t\t$el.children( 'div' ).each( function( i ) {\n\n\t\t\t\tvar $source = $( this );\n\t\t\t\ttheSources.push( {\n\t\t\t\t\twidth : $source.data( 'minWidth' ) || 0,\n\t\t\t\t\tsrc : $source.data( 'src' ),\n\t\t\t\t\tpos : i\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t\treturn theSources;\n\n\t\t},\n\t\t// change the number of masonry columns based on the current container's width and the settings.viewport configuration\n\t\t_setMasonry = function() {\n\n\t\t\tvar containerW = Gamma.container.width();\n\n\t\t\tif( Gamma.settings.viewport ) {\n\n\t\t\t\tfor( var i = 0, len = Gamma.settings.viewport.length; i < len; ++i ) {\n\n\t\t\t\t\tvar viewport = Gamma.settings.viewport[i];\n\n\t\t\t\t\tif( containerW > viewport.width ) {\n\n\t\t\t\t\t\tGamma.columns = viewport.columns;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// set the widths (%) for each of the <li>\n\t\t\tGamma.items.css( 'width', Math.floor( containerW / Gamma.columns ) * 100 / containerW + '%' );\n\n\t\t},\n\t\t// initialize masonry\n\t\t_initMasonry = function( callback ) {\n\n\t\t\tGamma.gallery.imagesLoaded( function() {\n\n\t\t\t\tGamma.gallery.masonry2_1_05( {\n\t\t\t\t\titemSelector : 'li',\n\t\t\t\t\tcolumnWidth : function( containerWidth ) {\n\t\t\t\t\t\treturn containerWidth / Gamma.columns;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tif( callback ) {\n\n\t\t\t\t\tcallback.call();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t},\n\t\t// reloads masonry grid\n\t\t_reloadMasonry = function( timeout ) {\n\n\t\t\tclearTimeout( Gamma.masonrytimeout );\n\t\t\ttimeout = timeout || 0;\n\t\t\tGamma.masonrytimeout = setTimeout( function() { Gamma.gallery.masonry2_1_05( 'reload' ); }, timeout );\n\n\t\t},\n\t\t// choose a source based on the item's size and on the configuration set by the user in the initial HTML\n\t\t_chooseImgSource = function( sources, w ) {\n\n\t\t\tif( w <= 0 ) {\n\t\t\t\tw = 1;\n\t\t\t}\n\n\t\t\tfor( var i = 0, len = sources.length; i < len; ++i ) {\n\n\t\t\t\tvar source = sources[i];\n\n\n\t\t\t\tif( w > source.width ) {\n\n\t\t\t\t\treturn source;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t},\n\t\t// show or hide a specific control button\n\t\t_toggleControl = function( $control, status, animStyle ) {\n\n\t\t\tanimStyle ? $control.css( animStyle ) : status === 'on' ? $control.show() : $control.hide();\n\n\t\t},\n\t\t// triggered on the events for the nav buttons, keyboard, swipe\n\t\t_onnavigate = function( dir ) {\n\n\t\t\tif( !Gamma.slideshow ) {\n\n\t\t\t\t_navigate( dir );\n\n\t\t\t}\n\n\t\t},\n\t\t// goes to next or previous image\n\t\t_navigate = function( dir ) {\n\n\t\t\tif( !Gamma.isSV || Gamma.isAnimating ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tvar current = Gamma.current;\n\n\t\t\tif( dir === 'next' ) {\n\n\t\t\t\tGamma.current = Gamma.current < Gamma.itemsCount - 1 ? ++Gamma.current :\n\t\t\t\t\tGamma.settings.circular ? 0 : Gamma.current;\n\n\t\t\t}\n\t\t\telse if( dir === 'prev' ) {\n\n\t\t\t\tGamma.current = Gamma.current > 0 ? --Gamma.current :\n\t\t\t\t\tGamma.settings.circular ? Gamma.itemsCount - 1 : Gamma.current;\n\n\t\t\t}\n\n\t\t\tif( current === Gamma.current ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tGamma.isAnimating = true;\n\n\t\t\t// get positions, dimentions and source for the new item\n\t\t\t_saveState( Gamma.current );\n\n\t\t},\n\t\t// resize the window event\n\t\t_resize = function() {\n\n\t\t\t_setMasonry();\n\n\t\t\t_resizeGrid();\n\n\t\t\t// change the size, position and source of the image (single view) accordingly\n\t\t\tif( Gamma.isSV ) {\n\n\t\t\t\t_svResizeImage();\n\n\t\t\t}\n\n\t\t\t// seems that sometimes the masonry columns stay out of order.\n\t\t\t// just to make sure this doesnt happen\n\t\t\t_reloadMasonry( 200 );\n\n\t\t},\n\t\t// resizes the masonry grid\n\t\t// change the source of the images (grid) accordingly\n\t\t_resizeGrid = function() {\n\n\t\t\tGamma.items.each( function() {\n\n\t\t\t\tvar $item = $( this ),\n\t\t\t\t\tsource = _chooseImgSource( $item.data( 'source' ), Gamma.items.outerWidth( true ) );\n\n\t\t\t\t$item.find( 'img' ).attr( 'src', source.src );\n\n\t\t\t} );\n\n\t\t}\n\t\t// resize and chooses (if necessary) a new source for the image in the single view\n\t\t_svResizeImage = function( callback ) {\n\n\t\t\t// need to know which source to load for the image.\n\t\t\t// also need to know the final size and position.\n\t\t\tvar finalConfig = _getFinalImgConfig( {\n\n\t\t\t\t\tsources : Gamma.svImage.data( 'source' ),\n\t\t\t\t\timgMaxW : Gamma.svImage.data( 'maxwidth' ),\n\t\t\t\t\timgMaxH : Gamma.svImage.data( 'maxheight' ),\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\n\t\t\t\t\timage : { width : Gamma.svImage.width(), height : Gamma.svImage.height() }\n\n\t\t\t\t} ),\n\t\t\t\tsource = finalConfig.source,\n\t\t\t\tfinalSizePosition = finalConfig.finalSizePosition,\n\n\t\t\t\tcurrentSrc = Gamma.svImage.attr('src'),\n\n\t\t\t\tfinalStyle = {\n\t\t\t\t\twidth : finalSizePosition.width,\n\t\t\t\t\theight : finalSizePosition.height,\n\t\t\t\t\tleft : finalSizePosition.left + Gamma.svMargins.horizontal / 2,\n\t\t\t\t\ttop : finalSizePosition.top + Gamma.svMargins.vertical / 2\n\t\t\t\t};\n\n\t\t\t_applyAnimation( Gamma.svImage, finalStyle, Gamma.settings.svImageTransitionSpeedResize, Gamma.supportTransitions, function() {\n\n\t\t\t\tif( Gamma.supportTransitions ) {\n\t\t\t\t\t$( this ).off( transEndEventName );\n\t\t\t\t}\n\n\t\t\t\t// if source changes, change reset Gamma.svImage\n\t\t\t\tif( currentSrc !== source.src ) {\n\n\t\t\t\t\t// going to load a new image..\n\t\t\t\t\tGamma.isAnimating = true;\n\n\t\t\t\t\tvar w = Gamma.svImage.width(),\n\t\t\t\t\t\th = Gamma.svImage.height(),\n\t\t\t\t\t\tl = Gamma.svImage.position().left,\n\t\t\t\t\t\tt = Gamma.svImage.position().top;\n\n\t\t\t\t\tGamma.svImage = $( '<img/>' ).load( function() {\n\n\t\t\t\t\t\tvar $img = $( this );\n\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t\t\t_setTransition( $img , 'all', Gamma.settings.svImageTransitionSpeedResize , Gamma.settings.svImageTransitionEasingResize );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_applyAnimation( $img.next(), { opacity : 0 }, 500, Gamma.supportTransitions, function() {\n\n\t\t\t\t\t\t\tvar $img = $( this );\n\t\t\t\t\t\t\tif( Gamma.supportTransitions ) {\n\t\t\t\t\t\t\t\t$( this ).off( transEndEventName );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$img.remove();\n\t\t\t\t\t\t\tGamma.isAnimating = false;\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} )\n\t\t\t\t\t.css( { width : w, height : h, left : l, top : t } )\n\t\t\t\t\t.data( Gamma.svImage.data() )\n\t\t\t\t\t.insertBefore( Gamma.svImage )\n\t\t\t\t\t.attr( 'src', source.src );\n\n\t\t\t\t}\n\n\t\t\t\tif( callback ) {\n\n\t\t\t\t\tcallback.call();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t},\n\t\t// gets the position and sizes of the image given its container properties\n\t\t_getFinalImgConfig = function( properties ) {\n\n\t\t\tvar sources = properties.sources,\n\t\t\t\timgMaxW = properties.imgMaxW || 0,\n\t\t\t\timgMaxH = properties.imgMaxH || 0,\n\t\t\t\tsource = _chooseImgSource( sources, properties.wrapper.width ),\n\t\t\t\t// calculate final size and position of image\n\t\t\t\tfinalSizePosition = _getFinalSizePosition( properties.image, properties.wrapper );\n\n\t\t\t// check for new source\n\t\t\tif( finalSizePosition.checksource ) {\n\n\t\t\t\tsource = _chooseImgSource( sources, finalSizePosition.width );\n\n\t\t\t}\n\n\t\t\t// we still need to check one more detail:\n\t\t\t// if the source is the largest one provided in the html rules,\n\t\t\t// then we need to check if the final width/height are eventually bigger\n\t\t\t// than the original image sizes. If so, we will show the image\n\t\t\t// with its original size, avoiding like this that the image gets pixelated\n\t\t\tif( source.pos === 0 && ( imgMaxW !== 0 && finalSizePosition.width > imgMaxW || imgMaxH !== 0 && finalSizePosition.height > imgMaxH ) ) {\n\n\t\t\t\tif( imgMaxW !== 0 && finalSizePosition.width > imgMaxW ) {\n\n\t\t\t\t\tvar ratio = finalSizePosition.width / imgMaxW;\n\t\t\t\t\tfinalSizePosition.width = imgMaxW;\n\t\t\t\t\tfinalSizePosition.height /= ratio;\n\n\t\t\t\t}\n\t\t\t\telse if( imgMaxH !== 0 && finalSizePosition.height > imgMaxH ) {\n\n\t\t\t\t\tvar ratio = finalSizePosition.height / imgMaxH;\n\t\t\t\t\tfinalSizePosition.height = imgMaxH;\n\t\t\t\t\tfinalSizePosition.width /= ratio;\n\n\t\t\t\t}\n\n\t\t\t\tfinalSizePosition.left = properties.wrapper.width / 2 - finalSizePosition.width / 2;\n\t\t\t\tfinalSizePosition.top = properties.wrapper.height / 2 - finalSizePosition.height / 2;\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tsource : source,\n\t\t\t\tfinalSizePosition : finalSizePosition\n\t\t\t};\n\n\t\t},\n\t\t// triggered when one grid image is clicked\n\t\t_singleview = function() {\n\n\t\t\tvar id = $( this ).index();\n\t\t\t_saveState( id );\n\n\t\t},\n\t\t// shows the item\n\t\t_singleviewitem = function( $item, anim ) {\n\n\t\t\tGamma.isSV = true;\n\n\t\t\tvar id = $item.index(),\n\t\t\t\tdata = $item.data(),\n\t\t\t\t$img = $item.children( 'img' );\n\n\t\t\tif( anim ) {\n\n\t\t\t\tGamma.fly = $( '<img/>' ).attr( 'src', $img.attr( 'src' ) ).addClass( 'gamma-img-fly' ).css( {\n\t\t\t\t\twidth : $img.width(),\n\t\t\t\t\theight : $img.height(),\n\t\t\t\t\tleft : $item.offset().left + ( $item.outerWidth( true ) - $item.width() ) / 2,\n\t\t\t\t\ttop : $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2\n\t\t\t\t} ).appendTo( $body );\n\n\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t_setTransition( Gamma.fly );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// need to know which source to load for the image.\n\t\t\t// also need to know the final size and position.\n\t\t\tvar\tfinalConfig = _getFinalImgConfig( {\n\n\t\t\t\t\tsources : $item.data( 'source' ),\n\t\t\t\t\timgMaxW : $item.data( 'maxwidth' ),\n\t\t\t\t\timgMaxH : $item.data( 'maxheight' ),\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\n\t\t\t\t\timage : { width : $img.width(), height : $img.height() }\n\n\t\t\t\t} ),\n\t\t\t\tsource = finalConfig.source,\n\t\t\t\tfinalSizePosition = finalConfig.finalSizePosition;\n\n\t\t\tGamma.current = id;\n\n\t\t\t// transition: overlay opacity\n\t\t\tGamma.overlay.show();\n\n\t\t\tif( Gamma.settings.overlayAnimated && anim && Gamma.supportTransitions ) {\n\n\t\t\t\t_setTransition( Gamma.overlay , 'opacity' );\n\n\t\t\t}\n\n\t\t\tsetTimeout( function() {\n\n\t\t\t\t_applyAnimation( Gamma.overlay, { 'opacity' : 1 }, Gamma.settings.speed, Gamma.supportTransitions || !anim, function() {\n\n\t\t\t\t\tif( !Gamma.isSV ) {\n\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t}\n\t\t\t\t\tif( Gamma.supportTransitions ) {\n\t\t\t\t\t\t$( this ).off( transEndEventName );\n\t\t\t\t\t}\n\n\t\t\t\t\t// set the overflow-y to hidden\n\t\t\t\t\t$body.css( 'overflow-y', 'hidden' );\n\t\t\t\t\t// force repaint. Chrome in Windows does not remove overflow..\n\t\t\t\t\t// http://stackoverflow.com/a/3485654/989439\n\t\t\t\t\tvar el = Gamma.overlay[0];\n\t\t\t\t\tel.style.display='none';\n\t\t\t\t\tel.offsetHeight; // no need to store this anywhere, the reference is enough\n\t\t\t\t\tel.style.display='block';\n\n\t\t\t\t} );\n\n\t\t\t\t$item.css( 'visibility', 'hidden' );\n\n\t\t\t\tif( !anim ) {\n\n\t\t\t\t\t_loadSVItemFromGrid( data, finalSizePosition, source.src );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tvar styleCSS = {\n\t\t\t\t\t\t\twidth : finalSizePosition.width,\n\t\t\t\t\t\t\theight : finalSizePosition.height,\n\t\t\t\t\t\t\tleft : finalSizePosition.left + $window.scrollLeft() + Gamma.svMargins.horizontal / 2,\n\t\t\t\t\t\t\ttop : finalSizePosition.top + $window.scrollTop() + Gamma.svMargins.vertical / 2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcond = Gamma.supportTransitions;\n\n\t\t\t\t\t_applyAnimation( Gamma.fly, styleCSS, Gamma.settings.speed, cond, function() {\n\n\t\t\t\t\t\tif( cond ) {\n\t\t\t\t\t\t\t$( this ).off( transEndEventName );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_loadSVItemFromGrid( data, finalSizePosition, source.src );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}, 25 );\n\n\t\t},\n\t\t// load new image for the new item to show\n\t\t_loadSVItemFromGrid = function( data, position, src ) {\n\n\t\t\t// show single view\n\t\t\tGamma.singleview.show();\n\n\t\t\t// add description\n\t\t\tif( !Gamma.svDescription ) {\n\n\t\t\t\tGamma.svDescription = $( '<div/>' )\n\t\t\t\t\t\t\t\t\t\t.addClass( 'gamma-description' )\n\t\t\t\t\t\t\t\t\t\t.appendTo( Gamma.singleview ).wrap( '<div class=\"gamma-description-wrapper\"></div>' );\n\n\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t_setTransition( Gamma.svDescription , 'opacity', Gamma.settings.svImageTransitionSpeedFade / 2 , Gamma.settings.svImageTransitionEasingFade );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tGamma.svDescription.html( data.description );\n\n\t\t\t// loading status: give a little amount of time before displaying it\n\t\t\tvar loadingtimeout = setTimeout( function() { Gamma.singleview.addClass( 'gamma-loading' );\t}, Gamma.settings.svImageTransitionSpeedFade + 250 );\n\n\t\t\t// preload the new image\n\t\t\tGamma.svImage = $( '<img/>' ).load( function() {\n\n\t\t\t\tvar $img = $( this );\n\n\t\t\t\t// remove loading status\n\t\t\t\tclearTimeout( loadingtimeout );\n\t\t\t\tGamma.singleview.removeClass( 'gamma-loading' );\n\n\t\t\t\tsetTimeout( function() {\n\n\t\t\t\t\t_applyAnimation( Gamma.svDescription, { 'opacity' : 1 }, Gamma.settings.svImageTransitionSpeedFade / 2, Gamma.supportTransitions );\n\n\t\t\t\t}, 25 );\n\n\t\t\t\t$img.css( {\n\t\t\t\t\twidth : position.width,\n\t\t\t\t\theight : position.height,\n\t\t\t\t\tleft : position.left + Gamma.svMargins.horizontal / 2,\n\t\t\t\t\ttop : position.top + Gamma.svMargins.vertical / 2\n\t\t\t\t} ).appendTo( Gamma.singleview );\n\n\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t_setTransition( $img , 'all', Gamma.settings.svImageTransitionSpeedResize , Gamma.settings.svImageTransitionEasingResize );\n\n\t\t\t\t}\n\n\t\t\t\tif( Gamma.fly ) {\n\n\t\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t\t_setTransition( Gamma.fly, 'opacity', 1000 );\n\n\t\t\t\t\t}\n\t\t\t\t\tsetTimeout( function() {\n\n\t\t\t\t\t\t_applyAnimation( Gamma.fly, { 'opacity' : 0 }, 1000, Gamma.supportTransitions, function() {\n\n\t\t\t\t\t\t\tvar $this = $( this );\n\n\t\t\t\t\t\t\tif( Gamma.supportTransitions ) {\n\t\t\t\t\t\t\t\t$this.off( transEndEventName );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$this.remove();\n\t\t\t\t\t\t\tGamma.fly = null;\n\t\t\t\t\t\t\tGamma.isAnimating = false;\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}, 25 );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tGamma.isAnimating = false;\n\n\t\t\t\t}\n\n\t\t\t} ).data( data ).attr( 'src', src );\n\n\t\t},\n\t\t// given the wrapper's width and height, calculates the final width, height, left and top for the image to fit inside\n\t\t_getFinalSizePosition = function( imageSize, wrapperSize ) {\n\n\t\t\t// image size\n\t\t\tvar imgW = imageSize.width,\n\t\t\t\timgH = imageSize.height,\n\n\t\t\t\t// container size\n\t\t\t\twrapperW = wrapperSize.width,\n\t\t\t\twrapperH = wrapperSize.height,\n\n\t\t\t\tfinalW, finalH, finalL, finalT,\n\t\t\t\t// flag to indicate we could check for another source (smaller) for the image\n\t\t\t\tchecksource = false;\n\n\t\t\t// check which image side is bigger\n\t\t\tif( imgW > imgH ) {\n\n\t\t\t\tfinalW = wrapperW;\n\t\t\t\t// calculate the height given the finalW\n\t\t\t\tvar ratio = imgW / wrapperW;\n\n\t\t\t\tfinalH = imgH / ratio;\n\n\t\t\t\tif( finalH > wrapperH ) {\n\n\t\t\t\t\tchecksource = true;\n\t\t\t\t\tratio = finalH / wrapperH;\n\t\t\t\t\tfinalW /= ratio;\n\t\t\t\t\tfinalH = wrapperH;\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\tfinalH = wrapperH;\n\t\t\t\t// calculate the width given the finalH\n\t\t\t\tvar ratio = imgH / wrapperH;\n\n\t\t\t\tfinalW = imgW / ratio;\n\n\t\t\t\tchecksource = true;\n\n\t\t\t\tif( finalW > wrapperW ) {\n\n\t\t\t\t\tchecksource = false;\n\n\t\t\t\t\tratio = finalW / wrapperW;\n\t\t\t\t\tfinalW = wrapperW;\n\t\t\t\t\tfinalH /= ratio;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth : finalW,\n\t\t\t\theight : finalH,\n\t\t\t\tleft : wrapperW / 2 - finalW / 2,\n\t\t\t\ttop : wrapperH / 2 - finalH / 2,\n\t\t\t\tchecksource : checksource\n\t\t\t};\n\n\t\t},\n\t\t// closes the single view\n\t\t_closesingleview = function() {\n\n\t\t\tif( Gamma.isAnimating || Gamma.fly ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tGamma.isSV = false;\n\n\t\t\tif( Gamma.slideshow ) {\n\n\t\t\t\t_stopSlideshow();\n\n\t\t\t}\n\n\t\t\tvar $item = Gamma.items.eq( Gamma.current ),\n\t\t\t\t$img = $item.children( 'img' );\n\n\t\t\tGamma.items.not( $item ).css( 'visibility', 'visible' );\n\n\t\t\t// scroll window to item's position if item is not \"partially\" visible\n\t\t\tvar wst = $window.scrollTop();\n\n\t\t\tif( !$item.is( ':inViewport' ) ) {\n\n\t\t\t\twst = $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2;\n\n\t\t\t\tvar diff = $document.height() - $window.height();\n\n\t\t\t\tif( wst > diff ) {\n\n\t\t\t\t\twst = diff;\n\t\t\t\t}\n\n\t\t\t\t$window.scrollTop( wst );\n\n\t\t\t}\n\n\t\t\tvar l = Gamma.svImage.position().left + $window.scrollLeft(),\n\t\t\t\tt = Gamma.svImage.position().top + wst;\n\n\t\t\tGamma.svImage.appendTo( $body ).css( {\n\t\t\t\tposition : 'absolute',\n\t\t\t\tzIndex : 10000,\n\t\t\t\tleft : l,\n\t\t\t\ttop : t\n\t\t\t} );\n\n\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t_setTransition( Gamma.svImage  );\n\n\t\t\t}\n\n\t\t\tGamma.singleview.hide();\n\t\t\tGamma.svDescription.empty().css( 'opacity', 0 );\n\t\t\t$body.css( 'overflow-y', 'scroll' );\n\n\t\t\tsetTimeout( function() {\n\n\t\t\t\tvar styleCSS = {\n\t\t\t\t\twidth : $img.width(),\n\t\t\t\t\theight : $img.height(),\n\t\t\t\t\tleft : $item.offset().left + ( $item.outerWidth( true ) - $item.width() ) / 2,\n\t\t\t\t\ttop : $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2\n\t\t\t\t}\n\t\t\t\t_applyAnimation( Gamma.svImage, styleCSS, Gamma.settings.speed, Gamma.supportTransitions, function() {\n\n\t\t\t\t\t$item.css( 'visibility', 'visible' );\n\t\t\t\t\t$( this ).remove();\n\t\t\t\t\tGamma.svImage = null;\n\n\t\t\t\t} );\n\n\t\t\t\t// transition: overlay opacity\n\t\t\t\tif( Gamma.settings.overlayAnimated ) {\n\n\t\t\t\t\tif( Gamma.supportTransitions ) {\n\n\t\t\t\t\t\t_setTransition( Gamma.overlay , 'opacity' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_applyAnimation( Gamma.overlay, { 'opacity' : 0 }, Gamma.settings.speed, Gamma.supportTransitions, function() {\n\n\t\t\t\t\t\tvar $this = $( this );\n\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\n\t\t\t\t\t\t\t$this.off( transEndEventName );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.hide();\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tGamma.overlay.hide();\n\n\t\t\t\t}\n\n\t\t\t\t_saveState();\n\n\t\t\t}, 25 );\n\n\t\t},\n\t\t// the slideshow is active only if the page is visible\n\t\t_visChange = function() {\n\n\t\t\tif( Gamma.slideshow ) {\n\n\t\t\t\tisHidden() ? ( _stopSlideshow( true ), Gamma.slideshow = true ) : _prepareSlideshow();\n\n\t\t\t}\n\n\t\t},\n\t\t// before slideshow starts\n\t\t_prepareSlideshow = function() {\n\n\t\t\tif( Gamma.isAnimating && !Gamma.slideshow ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tGamma.isAnimating = true;\n\n\t\t\tclearTimeout( Gamma.slideshowtimeout );\n\n\t\t\tGamma.slideshow = true;\n\t\t\t// container is the window\n\t\t\tGamma.svMargins = {\n\t\t\t\tvertical : 0,\n\t\t\t\thorizontal : 0\n\t\t\t};\n\t\t\t_toggleControl( Gamma.svclose, 'off' );\n\t\t\t_toggleControl( Gamma.svnavprev, 'off', { left : -40 } );\n\t\t\t_toggleControl( Gamma.svnavnext, 'off', { right : -40 } );\n\n\t\t\t_svResizeImage( function() {\n\n\t\t\t\tGamma.isAnimating = false;\n\n\t\t\t\tGamma.svplay.addClass( 'gamma-btn-sspause' );\n\t\t\t\t_startSlideshow();\n\n\t\t\t} );\n\n\t\t},\n\t\t_preloadNext = function() {\n\n\t\t\t// preload image for Gamma.current + 1\n\t\t\tvar next = Gamma.current < Gamma.itemsCount - 1 ? Gamma.current + 1 :\n\t\t\t\tGamma.settings.circular ? 0 : Gamma.current,\n\t\t\t\t$item = Gamma.items.eq( next ),\n\t\t\t\t$img = $item.children( 'img' ),\n\t\t\t\tfinalConfig = _getFinalImgConfig( {\n\n\t\t\t\t\tsources : $item.data( 'source' ),\n\t\t\t\t\timgMaxW : $item.data( 'maxwidth' ),\n\t\t\t\t\timgMaxH : $item.data( 'maxheight' ),\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\n\t\t\t\t\timage : { width : $img.width(), height : $img.height() }\n\n\t\t\t\t} ),\n\t\t\t\tsource = finalConfig.source;\n\n\t\t\t$( '<img/>' ).attr( 'src', source.src );\n\n\t\t},\n\t\t// starts slideshow\n\t\t_startSlideshow = function() {\n\n\t\t\t_preloadNext();\n\n\t\t\tGamma.slideshowtimeout = setTimeout( function() {\n\n\t\t\t\t_navigate( 'next' );\n\t\t\t\t_startSlideshow();\n\n\t\t\t}, Gamma.settings.interval );\n\n\t\t},\n\t\t// stops slideshow\n\t\t_stopSlideshow = function( pause ) {\n\n\t\t\tif( Gamma.isAnimating ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tGamma.isAnimating = true;\n\n\t\t\tclearTimeout( Gamma.slideshowtimeout );\n\t\t\tif( !pause ) {\n\n\t\t\t\tGamma.slideshow = false;\n\t\t\t\tGamma.svplay.removeClass( 'gamma-btn-sspause' );\n\t\t\t\tGamma.svMargins = Gamma.settings.svMarginsVH;\n\t\t\t\t_toggleControl( Gamma.svclose, 'on' );\n\t\t\t\t_toggleControl( Gamma.svnavprev, 'on', { left : 20 } );\n\t\t\t\t_toggleControl( Gamma.svnavnext, 'on', { right : 20 } );\n\t\t\t\t_svResizeImage( function() {\n\n\t\t\t\t\tGamma.isAnimating = false;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t},\n\t\t// initializes events according to type\n\t\t_initEvents = function( type ) {\n\n\t\t\tswitch( type ) {\n\n\t\t\t\tcase 'window' :\n\n\t\t\t\t\tif( Gamma.settings.historyapi ) {\n\n\t\t\t\t\t\t$window.on( 'statechange.gamma', function() {\n\n\t\t\t\t\t\t\t_goto( true );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$window.on( 'smartresize.gamma', _resize );\n\n\t\t\t\t\t// use the property name to generate the prefixed event name\n\t\t\t\t\tvar visProp = getHiddenProp();\n\n\t\t\t\t\t// HTML5 PageVisibility API\n\t\t\t\t\t// http://www.html5rocks.com/en/tutorials/pagevisibility/intro/\n\t\t\t\t\t// by Joe Marini (@joemarini)\n\t\t\t\t\tif (visProp) {\n\n\t\t\t\t\t\tvar evtname = visProp.replace(/[H|h]idden/,'') + 'visibilitychange';\n\t\t\t\t\t\tdocument.addEventListener(evtname, _visChange);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'singleview' :\n\n\t\t\t\t\tGamma.gallery.on( 'click.gamma', 'li', _singleview );\n\t\t\t\t\tGamma.svclose.on( 'click.gamma', _closesingleview );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'singleviewnavigation' :\n\n\t\t\t\t\tGamma.svnavnext.on( 'click.gamma', function() { _onnavigate( 'next' ); } );\n\t\t\t\t\tGamma.svnavprev.on( 'click.gamma', function() { _onnavigate( 'prev' ); } );\n\n\t\t\t\t\tif( Gamma.settings.nextOnClickImage ) {\n\n\t\t\t\t\t\tGamma.singleview.on( 'click.gamma', 'img', function() { _onnavigate( 'next' ); } );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Gamma.settings.keyboard ) {\n\n\t\t\t\t\t\t$document.on( 'keydown.gamma', function( event ) {\n\n\t\t\t\t\t\t\tvar keyCode = event.keyCode || event.which,\n\t\t\t\t\t\t\t\tarrow = {\n\t\t\t\t\t\t\t\t\tleft: 37,\n\t\t\t\t\t\t\t\t\tup: 38,\n\t\t\t\t\t\t\t\t\tright: 39,\n\t\t\t\t\t\t\t\t\tdown: 40\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tswitch (keyCode) {\n\n\t\t\t\t\t\t\t\tcase arrow.left :\n\n\t\t\t\t\t\t\t\t\t_onnavigate( 'prev' );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase arrow.right :\n\n\t\t\t\t\t\t\t\t\t_onnavigate( 'next' );\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif( Gamma.settings.swipe ) {\n\n\t\t\t\t\t\tGamma.singleview.on( {\n\t\t\t\t\t\t\t'swipeleft.gamma' : function() {\n\n\t\t\t\t\t\t\t\t_onnavigate( 'next' );\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'swiperight.gamma' : function() {\n\n\t\t\t\t\t\t\t\t_onnavigate( 'prev' );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tGamma.svplay.on( 'click.gamma', function() {\n\n\t\t\t\t\t\tif( Gamma.slideshow ) {\n\n\t\t\t\t\t\t\t_stopSlideshow();\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if( !Gamma.isAnimating ) {\n\n\t\t\t\t\t\t\t_prepareSlideshow();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\n\t\t\t};\n\n\t\t},\n\t\t// sets a transition for an element\n\t\t_setTransition = function( el , property, speed, easing ) {\n\n\t\t\tif( !property ) {\n\n\t\t\t\tproperty = 'all';\n\n\t\t\t}\n\t\t\tif( !speed ) {\n\n\t\t\t\tspeed = Gamma.settings.speed;\n\n\t\t\t}\n\t\t\tif( !easing ) {\n\n\t\t\t\teasing = Gamma.settings.easing;\n\n\t\t\t}\n\n\t\t\tel.css( 'transition', property + ' ' + speed + 'ms ' + easing );\n\n\t\t},\n\t\t// apply a transition or fallback to jquery animate based on condition (cond)\n\t\t_applyAnimation = function( el, styleCSS, speed, cond, fncomplete ) {\n\n\t\t\t$.fn.applyStyle = cond ? $.fn.css : $.fn.animate;\n\n\t\t\tif( fncomplete && cond ) {\n\n\t\t\t\tel.on( transEndEventName, fncomplete );\n\n\t\t\t}\n\n\t\t\tfncomplete = fncomplete || function() { return false; };\n\n\t\t\tel.stop().applyStyle( styleCSS, $.extend( true, [], { duration : speed + 'ms', complete : fncomplete } ) );\n\n\t\t},\n\t\t// public method: adds more items\n\t\tadd = function( $newitems ) {\n\n\t\t\tGamma.gallery.append( $newitems );\n\t\t\tGamma.items = Gamma.gallery.children();\n\t\t\tGamma.itemsCount = Gamma.items.length;\n\t\t\t_layout( $newitems );\n\t\t\t_reloadMasonry();\n\n\t\t};\n\n\treturn {\n\t\tinit : init,\n\t\tadd : add,\n\t\tsetTransEndEventName : setTransEndEventName\n\t}\n\n})();"},function(t,e,n){n(0)(n(25))},function(t,e){t.exports='/*!\n * MediaElement.js\n * http://www.mediaelementjs.com/\n *\n * Wrapper that mimics native HTML5 MediaElement (audio and video)\n * using a variety of technologies (pure JavaScript, Flash, iframe)\n *\n * Copyright 2010-2017, John Dyer (http://j.hn/)\n * License: MIT\n *\n */\n!function r(a,s,l){function d(n,e){if(!s[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var o=new Error("Cannot find module \'"+n+"\'");throw o.code="MODULE_NOT_FOUND",o}var i=s[n]={exports:{}};a[n][0].call(i.exports,function(e){var t=a[n][1][e];return d(t||e)},i,i.exports,r,a,s,l)}return s[n].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,n){},{}],2:[function(i,r,e){(function(e){var t,n=void 0!==e?e:"undefined"!=typeof window?window:{},o=i(1);"undefined"!=typeof document?t=document:(t=n["__GLOBAL_DOCUMENT_CACHE@4"])||(t=n["__GLOBAL_DOCUMENT_CACHE@4"]=o),r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],3:[function(e,n,t){(function(e){var t;t="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},n.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,n,t){!function(e){var t=setTimeout;function o(){}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function i(n,o){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,r._immediateFn(function(){var e=1===n._state?o.onFulfilled:o.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void s(o.promise,e)}a(o.promise,t)}else(1===n._state?a:s)(o.promise,n._value)})):n._deferreds.push(o)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void d((o=n,i=e,function(){o.apply(i,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}var o,i}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=new this.constructor(o);return i(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},r.all=function(e){var s=Array.prototype.slice.call(e);return new r(function(o,i){if(0===s.length)return o([]);var r=s.length;function a(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){a(t,e)},i)}s[t]=e,0==--r&&o(s)}catch(e){i(e)}}for(var e=0;e<s.length;e++)a(e,s[e])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(n){return new r(function(e,t){t(n)})},r.race=function(i){return new r(function(e,t){for(var n=0,o=i.length;n<o;n++)i[n].then(e,t)})},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){t(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},void 0!==n&&n.exports?n.exports=r:e.Promise||(e.Promise=r)}(this)},{}],5:[function(e,t,n){var o,i;o=this,i=function(){function v(e,t,n){if(n){var o=document.createDocumentFragment(),i=!t.hasAttribute("viewBox")&&n.getAttribute("viewBox");i&&t.setAttribute("viewBox",i);for(var r=n.cloneNode(!0);r.childNodes.length;)o.appendChild(r.firstChild);e.appendChild(o)}}function g(o){o.onreadystatechange=function(){if(4===o.readyState){var n=o._cachedDocument;n||((n=o._cachedDocument=document.implementation.createHTMLDocument("")).body.innerHTML=o.responseText,o._cachedTarget={}),o._embeds.splice(0).map(function(e){var t=o._cachedTarget[e.id];t||(t=o._cachedTarget[e.id]=n.getElementById(e.id)),v(e.parent,e.svg,t)})}},o.onreadystatechange()}function y(e){for(var t=e;"svg"!==t.nodeName.toLowerCase()&&(t=t.parentNode););return t}return function(e){var u,c=Object(e),t=window.top!==window.self;u="polyfill"in c?c.polyfill:/\\bTrident\\/[567]\\b|\\bMSIE (?:9|10)\\.0\\b/.test(navigator.userAgent)||(navigator.userAgent.match(/\\bEdge\\/12\\.(\\d+)\\b/)||[])[1]<10547||(navigator.userAgent.match(/\\bAppleWebKit\\/(\\d+)\\b/)||[])[1]<537||/\\bEdge\\/.(\\d+)\\b/.test(navigator.userAgent)&&t;var f={},p=window.requestAnimationFrame||setTimeout,m=document.getElementsByTagName("use"),h=0;u&&function e(){for(var t=0;t<m.length;){var n=m[t],o=n.parentNode,i=y(o),r=n.getAttribute("xlink:href")||n.getAttribute("href");if(!r&&c.attributeName&&(r=n.getAttribute(c.attributeName)),i&&r){if(u)if(!c.validate||c.validate(r,i,n)){o.removeChild(n);var a=r.split("#"),s=a.shift(),l=a.join("#");if(s.length){var d=f[s];d||((d=f[s]=new XMLHttpRequest).open("GET",s),d.send(),d._embeds=[]),d._embeds.push({parent:o,svg:i,id:l}),g(d)}else v(o,i,document.getElementById(l))}else++t,++h}else++t}(!m.length||0<m.length-h)&&p(e,67)}()}},"function"==typeof define&&define.amd?define([],function(){return o.svg4everybody=i()}):"object"==typeof t&&t.exports?t.exports=i():o.svg4everybody=i()},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e(8),r=(o=i)&&o.__esModule?o:{default:o},s=e(16),l=e(28);var d={lang:"en",en:s.EN,language:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(null!=t&&t.length){if("string"!=typeof t[0])throw new TypeError("Language code must be a string value");if(!/^[a-z]{2,3}((\\-|_)[a-z]{2})?$/i.test(t[0]))throw new TypeError("Language code must have format 2-3 letters and. optionally, hyphen, underscore followed by 2 more letters");d.lang=t[0],void 0===d[t[0]]?(t[1]=null!==t[1]&&void 0!==t[1]&&"object"===a(t[1])?t[1]:{},d[t[0]]=(0,l.isObjectEmpty)(t[1])?s.EN:t[1]):null!==t[1]&&void 0!==t[1]&&"object"===a(t[1])&&(d[t[0]]=t[1])}return d.lang},t:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e&&e.length){var n=void 0,o=void 0,i=d.language(),r=function(e,t,n){return"object"!==(void 0===e?"undefined":a(e))||"number"!=typeof t||"number"!=typeof n?e:[function(){return arguments.length<=1?void 0:arguments[1]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 0===(arguments.length<=0?void 0:arguments[0])||1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:0!==(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])||11===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])||12===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:2<(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])<20?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:0===(arguments.length<=0?void 0:arguments[0])||0<(arguments.length<=0?void 0:arguments[0])%100&&(arguments.length<=0?void 0:arguments[0])%100<20?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:2<=(arguments.length<=0?void 0:arguments[0])%10&&((arguments.length<=0?void 0:arguments[0])%100<10||20<=(arguments.length<=0?void 0:arguments[0])%100)?arguments.length<=2?void 0:arguments[2]:[3]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:2<=(arguments.length<=0?void 0:arguments[0])%10&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||20<=(arguments.length<=0?void 0:arguments[0])%100)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2<=(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])<=4?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2<=(arguments.length<=0?void 0:arguments[0])%10&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||20<=(arguments.length<=0?void 0:arguments[0])%100)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return(arguments.length<=0?void 0:arguments[0])%100==1?arguments.length<=2?void 0:arguments[2]:(arguments.length<=0?void 0:arguments[0])%100==2?arguments.length<=3?void 0:arguments[3]:(arguments.length<=0?void 0:arguments[0])%100==3||(arguments.length<=0?void 0:arguments[0])%100==4?arguments.length<=4?void 0:arguments[4]:arguments.length<=1?void 0:arguments[1]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:2<(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])<7?arguments.length<=3?void 0:arguments[3]:6<(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])<11?arguments.length<=4?void 0:arguments[4]:arguments.length<=5?void 0:arguments[5]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:3<=(arguments.length<=0?void 0:arguments[0])%100&&(arguments.length<=0?void 0:arguments[0])%100<=10?arguments.length<=4?void 0:arguments[4]:11<=(arguments.length<=0?void 0:arguments[0])%100?arguments.length<=5?void 0:arguments[5]:arguments.length<=6?void 0:arguments[6]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:0===(arguments.length<=0?void 0:arguments[0])||1<(arguments.length<=0?void 0:arguments[0])%100&&(arguments.length<=0?void 0:arguments[0])%100<11?arguments.length<=2?void 0:arguments[2]:10<(arguments.length<=0?void 0:arguments[0])%100&&(arguments.length<=0?void 0:arguments[0])%100<20?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10==2?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 11!==(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])%10==1?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2<=(arguments.length<=0?void 0:arguments[0])%10&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||20<=(arguments.length<=0?void 0:arguments[0])%100)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:8!==(arguments.length<=0?void 0:arguments[0])&&11!==(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:3===(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]}][n].apply(null,[t].concat(e))};return void 0!==d[i]&&(n=d[i][e],null!==t&&"number"==typeof t&&(o=d[i]["mejs.plural-form"],n=r.apply(null,[n,t,o]))),!n&&d.en&&(n=d.en[e],null!==t&&"number"==typeof t&&(o=d.en["mejs.plural-form"],n=r.apply(null,[n,t,o]))),n=n||e,null!==t&&"number"==typeof t&&(n=n.replace("%1",t)),(0,l.escapeHTML)(n)}return e}};r.default.i18n=d,"undefined"!=typeof mejsL10n&&r.default.i18n.language(mejsL10n.language,mejsL10n.strings),n.default=d},{16:16,28:28,8:8}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F=o(e(3)),j=o(e(2)),I=o(e(8)),M=e(28),O=e(30),D=e(9),R=e(26);function o(e){return e&&e.__esModule?e:{default:e}}var i=function e(t,n,o){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var f=this;o=Array.isArray(o)?o:null,f.defaults={renderers:[],fakeNodeName:"div",pluginPath:"build/",iconSprite:"mejs-controls.svg",shimScriptAccess:"sameDomain"},n=Object.assign(f.defaults,n),f.mediaElement=j.default.createElement(n.fakeNodeName);var i=t,r=!1;if("string"==typeof t?f.mediaElement.originalNode=j.default.getElementById(t):i=(f.mediaElement.originalNode=t).id,void 0===f.mediaElement.originalNode||null===f.mediaElement.originalNode)return null;f.mediaElement.options=n,i=i||"mejs_"+Math.random().toString().slice(2),f.mediaElement.originalNode.setAttribute("id",i+"_from_mejs");var a=f.mediaElement.originalNode.tagName.toLowerCase();-1<["video","audio"].indexOf(a)&&!f.mediaElement.originalNode.getAttribute("preload")&&f.mediaElement.originalNode.setAttribute("preload","none"),f.mediaElement.originalNode.setAttribute("tabindex",-1),f.mediaElement.originalNode.parentNode.insertBefore(f.mediaElement,f.mediaElement.originalNode),f.mediaElement.appendChild(f.mediaElement.originalNode);var s=function(t,e){if("https:"===F.default.location.protocol&&0===t.indexOf("http:")&&R.IS_IOS&&-1<I.default.html5media.mediaTypes.indexOf(e)){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=(F.default.URL||F.default.webkitURL).createObjectURL(this.response);return f.mediaElement.originalNode.setAttribute("src",e),e}return t},n.open("GET",t),n.responseType="blob",n.send()}return t},l=void 0;if(null!==o)l=o;else if(null!==f.mediaElement.originalNode)switch(l=[],f.mediaElement.originalNode.nodeName.toLowerCase()){case"iframe":l.push({type:"",src:f.mediaElement.originalNode.getAttribute("src")});break;case"audio":case"video":var d=f.mediaElement.originalNode.children.length,u=f.mediaElement.originalNode.getAttribute("src");if(u){var p=f.mediaElement.originalNode,m=(0,O.formatType)(u,p.getAttribute("type"));l.push({type:m,src:s(u,m)})}for(var h=0;h<d;h++){var v=f.mediaElement.originalNode.children[h];if("source"===v.tagName.toLowerCase()){var g=v.getAttribute("src"),y=(0,O.formatType)(g,v.getAttribute("type"));l.push({type:y,src:s(g,y)})}}}f.mediaElement.id=i,f.mediaElement.renderers={},f.mediaElement.events={},f.mediaElement.promises=[],f.mediaElement.renderer=null,f.mediaElement.rendererName=null,f.mediaElement.changeRenderer=function(e,t){var n=c,o=2<Object.keys(t[0]).length?t[0]:t[0].src;if(void 0!==n.mediaElement.renderer&&null!==n.mediaElement.renderer&&n.mediaElement.renderer.name===e)return n.mediaElement.renderer.pause(),n.mediaElement.renderer.stop&&n.mediaElement.renderer.stop(),n.mediaElement.renderer.show(),n.mediaElement.renderer.setSrc(o),!0;void 0!==n.mediaElement.renderer&&null!==n.mediaElement.renderer&&(n.mediaElement.renderer.pause(),n.mediaElement.renderer.stop&&n.mediaElement.renderer.stop(),n.mediaElement.renderer.hide());var i=n.mediaElement.renderers[e],r=null;if(null!=i)return i.show(),i.setSrc(o),n.mediaElement.renderer=i,n.mediaElement.rendererName=e,!0;for(var a=n.mediaElement.options.renderers.length?n.mediaElement.options.renderers:D.renderer.order,s=0,l=a.length;s<l;s++){var d=a[s];if(d===e){r=D.renderer.renderers[d];var u=Object.assign(r.options,n.mediaElement.options);return(i=r.create(n.mediaElement,u,t)).name=e,n.mediaElement.renderers[r.name]=i,n.mediaElement.renderer=i,n.mediaElement.rendererName=e,i.show(),!0}}return!1},f.mediaElement.setSize=function(e,t){void 0!==f.mediaElement.renderer&&null!==f.mediaElement.renderer&&f.mediaElement.renderer.setSize(e,t)},f.mediaElement.generateError=function(e,t){e=e||"",t=Array.isArray(t)?t:[];var n=(0,M.createEvent)("error",f.mediaElement);n.message=e,n.urls=t,f.mediaElement.dispatchEvent(n),r=!0};var E=I.default.html5media.properties,b=I.default.html5media.methods,S=function(t,e,n,o){var i=t[e];Object.defineProperty(t,e,{get:function(){return n.apply(t,[i])},set:function(e){return i=o.apply(t,[e])}})},w=function(e){if("src"!==e){var t=""+e.substring(0,1).toUpperCase()+e.substring(1),n=function(){return void 0!==f.mediaElement.renderer&&null!==f.mediaElement.renderer&&"function"==typeof f.mediaElement.renderer["get"+t]?f.mediaElement.renderer["get"+t]():null},o=function(e){void 0!==f.mediaElement.renderer&&null!==f.mediaElement.renderer&&"function"==typeof f.mediaElement.renderer["set"+t]&&f.mediaElement.renderer["set"+t](e)};S(f.mediaElement,e,n,o),f.mediaElement["get"+t]=n,f.mediaElement["set"+t]=o}},x=function(){return void 0!==f.mediaElement.renderer&&null!==f.mediaElement.renderer?f.mediaElement.renderer.getSrc():null},P=function(e){var t=[];if("string"==typeof e)t.push({src:e,type:e?(0,O.getTypeFromFile)(e):""});else if("object"===(void 0===e?"undefined":L(e))&&void 0!==e.src){var n=(0,O.absolutizeUrl)(e.src),o=e.type,i=Object.assign(e,{src:n,type:""!==o&&null!=o||!n?o:(0,O.getTypeFromFile)(n)});t.push(i)}else if(Array.isArray(e))for(var r=0,a=e.length;r<a;r++){var s=(0,O.absolutizeUrl)(e[r].src),l=e[r].type,d=Object.assign(e[r],{src:s,type:""!==l&&null!=l||!s?l:(0,O.getTypeFromFile)(s)});t.push(d)}var u=D.renderer.select(t,f.mediaElement.options.renderers.length?f.mediaElement.options.renderers:[]),c=void 0;if(f.mediaElement.paused||null==f.mediaElement.src||""===f.mediaElement.src||(f.mediaElement.pause(),c=(0,M.createEvent)("pause",f.mediaElement),f.mediaElement.dispatchEvent(c)),f.mediaElement.originalNode.src=t[0].src||"",null!==u||!t[0].src)return!(null==t[0].src||""===t[0].src)?f.mediaElement.changeRenderer(u.rendererName,t):null;f.mediaElement.generateError("No renderer found",t)},T=function(e,t){try{if("play"!==e||"native_dash"!==f.mediaElement.rendererName&&"native_hls"!==f.mediaElement.rendererName&&"vimeo_iframe"!==f.mediaElement.rendererName)return f.mediaElement.renderer[e](t);var n=f.mediaElement.renderer[e](t);return n&&"function"==typeof n.then&&n.catch(function(){f.mediaElement.paused&&setTimeout(function(){var e=f.mediaElement.renderer.play();void 0!==e&&e.catch(function(){f.mediaElement.renderer.paused||f.mediaElement.renderer.pause()})},150)}),n}catch(e){throw f.mediaElement.generateError(e,l),e}},C=function(o){f.mediaElement[o]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return void 0!==f.mediaElement.renderer&&null!==f.mediaElement.renderer&&"function"==typeof f.mediaElement.renderer[o]?f.mediaElement.promises.length?Promise.all(f.mediaElement.promises).then(function(){return T(o,t)}).catch(function(e){return f.mediaElement.generateError(e,l),Promise.reject(e)}):T(o,t):null}};S(f.mediaElement,"src",x,P),f.mediaElement.getSrc=x,f.mediaElement.setSrc=P;for(var k=0,_=E.length;k<_;k++)w(E[k]);for(var N=0,A=b.length;N<A;N++)C(b[N]);return f.mediaElement.addEventListener=function(e,t){f.mediaElement.events[e]=f.mediaElement.events[e]||[],f.mediaElement.events[e].push(t)},f.mediaElement.removeEventListener=function(e,t){if(!e)return f.mediaElement.events={},!0;var n=f.mediaElement.events[e];if(!n)return!0;if(!t)return f.mediaElement.events[e]=[],!0;for(var o=0;o<n.length;o++)if(n[o]===t)return f.mediaElement.events[e].splice(o,1),!0;return!1},f.mediaElement.dispatchEvent=function(e){var t=f.mediaElement.events[e.type];if(t)for(var n=0;n<t.length;n++)t[n].apply(null,[e])},f.mediaElement.destroy=function(){var e=f.mediaElement.originalNode.cloneNode(!0),t=f.mediaElement.parentElement;e.removeAttribute("id"),e.remove(),f.mediaElement.remove(),t.appendChild(e)},l.length&&(f.mediaElement.src=l),f.mediaElement.promises.length?Promise.all(f.mediaElement.promises).then(function(){f.mediaElement.options.success&&f.mediaElement.options.success(f.mediaElement,f.mediaElement.originalNode)}).catch(function(){r&&f.mediaElement.options.error&&f.mediaElement.options.error(f.mediaElement,f.mediaElement.originalNode)}):(f.mediaElement.options.success&&f.mediaElement.options.success(f.mediaElement,f.mediaElement.originalNode),r&&f.mediaElement.options.error&&f.mediaElement.options.error(f.mediaElement,f.mediaElement.originalNode)),f.mediaElement};F.default.MediaElement=i,I.default.MediaElement=i,n.default=i},{2:2,26:26,28:28,3:3,30:30,8:8,9:9}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=e(3);var r={version:"5.0.5",html5media:{properties:["volume","src","currentTime","muted","duration","paused","ended","buffered","error","networkState","readyState","seeking","seekable","currentSrc","preload","bufferedBytes","bufferedTime","initialTime","startOffsetTime","defaultPlaybackRate","playbackRate","played","autoplay","loop","controls"],readOnlyProperties:["duration","paused","ended","buffered","error","networkState","readyState","seeking","seekable"],methods:["load","play","pause","canPlayType"],events:["loadstart","durationchange","loadedmetadata","loadeddata","progress","canplay","canplaythrough","suspend","abort","error","emptied","stalled","play","playing","pause","waiting","seeking","seeked","timeupdate","ended","ratechange","volumechange"],mediaTypes:["audio/mp3","audio/ogg","audio/oga","audio/wav","audio/x-wav","audio/wave","audio/x-pn-wav","audio/mpeg","audio/mp4","video/mp4","video/webm","video/ogg","video/ogv"]}};((o=i)&&o.__esModule?o:{default:o}).default.mejs=r,n.default=r},{3:3}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.renderer=void 0;var o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),a=e(8),s=(o=a)&&o.__esModule?o:{default:o};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderers={},this.order=[]}return r(e,[{key:"add",value:function(e){if(void 0===e.name)throw new TypeError("renderer must contain at least `name` property");this.renderers[e.name]=e,this.order.push(e.name)}},{key:"select",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=t.length;if(t=t.length?t:this.order,!n){var o=[/^(html5|native)/i,/^flash/i,/iframe$/i],i=function(e){for(var t=0,n=o.length;t<n;t++)if(o[t].test(e))return t;return o.length};t.sort(function(e,t){return i(e)-i(t)})}for(var r=0,a=t.length;r<a;r++){var s=t[r],l=this.renderers[s];if(null!=l)for(var d=0,u=e.length;d<u;d++)if("function"==typeof l.canPlayType&&"string"==typeof e[d].type&&l.canPlayType(e[d].type))return{rendererName:l.name,src:e[d].src}}return null}},{key:"order",set:function(e){if(!Array.isArray(e))throw new TypeError("order must be an array of strings.");this._order=e},get:function(){return this._order}},{key:"renderers",set:function(e){if(null!==e&&"object"!==(void 0===e?"undefined":i(e)))throw new TypeError("renderers must be an array of objects.");this._renderers=e},get:function(){return this._renderers}}]),e}(),d=n.renderer=new l;s.default.Renderers=d},{8:8}],10:[function(e,t,n){"use strict";var f=s(e(3)),p=s(e(2)),i=s(e(6)),o=e(17),r=s(o),m=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e(26)),h=e(28),v=e(27),g=e(30),a=e(29);function s(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{usePluginFullScreen:!0,fullscreenText:null,useFakeFullscreen:!1}),Object.assign(r.default.prototype,{isFullScreen:!1,isNativeFullScreen:!1,isInIframe:!1,isPluginClickThroughCreated:!1,fullscreenMode:"",containerSizeTimeout:null,buildfullscreen:function(n){if(n.isVideo){n.isInIframe=f.default.location!==f.default.parent.location,n.detectFullscreenMode();var o=this,e=(0,h.isString)(o.options.fullscreenText)?o.options.fullscreenText:i.default.t("mejs.fullscreen"),t=p.default.createElement("div");if(t.className=o.options.classPrefix+"button "+o.options.classPrefix+"fullscreen-button",t.innerHTML=(0,a.generateControlButton)(o.id,e,e,""+o.media.options.iconSprite,["icon-fullscreen","icon-unfullscreen"],""+o.options.classPrefix),o.addControlElement(t,"fullscreen"),t.addEventListener("click",function(){m.HAS_TRUE_NATIVE_FULLSCREEN&&m.IS_FULLSCREEN||n.isFullScreen?n.exitFullScreen():n.enterFullScreen()}),n.fullscreenBtn=t,o.options.keyActions.push({keys:[70],action:function(e,t,n,o){o.ctrlKey||void 0!==e.enterFullScreen&&(e.isFullScreen?e.exitFullScreen():e.enterFullScreen())}}),o.exitFullscreenCallback=function(e){var t=e.which||e.keyCode||0;o.options.enableKeyboard&&27===t&&(m.HAS_TRUE_NATIVE_FULLSCREEN&&m.IS_FULLSCREEN||o.isFullScreen)&&n.exitFullScreen()},o.globalBind("keydown",o.exitFullscreenCallback),o.normalHeight=0,o.normalWidth=0,m.HAS_TRUE_NATIVE_FULLSCREEN){n.globalBind(m.FULLSCREEN_EVENT_NAME,function(){n.isFullScreen&&(m.isFullScreen()?(n.isNativeFullScreen=!0,n.setControlsSize()):(n.isNativeFullScreen=!1,n.exitFullScreen()))})}}},cleanfullscreen:function(e){e.exitFullScreen(),e.globalUnbind("keydown",e.exitFullscreenCallback)},detectFullscreenMode:function(){var e=null!==this.media.rendererName&&/(native|html5)/i.test(this.media.rendererName),t="";return m.HAS_TRUE_NATIVE_FULLSCREEN&&e?t="native-native":m.HAS_TRUE_NATIVE_FULLSCREEN&&!e?t="plugin-native":this.usePluginFullScreen&&m.SUPPORT_POINTER_EVENTS&&(t="plugin-click"),this.fullscreenMode=t},enterFullScreen:function(){var o=this,e=null!==o.media.rendererName&&/(html5|native)/i.test(o.media.rendererName),t=getComputedStyle(o.getElement(o.container));if(o.isVideo)if(!1===o.options.useFakeFullscreen&&(m.IS_IOS||m.IS_SAFARI)&&m.HAS_IOS_FULLSCREEN&&"function"==typeof o.media.originalNode.webkitEnterFullscreen&&o.media.originalNode.canPlayType((0,g.getTypeFromFile)(o.media.getSrc())))o.media.originalNode.webkitEnterFullscreen();else{if((0,v.addClass)(p.default.documentElement,o.options.classPrefix+"fullscreen"),(0,v.addClass)(o.getElement(o.container),o.options.classPrefix+"container-fullscreen"),o.normalHeight=parseFloat(t.height),o.normalWidth=parseFloat(t.width),"native-native"!==o.fullscreenMode&&"plugin-native"!==o.fullscreenMode||(m.requestFullScreen(o.getElement(o.container)),o.isInIframe&&setTimeout(function e(){if(o.isNativeFullScreen){var t=f.default.innerWidth||p.default.documentElement.clientWidth||p.default.body.clientWidth,n=screen.width;.002*n<Math.abs(n-t)?o.exitFullScreen():setTimeout(e,500)}},1e3)),o.getElement(o.container).style.width="100%",o.getElement(o.container).style.height="100%",o.containerSizeTimeout=setTimeout(function(){o.getElement(o.container).style.width="100%",o.getElement(o.container).style.height="100%",o.setControlsSize()},500),e)o.node.style.width="100%",o.node.style.height="100%";else for(var n=o.getElement(o.container).querySelectorAll("embed, object, video"),i=n.length,r=0;r<i;r++)n[r].style.width="100%",n[r].style.height="100%";o.options.setDimensions&&"function"==typeof o.media.setSize&&o.media.setSize(screen.width,screen.height);for(var a=o.getElement(o.layers).children,s=a.length,l=0;l<s;l++)a[l].style.width="100%",a[l].style.height="100%";o.fullscreenBtn&&((0,v.removeClass)(o.fullscreenBtn,o.options.classPrefix+"fullscreen"),(0,v.addClass)(o.fullscreenBtn,o.options.classPrefix+"unfullscreen")),o.setControlsSize(),o.isFullScreen=!0;var d=Math.min(screen.width/o.width,screen.height/o.height),u=o.getElement(o.container).querySelector("."+o.options.classPrefix+"captions-text");u&&(u.style.fontSize=100*d+"%",u.style.lineHeight="normal",o.getElement(o.container).querySelector("."+o.options.classPrefix+"captions-position").style.bottom=(screen.height-o.normalHeight)/2-o.getElement(o.controls).offsetHeight/2+d+15+"px");var c=(0,h.createEvent)("enteredfullscreen",o.getElement(o.container));o.getElement(o.container).dispatchEvent(c)}},exitFullScreen:function(){var e=this,t=null!==e.media.rendererName&&/(native|html5)/i.test(e.media.rendererName);if(e.isVideo){if(clearTimeout(e.containerSizeTimeout),m.HAS_TRUE_NATIVE_FULLSCREEN&&(m.IS_FULLSCREEN||e.isFullScreen)&&m.cancelFullScreen(),(0,v.removeClass)(p.default.documentElement,e.options.classPrefix+"fullscreen"),(0,v.removeClass)(e.getElement(e.container),e.options.classPrefix+"container-fullscreen"),e.options.setDimensions){if(e.getElement(e.container).style.width=e.normalWidth+"px",e.getElement(e.container).style.height=e.normalHeight+"px",t)e.node.style.width=e.normalWidth+"px",e.node.style.height=e.normalHeight+"px";else for(var n=e.getElement(e.container).querySelectorAll("embed, object, video"),o=n.length,i=0;i<o;i++)n[i].style.width=e.normalWidth+"px",n[i].style.height=e.normalHeight+"px";"function"==typeof e.media.setSize&&e.media.setSize(e.normalWidth,e.normalHeight);for(var r=e.getElement(e.layers).children,a=r.length,s=0;s<a;s++)r[s].style.width=e.normalWidth+"px",r[s].style.height=e.normalHeight+"px"}e.fullscreenBtn&&((0,v.removeClass)(e.fullscreenBtn,e.options.classPrefix+"unfullscreen"),(0,v.addClass)(e.fullscreenBtn,e.options.classPrefix+"fullscreen")),e.setControlsSize(),e.isFullScreen=!1;var l=e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-text");l&&(l.style.fontSize="",l.style.lineHeight="",e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-position").style.bottom="");var d=(0,h.createEvent)("exitedfullscreen",e.getElement(e.container));e.getElement(e.container).dispatchEvent(d)}}})},{17:17,2:2,26:26,27:27,28:28,29:29,3:3,30:30,6:6}],11:[function(e,t,n){"use strict";var c=r(e(2)),o=e(17),i=r(o),f=r(e(6)),p=e(28),m=e(27),h=e(29);function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{playText:null,pauseText:null}),Object.assign(i.default.prototype,{buildplaypause:function(e,t,n,o){var i=this,r=i.options,a=(0,p.isString)(r.playText)?r.playText:f.default.t("mejs.play"),s=(0,p.isString)(r.pauseText)?r.pauseText:f.default.t("mejs.pause"),l=c.default.createElement("div");l.className=i.options.classPrefix+"button "+i.options.classPrefix+"playpause-button "+i.options.classPrefix+"play",l.innerHTML=(0,h.generateControlButton)(i.id,s,a,""+i.media.options.iconSprite,["icon-play","icon-pause","icon-replay"],""+i.options.classPrefix),l.addEventListener("click",function(){i.paused?i.play():i.pause()});var d=l.querySelector("button");function u(e){(0,m.removeClass)(l,i.options.classPrefix+"play"),(0,m.removeClass)(l,i.options.classPrefix+"replay"),(0,m.removeClass)(l,i.options.classPrefix+"pause"),"play"===e?((0,m.addClass)(l,i.options.classPrefix+"pause"),d.setAttribute("title",s),d.setAttribute("aria-label",s)):("pse"===e?(0,m.addClass)(l,i.options.classPrefix+"play"):(0,m.addClass)(l,i.options.classPrefix+"replay"),d.setAttribute("title",a),d.setAttribute("aria-label",a))}i.addControlElement(l,"playpause"),u("pse"),o.addEventListener("loadedmetadata",function(){-1===o.rendererName.indexOf("flash")&&u("pse")}),o.addEventListener("play",function(){u("play")}),o.addEventListener("playing",function(){u("play")}),o.addEventListener("pause",function(){u("pse")}),o.addEventListener("ended",function(){e.options.loop||setTimeout(function(){u("replay")},0)})}})},{17:17,2:2,27:27,28:28,29:29,6:6}],12:[function(e,t,n){"use strict";var p=r(e(2)),o=e(17),i=r(o),m=r(e(6)),y=e(26),E=e(32),b=e(27);function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{enableProgressTooltip:!0,useSmoothHover:!0,forceLive:!1}),Object.assign(i.default.prototype,{buildprogress:function(h,s,e,d){var u=0,v=!1,c=!1,g=this,t=h.options.autoRewind,n=h.options.enableProgressTooltip?\'<span class="\'+g.options.classPrefix+\'time-float"><span class="\'+g.options.classPrefix+\'time-float-current">00:00</span><span class="\'+g.options.classPrefix+\'time-float-corner"></span></span>\':"",o=p.default.createElement("div");o.className=g.options.classPrefix+"time-rail",o.innerHTML=\'<span class="\'+g.options.classPrefix+"time-total "+g.options.classPrefix+\'time-slider"><span class="\'+g.options.classPrefix+\'time-buffering"></span><span class="\'+g.options.classPrefix+\'time-loaded"></span><span class="\'+g.options.classPrefix+\'time-current"></span><span class="\'+g.options.classPrefix+\'time-hovered no-hover"></span><span class="\'+g.options.classPrefix+\'time-handle"><span class="\'+g.options.classPrefix+\'time-handle-content"></span></span>\'+n+"</span>",g.addControlElement(o,"progress"),g.options.keyActions.push({keys:[37,227],action:function(e){if(!isNaN(e.duration)&&0<e.duration){e.isVideo&&(e.showControls(),e.startControlsTimer());var t=e.getElement(e.container).querySelector("."+g.options.classPrefix+"time-total");t&&t.focus();var n=Math.max(e.currentTime-e.options.defaultSeekBackwardInterval(e),0);e.paused||e.pause(),setTimeout(function(){e.setCurrentTime(n)},0),setTimeout(function(){e.play()},0)}}},{keys:[39,228],action:function(e){if(!isNaN(e.duration)&&0<e.duration){e.isVideo&&(e.showControls(),e.startControlsTimer());var t=e.getElement(e.container).querySelector("."+g.options.classPrefix+"time-total");t&&t.focus();var n=Math.min(e.currentTime+e.options.defaultSeekForwardInterval(e),e.duration);e.paused||e.pause(),setTimeout(function(){e.setCurrentTime(n)},0),setTimeout(function(){e.play()},0)}}}),g.rail=s.querySelector("."+g.options.classPrefix+"time-rail"),g.total=s.querySelector("."+g.options.classPrefix+"time-total"),g.loaded=s.querySelector("."+g.options.classPrefix+"time-loaded"),g.current=s.querySelector("."+g.options.classPrefix+"time-current"),g.handle=s.querySelector("."+g.options.classPrefix+"time-handle"),g.timefloat=s.querySelector("."+g.options.classPrefix+"time-float"),g.timefloatcurrent=s.querySelector("."+g.options.classPrefix+"time-float-current"),g.slider=s.querySelector("."+g.options.classPrefix+"time-slider"),g.hovered=s.querySelector("."+g.options.classPrefix+"time-hovered"),g.buffer=s.querySelector("."+g.options.classPrefix+"time-buffering"),g.newTime=0,g.forcedHandlePause=!1,g.setTransformStyle=function(e,t){e.style.transform=t,e.style.webkitTransform=t,e.style.MozTransform=t,e.style.msTransform=t,e.style.OTransform=t},g.buffer.style.display="none";var i=function(e){var t=getComputedStyle(g.total),n=(0,b.offset)(g.total),o=g.total.offsetWidth,i=void 0!==t.webkitTransform?"webkitTransform":void 0!==t.mozTransform?"mozTransform ":void 0!==t.oTransform?"oTransform":void 0!==t.msTransform?"msTransform":"transform",r="WebKitCSSMatrix"in window?"WebKitCSSMatrix":"MSCSSMatrix"in window?"MSCSSMatrix":"CSSMatrix"in window?"CSSMatrix":void 0,a=0,s=0,l=0,d=void 0;if(d=e.originalEvent&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.changedTouches?e.changedTouches[0].pageX:e.pageX,g.getDuration()){if(d<n.left?d=n.left:d>o+n.left&&(d=o+n.left),a=(l=d-n.left)/o,g.newTime=a*g.getDuration(),v&&null!==g.getCurrentTime()&&g.newTime.toFixed(4)!==g.getCurrentTime().toFixed(4)&&(g.setCurrentRailHandle(g.newTime),g.updateCurrent(g.newTime)),!y.IS_IOS&&!y.IS_ANDROID){if(l<0&&(l=0),g.options.useSmoothHover&&null!==r&&void 0!==window[r]){var u=new window[r](getComputedStyle(g.handle)[i]).m41,c=l/parseFloat(getComputedStyle(g.total).width)-u/parseFloat(getComputedStyle(g.total).width);g.hovered.style.left=u+"px",g.setTransformStyle(g.hovered,"scaleX("+c+")"),g.hovered.setAttribute("pos",l),0<=c?(0,b.removeClass)(g.hovered,"negative"):(0,b.addClass)(g.hovered,"negative")}if(g.timefloat){var f=g.timefloat.offsetWidth/2,p=mejs.Utils.offset(g.getElement(g.container)),m=getComputedStyle(g.timefloat);s=d-p.left<g.timefloat.offsetWidth?f:d-p.left>=g.getElement(g.container).offsetWidth-f?g.total.offsetWidth-f:l,(0,b.hasClass)(g.getElement(g.container),g.options.classPrefix+"long-video")&&(s+=parseFloat(m.marginLeft)/2+g.timefloat.offsetWidth/2),g.timefloat.style.left=s+"px",g.timefloatcurrent.innerHTML=(0,E.secondsToTimeCode)(g.newTime,h.options.alwaysShowHours,h.options.showTimecodeFrameCount,h.options.framesPerSecond,h.options.secondsDecimalLength,h.options.timeFormat),g.timefloat.style.display="block"}}}else y.IS_IOS||y.IS_ANDROID||!g.timefloat||(s=g.timefloat.offsetWidth+o>=g.getElement(g.container).offsetWidth?g.timefloat.offsetWidth/2:0,g.timefloat.style.left=s+"px",g.timefloat.style.left=s+"px",g.timefloat.style.display="block")},f=function(){1e3<=new Date-u&&g.play()};g.slider.addEventListener("focus",function(){h.options.autoRewind=!1}),g.slider.addEventListener("blur",function(){h.options.autoRewind=t}),g.slider.addEventListener("keydown",function(e){if(1e3<=new Date-u&&(c=g.paused),g.options.enableKeyboard&&g.options.keyActions.length){var t=e.which||e.keyCode||0,n=g.getDuration(),o=h.options.defaultSeekForwardInterval(d),i=h.options.defaultSeekBackwardInterval(d),r=g.getCurrentTime(),a=g.getElement(g.container).querySelector("."+g.options.classPrefix+"volume-slider");if(38===t||40===t){a&&(a.style.display="block"),g.isVideo&&(g.showControls(),g.startControlsTimer());var s=38===t?Math.min(g.volume+.1,1):Math.max(g.volume-.1,0),l=s<=0;return g.setVolume(s),void g.setMuted(l)}switch(a&&(a.style.display="none"),t){case 37:g.getDuration()!==1/0&&(r-=i);break;case 39:g.getDuration()!==1/0&&(r+=o);break;case 36:r=0;break;case 35:r=n;break;case 13:case 32:return void(y.IS_FIREFOX&&(g.paused?g.play():g.pause()));default:return}r=r<0||isNaN(r)?0:n<=r?n:Math.floor(r),u=new Date,c||h.pause(),setTimeout(function(){g.setCurrentTime(r)},0),r<g.getDuration()&&!c&&setTimeout(f,1100),h.showControls(),e.preventDefault(),e.stopPropagation()}});var r=["mousedown","touchstart"];g.slider.addEventListener("dragstart",function(){return!1});for(var a=0,l=r.length;a<l;a++)g.slider.addEventListener(r[a],function(e){if(g.forcedHandlePause=!1,g.getDuration()!==1/0&&(1===e.which||0===e.which)){g.paused||(g.pause(),g.forcedHandlePause=!0),v=!0,i(e);for(var t=["mouseup","touchend"],n=0,o=t.length;n<o;n++)g.getElement(g.container).addEventListener(t[n],function(e){var t=e.target;(t===g.slider||t.closest("."+g.options.classPrefix+"time-slider"))&&i(e)});g.globalBind("mouseup.dur touchend.dur",function(){v&&null!==g.getCurrentTime()&&g.newTime.toFixed(4)!==g.getCurrentTime().toFixed(4)&&(g.setCurrentTime(g.newTime),g.setCurrentRailHandle(g.newTime),g.updateCurrent(g.newTime)),g.forcedHandlePause&&(g.slider.focus(),g.play()),g.forcedHandlePause=!1,v=!1,g.timefloat&&(g.timefloat.style.display="none")})}},!(!y.SUPPORT_PASSIVE_EVENT||"touchstart"!==r[a])&&{passive:!0});g.slider.addEventListener("mouseenter",function(e){e.target===g.slider&&g.getDuration()!==1/0&&(g.getElement(g.container).addEventListener("mousemove",function(e){var t=e.target;(t===g.slider||t.closest("."+g.options.classPrefix+"time-slider"))&&i(e)}),!g.timefloat||y.IS_IOS||y.IS_ANDROID||(g.timefloat.style.display="block"),g.hovered&&!y.IS_IOS&&!y.IS_ANDROID&&g.options.useSmoothHover&&(0,b.removeClass)(g.hovered,"no-hover"))}),g.slider.addEventListener("mouseleave",function(){g.getDuration()!==1/0&&(v||(g.timefloat&&(g.timefloat.style.display="none"),g.hovered&&g.options.useSmoothHover&&(0,b.addClass)(g.hovered,"no-hover")))}),g.broadcastCallback=function(e){var t,n,o,i,r=s.querySelector("."+g.options.classPrefix+"broadcast");if(g.options.forceLive||g.getDuration()===1/0){if(!r&&g.options.forceLive){var a=p.default.createElement("span");a.className=g.options.classPrefix+"broadcast",a.innerText=m.default.t("mejs.live-broadcast"),g.slider.style.display="none",g.rail.appendChild(a)}}else r&&(g.slider.style.display="",r.remove()),h.setProgressRail(e),g.forcedHandlePause||h.setCurrentRail(e),t=g.getCurrentTime(),n=m.default.t("mejs.time-slider"),o=(0,E.secondsToTimeCode)(t,h.options.alwaysShowHours,h.options.showTimecodeFrameCount,h.options.framesPerSecond,h.options.secondsDecimalLength,h.options.timeFormat),i=g.getDuration(),g.slider.setAttribute("role","slider"),g.slider.tabIndex=0,d.paused?(g.slider.setAttribute("aria-label",n),g.slider.setAttribute("aria-valuemin",0),g.slider.setAttribute("aria-valuemax",isNaN(i)?0:i),g.slider.setAttribute("aria-valuenow",t),g.slider.setAttribute("aria-valuetext",o)):(g.slider.removeAttribute("aria-label"),g.slider.removeAttribute("aria-valuemin"),g.slider.removeAttribute("aria-valuemax"),g.slider.removeAttribute("aria-valuenow"),g.slider.removeAttribute("aria-valuetext"))},d.addEventListener("progress",g.broadcastCallback),d.addEventListener("timeupdate",g.broadcastCallback),d.addEventListener("play",function(){g.buffer.style.display="none"}),d.addEventListener("playing",function(){g.buffer.style.display="none"}),d.addEventListener("seeking",function(){g.buffer.style.display=""}),d.addEventListener("seeked",function(){g.buffer.style.display="none"}),d.addEventListener("pause",function(){g.buffer.style.display="none"}),d.addEventListener("waiting",function(){g.buffer.style.display=""}),d.addEventListener("loadeddata",function(){g.buffer.style.display=""}),d.addEventListener("canplay",function(){g.buffer.style.display="none"}),d.addEventListener("error",function(){g.buffer.style.display="none"}),g.getElement(g.container).addEventListener("controlsresize",function(e){g.getDuration()!==1/0&&(h.setProgressRail(e),g.forcedHandlePause||h.setCurrentRail(e))})},cleanprogress:function(e,t,n,o){o.removeEventListener("progress",e.broadcastCallback),o.removeEventListener("timeupdate",e.broadcastCallback),e.rail&&e.rail.remove()},setProgressRail:function(e){var t=this,n=void 0!==e?e.detail.target||e.target:t.media,o=null;n&&n.buffered&&0<n.buffered.length&&n.buffered.end&&t.getDuration()?o=n.buffered.end(n.buffered.length-1)/t.getDuration():n&&void 0!==n.bytesTotal&&0<n.bytesTotal&&void 0!==n.bufferedBytes?o=n.bufferedBytes/n.bytesTotal:e&&e.lengthComputable&&0!==e.total&&(o=e.loaded/e.total),null!==o&&(o=Math.min(1,Math.max(0,o)),t.loaded&&t.setTransformStyle(t.loaded,"scaleX("+o+")"))},setCurrentRailHandle:function(e){this.setCurrentRailMain(this,e)},setCurrentRail:function(){this.setCurrentRailMain(this)},setCurrentRailMain:function(e,t){if(void 0!==e.getCurrentTime()&&e.getDuration()){var n=void 0===t?e.getCurrentTime():t;if(e.total&&e.handle){var o=parseFloat(getComputedStyle(e.total).width),i=Math.round(o*n/e.getDuration()),r=i-Math.round(e.handle.offsetWidth/2);if(r=r<0?0:r,e.setTransformStyle(e.current,"scaleX("+i/o+")"),e.setTransformStyle(e.handle,"translateX("+r+"px)"),e.options.useSmoothHover&&!(0,b.hasClass)(e.hovered,"no-hover")){var a=parseInt(e.hovered.getAttribute("pos"),10),s=(a=isNaN(a)?0:a)/o-r/o;e.hovered.style.left=r+"px",e.setTransformStyle(e.hovered,"scaleX("+s+")"),0<=s?(0,b.removeClass)(e.hovered,"negative"):(0,b.addClass)(e.hovered,"negative")}}}}})},{17:17,2:2,26:26,27:27,32:32,6:6}],13:[function(e,t,n){"use strict";var a=r(e(2)),o=e(17),i=r(o),s=e(32),l=e(27);function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{duration:0,timeAndDurationSeparator:"<span> | </span>"}),Object.assign(i.default.prototype,{buildcurrent:function(e,t,n,o){var i=this,r=a.default.createElement("div");r.className=i.options.classPrefix+"time",r.setAttribute("role","timer"),r.setAttribute("aria-live","off"),r.innerHTML=\'<span class="\'+i.options.classPrefix+\'currenttime">\'+(0,s.secondsToTimeCode)(0,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat)+"</span>",i.addControlElement(r,"current"),e.updateCurrent(),i.updateTimeCallback=function(){i.controlsAreVisible&&e.updateCurrent()},o.addEventListener("timeupdate",i.updateTimeCallback)},cleancurrent:function(e,t,n,o){o.removeEventListener("timeupdate",e.updateTimeCallback)},buildduration:function(e,t,n,o){var i=this;if(t.lastChild.querySelector("."+i.options.classPrefix+"currenttime"))t.querySelector("."+i.options.classPrefix+"time").innerHTML+=i.options.timeAndDurationSeparator+\'<span class="\'+i.options.classPrefix+\'duration">\'+(0,s.secondsToTimeCode)(i.options.duration,i.options.alwaysShowHours,i.options.showTimecodeFrameCount,i.options.framesPerSecond,i.options.secondsDecimalLength,i.options.timeFormat)+"</span>";else{t.querySelector("."+i.options.classPrefix+"currenttime")&&(0,l.addClass)(t.querySelector("."+i.options.classPrefix+"currenttime").parentNode,i.options.classPrefix+"currenttime-container");var r=a.default.createElement("div");r.className=i.options.classPrefix+"time "+i.options.classPrefix+"duration-container",r.innerHTML=\'<span class="\'+i.options.classPrefix+\'duration">\'+(0,s.secondsToTimeCode)(i.options.duration,i.options.alwaysShowHours,i.options.showTimecodeFrameCount,i.options.framesPerSecond,i.options.secondsDecimalLength,i.options.timeFormat)+"</span>",i.addControlElement(r,"duration")}i.updateDurationCallback=function(){i.controlsAreVisible&&e.updateDuration()},o.addEventListener("timeupdate",i.updateDurationCallback)},cleanduration:function(e,t,n,o){o.removeEventListener("timeupdate",e.updateDurationCallback)},updateCurrent:function(){var e=this,t=e.getCurrentTime();isNaN(t)&&(t=0);var n=(0,s.secondsToTimeCode)(t,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat);5<n.length?(0,l.addClass)(e.getElement(e.container),e.options.classPrefix+"long-video"):(0,l.removeClass)(e.getElement(e.container),e.options.classPrefix+"long-video"),e.getElement(e.controls).querySelector("."+e.options.classPrefix+"currenttime")&&(e.getElement(e.controls).querySelector("."+e.options.classPrefix+"currenttime").innerText=n)},updateDuration:function(){var e=this,t=e.getDuration();void 0!==e.media&&(isNaN(t)||t===1/0||t<0)&&(e.media.duration=e.options.duration=t=0),0<e.options.duration&&(t=e.options.duration);var n=(0,s.secondsToTimeCode)(t,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat);5<n.length?(0,l.addClass)(e.getElement(e.container),e.options.classPrefix+"long-video"):(0,l.removeClass)(e.getElement(e.container),e.options.classPrefix+"long-video"),e.getElement(e.controls).querySelector("."+e.options.classPrefix+"duration")&&0<t&&(e.getElement(e.controls).querySelector("."+e.options.classPrefix+"duration").innerHTML=n)}})},{17:17,2:2,27:27,32:32}],14:[function(e,t,n){"use strict";var L=r(e(2)),d=r(e(8)),F=r(e(6)),o=e(17),i=r(o),m=e(32),j=e(28),I=e(27),M=e(29);function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{startLanguage:"",tracksText:null,chaptersText:null,tracksAriaLive:!1,hideCaptionsButtonWhenEmpty:!0,toggleCaptionsButtonWhenOnlyOne:!1,slidesSelector:""}),Object.assign(i.default.prototype,{hasChapters:!1,buildtracks:function(o,e,t,n){if(this.findTracks(),o.tracks.length||o.trackFiles&&0!==!o.trackFiles.length){var i=this,r=i.options.tracksAriaLive?\' role="log" aria-live="assertive" aria-atomic="false"\':"",a=(0,j.isString)(i.options.tracksText)?i.options.tracksText:F.default.t("mejs.captions-subtitles"),s=(0,j.isString)(i.options.chaptersText)?i.options.chaptersText:F.default.t("mejs.captions-chapters"),l=null===o.trackFiles?o.tracks.length:o.trackFiles.length;if(i.domNode.textTracks)for(var d=i.domNode.textTracks.length-1;0<=d;d--)i.domNode.textTracks[d].mode="hidden";i.cleartracks(o),o.captions=L.default.createElement("div"),o.captions.className=i.options.classPrefix+"captions-layer "+i.options.classPrefix+"layer",o.captions.innerHTML=\'<div class="\'+i.options.classPrefix+"captions-position "+i.options.classPrefix+\'captions-position-hover"\'+r+\'><span class="\'+i.options.classPrefix+\'captions-text"></span></div>\',o.captions.style.display="none",t.insertBefore(o.captions,t.firstChild),o.captionsText=o.captions.querySelector("."+i.options.classPrefix+"captions-text"),o.captionsButton=L.default.createElement("div"),o.captionsButton.className=i.options.classPrefix+"button "+i.options.classPrefix+"captions-button",o.captionsButton.innerHTML=(0,M.generateControlButton)(i.id,a,a,""+i.media.options.iconSprite,["icon-captions"],""+i.options.classPrefix)+\'<div class="\'+i.options.classPrefix+"captions-selector "+i.options.classPrefix+\'offscreen"><ul class="\'+i.options.classPrefix+\'captions-selector-list"><li class="\'+i.options.classPrefix+\'captions-selector-list-item"><input type="radio" class="\'+i.options.classPrefix+\'captions-selector-input" name="\'+o.id+\'_captions" id="\'+o.id+\'_captions_none" value="none" checked disabled><label class="\'+i.options.classPrefix+"captions-selector-label "+i.options.classPrefix+\'captions-selected" for="\'+o.id+\'_captions_none">\'+F.default.t("mejs.none")+"</label></li></ul></div>",i.addControlElement(o.captionsButton,"tracks"),o.captionsButton.querySelector("."+i.options.classPrefix+"captions-selector-input").disabled=!1,o.chaptersButton=L.default.createElement("div"),o.chaptersButton.className=i.options.classPrefix+"button "+i.options.classPrefix+"chapters-button",o.chaptersButton.innerHTML=(0,M.generateControlButton)(i.id,s,s,""+i.media.options.iconSprite,["icon-chapters"],""+i.options.classPrefix)+\'<div class="\'+i.options.classPrefix+"chapters-selector "+i.options.classPrefix+\'offscreen"><ul class="\'+i.options.classPrefix+\'chapters-selector-list"></ul></div>\';for(var u=0,c=0;c<l;c++){var f=o.tracks[c].kind;o.tracks[c].src.trim()&&("subtitles"===f||"captions"===f?u++:"chapters"!==f||e.querySelector("."+i.options.classPrefix+"chapter-selector")||o.captionsButton.parentNode.insertBefore(o.chaptersButton,o.captionsButton))}o.trackToLoad=-1,o.selectedTrack=null,o.isLoadingTrack=!1;for(var p=0;p<l;p++){var m=o.tracks[p].kind;!o.tracks[p].src.trim()||"subtitles"!==m&&"captions"!==m||o.addTrackButton(o.tracks[p].trackId,o.tracks[p].srclang,o.tracks[p].label)}o.loadNextTrack();var h=["mouseenter","focusin"],v=["mouseleave","focusout"];if(i.options.toggleCaptionsButtonWhenOnlyOne&&1===u)o.captionsButton.addEventListener("click",function(e){var t="none";null===o.selectedTrack&&(t=o.tracks[0].trackId);var n=e.keyCode||e.which;o.setTrack(t,void 0!==n)});else{for(var g=o.captionsButton.querySelectorAll("."+i.options.classPrefix+"captions-selector-label"),y=o.captionsButton.querySelectorAll("input[type=radio]"),E=0,b=h.length;E<b;E++)o.captionsButton.addEventListener(h[E],function(){(0,I.removeClass)(this.querySelector("."+i.options.classPrefix+"captions-selector"),i.options.classPrefix+"offscreen")});for(var S=0,w=v.length;S<w;S++)o.captionsButton.addEventListener(v[S],function(){(0,I.addClass)(this.querySelector("."+i.options.classPrefix+"captions-selector"),i.options.classPrefix+"offscreen")});for(var x=0,P=y.length;x<P;x++)y[x].addEventListener("click",function(e){var t=e.keyCode||e.which;o.setTrack(this.value,void 0!==t)});for(var T=0,C=g.length;T<C;T++)g[T].addEventListener("click",function(e){var t=(0,I.siblings)(this,function(e){return"INPUT"===e.tagName})[0],n=(0,j.createEvent)("click",t);t.dispatchEvent(n),e.preventDefault()});o.captionsButton.addEventListener("keydown",function(e){e.stopPropagation()})}for(var k=0,_=h.length;k<_;k++)o.chaptersButton.addEventListener(h[k],function(){this.querySelector("."+i.options.classPrefix+"chapters-selector-list").children.length&&(0,I.removeClass)(this.querySelector("."+i.options.classPrefix+"chapters-selector"),i.options.classPrefix+"offscreen")});for(var N=0,A=v.length;N<A;N++)o.chaptersButton.addEventListener(v[N],function(){(0,I.addClass)(this.querySelector("."+i.options.classPrefix+"chapters-selector"),i.options.classPrefix+"offscreen")});o.chaptersButton.addEventListener("keydown",function(e){e.stopPropagation()}),o.options.alwaysShowControls?(0,I.addClass)(o.getElement(o.container).querySelector("."+i.options.classPrefix+"captions-position"),i.options.classPrefix+"captions-position-hover"):(o.getElement(o.container).addEventListener("controlsshown",function(){(0,I.addClass)(o.getElement(o.container).querySelector("."+i.options.classPrefix+"captions-position"),i.options.classPrefix+"captions-position-hover")}),o.getElement(o.container).addEventListener("controlshidden",function(){n.paused||(0,I.removeClass)(o.getElement(o.container).querySelector("."+i.options.classPrefix+"captions-position"),i.options.classPrefix+"captions-position-hover")})),n.addEventListener("timeupdate",function(){o.displayCaptions()}),""!==o.options.slidesSelector&&(o.slidesContainer=L.default.querySelectorAll(o.options.slidesSelector),n.addEventListener("timeupdate",function(){o.displaySlides()}))}},cleartracks:function(e){e&&(e.captions&&e.captions.remove(),e.chapters&&e.chapters.remove(),e.captionsText&&e.captionsText.remove(),e.captionsButton&&e.captionsButton.remove(),e.chaptersButton&&e.chaptersButton.remove())},rebuildtracks:function(){var e=this;e.findTracks(),e.buildtracks(e,e.getElement(e.controls),e.getElement(e.layers),e.media)},findTracks:function(){var e=this,t=null===e.trackFiles?e.node.querySelectorAll("track"):e.trackFiles,n=t.length;e.tracks=[];for(var o=0;o<n;o++){var i=t[o],r=i.getAttribute("srclang").toLowerCase()||"",a=e.id+"_track_"+o+"_"+i.getAttribute("kind")+"_"+r;e.tracks.push({trackId:a,srclang:r,src:i.getAttribute("src"),kind:i.getAttribute("kind"),label:i.getAttribute("label")||"",entries:[],isLoaded:!1})}},setTrack:function(e,t){for(var n=this,o=n.captionsButton.querySelectorAll(\'input[type="radio"]\'),i=n.captionsButton.querySelectorAll("."+n.options.classPrefix+"captions-selected"),r=n.captionsButton.querySelector(\'input[value="\'+e+\'"]\'),a=0,s=o.length;a<s;a++)o[a].checked=!1;for(var l=0,d=i.length;l<d;l++)(0,I.removeClass)(i[l],n.options.classPrefix+"captions-selected");r.checked=!0;for(var u=(0,I.siblings)(r,function(e){return(0,I.hasClass)(e,n.options.classPrefix+"captions-selector-label")}),c=0,f=u.length;c<f;c++)(0,I.addClass)(u[c],n.options.classPrefix+"captions-selected");if("none"===e)n.selectedTrack=null,(0,I.removeClass)(n.captionsButton,n.options.classPrefix+"captions-enabled");else for(var p=0,m=n.tracks.length;p<m;p++){var h=n.tracks[p];if(h.trackId===e){null===n.selectedTrack&&(0,I.addClass)(n.captionsButton,n.options.classPrefix+"captions-enabled"),n.selectedTrack=h,n.captions.setAttribute("lang",n.selectedTrack.srclang),n.displayCaptions();break}}var v=(0,j.createEvent)("captionschange",n.media);v.detail.caption=n.selectedTrack,n.media.dispatchEvent(v),t||setTimeout(function(){n.getElement(n.container).focus()},500)},loadNextTrack:function(){var e=this;e.trackToLoad++,e.trackToLoad<e.tracks.length?(e.isLoadingTrack=!0,e.loadTrack(e.trackToLoad)):(e.isLoadingTrack=!1,e.checkForTracks())},loadTrack:function(e){var t=this,n=t.tracks[e];void 0===n||void 0===n.src&&""===n.src||(0,I.ajax)(n.src,"text",function(e){n.entries="string"==typeof e&&/<tt\\s+xml/gi.exec(e)?d.default.TrackFormatParser.dfxp.parse(e):d.default.TrackFormatParser.webvtt.parse(e),n.isLoaded=!0,t.enableTrackButton(n),t.loadNextTrack(),"slides"===n.kind?t.setupSlides(n):"chapters"!==n.kind||t.hasChapters||(t.drawChapters(n),t.hasChapters=!0)},function(){t.removeTrackButton(n.trackId),t.loadNextTrack()})},enableTrackButton:function(e){var t=this,n=e.srclang,o=L.default.getElementById(""+e.trackId);if(o){var i=e.label;""===i&&(i=F.default.t(d.default.language.codes[n])||n),o.disabled=!1;for(var r=(0,I.siblings)(o,function(e){return(0,I.hasClass)(e,t.options.classPrefix+"captions-selector-label")}),a=0,s=r.length;a<s;a++)r[a].innerHTML=i;if(t.options.startLanguage===n){o.checked=!0;var l=(0,j.createEvent)("click",o);o.dispatchEvent(l)}}},removeTrackButton:function(e){var t=L.default.getElementById(""+e);if(t){var n=t.closest("li");n&&n.remove()}},addTrackButton:function(e,t,n){var o=this;""===n&&(n=F.default.t(d.default.language.codes[t])||t),o.captionsButton.querySelector("ul").innerHTML+=\'<li class="\'+o.options.classPrefix+\'captions-selector-list-item"><input type="radio" class="\'+o.options.classPrefix+\'captions-selector-input" name="\'+o.id+\'_captions" id="\'+e+\'" value="\'+e+\'" disabled><label class="\'+o.options.classPrefix+\'captions-selector-label"for="\'+e+\'">\'+n+" (loading)</label></li>"},checkForTracks:function(){var e=this,t=!1;if(e.options.hideCaptionsButtonWhenEmpty){for(var n=0,o=e.tracks.length;n<o;n++){var i=e.tracks[n].kind;if(("subtitles"===i||"captions"===i)&&e.tracks[n].isLoaded){t=!0;break}}e.captionsButton.style.display=t?"":"none",e.setControlsSize()}},displayCaptions:function(){if(void 0!==this.tracks){var e=this,t=e.selectedTrack;if(null!==t&&t.isLoaded){var n=e.searchTrackPosition(t.entries,e.media.currentTime);if(-1<n){var o=t.entries[n].text;return"function"==typeof e.options.captionTextPreprocessor&&(o=e.options.captionTextPreprocessor(o)),e.captionsText.innerHTML=function(e){var t=L.default.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("script"),o=n.length;o--;)n[o].remove();for(var i=t.getElementsByTagName("*"),r=0,a=i.length;r<a;r++)for(var s=i[r].attributes,l=Array.prototype.slice.call(s),d=0,u=l.length;d<u;d++)l[d].name.startsWith("on")||l[d].value.startsWith("javascript")?i[r].remove():"style"===l[d].name&&i[r].removeAttribute(l[d].name);return t.innerHTML}(o),e.captionsText.className=e.options.classPrefix+"captions-text "+(t.entries[n].identifier||""),e.captions.style.display="",void(e.captions.style.height="0px")}e.captions.style.display="none"}else e.captions.style.display="none"}},setupSlides:function(e){this.slides=e,this.slides.entries.imgs=[this.slides.entries.length],this.showSlide(0)},showSlide:function(e){var i=this,r=this;if(void 0!==r.tracks&&void 0!==r.slidesContainer){var t=r.slides.entries[e].text,n=r.slides.entries[e].imgs;if(void 0===n||void 0===n.fadeIn){var a=L.default.createElement("img");a.src=t,a.addEventListener("load",function(){var e=i,t=(0,I.siblings)(e,function(e){return t(e)});e.style.display="none",r.slidesContainer.innerHTML+=e.innerHTML,(0,I.fadeIn)(r.slidesContainer.querySelector(a));for(var n=0,o=t.length;n<o;n++)(0,I.fadeOut)(t[n],400)}),r.slides.entries[e].imgs=n=a}else if(!(0,I.visible)(n)){var o=(0,I.siblings)(self,function(e){return o(e)});(0,I.fadeIn)(r.slidesContainer.querySelector(n));for(var s=0,l=o.length;s<l;s++)(0,I.fadeOut)(o[s])}}},displaySlides:function(){if(void 0!==this.slides){var e=this.slides,t=this.searchTrackPosition(e.entries,this.media.currentTime);-1<t&&this.showSlide(t)}},drawChapters:function(e){var r=this,t=e.entries.length;if(t){r.chaptersButton.querySelector("ul").innerHTML="";for(var n=0;n<t;n++)r.chaptersButton.querySelector("ul").innerHTML+=\'<li class="\'+r.options.classPrefix+\'chapters-selector-list-item" role="menuitemcheckbox" aria-live="polite" aria-disabled="false" aria-checked="false"><input type="radio" class="\'+r.options.classPrefix+\'captions-selector-input" name="\'+r.id+\'_chapters" id="\'+r.id+"_chapters_"+n+\'" value="\'+e.entries[n].start+\'" disabled><label class="\'+r.options.classPrefix+\'chapters-selector-label"for="\'+r.id+"_chapters_"+n+\'">\'+e.entries[n].text+"</label></li>";for(var o=r.chaptersButton.querySelectorAll(\'input[type="radio"]\'),i=r.chaptersButton.querySelectorAll("."+r.options.classPrefix+"chapters-selector-label"),a=0,s=o.length;a<s;a++)o[a].disabled=!1,o[a].checked=!1,o[a].addEventListener("click",function(e){var t=r.chaptersButton.querySelectorAll("li"),n=(0,I.siblings)(this,function(e){return(0,I.hasClass)(e,r.options.classPrefix+"chapters-selector-label")})[0];this.checked=!0,this.parentNode.setAttribute("aria-checked",!0),(0,I.addClass)(n,r.options.classPrefix+"chapters-selected"),(0,I.removeClass)(r.chaptersButton.querySelector("."+r.options.classPrefix+"chapters-selected"),r.options.classPrefix+"chapters-selected");for(var o=0,i=t.length;o<i;o++)t[o].setAttribute("aria-checked",!1);void 0===(e.keyCode||e.which)&&setTimeout(function(){r.getElement(r.container).focus()},500),r.media.setCurrentTime(parseFloat(this.value)),r.media.paused&&r.media.play()});for(var l=0,d=i.length;l<d;l++)i[l].addEventListener("click",function(e){var t=(0,I.siblings)(this,function(e){return"INPUT"===e.tagName})[0],n=(0,j.createEvent)("click",t);t.dispatchEvent(n),e.preventDefault()})}},searchTrackPosition:function(e,t){for(var n=0,o=e.length-1,i=void 0,r=void 0,a=void 0;n<=o;){if(r=e[i=n+o>>1].start,a=e[i].stop,r<=t&&t<a)return i;r<t?n=i+1:t<r&&(o=i-1)}return-1}}),d.default.language={codes:{af:"mejs.afrikaans",sq:"mejs.albanian",ar:"mejs.arabic",be:"mejs.belarusian",bg:"mejs.bulgarian",ca:"mejs.catalan",zh:"mejs.chinese","zh-cn":"mejs.chinese-simplified","zh-tw":"mejs.chines-traditional",hr:"mejs.croatian",cs:"mejs.czech",da:"mejs.danish",nl:"mejs.dutch",en:"mejs.english",et:"mejs.estonian",fl:"mejs.filipino",fi:"mejs.finnish",fr:"mejs.french",gl:"mejs.galician",de:"mejs.german",el:"mejs.greek",ht:"mejs.haitian-creole",iw:"mejs.hebrew",hi:"mejs.hindi",hu:"mejs.hungarian",is:"mejs.icelandic",id:"mejs.indonesian",ga:"mejs.irish",it:"mejs.italian",ja:"mejs.japanese",ko:"mejs.korean",lv:"mejs.latvian",lt:"mejs.lithuanian",mk:"mejs.macedonian",ms:"mejs.malay",mt:"mejs.maltese",no:"mejs.norwegian",fa:"mejs.persian",pl:"mejs.polish",pt:"mejs.portuguese",ro:"mejs.romanian",ru:"mejs.russian",sr:"mejs.serbian",sk:"mejs.slovak",sl:"mejs.slovenian",es:"mejs.spanish",sw:"mejs.swahili",sv:"mejs.swedish",tl:"mejs.tagalog",th:"mejs.thai",tr:"mejs.turkish",uk:"mejs.ukrainian",vi:"mejs.vietnamese",cy:"mejs.welsh",yi:"mejs.yiddish"}},d.default.TrackFormatParser={webvtt:{pattern:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(e){for(var t=e.split(/\\r?\\n/),n=[],o=void 0,i=void 0,r=void 0,a=0,s=t.length;a<s;a++){if((o=this.pattern.exec(t[a]))&&a<t.length){for(0<=a-1&&""!==t[a-1]&&(r=t[a-1]),i=t[++a],a++;""!==t[a]&&a<t.length;)i=i+"\\n"+t[a],a++;i=null===i?"":i.trim().replace(/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/gi,"<a href=\'$1\' target=\'_blank\'>$1</a>"),n.push({identifier:r,start:0===(0,m.convertSMPTEtoSeconds)(o[1])?.2:(0,m.convertSMPTEtoSeconds)(o[1]),stop:(0,m.convertSMPTEtoSeconds)(o[3]),text:i,settings:o[5]})}r=""}return n}},dfxp:{parse:function(e){var t=L.default.adoptNode((new DOMParser).parseFromString(e,"application/xml").documentElement).querySelector("div"),n=t.querySelectorAll("p"),o=L.default.getElementById(t.getAttribute("style")),i=[],r=void 0;if(o){o.removeAttribute("id");var a=o.attributes;if(a.length){r={};for(var s=0,l=a.length;s<l;s++)r[a[s].name.split(":")[1]]=a[s].value}}for(var d=0,u=n.length;d<u;d++){var c=void 0,f={start:null,stop:null,style:null,text:null};if(n[d].getAttribute("begin")&&(f.start=(0,m.convertSMPTEtoSeconds)(n[d].getAttribute("begin"))),!f.start&&n[d-1].getAttribute("end")&&(f.start=(0,m.convertSMPTEtoSeconds)(n[d-1].getAttribute("end"))),n[d].getAttribute("end")&&(f.stop=(0,m.convertSMPTEtoSeconds)(n[d].getAttribute("end"))),!f.stop&&n[d+1].getAttribute("begin")&&(f.stop=(0,m.convertSMPTEtoSeconds)(n[d+1].getAttribute("begin"))),r)for(var p in c="",r)c+=p+": "+r[p]+";";c&&(f.style=c),0===f.start&&(f.start=.2),f.text=n[d].innerHTML.trim().replace(/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_| !:, .; ]*[-A-Z0-9+&@#\\/%=~_|])/gi,"<a href=\'$1\' target=\'_blank\'>$1</a>"),i.push(f)}return i}}}},{17:17,2:2,27:27,28:28,29:29,32:32,6:6,8:8}],15:[function(e,t,n){"use strict";var w=r(e(2)),o=e(17),i=r(o),x=r(e(6)),P=e(26),T=e(28),C=e(27),k=e(29);function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(o.config,{muteText:null,unmuteText:null,allyVolumeControlText:null,hideVolumeOnTouchDevices:!0,audioVolume:"horizontal",videoVolume:"vertical",startVolume:.8}),Object.assign(i.default.prototype,{buildvolume:function(e,t,n,o){if(!P.IS_ANDROID&&!P.IS_IOS||!this.options.hideVolumeOnTouchDevices){var a=this,s=a.isVideo?a.options.videoVolume:a.options.audioVolume,r=(0,T.isString)(a.options.muteText)?a.options.muteText:x.default.t("mejs.mute"),l=(0,T.isString)(a.options.unmuteText)?a.options.unmuteText:x.default.t("mejs.unmute"),i=(0,T.isString)(a.options.allyVolumeControlText)?a.options.allyVolumeControlText:x.default.t("mejs.volume-help-text"),d=w.default.createElement("div");if(d.className=a.options.classPrefix+"button "+a.options.classPrefix+"volume-button "+a.options.classPrefix+"mute",d.innerHTML="horizontal"===s?(0,k.generateControlButton)(a.id,r,r,""+a.media.options.iconSprite,["icon-mute","icon-unmute"],""+a.options.classPrefix,"",a.options.classPrefix+"horizontal-volume-slider"):(0,k.generateControlButton)(a.id,r,r,""+a.media.options.iconSprite,["icon-mute","icon-unmute"],""+a.options.classPrefix,"",a.options.classPrefix+"volume-slider")+\'<a class="\'+a.options.classPrefix+\'volume-slider" aria-label="\'+x.default.t("mejs.volume-slider")+\'" aria-valuemin="0" aria-valuemax="100" role="slider" aria-orientation="vertical"><span class="\'+a.options.classPrefix+\'offscreen" id="\'+a.options.classPrefix+\'volume-slider">\'+i+\'</span><div class="\'+a.options.classPrefix+\'volume-total"><div class="\'+a.options.classPrefix+\'volume-current"></div><div class="\'+a.options.classPrefix+\'volume-handle"></div></div></a>\',a.addControlElement(d,"volume"),a.options.keyActions.push({keys:[38],action:function(e){var t=e.getElement(e.container).querySelector("."+a.options.classPrefix+"volume-slider");t&&t.matches(":focus")&&(t.style.display="block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.min(e.volume+.1,1);e.setVolume(n),0<n&&e.setMuted(!1)}},{keys:[40],action:function(e){var t=e.getElement(e.container).querySelector("."+a.options.classPrefix+"volume-slider");t&&(t.style.display="block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.max(e.volume-.1,0);e.setVolume(n),n<=.1&&e.setMuted(!0)}},{keys:[77],action:function(e){var t=e.getElement(e.container).querySelector("."+a.options.classPrefix+"volume-slider");t&&(t.style.display="block"),e.isVideo&&(e.showControls(),e.startControlsTimer()),e.media.muted?e.setMuted(!1):e.setMuted(!0)}}),"horizontal"===s){var u=w.default.createElement("a");u.className=a.options.classPrefix+"horizontal-volume-slider",u.setAttribute("aria-label",x.default.t("mejs.volume-slider")),u.setAttribute("aria-valuemin",0),u.setAttribute("aria-valuemax",100),u.setAttribute("aria-valuenow",100),u.setAttribute("role","slider"),u.innerHTML+=\'<span class="\'+a.options.classPrefix+\'offscreen" id="\'+a.options.classPrefix+\'horizontal-volume-slider">\'+i+\'</span><div class="\'+a.options.classPrefix+\'horizontal-volume-total"><div class="\'+a.options.classPrefix+\'horizontal-volume-current"></div><div class="\'+a.options.classPrefix+\'horizontal-volume-handle"></div></div>\',d.parentNode.insertBefore(u,d.nextSibling)}var c=!1,f=!1,p=!1,m="vertical"===s?a.getElement(a.container).querySelector("."+a.options.classPrefix+"volume-slider"):a.getElement(a.container).querySelector("."+a.options.classPrefix+"horizontal-volume-slider"),h="vertical"===s?a.getElement(a.container).querySelector("."+a.options.classPrefix+"volume-total"):a.getElement(a.container).querySelector("."+a.options.classPrefix+"horizontal-volume-total"),v="vertical"===s?a.getElement(a.container).querySelector("."+a.options.classPrefix+"volume-current"):a.getElement(a.container).querySelector("."+a.options.classPrefix+"horizontal-volume-current"),g="vertical"===s?a.getElement(a.container).querySelector("."+a.options.classPrefix+"volume-handle"):a.getElement(a.container).querySelector("."+a.options.classPrefix+"horizontal-volume-handle"),y=function(e){if(null!==e&&!isNaN(e)&&void 0!==e){if(e=Math.max(0,e),0===(e=Math.min(e,1))){(0,C.removeClass)(d,a.options.classPrefix+"mute"),(0,C.addClass)(d,a.options.classPrefix+"unmute");var t=d.firstElementChild;t.setAttribute("title",l),t.setAttribute("aria-label",l)}else{(0,C.removeClass)(d,a.options.classPrefix+"unmute"),(0,C.addClass)(d,a.options.classPrefix+"mute");var n=d.firstElementChild;n.setAttribute("title",r),n.setAttribute("aria-label",r)}var o=100*e+"%",i=getComputedStyle(g);"vertical"===s?(v.style.bottom=0,v.style.height=o,g.style.bottom=o,g.style.marginBottom=-parseFloat(i.height)/2+"px"):(v.style.left=0,v.style.width=o,g.style.left=o,g.style.marginLeft=-parseFloat(i.width)/2+"px")}},E=function(e){var t=(0,C.offset)(h),n=getComputedStyle(h);p=!0;var o=null;if("vertical"===s){var i=parseFloat(n.height);if(o=(i-(e.pageY-t.top))/i,0===t.top||0===t.left)return}else{var r=parseFloat(n.width);o=(e.pageX-t.left)/r}o=Math.max(0,o),o=Math.min(o,1),y(o),a.setMuted(0===o),a.setVolume(o),e.preventDefault(),e.stopPropagation()},b=function(){a.muted?(y(0),(0,C.removeClass)(d,a.options.classPrefix+"mute"),(0,C.addClass)(d,a.options.classPrefix+"unmute")):(y(o.volume),(0,C.removeClass)(d,a.options.classPrefix+"unmute"),(0,C.addClass)(d,a.options.classPrefix+"mute"))};e.getElement(e.container).addEventListener("keydown",function(e){!!e.target.closest("."+a.options.classPrefix+"container")||"vertical"!==s||(m.style.display="none")}),d.addEventListener("mouseenter",function(e){e.target===d&&(m.style.display="block",f=!0,e.preventDefault(),e.stopPropagation())}),d.addEventListener("focusin",function(){m.style.display="block",f=!0}),d.addEventListener("focusout",function(e){e.relatedTarget&&(!e.relatedTarget||e.relatedTarget.matches("."+a.options.classPrefix+"volume-slider"))||"vertical"!==s||(m.style.display="none")}),d.addEventListener("mouseleave",function(){f=!1,c||"vertical"!==s||(m.style.display="none")}),d.addEventListener("focusout",function(){f=!1}),d.addEventListener("keydown",function(e){if(a.options.enableKeyboard&&a.options.keyActions.length){var t=e.which||e.keyCode||0,n=o.volume;switch(t){case 38:n=Math.min(n+.1,1);break;case 40:n=Math.max(0,n-.1);break;default:return!0}c=!1,y(n),o.setVolume(n),e.preventDefault(),e.stopPropagation()}}),d.querySelector("button").addEventListener("click",function(){o.setMuted(!o.muted);var e=(0,T.createEvent)("volumechange",o);o.dispatchEvent(e)}),m.addEventListener("dragstart",function(){return!1}),m.addEventListener("mouseover",function(){f=!0}),m.addEventListener("focusin",function(){m.style.display="block",f=!0}),m.addEventListener("focusout",function(){f=!1,c||"vertical"!==s||(m.style.display="none")}),m.addEventListener("mousedown",function(e){E(e),a.globalBind("mousemove.vol",function(e){var t=e.target;c&&(t===m||t.closest("vertical"===s?"."+a.options.classPrefix+"volume-slider":"."+a.options.classPrefix+"horizontal-volume-slider"))&&E(e)}),a.globalBind("mouseup.vol",function(){c=!1,f||"vertical"!==s||(m.style.display="none")}),c=!0,e.preventDefault(),e.stopPropagation()}),o.addEventListener("volumechange",function(e){var t;c||b(),t=Math.floor(100*o.volume),m.setAttribute("aria-valuenow",t),m.setAttribute("aria-valuetext",t+"%")});var S=!1;o.addEventListener("rendererready",function(){p||setTimeout(function(){S=!0,(0===e.options.startVolume||o.originalNode.muted)&&o.setMuted(!0),o.setVolume(e.options.startVolume),a.setControlsSize()},250)}),o.addEventListener("loadedmetadata",function(){setTimeout(function(){p||S||((0===e.options.startVolume||o.originalNode.muted)&&o.setMuted(!0),0===e.options.startVolume&&(e.options.startVolume=0),o.setVolume(e.options.startVolume),a.setControlsSize()),S=!1},250)}),(0===e.options.startVolume||o.originalNode.muted)&&(o.setMuted(!0),0===e.options.startVolume&&(e.options.startVolume=0),b()),a.getElement(a.container).addEventListener("controlsresize",function(){b()})}}})},{17:17,2:2,26:26,27:27,28:28,29:29,6:6}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EN={"mejs.plural-form":1,"mejs.download-file":"Download File","mejs.install-flash":"You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https://get.adobe.com/flashplayer/","mejs.fullscreen":"Fullscreen","mejs.play":"Play","mejs.pause":"Pause","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.","mejs.live-broadcast":"Live Broadcast","mejs.volume-help-text":"Use Up/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.captions-subtitles":"Captions/Subtitles","mejs.captions-chapters":"Chapters","mejs.none":"None","mejs.afrikaans":"Afrikaans","mejs.albanian":"Albanian","mejs.arabic":"Arabic","mejs.belarusian":"Belarusian","mejs.bulgarian":"Bulgarian","mejs.catalan":"Catalan","mejs.chinese":"Chinese","mejs.chinese-simplified":"Chinese (Simplified)","mejs.chinese-traditional":"Chinese (Traditional)","mejs.croatian":"Croatian","mejs.czech":"Czech","mejs.danish":"Danish","mejs.dutch":"Dutch","mejs.english":"English","mejs.estonian":"Estonian","mejs.filipino":"Filipino","mejs.finnish":"Finnish","mejs.french":"French","mejs.galician":"Galician","mejs.german":"German","mejs.greek":"Greek","mejs.haitian-creole":"Haitian Creole","mejs.hebrew":"Hebrew","mejs.hindi":"Hindi","mejs.hungarian":"Hungarian","mejs.icelandic":"Icelandic","mejs.indonesian":"Indonesian","mejs.irish":"Irish","mejs.italian":"Italian","mejs.japanese":"Japanese","mejs.korean":"Korean","mejs.latvian":"Latvian","mejs.lithuanian":"Lithuanian","mejs.macedonian":"Macedonian","mejs.malay":"Malay","mejs.maltese":"Maltese","mejs.norwegian":"Norwegian","mejs.persian":"Persian","mejs.polish":"Polish","mejs.portuguese":"Portuguese","mejs.romanian":"Romanian","mejs.russian":"Russian","mejs.serbian":"Serbian","mejs.slovak":"Slovak","mejs.slovenian":"Slovenian","mejs.spanish":"Spanish","mejs.swahili":"Swahili","mejs.swedish":"Swedish","mejs.tagalog":"Tagalog","mejs.thai":"Thai","mejs.turkish":"Turkish","mejs.ukrainian":"Ukrainian","mejs.vietnamese":"Vietnamese","mejs.welsh":"Welsh","mejs.yiddish":"Yiddish"}},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.config=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),S=r(e(3)),w=r(e(2)),f=r(e(8)),d=r(e(7)),i=r(e(18)),u=r(e(6)),x=e(26),m=e(28),c=e(32),p=e(30),P=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e(27)),h=e(29);function r(e){return e&&e.__esModule?e:{default:e}}f.default.mepIndex=0,f.default.players={};var s=n.config={poster:"",showPosterWhenEnded:!1,showPosterWhenPaused:!1,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:40,defaultSeekBackwardInterval:function(e){return.05*e.getDuration()},defaultSeekForwardInterval:function(e){return.05*e.getDuration()},setDimensions:!0,audioWidth:-1,audioHeight:-1,loop:!1,autoRewind:!0,enableAutosize:!0,timeFormat:"",alwaysShowHours:!1,showTimecodeFrameCount:!1,framesPerSecond:25,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,hideVideoControlsOnPause:!1,clickToPlayPause:!0,controlsTimeoutDefault:1500,controlsTimeoutMouseEnter:2500,controlsTimeoutMouseLeave:1e3,iPadUseNativeControls:!1,iPhoneUseNativeControls:!1,AndroidUseNativeControls:!1,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],useDefaultControls:!1,isVideo:!0,stretching:"auto",classPrefix:"mejs__",enableKeyboard:!0,pauseOtherPlayers:!0,secondsDecimalLength:0,customError:null,keyActions:[],hideScreenReaderTitle:!1};f.default.MepDefaults=s;var l=function(){function r(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=this,o="string"==typeof e?w.default.getElementById(e):e;if(!(n instanceof r))return new r(o,t);if(n.node=n.media=o,n.node){if(n.media.player)return n.media.player;if(n.hasFocus=!1,n.controlsAreVisible=!0,n.controlsEnabled=!0,n.controlsTimer=null,n.currentMediaTime=0,n.proxy=null,void 0===t){var i=n.node.getAttribute("data-mejsoptions");t=i?JSON.parse(i):{}}return n.options=Object.assign({},s,t),n.options.loop&&!n.media.getAttribute("loop")?(n.media.loop=!0,n.node.loop=!0):n.media.loop&&(n.options.loop=!0),n.options.timeFormat||(n.options.timeFormat="mm:ss",n.options.alwaysShowHours&&(n.options.timeFormat="hh:mm:ss"),n.options.showTimecodeFrameCount&&(n.options.timeFormat+=":ff")),(0,c.calculateTimeFormat)(0,n.options,n.options.framesPerSecond||25),n.id="mep_"+f.default.mepIndex++,(f.default.players[n.id]=n).init(),n}}return o(r,[{key:"getElement",value:function(e){return e}},{key:"init",value:function(){var n=this,e=Object.assign({},n.options,{success:function(e,t){n._meReady(e,t)},error:function(e){n._handleError(e)}}),t=n.node.tagName.toLowerCase();if(n.isDynamic="audio"!==t&&"video"!==t&&"iframe"!==t,n.isVideo=n.isDynamic?n.options.isVideo:"audio"!==t&&n.options.isVideo,n.mediaFiles=null,n.trackFiles=null,x.IS_IPAD&&n.options.iPadUseNativeControls||x.IS_IPHONE&&n.options.iPhoneUseNativeControls)n.node.setAttribute("controls",!0),x.IS_IPAD&&n.node.getAttribute("autoplay")&&n.play();else if(!n.isVideo&&(n.isVideo||!n.options.features.length&&!n.options.useDefaultControls)||x.IS_ANDROID&&n.options.AndroidUseNativeControls)n.isVideo||n.options.features.length||n.options.useDefaultControls||(n.node.style.display="none");else{n.node.removeAttribute("controls");var o=n.isVideo?u.default.t("mejs.video-player"):u.default.t("mejs.audio-player");if(!n.options.hideScreenReaderTitle){var i=w.default.createElement("span");i.className=n.options.classPrefix+"offscreen",i.innerText=o,n.media.parentNode.insertBefore(i,n.media)}if(n.container=w.default.createElement("div"),n.getElement(n.container).id=n.id,n.getElement(n.container).className=n.options.classPrefix+"container "+n.options.classPrefix+"container-keyboard-inactive "+n.media.className,n.getElement(n.container).tabIndex=0,n.getElement(n.container).setAttribute("role","application"),n.getElement(n.container).setAttribute("aria-label",o),n.getElement(n.container).innerHTML=\'<div class="\'+n.options.classPrefix+\'inner"><div class="\'+n.options.classPrefix+\'mediaelement"></div><div class="\'+n.options.classPrefix+\'layers"></div><div class="\'+n.options.classPrefix+\'controls"></div></div>\',n.getElement(n.container).addEventListener("focus",function(e){if(!n.controlsAreVisible&&!n.hasFocus&&n.controlsEnabled){n.showControls(!0);var t=(0,m.isNodeAfter)(e.relatedTarget,n.getElement(n.container))?"."+n.options.classPrefix+"controls ."+n.options.classPrefix+"button:last-child > button":"."+n.options.classPrefix+"playpause-button > button";n.getElement(n.container).querySelector(t).focus()}}),n.node.parentNode.insertBefore(n.getElement(n.container),n.node),n.options.features.length||n.options.useDefaultControls||(n.getElement(n.container).style.background="transparent",n.getElement(n.container).querySelector("."+n.options.classPrefix+"controls").style.display="none"),n.isVideo&&"fill"===n.options.stretching&&!P.hasClass(n.getElement(n.container).parentNode,n.options.classPrefix+"fill-container")){n.outerContainer=n.media.parentNode;var r=w.default.createElement("div");r.className=n.options.classPrefix+"fill-container",n.getElement(n.container).parentNode.insertBefore(r,n.getElement(n.container)),r.appendChild(n.getElement(n.container))}x.IS_ANDROID&&P.addClass(n.getElement(n.container),n.options.classPrefix+"android"),x.IS_IOS&&P.addClass(n.getElement(n.container),n.options.classPrefix+"ios"),x.IS_IPAD&&P.addClass(n.getElement(n.container),n.options.classPrefix+"ipad"),x.IS_IPHONE&&P.addClass(n.getElement(n.container),n.options.classPrefix+"iphone"),P.addClass(n.getElement(n.container),n.isVideo?n.options.classPrefix+"video":n.options.classPrefix+"audio"),n.getElement(n.container).querySelector("."+n.options.classPrefix+"mediaelement").appendChild(n.node),(n.media.player=n).controls=n.getElement(n.container).querySelector("."+n.options.classPrefix+"controls"),n.layers=n.getElement(n.container).querySelector("."+n.options.classPrefix+"layers");var a=n.isVideo?"video":"audio",s=a.substring(0,1).toUpperCase()+a.substring(1);0<n.options[a+"Width"]||-1<n.options[a+"Width"].toString().indexOf("%")?n.width=n.options[a+"Width"]:""!==n.node.style.width&&null!==n.node.style.width?n.width=n.node.style.width:n.node.getAttribute("width")?n.width=n.node.getAttribute("width"):n.width=n.options["default"+s+"Width"],0<n.options[a+"Height"]||-1<n.options[a+"Height"].toString().indexOf("%")?n.height=n.options[a+"Height"]:""!==n.node.style.height&&null!==n.node.style.height?n.height=n.node.style.height:n.node.getAttribute("height")?n.height=n.node.getAttribute("height"):n.height=n.options["default"+s+"Height"],n.initialAspectRatio=n.height>=n.width?n.width/n.height:n.height/n.width,n.setPlayerSize(n.width,n.height),e.pluginWidth=n.width,e.pluginHeight=n.height}if(f.default.MepDefaults=e,new d.default(n.media,e,n.mediaFiles),void 0!==n.getElement(n.container)&&n.options.features.length&&n.controlsAreVisible&&!n.options.hideVideoControlsOnLoad){var l=(0,m.createEvent)("controlsshown",n.getElement(n.container));n.getElement(n.container).dispatchEvent(l)}}},{key:"showControls",value:function(e){var i=this;if(e=void 0===e||e,!i.controlsAreVisible&&i.isVideo){if(e)!function(){P.fadeIn(i.getElement(i.controls),200,function(){P.removeClass(i.getElement(i.controls),i.options.classPrefix+"offscreen");var e=(0,m.createEvent)("controlsshown",i.getElement(i.container));i.getElement(i.container).dispatchEvent(e)});for(var n=i.getElement(i.container).querySelectorAll("."+i.options.classPrefix+"control"),e=function(e,t){P.fadeIn(n[e],200,function(){P.removeClass(n[e],i.options.classPrefix+"offscreen")})},t=0,o=n.length;t<o;t++)e(t)}();else{P.removeClass(i.getElement(i.controls),i.options.classPrefix+"offscreen"),i.getElement(i.controls).style.display="",i.getElement(i.controls).style.opacity=1;for(var t=i.getElement(i.container).querySelectorAll("."+i.options.classPrefix+"control"),n=0,o=t.length;n<o;n++)P.removeClass(t[n],i.options.classPrefix+"offscreen"),t[n].style.display="";var r=(0,m.createEvent)("controlsshown",i.getElement(i.container));i.getElement(i.container).dispatchEvent(r)}i.controlsAreVisible=!0,i.setControlsSize()}}},{key:"hideControls",value:function(e,t){var i=this;if(e=void 0===e||e,!0===t||!(!i.controlsAreVisible||i.options.alwaysShowControls||i.paused&&4===i.readyState&&(!i.options.hideVideoControlsOnLoad&&i.currentTime<=0||!i.options.hideVideoControlsOnPause&&0<i.currentTime)||i.isVideo&&!i.options.hideVideoControlsOnLoad&&!i.readyState||i.ended)){if(e)!function(){P.fadeOut(i.getElement(i.controls),200,function(){P.addClass(i.getElement(i.controls),i.options.classPrefix+"offscreen"),i.getElement(i.controls).style.display="";var e=(0,m.createEvent)("controlshidden",i.getElement(i.container));i.getElement(i.container).dispatchEvent(e)});for(var n=i.getElement(i.container).querySelectorAll("."+i.options.classPrefix+"control"),e=function(e,t){P.fadeOut(n[e],200,function(){P.addClass(n[e],i.options.classPrefix+"offscreen"),n[e].style.display=""})},t=0,o=n.length;t<o;t++)e(t)}();else{P.addClass(i.getElement(i.controls),i.options.classPrefix+"offscreen"),i.getElement(i.controls).style.display="",i.getElement(i.controls).style.opacity=0;for(var n=i.getElement(i.container).querySelectorAll("."+i.options.classPrefix+"control"),o=0,r=n.length;o<r;o++)P.addClass(n[o],i.options.classPrefix+"offscreen"),n[o].style.display="";var a=(0,m.createEvent)("controlshidden",i.getElement(i.container));i.getElement(i.container).dispatchEvent(a)}i.controlsAreVisible=!1}}},{key:"startControlsTimer",value:function(e){var t=this;e=void 0!==e?e:t.options.controlsTimeoutDefault,t.killControlsTimer("start"),t.controlsTimer=setTimeout(function(){t.hideControls(),t.killControlsTimer("hide")},e)}},{key:"killControlsTimer",value:function(){null!==this.controlsTimer&&(clearTimeout(this.controlsTimer),delete this.controlsTimer,this.controlsTimer=null)}},{key:"disableControls",value:function(){this.killControlsTimer(),this.controlsEnabled=!1,this.hideControls(!1,!0)}},{key:"enableControls",value:function(){this.controlsEnabled=!0,this.showControls(!1)}},{key:"_setDefaultPlayer",value:function(){var e=this;e.proxy&&e.proxy.pause(),e.proxy=new i.default(e),e.media.addEventListener("loadedmetadata",function(){0<e.getCurrentTime()&&0<e.currentMediaTime&&(e.setCurrentTime(e.currentMediaTime),x.IS_IOS||x.IS_ANDROID||e.play())})}},{key:"_meReady",value:function(e,t){var n=this,o=t.getAttribute("autoplay"),i=!(null==o||"false"===o),r=null!==e.rendererName&&/(native|html5)/i.test(e.rendererName);if(n.getElement(n.controls)&&n.enableControls(),n.getElement(n.container)&&n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-play")&&(n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-play").style.display=""),!n.created){if(n.created=!0,n.media=e,n.domNode=t,!(x.IS_ANDROID&&n.options.AndroidUseNativeControls||x.IS_IPAD&&n.options.iPadUseNativeControls||x.IS_IPHONE&&n.options.iPhoneUseNativeControls)){if(!n.isVideo&&!n.options.features.length&&!n.options.useDefaultControls)return i&&r&&n.play(),void(n.options.success&&("string"==typeof n.options.success?S.default[n.options.success](n.media,n.domNode,n):n.options.success(n.media,n.domNode,n)));if(n.featurePosition={},n._setDefaultPlayer(),n.buildposter(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.buildkeyboard(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.buildoverlays(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.options.useDefaultControls){var a=["playpause","current","progress","duration","tracks","volume","fullscreen"];n.options.features=a.concat(n.options.features.filter(function(e){return-1===a.indexOf(e)}))}n.buildfeatures(n,n.getElement(n.controls),n.getElement(n.layers),n.media);var s=(0,m.createEvent)("controlsready",n.getElement(n.container));n.getElement(n.container).dispatchEvent(s),n.setPlayerSize(n.width,n.height),n.setControlsSize(),n.isVideo&&(n.clickToPlayPauseCallback=function(){if(n.options.clickToPlayPause){var e=n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-button"),t=e.getAttribute("aria-pressed");n.paused&&t?n.pause():n.paused?n.play():n.pause(),e.setAttribute("aria-pressed",!t),n.getElement(n.container).focus()}},n.createIframeLayer(),n.media.addEventListener("click",n.clickToPlayPauseCallback),!x.IS_ANDROID&&!x.IS_IOS||n.options.alwaysShowControls?(n.getElement(n.container).addEventListener("mouseenter",function(){n.controlsEnabled&&(n.options.alwaysShowControls||(n.killControlsTimer("enter"),n.showControls(),n.startControlsTimer(n.options.controlsTimeoutMouseEnter)))}),n.getElement(n.container).addEventListener("mousemove",function(){n.controlsEnabled&&(n.controlsAreVisible||n.showControls(),n.options.alwaysShowControls||n.startControlsTimer(n.options.controlsTimeoutMouseEnter))}),n.getElement(n.container).addEventListener("mouseleave",function(){n.controlsEnabled&&(n.paused||n.options.alwaysShowControls||n.startControlsTimer(n.options.controlsTimeoutMouseLeave))})):n.node.addEventListener("touchstart",function(){n.controlsAreVisible?n.hideControls(!1):n.controlsEnabled&&n.showControls(!1)},!!x.SUPPORT_PASSIVE_EVENT&&{passive:!0}),n.options.hideVideoControlsOnLoad&&n.hideControls(!1),n.options.enableAutosize&&n.media.addEventListener("loadedmetadata",function(e){var t=void 0!==e?e.detail.target||e.target:n.media;n.options.videoHeight<=0&&!n.domNode.getAttribute("height")&&!n.domNode.style.height&&null!==t&&!isNaN(t.videoHeight)&&(n.setPlayerSize(t.videoWidth,t.videoHeight),n.setControlsSize(),n.media.setSize(t.videoWidth,t.videoHeight))})),n.media.addEventListener("play",function(){for(var e in n.hasFocus=!0,f.default.players)if(f.default.players.hasOwnProperty(e)){var t=f.default.players[e];t.id===n.id||!n.options.pauseOtherPlayers||t.paused||t.ended||!0===t.options.ignorePauseOtherPlayersOption||(t.pause(),t.hasFocus=!1)}x.IS_ANDROID||x.IS_IOS||n.options.alwaysShowControls||!n.isVideo||n.hideControls()}),n.media.addEventListener("ended",function(){if(n.options.autoRewind)try{n.setCurrentTime(0),setTimeout(function(){var e=n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-loading");e&&e.parentNode&&(e.parentNode.style.display="none")},20)}catch(e){}"function"==typeof n.media.renderer.stop?n.media.renderer.stop():n.pause(),n.setProgressRail&&n.setProgressRail(),n.setCurrentRail&&n.setCurrentRail(),n.options.loop?n.play():!n.options.alwaysShowControls&&n.controlsEnabled&&n.showControls()}),n.media.addEventListener("loadedmetadata",function(){(0,c.calculateTimeFormat)(n.getDuration(),n.options,n.options.framesPerSecond||25),n.updateDuration&&n.updateDuration(),n.updateCurrent&&n.updateCurrent(),n.isFullScreen||(n.setPlayerSize(n.width,n.height),n.setControlsSize())});var l=null;n.media.addEventListener("timeupdate",function(){isNaN(n.getDuration())||l===n.getDuration()||(l=n.getDuration(),(0,c.calculateTimeFormat)(l,n.options,n.options.framesPerSecond||25),n.updateDuration&&n.updateDuration(),n.updateCurrent&&n.updateCurrent(),n.setControlsSize())}),n.getElement(n.container).addEventListener("click",function(e){P.addClass(e.currentTarget,n.options.classPrefix+"container-keyboard-inactive")}),n.getElement(n.container).addEventListener("focusin",function(e){P.removeClass(e.currentTarget,n.options.classPrefix+"container-keyboard-inactive"),!n.isVideo||x.IS_ANDROID||x.IS_IOS||!n.controlsEnabled||n.options.alwaysShowControls||(n.killControlsTimer("enter"),n.showControls(),n.startControlsTimer(n.options.controlsTimeoutMouseEnter))}),n.getElement(n.container).addEventListener("focusout",function(e){setTimeout(function(){e.relatedTarget&&n.keyboardAction&&!e.relatedTarget.closest("."+n.options.classPrefix+"container")&&(n.keyboardAction=!1,!n.isVideo||n.options.alwaysShowControls||n.paused||n.startControlsTimer(n.options.controlsTimeoutMouseLeave))},0)}),setTimeout(function(){n.setPlayerSize(n.width,n.height),n.setControlsSize()},0),n.globalResizeCallback=function(){n.isFullScreen||x.HAS_TRUE_NATIVE_FULLSCREEN&&w.default.webkitIsFullScreen||n.setPlayerSize(n.width,n.height),n.setControlsSize()},n.globalBind("resize",n.globalResizeCallback)}i&&r&&n.play(),n.options.success&&("string"==typeof n.options.success?S.default[n.options.success](n.media,n.domNode,n):n.options.success(n.media,n.domNode,n))}}},{key:"_handleError",value:function(e,t,n){var o=this,i=o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-play");i&&(i.style.display="none"),o.options.error&&o.options.error(e,t,n),o.getElement(o.container).querySelector("."+o.options.classPrefix+"cannotplay")&&o.getElement(o.container).querySelector("."+o.options.classPrefix+"cannotplay").remove();var r=w.default.createElement("div");r.className=o.options.classPrefix+"cannotplay",r.style.width="100%",r.style.height="100%";var a="function"==typeof o.options.customError?o.options.customError(o.media,o.media.originalNode):o.options.customError,s="";if(!a){var l=o.media.originalNode.getAttribute("poster");if(l&&(s=\'<img src="\'+l+\'" alt="\'+f.default.i18n.t("mejs.download-file")+\'">\'),e.message&&(a="<p>"+e.message+"</p>"),e.urls)for(var d=0,u=e.urls.length;d<u;d++){var c=e.urls[d];a+=\'<a href="\'+c.src+\'" data-type="\'+c.type+\'"><span>\'+f.default.i18n.t("mejs.download-file")+": "+c.src+"</span></a>"}}a&&o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error")&&(r.innerHTML=a,o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error").innerHTML=""+s+r.outerHTML,o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error").parentNode.style.display="block"),o.controlsEnabled&&o.disableControls()}},{key:"setPlayerSize",value:function(e,t){var n=this;if(!n.options.setDimensions)return!1;switch(void 0!==e&&(n.width=e),void 0!==t&&(n.height=t),n.options.stretching){case"fill":n.isVideo?n.setFillMode():n.setDimensions(n.width,n.height);break;case"responsive":n.setResponsiveMode();break;case"none":n.setDimensions(n.width,n.height);break;default:!0===n.hasFluidMode()?n.setResponsiveMode():n.setDimensions(n.width,n.height)}}},{key:"hasFluidMode",value:function(){var e=this;return-1!==e.height.toString().indexOf("%")||e.node&&e.node.style.maxWidth&&"none"!==e.node.style.maxWidth&&e.node.style.maxWidth!==e.width||e.node&&e.node.currentStyle&&"100%"===e.node.currentStyle.maxWidth}},{key:"setResponsiveMode",value:function(){var o=this,e=function(){for(var t=void 0,n=o.getElement(o.container);n;){try{if(x.IS_FIREFOX&&"html"===n.tagName.toLowerCase()&&S.default.self!==S.default.top&&null!==S.default.frameElement)return S.default.frameElement;t=n.parentElement}catch(e){t=n.parentElement}if(t&&P.visible(t))return t;n=t}return null}(),t=e?getComputedStyle(e,null):getComputedStyle(w.default.body,null),n=o.isVideo?o.node.videoWidth&&0<o.node.videoWidth?o.node.videoWidth:o.node.getAttribute("width")?o.node.getAttribute("width"):o.options.defaultVideoWidth:o.options.defaultAudioWidth,i=o.isVideo?o.node.videoHeight&&0<o.node.videoHeight?o.node.videoHeight:o.node.getAttribute("height")?o.node.getAttribute("height"):o.options.defaultVideoHeight:o.options.defaultAudioHeight,r=function(){if(!o.options.enableAutosize)return o.initialAspectRatio;var e=1;return o.isVideo&&(e=o.node.videoWidth&&0<o.node.videoWidth&&o.node.videoHeight&&0<o.node.videoHeight?o.height>=o.width?o.node.videoWidth/o.node.videoHeight:o.node.videoHeight/o.node.videoWidth:o.initialAspectRatio,(isNaN(e)||e<.01||100<e)&&(e=1)),e}(),a=parseFloat(t.height),s=void 0,l=parseFloat(t.width);if(s=o.isVideo?"100%"===o.height?parseFloat(l*i/n,10):o.height>=o.width?parseFloat(l/r,10):parseFloat(l*r,10):i,isNaN(s)&&(s=a),0<o.getElement(o.container).parentNode.length&&"body"===o.getElement(o.container).parentNode.tagName.toLowerCase()&&(l=S.default.innerWidth||w.default.documentElement.clientWidth||w.default.body.clientWidth,s=S.default.innerHeight||w.default.documentElement.clientHeight||w.default.body.clientHeight),s&&l){o.getElement(o.container).style.width=l+"px",o.getElement(o.container).style.height=s+"px",o.node.style.width="100%",o.node.style.height="100%",o.isVideo&&o.media.setSize&&o.media.setSize(l,s);for(var d=o.getElement(o.layers).children,u=0,c=d.length;u<c;u++)d[u].style.width="100%",d[u].style.height="100%"}}},{key:"setFillMode",value:function(){var e=this,t=S.default.self!==S.default.top&&null!==S.default.frameElement,n=function(){for(var t=void 0,n=e.getElement(e.container);n;){try{if(x.IS_FIREFOX&&"html"===n.tagName.toLowerCase()&&S.default.self!==S.default.top&&null!==S.default.frameElement)return S.default.frameElement;t=n.parentElement}catch(e){t=n.parentElement}if(t&&P.visible(t))return t;n=t}return null}(),o=n?getComputedStyle(n,null):getComputedStyle(w.default.body,null);"none"!==e.node.style.height&&e.node.style.height!==e.height&&(e.node.style.height="auto"),"none"!==e.node.style.maxWidth&&e.node.style.maxWidth!==e.width&&(e.node.style.maxWidth="none"),"none"!==e.node.style.maxHeight&&e.node.style.maxHeight!==e.height&&(e.node.style.maxHeight="none"),e.node.currentStyle&&("100%"===e.node.currentStyle.height&&(e.node.currentStyle.height="auto"),"100%"===e.node.currentStyle.maxWidth&&(e.node.currentStyle.maxWidth="none"),"100%"===e.node.currentStyle.maxHeight&&(e.node.currentStyle.maxHeight="none")),t||parseFloat(o.width)||(n.style.width=e.media.offsetWidth+"px"),t||parseFloat(o.height)||(n.style.height=e.media.offsetHeight+"px"),o=getComputedStyle(n);var i=parseFloat(o.width),r=parseFloat(o.height);e.setDimensions("100%","100%");var a=e.getElement(e.container).querySelector("."+e.options.classPrefix+"poster>img");a&&(a.style.display="");for(var s=e.getElement(e.container).querySelectorAll("object, embed, iframe, video"),l=e.height,d=e.width,u=i,c=l*i/d,f=d*r/l,p=r,m=i<f==!1,h=m?Math.floor(u):Math.floor(f),v=m?Math.floor(c):Math.floor(p),g=m?i+"px":h+"px",y=m?v+"px":r+"px",E=0,b=s.length;E<b;E++)s[E].style.height=y,s[E].style.width=g,e.media.setSize&&e.media.setSize(g,y),s[E].style.marginLeft=Math.floor((i-h)/2)+"px",s[E].style.marginTop=0}},{key:"setDimensions",value:function(e,t){var n=this;e=(0,m.isString)(e)&&-1<e.indexOf("%")?e:parseFloat(e)+"px",t=(0,m.isString)(t)&&-1<t.indexOf("%")?t:parseFloat(t)+"px",n.getElement(n.container).style.width=e,n.getElement(n.container).style.height=t;for(var o=n.getElement(n.layers).children,i=0,r=o.length;i<r;i++)o[i].style.width=e,o[i].style.height=t}},{key:"setControlsSize",value:function(){var t=this;if(P.visible(t.getElement(t.container)))if(t.rail&&P.visible(t.rail)){for(var e=t.total?getComputedStyle(t.total,null):null,n=e?parseFloat(e.marginLeft)+parseFloat(e.marginRight):0,o=getComputedStyle(t.rail),i=parseFloat(o.marginLeft)+parseFloat(o.marginRight),r=0,a=P.siblings(t.rail,function(e){return e!==t.rail}),s=a.length,l=0;l<s;l++)r+=a[l].offsetWidth;r+=n+(0===n?2*i:i)+1,t.getElement(t.container).style.minWidth=r+"px";var d=(0,m.createEvent)("controlsresize",t.getElement(t.container));t.getElement(t.container).dispatchEvent(d)}else{for(var u=t.getElement(t.controls).children,c=0,f=0,p=u.length;f<p;f++)c+=u[f].offsetWidth;t.getElement(t.container).style.minWidth=c+"px"}}},{key:"addControlElement",value:function(e,t){var n=this;if(void 0!==n.featurePosition[t]){var o=n.getElement(n.controls).children[n.featurePosition[t]-1];o.parentNode.insertBefore(e,o.nextSibling)}else{n.getElement(n.controls).appendChild(e);for(var i=n.getElement(n.controls).children,r=0,a=i.length;r<a;r++)if(e===i[r]){n.featurePosition[t]=r;break}}}},{key:"createIframeLayer",value:function(){var t=this;if(t.isVideo&&null!==t.media.rendererName&&-1<t.media.rendererName.indexOf("iframe")&&!w.default.getElementById(t.media.id+"-iframe-overlay")){var e=w.default.createElement("div"),n=w.default.getElementById(t.media.id+"_"+t.media.rendererName);e.id=t.media.id+"-iframe-overlay",e.className=t.options.classPrefix+"iframe-overlay",e.addEventListener("click",function(e){t.options.clickToPlayPause&&(t.paused?t.play():t.pause(),e.preventDefault(),e.stopPropagation())}),n.parentNode.insertBefore(e,n)}}},{key:"resetSize",value:function(){var e=this;setTimeout(function(){e.setPlayerSize(e.width,e.height),e.setControlsSize()},50)}},{key:"setPoster",value:function(e){var t=this;if(t.getElement(t.container)){var n=t.getElement(t.container).querySelector("."+t.options.classPrefix+"poster");n||((n=w.default.createElement("div")).className=t.options.classPrefix+"poster "+t.options.classPrefix+"layer",t.getElement(t.layers).appendChild(n));var o=n.querySelector("img");!o&&e&&((o=w.default.createElement("img")).alt="",o.className=t.options.classPrefix+"poster-img",o.width="100%",o.height="100%",n.style.display="",n.appendChild(o)),e?(o.setAttribute("src",e),n.style.backgroundImage=\'url("\'+e+\'")\',n.style.display=""):o?(n.style.backgroundImage="none",n.style.display="none",o.remove()):n.style.display="none"}else(x.IS_IPAD&&t.options.iPadUseNativeControls||x.IS_IPHONE&&t.options.iPhoneUseNativeControls||x.IS_ANDROID&&t.options.AndroidUseNativeControls)&&(t.media.originalNode.poster=e)}},{key:"changeSkin",value:function(e){var t=this;t.getElement(t.container).className=t.options.classPrefix+"container "+e,t.setPlayerSize(t.width,t.height),t.setControlsSize()}},{key:"globalBind",value:function(e,n){var o=this.node?this.node.ownerDocument:w.default;if((e=(0,m.splitEvents)(e,this.id)).d)for(var t=e.d.split(" "),i=0,r=t.length;i<r;i++)t[i].split(".").reduce(function(e,t){return o.addEventListener(t,n,!1),t},"");if(e.w)for(var a=e.w.split(" "),s=0,l=a.length;s<l;s++)a[s].split(".").reduce(function(e,t){return S.default.addEventListener(t,n,!1),t},"")}},{key:"globalUnbind",value:function(e,n){var o=this.node?this.node.ownerDocument:w.default;if((e=(0,m.splitEvents)(e,this.id)).d)for(var t=e.d.split(" "),i=0,r=t.length;i<r;i++)t[i].split(".").reduce(function(e,t){return o.removeEventListener(t,n,!1),t},"");if(e.w)for(var a=e.w.split(" "),s=0,l=a.length;s<l;s++)a[s].split(".").reduce(function(e,t){return S.default.removeEventListener(t,n,!1),t},"")}},{key:"buildfeatures",value:function(e,t,n,o){for(var i=0,r=this.options.features.length;i<r;i++){var a=this.options.features[i];if(this["build"+a])try{this["build"+a](e,t,n,o)}catch(e){console.error("error building "+a,e)}}}},{key:"buildposter",value:function(e,t,n,o){var i=this,r=w.default.createElement("div");r.className=i.options.classPrefix+"poster "+i.options.classPrefix+"layer",n.appendChild(r);var a=o.originalNode.getAttribute("poster");""!==e.options.poster&&(a&&x.IS_IOS&&o.originalNode.removeAttribute("poster"),a=e.options.poster),a?i.setPoster(a):null!==i.media.renderer&&"function"==typeof i.media.renderer.getPosterUrl?i.setPoster(i.media.renderer.getPosterUrl()):r.style.display="none",o.addEventListener("play",function(){r.style.display="none"}),o.addEventListener("playing",function(){r.style.display="none"}),e.options.showPosterWhenEnded&&e.options.autoRewind&&o.addEventListener("ended",function(){r.style.display=""}),o.addEventListener("error",function(){r.style.display="none"}),e.options.showPosterWhenPaused&&o.addEventListener("pause",function(){e.ended||(r.style.display="")})}},{key:"buildoverlays",value:function(t,e,n,o){if(t.isVideo){var i=this,r=w.default.createElement("div"),a=w.default.createElement("div"),s=w.default.createElement("div");r.style.display="none",r.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer",r.innerHTML=\'<div class="\'+i.options.classPrefix+\'overlay-loading"><div class="\'+i.options.classPrefix+\'overlay-loading-bg-img">\\n\\t\\t\\t\\t\\t<svg xmlns="http://www.w3.org/2000/svg">\\n\\t\\t\\t\\t\\t\\t<use xlink:href="\'+i.media.options.iconSprite+\'#icon-loading-spinner"></use>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t</div></div>\',n.appendChild(r),a.style.display="none",a.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer",a.innerHTML=\'<div class="\'+i.options.classPrefix+\'overlay-error"></div>\',n.appendChild(a),s.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer "+i.options.classPrefix+"overlay-play",s.innerHTML=(0,h.generateControlButton)(i.id,u.default.t("mejs.play"),u.default.t("mejs.play"),""+i.media.options.iconSprite,["icon-overlay-play"],""+i.options.classPrefix,i.options.classPrefix+"overlay-button","",!1),s.addEventListener("click",function(){if(i.options.clickToPlayPause){var e=i.getElement(i.container).querySelector("."+i.options.classPrefix+"overlay-button"),t=e.getAttribute("aria-pressed");i.paused?i.play():i.pause(),e.setAttribute("aria-pressed",!!t),i.getElement(i.container).focus()}}),s.addEventListener("keydown",function(e){var t=e.keyCode||e.which||0;if(13===t||x.IS_FIREFOX&&32===t){var n=(0,m.createEvent)("click",s);return s.dispatchEvent(n),!1}}),n.appendChild(s),null!==i.media.rendererName&&(/(youtube|facebook)/i.test(i.media.rendererName)&&!(i.media.originalNode.getAttribute("poster")||t.options.poster||"function"==typeof i.media.renderer.getPosterUrl&&i.media.renderer.getPosterUrl())||x.IS_STOCK_ANDROID||i.media.originalNode.getAttribute("autoplay"))&&(s.style.display="none");var l=!1;o.addEventListener("play",function(){s.style.display="none",r.style.display="none",a.style.display="none",l=!1}),o.addEventListener("playing",function(){s.style.display="none",r.style.display="none",a.style.display="none",l=!1}),o.addEventListener("seeking",function(){s.style.display="none",r.style.display="",l=!1}),o.addEventListener("seeked",function(){s.style.display=i.paused&&!x.IS_STOCK_ANDROID?"":"none",r.style.display="none",l=!1}),o.addEventListener("pause",function(){r.style.display="none",x.IS_STOCK_ANDROID||l||(s.style.display=""),l=!1}),o.addEventListener("waiting",function(){r.style.display="",l=!1}),o.addEventListener("loadeddata",function(){r.style.display="",x.IS_ANDROID&&(o.canplayTimeout=setTimeout(function(){if(w.default.createEvent){var e=w.default.createEvent("HTMLEvents");return e.initEvent("canplay",!0,!0),o.dispatchEvent(e)}},300)),l=!1}),o.addEventListener("canplay",function(){r.style.display="none",clearTimeout(o.canplayTimeout),l=!1}),o.addEventListener("error",function(e){i._handleError(e,i.media,i.node),r.style.display="none",s.style.display="none",l=!0}),o.addEventListener("loadedmetadata",function(){i.controlsEnabled||i.enableControls()}),o.addEventListener("keydown",function(e){i.onkeydown(t,o,e),l=!1})}}},{key:"buildkeyboard",value:function(o,e,t,i){var r=this;r.getElement(r.container).addEventListener("keydown",function(){r.keyboardAction=!0}),r.globalKeydownCallback=function(e){if(!w.default.activeElement)return!0;var t=w.default.activeElement.closest("."+r.options.classPrefix+"container"),n=r.media.closest("."+r.options.classPrefix+"container");return r.hasFocus=!(!t||!n||t.id!==n.id),r.onkeydown(o,i,e)},r.globalClickCallback=function(e){r.hasFocus=!!e.target.closest("."+r.options.classPrefix+"container")},r.globalBind("keydown",r.globalKeydownCallback),r.globalBind("click",r.globalClickCallback)}},{key:"onkeydown",value:function(e,t,n){if(e.hasFocus&&e.options.enableKeyboard)for(var o=0,i=e.options.keyActions.length;o<i;o++)for(var r=e.options.keyActions[o],a=0,s=r.keys.length;a<s;a++)if(n.keyCode===r.keys[a])return r.action(e,t,n.keyCode,n),n.preventDefault(),void n.stopPropagation();return!0}},{key:"play",value:function(){return this.proxy.play()}},{key:"pause",value:function(){return this.proxy.pause()}},{key:"load",value:function(){return this.proxy.load()}},{key:"setCurrentTime",value:function(e){this.proxy.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){return this.proxy.currentTime}},{key:"getDuration",value:function(){return this.proxy.duration}},{key:"setVolume",value:function(e){this.proxy.volume=e}},{key:"getVolume",value:function(){return this.proxy.getVolume()}},{key:"setMuted",value:function(e){this.proxy.setMuted(e)}},{key:"setSrc",value:function(e){this.controlsEnabled||this.enableControls(),this.proxy.setSrc(e)}},{key:"getSrc",value:function(){return this.proxy.getSrc()}},{key:"canPlayType",value:function(e){return this.proxy.canPlayType(e)}},{key:"remove",value:function(){var l=this,d=l.media.rendererName,u=l.media.originalNode.src;for(var e in l.options.features){var t=l.options.features[e];if(l["clean"+t])try{l["clean"+t](l,l.getElement(l.layers),l.getElement(l.controls),l.media)}catch(e){console.error("error cleaning "+t,e)}}var n=l.node.getAttribute("width"),o=l.node.getAttribute("height");if(n?-1===n.indexOf("%")&&(n+="px"):n="auto",o?-1===o.indexOf("%")&&(o+="px"):o="auto",l.node.style.width=n,l.node.style.height=o,l.setPlayerSize(0,0),l.isDynamic?l.getElement(l.container).parentNode.insertBefore(l.node,l.getElement(l.container)):function(){l.node.setAttribute("controls",!0),l.node.setAttribute("id",l.node.getAttribute("id").replace("_"+d,"").replace("_from_mejs",""));var e=l.getElement(l.container).querySelector("."+l.options.classPrefix+"poster>img");(e&&l.node.setAttribute("poster",e.src),delete l.node.autoplay,l.node.setAttribute("src",""),""!==l.media.canPlayType((0,p.getTypeFromFile)(u))&&l.node.setAttribute("src",u),d&&-1<d.indexOf("iframe"))&&w.default.getElementById(l.media.id+"-iframe-overlay").remove();var i=l.node.cloneNode();if(i.style.display="",l.getElement(l.container).parentNode.insertBefore(i,l.getElement(l.container)),l.node.remove(),l.mediaFiles)for(var t=0,n=l.mediaFiles.length;t<n;t++){var o=w.default.createElement("source");o.setAttribute("src",l.mediaFiles[t].src),o.setAttribute("type",l.mediaFiles[t].type),i.appendChild(o)}if(l.trackFiles)for(var r=function(e,t){var n=l.trackFiles[e],o=w.default.createElement("track");o.kind=n.kind,o.label=n.label,o.srclang=n.srclang,o.src=n.src,i.appendChild(o),o.addEventListener("load",function(){this.mode="showing",i.textTracks[e].mode="showing"})},a=0,s=l.trackFiles.length;a<s;a++)r(a);delete l.node,delete l.mediaFiles,delete l.trackFiles}(),l.media.renderer&&"function"==typeof l.media.renderer.destroy&&l.media.renderer.destroy(),delete f.default.players[l.id],"object"===a(l.getElement(l.container))){var i=l.getElement(l.container).parentNode.querySelector("."+l.options.classPrefix+"offscreen");i&&i.remove(),l.getElement(l.container).remove()}l.globalUnbind("resize",l.globalResizeCallback),l.globalUnbind("keydown",l.globalKeydownCallback),l.globalUnbind("click",l.globalClickCallback),delete l.media.player}},{key:"paused",get:function(){return this.proxy.paused}},{key:"muted",get:function(){return this.proxy.muted},set:function(e){this.setMuted(e)}},{key:"ended",get:function(){return this.proxy.ended}},{key:"readyState",get:function(){return this.proxy.readyState}},{key:"currentTime",set:function(e){this.setCurrentTime(e)},get:function(){return this.getCurrentTime()}},{key:"duration",get:function(){return this.getDuration()}},{key:"volume",set:function(e){this.setVolume(e)},get:function(){return this.getVolume()}},{key:"src",set:function(e){this.setSrc(e)},get:function(){return this.getSrc()}}]),r}();S.default.MediaElementPlayer=l,f.default.MediaElementPlayer=l,n.default=l},{18:18,2:2,26:26,27:27,28:28,29:29,3:3,30:30,32:32,6:6,7:7,8:8}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),r=e(3),a=(o=r)&&o.__esModule?o:{default:o};var s=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.media=t.media,this.isVideo=t.isVideo,this.classPrefix=t.options.classPrefix,this.createIframeLayer=function(){return t.createIframeLayer()},this.setPoster=function(e){return t.setPoster(e)},this}return i(e,[{key:"play",value:function(){return this.media.play()}},{key:"pause",value:function(){return this.media.pause()}},{key:"load",value:function(){this.isLoaded||this.media.load(),this.isLoaded=!0}},{key:"setCurrentTime",value:function(e){this.media.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){return this.media.currentTime}},{key:"getDuration",value:function(){var e=this.media.getDuration();return e===1/0&&this.media.seekable&&this.media.seekable.length&&(e=this.media.seekable.end(0)),e}},{key:"setVolume",value:function(e){this.media.setVolume(e)}},{key:"getVolume",value:function(){return this.media.getVolume()}},{key:"setMuted",value:function(e){this.media.setMuted(e)}},{key:"setSrc",value:function(e){var t=this,n=document.getElementById(t.media.id+"-iframe-overlay");n&&n.remove(),t.media.setSrc(e),t.createIframeLayer(),null!==t.media.renderer&&"function"==typeof t.media.renderer.getPosterUrl&&t.setPoster(t.media.renderer.getPosterUrl())}},{key:"getSrc",value:function(){return this.media.getSrc()}},{key:"canPlayType",value:function(e){return this.media.canPlayType(e)}},{key:"paused",get:function(){return this.media.paused}},{key:"muted",set:function(e){this.setMuted(e)},get:function(){return this.media.muted}},{key:"ended",get:function(){return this.media.ended}},{key:"readyState",get:function(){return this.media.readyState}},{key:"currentTime",set:function(e){this.setCurrentTime(e)},get:function(){return this.getCurrentTime()}},{key:"duration",get:function(){return this.getDuration()}},{key:"remainingTime",get:function(){return this.getDuration()-this.currentTime()}},{key:"volume",set:function(e){this.setVolume(e)},get:function(){return this.getVolume()}},{key:"src",set:function(e){this.setSrc(e)},get:function(){return this.getSrc()}}]),e}();n.default=s,a.default.DefaultPlayer=s},{3:3}],19:[function(e,t,n){"use strict";a(e(3));var o,i=a(e(8)),r=a(e(17));function a(e){return e&&e.__esModule?e:{default:e}}"undefined"!=typeof jQuery?i.default.$=jQuery:"undefined"!=typeof Zepto?i.default.$=Zepto:"undefined"!=typeof ender&&(i.default.$=ender),void 0!==(o=i.default.$)&&(o.fn.mediaelementplayer=function(e){return!1===e?this.each(function(){var e=o(this).data("mediaelementplayer");e&&e.remove(),o(this).removeData("mediaelementplayer")}):this.each(function(){o(this).data("mediaelementplayer",new r.default(this,e))}),this},o(document).ready(function(){o("."+i.default.MepDefaults.classPrefix+"player").mediaelementplayer()}))},{17:17,3:3,8:8}],20:[function(e,t,n){"use strict";var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S=a(e(3)),w=a(e(8)),x=e(9),P=e(28),o=e(30),i=e(26),r=e(27);function a(e){return e&&e.__esModule?e:{default:e}}var T={promise:null,load:function(e){return"undefined"!=typeof dashjs?T.promise=new Promise(function(e){e()}).then(function(){T._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.dashjs.org/latest/dash.all.min.js",T.promise=T.promise||(0,r.loadScript)(e.options.path),T.promise.then(function(){T._createPlayer(e)})),T.promise},_createPlayer:function(e){var t=dashjs.MediaPlayer().create();return S.default["__ready__"+e.id](t),t}},s={name:"native_dash",options:{prefix:"native_dash",dash:{path:"https://cdn.dashjs.org/latest/dash.all.min.js",debug:!1,drm:{},robustnessLevel:""}},canPlayType:function(e){return i.HAS_MSE&&-1<["application/dash+xml"].indexOf(e.toLowerCase())},create:function(s,l,e){var t=s.originalNode,r=s.id+"_"+l.prefix,a=t.autoplay,n=t.children,d=null,u=null;t.removeAttribute("type");for(var o=0,i=n.length;o<i;o++)n[o].removeAttribute("type");d=t.cloneNode(!0),l=Object.assign(l,s.options);for(var c=w.default.html5media.properties,f=w.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),p=function(e){var t=(0,P.createEvent)(e.type,s);s.dispatchEvent(t)},m=function(i){var e=""+i.substring(0,1).toUpperCase()+i.substring(1);d["get"+e]=function(){return null!==u?d[i]:null},d["set"+e]=function(e){if(-1===w.default.html5media.readOnlyProperties.indexOf(i))if("src"===i){var t="object"===(void 0===e?"undefined":b(e))&&e.src?e.src:e;if(d[i]=t,null!==u){u.reset();for(var n=0,o=f.length;n<o;n++)d.removeEventListener(f[n],p);u=T._createPlayer({options:l.dash,id:r}),e&&"object"===(void 0===e?"undefined":b(e))&&"object"===b(e.drm)&&(u.setProtectionData(e.drm),(0,P.isString)(l.dash.robustnessLevel)&&l.dash.robustnessLevel&&u.getProtectionController().setRobustnessLevel(l.dash.robustnessLevel)),u.attachSource(t),a&&u.play()}}else d[i]=e}},h=0,v=c.length;h<v;h++)m(c[h]);if(S.default["__ready__"+r]=function(e){s.dashPlayer=u=e;for(var t,n=dashjs.MediaPlayer.events,o=0,i=f.length;o<i;o++)"loadedmetadata"===(t=f[o])&&(u.initialize(),u.attachView(d),u.setAutoPlay(!1),"object"!==b(l.dash.drm)||w.default.Utils.isObjectEmpty(l.dash.drm)||(u.setProtectionData(l.dash.drm),(0,P.isString)(l.dash.robustnessLevel)&&l.dash.robustnessLevel&&u.getProtectionController().setRobustnessLevel(l.dash.robustnessLevel)),u.attachSource(d.getSrc())),d.addEventListener(t,p);var r=function(e){if("error"===e.type.toLowerCase())s.generateError(e.message,d.src),console.error(e);else{var t=(0,P.createEvent)(e.type,s);t.data=e,s.dispatchEvent(t)}};for(var a in n)n.hasOwnProperty(a)&&u.on(n[a],function(e){return r(e)})},e&&0<e.length)for(var g=0,y=e.length;g<y;g++)if(x.renderer.renderers[l.prefix].canPlayType(e[g].type)){d.setAttribute("src",e[g].src),void 0!==e[g].drm&&(l.dash.drm=e[g].drm);break}d.setAttribute("id",r),t.parentNode.insertBefore(d,t),t.autoplay=!1,t.style.display="none",d.setSize=function(e,t){return d.style.width=e+"px",d.style.height=t+"px",d},d.hide=function(){return d.pause(),d.style.display="none",d},d.show=function(){return d.style.display="",d},d.destroy=function(){null!==u&&u.reset()};var E=(0,P.createEvent)("rendererready",d);return s.dispatchEvent(E),s.promises.push(T.load({options:l.dash,id:r})),d}};o.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".mpd")?"application/dash+xml":null}),x.renderer.add(s)},{26:26,27:27,28:28,3:3,30:30,8:8,9:9}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PluginDetector=void 0;var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C=o(e(3)),k=o(e(2)),_=o(e(8)),N=o(e(6)),A=e(9),L=e(28),F=e(26),j=e(30);function o(e){return e&&e.__esModule?e:{default:e}}var r=n.PluginDetector={plugins:[],hasPluginVersion:function(e,t){var n=r.plugins[e];return t[1]=t[1]||0,t[2]=t[2]||0,n[0]>t[0]||n[0]===t[0]&&n[1]>t[1]||n[0]===t[0]&&n[1]===t[1]&&n[2]>=t[2]},addPlugin:function(e,t,n,o,i){r.plugins[e]=r.detectPlugin(t,n,o,i)},detectPlugin:function(e,t,n,o){var i=[0,0,0],r=void 0,a=void 0;if(null!==F.NAV.plugins&&void 0!==F.NAV.plugins&&"object"===d(F.NAV.plugins[e])){if((r=F.NAV.plugins[e].description)&&(void 0===F.NAV.mimeTypes||!F.NAV.mimeTypes[t]||F.NAV.mimeTypes[t].enabledPlugin))for(var s=0,l=(i=r.replace(e,"").replace(/^\\s+/,"").replace(/\\sr/gi,".").split(".")).length;s<l;s++)i[s]=parseInt(i[s].match(/\\d+/),10)}else if(void 0!==C.default.ActiveXObject)try{(a=new ActiveXObject(n))&&(i=o(a))}catch(e){}return i}};r.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(e){var t=[],n=e.GetVariable("$version");return n&&(n=n.split(" ")[1].split(","),t=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]),t});var i={create:function(e,t,n){var r={},o=!1;r.options=t,r.id=e.id+"_"+r.options.prefix,r.mediaElement=e,r.flashState={},r.flashApi=null,r.flashApiStack=[];for(var i=_.default.html5media.properties,a=function(t){r.flashState[t]=null;var e=""+t.substring(0,1).toUpperCase()+t.substring(1);r["get"+e]=function(){if(null!==r.flashApi){if("function"==typeof r.flashApi["get_"+t]){var e=r.flashApi["get_"+t]();return"buffered"===t?{start:function(){return 0},end:function(){return e},length:1}:e}return null}return null},r["set"+e]=function(e){if("src"===t&&(e=(0,j.absolutizeUrl)(e)),null!==r.flashApi&&void 0!==r.flashApi["set_"+t])try{r.flashApi["set_"+t](e)}catch(e){}else r.flashApiStack.push({type:"set",propName:t,value:e})}},s=0,l=i.length;s<l;s++)a(i[s]);var d=_.default.html5media.methods,u=function(e){r[e]=function(){if(o)if(null!==r.flashApi){if(r.flashApi["fire_"+e])try{r.flashApi["fire_"+e]()}catch(e){}}else r.flashApiStack.push({type:"call",methodName:e})}};d.push("stop");for(var c=0,f=d.length;c<f;c++)u(d[c]);for(var p=["rendererready"],m=0,h=p.length;m<h;m++){var v=(0,L.createEvent)(p[m],r);e.dispatchEvent(v)}C.default["__ready__"+r.id]=function(){if(r.flashReady=!0,r.flashApi=k.default.getElementById("__"+r.id),r.flashApiStack.length)for(var e=0,t=r.flashApiStack.length;e<t;e++){var n=r.flashApiStack[e];if("set"===n.type){var o=n.propName,i=""+o.substring(0,1).toUpperCase()+o.substring(1);r["set"+i](n.value)}else"call"===n.type&&r[n.methodName]()}},C.default["__event__"+r.id]=function(e,t){var n=(0,L.createEvent)(e,r);if(t)try{n.data=JSON.parse(t),n.details.data=JSON.parse(t)}catch(e){n.message=t}r.mediaElement.dispatchEvent(n)},r.flashWrapper=k.default.createElement("div"),-1===["always","sameDomain"].indexOf(r.options.shimScriptAccess)&&(r.options.shimScriptAccess="sameDomain");var g=e.originalNode.autoplay,y=["uid="+r.id,"autoplay="+g,"allowScriptAccess="+r.options.shimScriptAccess,"preload="+(e.originalNode.getAttribute("preload")||"")],E=null!==e.originalNode&&"video"===e.originalNode.tagName.toLowerCase(),b=E?e.originalNode.height:1,S=E?e.originalNode.width:1;e.originalNode.getAttribute("src")&&y.push("src="+e.originalNode.getAttribute("src")),!0===r.options.enablePseudoStreaming&&(y.push("pseudostreamstart="+r.options.pseudoStreamingStartQueryParam),y.push("pseudostreamtype="+r.options.pseudoStreamingType)),r.options.streamDelimiter&&y.push("streamdelimiter="+encodeURIComponent(r.options.streamDelimiter)),r.options.proxyType&&y.push("proxytype="+r.options.proxyType),e.appendChild(r.flashWrapper),e.originalNode.style.display="none";var w=[];if(F.IS_IE||F.IS_EDGE){var x=k.default.createElement("div");r.flashWrapper.appendChild(x),w=F.IS_EDGE?[\'type="application/x-shockwave-flash"\',\'data="\'+r.options.pluginPath+r.options.filename+\'"\',\'id="__\'+r.id+\'"\',\'width="\'+S+\'"\',\'height="\'+b+"\'\\""]:[\'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"\',\'codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"\',\'id="__\'+r.id+\'"\',\'width="\'+S+\'"\',\'height="\'+b+\'"\'],E||w.push(\'style="clip: rect(0 0 0 0); position: absolute;"\'),x.outerHTML="<object "+w.join(" ")+\'><param name="movie" value="\'+r.options.pluginPath+r.options.filename+"?x="+new Date+\'" /><param name="flashvars" value="\'+y.join("&amp;")+\'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="\'+r.options.shimScriptAccess+\'" /><param name="allowFullScreen" value="true" /><div>\'+N.default.t("mejs.install-flash")+"</div></object>"}else w=[\'id="__\'+r.id+\'"\',\'name="__\'+r.id+\'"\',\'play="true"\',\'loop="false"\',\'quality="high"\',\'bgcolor="#000000"\',\'wmode="transparent"\',\'allowScriptAccess="\'+r.options.shimScriptAccess+\'"\',\'allowFullScreen="true"\',\'type="application/x-shockwave-flash"\',\'pluginspage="//www.macromedia.com/go/getflashplayer"\',\'src="\'+r.options.pluginPath+r.options.filename+\'"\',\'flashvars="\'+y.join("&")+\'"\'],E?(w.push(\'width="\'+S+\'"\'),w.push(\'height="\'+b+\'"\')):w.push(\'style="position: fixed; left: -9999em; top: -9999em;"\'),r.flashWrapper.innerHTML="<embed "+w.join(" ")+">";if(r.flashNode=r.flashWrapper.lastChild,r.hide=function(){o=!1,E&&(r.flashNode.style.display="none")},r.show=function(){o=!0,E&&(r.flashNode.style.display="")},r.setSize=function(e,t){r.flashNode.style.width=e+"px",r.flashNode.style.height=t+"px",null!==r.flashApi&&"function"==typeof r.flashApi.fire_setSize&&r.flashApi.fire_setSize(e,t)},r.destroy=function(){r.flashNode.remove()},n&&0<n.length)for(var P=0,T=n.length;P<T;P++)if(A.renderer.renderers[t.prefix].canPlayType(n[P].type)){r.setSrc(n[P].src);break}return r}};if(r.hasPluginVersion("flash",[10,0,0])){j.typeChecks.push(function(e){return(e=e.toLowerCase()).startsWith("rtmp")?~e.indexOf(".mp3")?"audio/rtmp":"video/rtmp":/\\.og(a|g)/i.test(e)?"audio/ogg":~e.indexOf(".m3u8")?"application/x-mpegURL":~e.indexOf(".mpd")?"application/dash+xml":~e.indexOf(".flv")?"video/flv":null});var a={name:"flash_video",options:{prefix:"flash_video",filename:"mediaelement-flash-video.swf",enablePseudoStreaming:!1,pseudoStreamingStartQueryParam:"start",pseudoStreamingType:"byte",proxyType:"",streamDelimiter:""},canPlayType:function(e){return~["video/mp4","video/rtmp","audio/rtmp","rtmp/mp4","audio/mp4","video/flv","video/x-flv"].indexOf(e.toLowerCase())},create:i.create};A.renderer.add(a);var s={name:"flash_hls",options:{prefix:"flash_hls",filename:"mediaelement-flash-video-hls.swf"},canPlayType:function(e){return~["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())},create:i.create};A.renderer.add(s);var l={name:"flash_dash",options:{prefix:"flash_dash",filename:"mediaelement-flash-video-mdash.swf"},canPlayType:function(e){return~["application/dash+xml"].indexOf(e.toLowerCase())},create:i.create};A.renderer.add(l);var u={name:"flash_audio",options:{prefix:"flash_audio",filename:"mediaelement-flash-audio.swf"},canPlayType:function(e){return~["audio/mp3"].indexOf(e.toLowerCase())},create:i.create};A.renderer.add(u);var c={name:"flash_audio_ogg",options:{prefix:"flash_audio_ogg",filename:"mediaelement-flash-audio-ogg.swf"},canPlayType:function(e){return~["audio/ogg","audio/oga","audio/ogv"].indexOf(e.toLowerCase())},create:i.create};A.renderer.add(c)}},{2:2,26:26,28:28,3:3,30:30,6:6,8:8,9:9}],22:[function(e,t,n){"use strict";var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=a(e(3)),b=a(e(8)),S=e(9),w=e(28),o=e(26),i=e(30),r=e(27);function a(e){return e&&e.__esModule?e:{default:e}}var x={promise:null,load:function(e){return"undefined"!=typeof flvjs?x.promise=new Promise(function(e){e()}).then(function(){x._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.jsdelivr.net/npm/flv.js@latest",x.promise=x.promise||(0,r.loadScript)(e.options.path),x.promise.then(function(){x._createPlayer(e)})),x.promise},_createPlayer:function(e){flvjs.LoggingControl.enableDebug=e.options.debug,flvjs.LoggingControl.enableVerbose=e.options.debug;var t=flvjs.createPlayer(e.options,e.configs);return E.default["__ready__"+e.id](t),t}},s={name:"native_flv",options:{prefix:"native_flv",flv:{path:"https://cdn.jsdelivr.net/npm/flv.js@latest",cors:!0,debug:!1}},canPlayType:function(e){return o.HAS_MSE&&-1<["video/x-flv","video/flv"].indexOf(e.toLowerCase())},create:function(s,a,e){var t=s.originalNode,l=s.id+"_"+a.prefix,d=null,u=null;d=t.cloneNode(!0),a=Object.assign(a,s.options);for(var n=b.default.html5media.properties,c=b.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),f=function(e){var t=(0,w.createEvent)(e.type,s);s.dispatchEvent(t)},o=function(r){var e=""+r.substring(0,1).toUpperCase()+r.substring(1);d["get"+e]=function(){return null!==u?d[r]:null},d["set"+e]=function(e){if(-1===b.default.html5media.readOnlyProperties.indexOf(r))if("src"===r){if(d[r]="object"===(void 0===e?"undefined":y(e))&&e.src?e.src:e,null!==u){var t={type:"flv"};t.url=e,t.cors=a.flv.cors,t.debug=a.flv.debug,t.path=a.flv.path;var n=a.flv.configs;u.destroy();for(var o=0,i=c.length;o<i;o++)d.removeEventListener(c[o],f);(u=x._createPlayer({options:t,configs:n,id:l})).attachMediaElement(d),u.load()}}else d[r]=e}},i=0,r=n.length;i<r;i++)o(n[i]);if(E.default["__ready__"+l]=function(e){s.flvPlayer=u=e;for(var t,i=flvjs.Events,n=0,o=c.length;n<o;n++)"loadedmetadata"===(t=c[n])&&(u.unload(),u.detachMediaElement(),u.attachMediaElement(d),u.load()),d.addEventListener(t,f);var r=function(o){i.hasOwnProperty(o)&&u.on(i[o],function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){if("error"===e){var n=t[0]+": "+t[1]+" "+t[2].msg;s.generateError(n,d.src)}else{var o=(0,w.createEvent)(e,s);o.data=t,s.dispatchEvent(o)}}(i[o],t)})};for(var a in i)r(a)},e&&0<e.length)for(var p=0,m=e.length;p<m;p++)if(S.renderer.renderers[a.prefix].canPlayType(e[p].type)){d.setAttribute("src",e[p].src);break}d.setAttribute("id",l),t.parentNode.insertBefore(d,t),t.autoplay=!1,t.style.display="none";var h={type:"flv"};h.url=d.src,h.cors=a.flv.cors,h.debug=a.flv.debug,h.path=a.flv.path;var v=a.flv.configs;d.setSize=function(e,t){return d.style.width=e+"px",d.style.height=t+"px",d},d.hide=function(){return null!==u&&u.pause(),d.style.display="none",d},d.show=function(){return d.style.display="",d},d.destroy=function(){null!==u&&u.destroy()};var g=(0,w.createEvent)("rendererready",d);return s.dispatchEvent(g),s.promises.push(x.load({options:h,configs:v,id:l})),d}};i.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".flv")?"video/flv":null}),S.renderer.add(s)},{26:26,27:27,28:28,3:3,30:30,8:8,9:9}],23:[function(e,t,n){"use strict";var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=a(e(3)),b=a(e(8)),S=e(9),w=e(28),o=e(26),i=e(30),r=e(27);function a(e){return e&&e.__esModule?e:{default:e}}var x={promise:null,load:function(e){return"undefined"!=typeof Hls?x.promise=new Promise(function(e){e()}).then(function(){x._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.jsdelivr.net/npm/hls.js@latest",x.promise=x.promise||(0,r.loadScript)(e.options.path),x.promise.then(function(){x._createPlayer(e)})),x.promise},_createPlayer:function(e){var t=new Hls(e.options);return E.default["__ready__"+e.id](t),t}},s={name:"native_hls",options:{prefix:"native_hls",hls:{path:"https://cdn.jsdelivr.net/npm/hls.js@latest",autoStartLoad:!1,debug:!1}},canPlayType:function(e){return o.HAS_MSE&&-1<["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())},create:function(d,i,u){var e=d.originalNode,r=d.id+"_"+i.prefix,t=e.getAttribute("preload"),n=e.autoplay,c=null,f=null,p=0,m=u.length;f=e.cloneNode(!0),(i=Object.assign(i,d.options)).hls.autoStartLoad=t&&"none"!==t||n;for(var o=b.default.html5media.properties,h=b.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),v=function(e){var t=(0,w.createEvent)(e.type,d);d.dispatchEvent(t)},a=function(o){var e=""+o.substring(0,1).toUpperCase()+o.substring(1);f["get"+e]=function(){return null!==c?f[o]:null},f["set"+e]=function(e){if(-1===b.default.html5media.readOnlyProperties.indexOf(o))if("src"===o){if(f[o]="object"===(void 0===e?"undefined":y(e))&&e.src?e.src:e,null!==c){c.destroy();for(var t=0,n=h.length;t<n;t++)f.removeEventListener(h[t],v);(c=x._createPlayer({options:i.hls,id:r})).loadSource(e),c.attachMedia(f)}}else f[o]=e}},s=0,l=o.length;s<l;s++)a(o[s]);if(E.default["__ready__"+r]=function(e){d.hlsPlayer=c=e;for(var i=Hls.Events,t=function(e){if("loadedmetadata"===e){var t=d.originalNode.src;c.detachMedia(),c.loadSource(t),c.attachMedia(f)}f.addEventListener(e,v)},n=0,o=h.length;n<o;n++)t(h[n]);var s=void 0,l=void 0,r=function(o){i.hasOwnProperty(o)&&c.on(i[o],function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t){if("hlsError"===e&&(console.warn(t),(t=t[1]).fatal))switch(t.type){case"mediaError":var n=(new Date).getTime();if(!s||3e3<n-s)s=(new Date).getTime(),c.recoverMediaError();else if(!l||3e3<n-l)l=(new Date).getTime(),console.warn("Attempting to swap Audio Codec and recover from media error"),c.swapAudioCodec(),c.recoverMediaError();else{var o="Cannot recover, last media error recovery failed";d.generateError(o,f.src),console.error(o)}break;case"networkError":if("manifestLoadError"===t.details)if(p<m&&void 0!==u[p+1])f.setSrc(u[p++].src),f.load(),f.play();else{var i="Network error";d.generateError(i,u),console.error(i)}else{var r="Network error";d.generateError(r,u),console.error(r)}break;default:c.destroy()}else{var a=(0,w.createEvent)(e,d);a.data=t,d.dispatchEvent(a)}}(i[o],t)})};for(var a in i)r(a)},0<m)for(;p<m;p++)if(S.renderer.renderers[i.prefix].canPlayType(u[p].type)){f.setAttribute("src",u[p].src);break}"auto"===t||n||(f.addEventListener("play",function(){null!==c&&c.startLoad()}),f.addEventListener("pause",function(){null!==c&&c.stopLoad()})),f.setAttribute("id",r),e.parentNode.insertBefore(f,e),e.autoplay=!1,e.style.display="none",f.setSize=function(e,t){return f.style.width=e+"px",f.style.height=t+"px",f},f.hide=function(){return f.pause(),f.style.display="none",f},f.show=function(){return f.style.display="",f},f.destroy=function(){null!==c&&(c.stopLoad(),c.destroy())};var g=(0,w.createEvent)("rendererready",f);return d.dispatchEvent(g),d.promises.push(x.load({options:i.hls,id:r})),f}};i.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".m3u8")?"application/x-mpegURL":null}),S.renderer.add(s)},{26:26,27:27,28:28,3:3,30:30,8:8,9:9}],24:[function(e,t,n){"use strict";var o=r(e(3)),g=r(e(2)),y=r(e(8)),E=e(9),b=e(28),i=e(26);function r(e){return e&&e.__esModule?e:{default:e}}var a={name:"html5",options:{prefix:"html5"},canPlayType:function(e){var t=g.default.createElement("video");return i.IS_ANDROID&&/\\/mp(3|4)$/i.test(e)||~["application/x-mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())&&i.SUPPORTS_NATIVE_HLS?"yes":t.canPlayType?t.canPlayType(e.toLowerCase()).replace(/no/,""):""},create:function(n,e,t){var o=n.id+"_"+e.prefix,i=!1,r=null;void 0===n.originalNode||null===n.originalNode?(r=g.default.createElement("audio"),n.appendChild(r)):r=n.originalNode,r.setAttribute("id",o);for(var a=y.default.html5media.properties,s=function(t){var e=""+t.substring(0,1).toUpperCase()+t.substring(1);r["get"+e]=function(){return r[t]},r["set"+e]=function(e){-1===y.default.html5media.readOnlyProperties.indexOf(t)&&(r[t]=e)}},l=0,d=a.length;l<d;l++)s(a[l]);for(var u,c=y.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),f=0,p=c.length;f<p;f++)u=c[f],r.addEventListener(u,function(e){if(i){var t=(0,b.createEvent)(e.type,e.target);n.dispatchEvent(t)}});r.setSize=function(e,t){return r.style.width=e+"px",r.style.height=t+"px",r},r.hide=function(){return i=!1,r.style.display="none",r},r.show=function(){return i=!0,r.style.display="",r};var m=0,h=t.length;if(0<h)for(;m<h;m++)if(E.renderer.renderers[e.prefix].canPlayType(t[m].type)){r.setAttribute("src",t[m].src);break}r.addEventListener("error",function(e){e&&e.target&&e.target.error&&4===e.target.error.code&&i&&(m<h&&void 0!==t[m+1]?(r.src=t[m++].src,r.load(),r.play()):n.generateError("Media error: Format(s) not supported or source(s) not found",t))});var v=(0,b.createEvent)("rendererready",r);return n.dispatchEvent(v),r}};o.default.HtmlMediaElement=y.default.HtmlMediaElement=a,E.renderer.add(a)},{2:2,26:26,28:28,3:3,8:8,9:9}],25:[function(e,t,n){"use strict";var x=a(e(3)),P=a(e(2)),T=a(e(8)),o=e(9),C=e(28),i=e(30),r=e(27);function a(e){return e&&e.__esModule?e:{default:e}}var k={isIframeStarted:!1,isIframeLoaded:!1,iframeQueue:[],enqueueIframe:function(e){k.isLoaded="undefined"!=typeof YT&&YT.loaded,k.isLoaded?k.createIframe(e):(k.loadIframeApi(),k.iframeQueue.push(e))},loadIframeApi:function(){k.isIframeStarted||((0,r.loadScript)("https://www.youtube.com/player_api"),k.isIframeStarted=!0)},iFrameReady:function(){for(k.isLoaded=!0,k.isIframeLoaded=!0;0<k.iframeQueue.length;){var e=k.iframeQueue.pop();k.createIframe(e)}},createIframe:function(e){return new YT.Player(e.containerId,e)},getYouTubeId:function(e){var t="";return 0<e.indexOf("?")?""===(t=k.getYouTubeIdFromParam(e))&&(t=k.getYouTubeIdFromUrl(e)):t=k.getYouTubeIdFromUrl(e),(t=t.substring(t.lastIndexOf("/")+1).split("?"))[0]},getYouTubeIdFromParam:function(e){if(null==e||!e.trim().length)return null;for(var t=e.split("?")[1].split("&"),n="",o=0,i=t.length;o<i;o++){var r=t[o].split("=");if("v"===r[0]){n=r[1];break}}return n},getYouTubeIdFromUrl:function(e){return null!=e&&e.trim().length?(e=e.split("?")[0]).substring(e.lastIndexOf("/")+1):null},getYouTubeNoCookieUrl:function(e){if(null==e||!e.trim().length||-1===e.indexOf("//www.youtube"))return e;var t=e.split("/");return t[2]=t[2].replace(".com","-nocookie.com"),t.join("/")}},s={name:"youtube_iframe",options:{prefix:"youtube_iframe",youtube:{autoplay:0,controls:0,disablekb:1,end:0,loop:0,modestbranding:0,playsinline:0,rel:0,showinfo:0,start:0,iv_load_policy:3,nocookie:!1,imageQuality:null}},canPlayType:function(e){return~["video/youtube","video/x-youtube"].indexOf(e.toLowerCase())},create:function(m,n,o){var h={},v=[],g=null,r=!0,a=!1,y=null;h.options=n,h.id=m.id+"_"+n.prefix,h.mediaElement=m;for(var e=T.default.html5media.properties,t=function(i){var e=""+i.substring(0,1).toUpperCase()+i.substring(1);h["get"+e]=function(){if(null!==g){switch(i){case"currentTime":return g.getCurrentTime();case"duration":return g.getDuration();case"volume":return g.getVolume()/100;case"playbackRate":return g.getPlaybackRate();case"paused":return r;case"ended":return a;case"muted":return g.isMuted();case"buffered":var e=g.getVideoLoadedFraction(),t=g.getDuration();return{start:function(){return 0},end:function(){return e*t},length:1};case"src":return g.getVideoUrl();case"readyState":return 4}return null}return null},h["set"+e]=function(e){if(null!==g)switch(i){case"src":var t="string"==typeof e?e:e[0].src,n=k.getYouTubeId(t);m.originalNode.autoplay?g.loadVideoById(n):g.cueVideoById(n);break;case"currentTime":g.seekTo(e);break;case"muted":e?g.mute():g.unMute(),setTimeout(function(){var e=(0,C.createEvent)("volumechange",h);m.dispatchEvent(e)},50);break;case"volume":e,g.setVolume(100*e),setTimeout(function(){var e=(0,C.createEvent)("volumechange",h);m.dispatchEvent(e)},50);break;case"playbackRate":g.setPlaybackRate(e),setTimeout(function(){var e=(0,C.createEvent)("ratechange",h);m.dispatchEvent(e)},50);break;case"readyState":var o=(0,C.createEvent)("canplay",h);m.dispatchEvent(o)}else v.push({type:"set",propName:i,value:e})}},i=0,s=e.length;i<s;i++)t(e[i]);for(var l=T.default.html5media.methods,d=function(e){h[e]=function(){if(null!==g)switch(e){case"play":return r=!1,g.playVideo();case"pause":return r=!0,g.pauseVideo();case"load":return null}else v.push({type:"call",methodName:e})}},u=0,c=l.length;u<c;u++)d(l[u]);var f=P.default.createElement("div");f.id=h.id,h.options.youtube.nocookie&&(m.originalNode.src=k.getYouTubeNoCookieUrl(o[0].src)),m.originalNode.parentNode.insertBefore(f,m.originalNode),m.originalNode.style.display="none";var p="audio"===m.originalNode.tagName.toLowerCase(),E=p?"1":m.originalNode.height,b=p?"1":m.originalNode.width,S=k.getYouTubeId(o[0].src),w={id:h.id,containerId:f.id,videoId:S,height:E,width:b,host:h.options.youtube&&h.options.youtube.nocookie?"https://www.youtube-nocookie.com":void 0,playerVars:Object.assign({controls:0,rel:0,disablekb:1,showinfo:0,modestbranding:0,html5:1,iv_load_policy:3},h.options.youtube),origin:x.default.location.host,events:{onReady:function(e){if(m.youTubeApi=g=e.target,m.youTubeState={paused:!0,ended:!1},v.length)for(var t=0,n=v.length;t<n;t++){var o=v[t];if("set"===o.type){var i=o.propName,r=""+i.substring(0,1).toUpperCase()+i.substring(1);h["set"+r](o.value)}else"call"===o.type&&h[o.methodName]()}y=g.getIframe(),m.originalNode.muted&&g.mute();for(var a=["mouseover","mouseout"],s=function(e){var t=(0,C.createEvent)(e.type,h);m.dispatchEvent(t)},l=0,d=a.length;l<d;l++)y.addEventListener(a[l],s,!1);for(var u=["rendererready","loadedmetadata","loadeddata","canplay"],c=0,f=u.length;c<f;c++){var p=(0,C.createEvent)(u[c],h);m.dispatchEvent(p)}},onStateChange:function(e){var t=[];switch(e.data){case-1:t=["loadedmetadata"],r=!0,a=!1;break;case 0:t=["ended"],r=!1,a=!h.options.youtube.loop,h.options.youtube.loop||h.stopInterval();break;case 1:t=["play","playing"],a=r=!1,h.startInterval();break;case 2:t=["pause"],r=!0,a=!1,h.stopInterval();break;case 3:t=["progress"],a=!1;break;case 5:t=["loadeddata","loadedmetadata","canplay"],r=!0,a=!1}for(var n=0,o=t.length;n<o;n++){var i=(0,C.createEvent)(t[n],h);m.dispatchEvent(i)}},onError:function(e){return function(e){var t="";switch(e.data){case 2:t="The request contains an invalid parameter value. Verify that video ID has 11 characters and that contains no invalid characters, such as exclamation points or asterisks.";break;case 5:t="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";break;case 100:t="The video requested was not found. Either video has been removed or has been marked as private.";break;case 101:case 105:t="The owner of the requested video does not allow it to be played in embedded players.";break;default:t="Unknown error."}m.generateError("Code "+e.data+": "+t,o)}(e)}}};return(p||m.originalNode.hasAttribute("playsinline"))&&(w.playerVars.playsinline=1),m.originalNode.controls&&(w.playerVars.controls=1),m.originalNode.autoplay&&(w.playerVars.autoplay=1),m.originalNode.loop&&(w.playerVars.loop=1),(w.playerVars.loop&&1===parseInt(w.playerVars.loop,10)||-1<m.originalNode.src.indexOf("loop="))&&!w.playerVars.playlist&&-1===m.originalNode.src.indexOf("playlist=")&&(w.playerVars.playlist=k.getYouTubeId(m.originalNode.src)),k.enqueueIframe(w),h.onEvent=function(e,t,n){null!=n&&(m.youTubeState=n)},h.setSize=function(e,t){null!==g&&g.setSize(e,t)},h.hide=function(){h.stopInterval(),h.pause(),y&&(y.style.display="none")},h.show=function(){y&&(y.style.display="")},h.destroy=function(){g.destroy()},h.interval=null,h.startInterval=function(){h.interval=setInterval(function(){var e=(0,C.createEvent)("timeupdate",h);m.dispatchEvent(e)},250)},h.stopInterval=function(){h.interval&&clearInterval(h.interval)},h.getPosterUrl=function(){var e=n.youtube.imageQuality,t=k.getYouTubeId(m.originalNode.src);return e&&-1<["default","hqdefault","mqdefault","sddefault","maxresdefault"].indexOf(e)&&t?"https://img.youtube.com/vi/"+t+"/"+e+".jpg":""},h}};x.default.onYouTubePlayerAPIReady=function(){k.iFrameReady()},i.typeChecks.push(function(e){return/\\/\\/(www\\.youtube|youtu\\.?be)/i.test(e)?"video/x-youtube":null}),o.renderer.add(s)},{2:2,27:27,28:28,3:3,30:30,8:8,9:9}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cancelFullScreen=n.requestFullScreen=n.isFullScreen=n.FULLSCREEN_EVENT_NAME=n.HAS_NATIVE_FULLSCREEN_ENABLED=n.HAS_TRUE_NATIVE_FULLSCREEN=n.HAS_IOS_FULLSCREEN=n.HAS_MS_NATIVE_FULLSCREEN=n.HAS_MOZ_NATIVE_FULLSCREEN=n.HAS_WEBKIT_NATIVE_FULLSCREEN=n.HAS_NATIVE_FULLSCREEN=n.SUPPORTS_NATIVE_HLS=n.SUPPORT_PASSIVE_EVENT=n.SUPPORT_POINTER_EVENTS=n.HAS_MSE=n.IS_STOCK_ANDROID=n.IS_SAFARI=n.IS_FIREFOX=n.IS_CHROME=n.IS_EDGE=n.IS_IE=n.IS_ANDROID=n.IS_IOS=n.IS_IPOD=n.IS_IPHONE=n.IS_IPAD=n.UA=n.NAV=void 0;var i=a(e(3)),r=a(e(2)),o=a(e(8));function a(e){return e&&e.__esModule?e:{default:e}}for(var s=n.NAV=i.default.navigator,l=n.UA=s.userAgent.toLowerCase(),d=n.IS_IPAD=/ipad/i.test(l)&&!i.default.MSStream,u=n.IS_IPHONE=/iphone/i.test(l)&&!i.default.MSStream,c=n.IS_IPOD=/ipod/i.test(l)&&!i.default.MSStream,f=(n.IS_IOS=/ipad|iphone|ipod/i.test(l)&&!i.default.MSStream,n.IS_ANDROID=/android/i.test(l)),p=n.IS_IE=/(trident|microsoft)/i.test(s.appName),m=(n.IS_EDGE="msLaunchUri"in s&&!("documentMode"in r.default)),h=n.IS_CHROME=/chrome/i.test(l),v=n.IS_FIREFOX=/firefox/i.test(l),g=n.IS_SAFARI=/safari/i.test(l)&&!h,y=n.IS_STOCK_ANDROID=/^mozilla\\/\\d+\\.\\d+\\s\\(linux;\\su;/i.test(l),E=(n.HAS_MSE="MediaSource"in i.default),b=n.SUPPORT_POINTER_EVENTS=function(){var e=r.default.createElement("x"),t=r.default.documentElement,n=i.default.getComputedStyle;if(!("pointerEvents"in e.style))return!1;e.style.pointerEvents="auto",e.style.pointerEvents="x",t.appendChild(e);var o=n&&"auto"===(n(e,"")||{}).pointerEvents;return e.remove(),!!o}(),S=n.SUPPORT_PASSIVE_EVENT=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});i.default.addEventListener("test",null,t)}catch(e){}return e}(),w=["source","track","audio","video"],x=void 0,P=0,T=w.length;P<T;P++)x=r.default.createElement(w[P]);var C=n.SUPPORTS_NATIVE_HLS=g||p&&/edge/i.test(l),k=void 0!==x.webkitEnterFullscreen,_=void 0!==x.requestFullscreen;k&&/mac os x 10_5/i.test(l)&&(k=_=!1);var N=void 0!==x.webkitRequestFullScreen,A=void 0!==x.mozRequestFullScreen,L=void 0!==x.msRequestFullscreen,F=N||A||L,j=F,I="",M=void 0,O=void 0,D=void 0;A?j=r.default.mozFullScreenEnabled:L&&(j=r.default.msFullscreenEnabled),h&&(k=!1),F&&(N?I="webkitfullscreenchange":A?I="fullscreenchange":L&&(I="MSFullscreenChange"),n.isFullScreen=M=function(){return A?r.default.mozFullScreen:N?r.default.webkitIsFullScreen:L?null!==r.default.msFullscreenElement:void 0},n.requestFullScreen=O=function(e){N?e.webkitRequestFullScreen():A?e.mozRequestFullScreen():L&&e.msRequestFullscreen()},n.cancelFullScreen=D=function(){N?r.default.webkitCancelFullScreen():A?r.default.mozCancelFullScreen():L&&r.default.msExitFullscreen()});var R=n.HAS_NATIVE_FULLSCREEN=_,V=n.HAS_WEBKIT_NATIVE_FULLSCREEN=N,H=n.HAS_MOZ_NATIVE_FULLSCREEN=A,U=n.HAS_MS_NATIVE_FULLSCREEN=L,q=n.HAS_IOS_FULLSCREEN=k,B=n.HAS_TRUE_NATIVE_FULLSCREEN=F,z=n.HAS_NATIVE_FULLSCREEN_ENABLED=j,W=n.FULLSCREEN_EVENT_NAME=I;n.isFullScreen=M,n.requestFullScreen=O,n.cancelFullScreen=D,o.default.Features=o.default.Features||{},o.default.Features.isiPad=d,o.default.Features.isiPod=c,o.default.Features.isiPhone=u,o.default.Features.isiOS=o.default.Features.isiPhone||o.default.Features.isiPad,o.default.Features.isAndroid=f,o.default.Features.isIE=p,o.default.Features.isEdge=m,o.default.Features.isChrome=h,o.default.Features.isFirefox=v,o.default.Features.isSafari=g,o.default.Features.isStockAndroid=y,o.default.Features.hasMSE=E,o.default.Features.supportsNativeHLS=C,o.default.Features.supportsPointerEvents=b,o.default.Features.supportsPassiveEvent=S,o.default.Features.hasiOSFullScreen=q,o.default.Features.hasNativeFullscreen=R,o.default.Features.hasWebkitNativeFullScreen=V,o.default.Features.hasMozNativeFullScreen=H,o.default.Features.hasMsNativeFullScreen=U,o.default.Features.hasTrueNativeFullScreen=B,o.default.Features.nativeFullScreenEnabled=z,o.default.Features.fullScreenEventName=W,o.default.Features.isFullScreen=M,o.default.Features.requestFullScreen=O,o.default.Features.cancelFullScreen=D},{2:2,3:3,8:8}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeClass=n.addClass=n.hasClass=void 0,n.loadScript=a,n.offset=s,n.toggleClass=h,n.fadeOut=v,n.fadeIn=g,n.siblings=y,n.visible=E,n.ajax=b;var l=r(e(3)),i=r(e(2)),o=r(e(8));function r(e){return e&&e.__esModule?e:{default:e}}function a(o){return new Promise(function(e,t){var n=i.default.createElement("script");n.src=o,n.async=!0,n.onload=function(){n.remove(),e()},n.onerror=function(){n.remove(),t()},i.default.head.appendChild(n)})}function s(e){var t=e.getBoundingClientRect(),n=l.default.pageXOffset||i.default.documentElement.scrollLeft,o=l.default.pageYOffset||i.default.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}var d=void 0,u=void 0,c=void 0;"classList"in i.default.documentElement?(d=function(e,t){return void 0!==e.classList&&e.classList.contains(t)},u=function(e,t){return e.classList.add(t)},c=function(e,t){return e.classList.remove(t)}):(d=function(e,t){return new RegExp("\\\\b"+t+"\\\\b").test(e.className)},u=function(e,t){f(e,t)||(e.className+=" "+t)},c=function(e,t){e.className=e.className.replace(new RegExp("\\\\b"+t+"\\\\b","g"),"")});var f=n.hasClass=d,p=n.addClass=u,m=n.removeClass=c;function h(e,t){f(e,t)?m(e,t):p(e,t)}function v(i){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:400,a=arguments[2];i.style.opacity||(i.style.opacity=1);var s=null;l.default.requestAnimationFrame(function e(t){var n=t-(s=s||t),o=parseFloat(1-n/r,2);i.style.opacity=o<0?0:o,r<n?a&&"function"==typeof a&&a():l.default.requestAnimationFrame(e)})}function g(i){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:400,a=arguments[2];i.style.opacity||(i.style.opacity=0);var s=null;l.default.requestAnimationFrame(function e(t){var n=t-(s=s||t),o=parseFloat(n/r,2);i.style.opacity=1<o?1:o,r<n?a&&"function"==typeof a&&a():l.default.requestAnimationFrame(e)})}function y(e,t){var n=[];for(e=e.parentNode.firstChild;t&&!t(e)||n.push(e),e=e.nextSibling;);return n}function E(e){return void 0!==e.getClientRects&&"function"===e.getClientRects?!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length):!(!e.offsetWidth&&!e.offsetHeight)}function b(e,t,n,o){var i=l.default.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r="application/x-www-form-urlencoded; charset=UTF-8",a=!1,s="*/".concat("*");switch(t){case"text":r="text/plain";break;case"json":r="application/json, text/javascript";break;case"html":r="text/html";break;case"xml":r="application/xml, text/xml"}"application/x-www-form-urlencoded"!==r&&(s=r+", */*; q=0.01"),i&&(i.open("GET",e,!0),i.setRequestHeader("Accept",s),i.onreadystatechange=function(){if(!a&&4===i.readyState)if(200===i.status){a=!0;var e=void 0;switch(t){case"json":e=JSON.parse(i.responseText);break;case"xml":e=i.responseXML;break;default:e=i.responseText}n(e)}else"function"==typeof o&&o(i.status)},i.send())}o.default.Utils=o.default.Utils||{},o.default.Utils.offset=s,o.default.Utils.hasClass=f,o.default.Utils.addClass=p,o.default.Utils.removeClass=m,o.default.Utils.toggleClass=h,o.default.Utils.fadeIn=g,o.default.Utils.fadeOut=v,o.default.Utils.siblings=y,o.default.Utils.visible=E,o.default.Utils.ajax=b,o.default.Utils.loadScript=a},{2:2,3:3,8:8}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.escapeHTML=a,n.debounce=s,n.isObjectEmpty=l,n.splitEvents=d,n.createEvent=u,n.isNodeAfter=c,n.isString=f;var o,i=e(8),r=(o=i)&&o.__esModule?o:{default:o};function a(e){if("string"!=typeof e)throw new Error("Argument passed must be a string");var t={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;"};return e.replace(/[&<>"]/g,function(e){return t[e]})}function s(o,i){var r=this,a=arguments,s=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof o)throw new Error("First argument must be a function");if("number"!=typeof i)throw new Error("Second argument must be a numeric value");var l=void 0;return function(){var e=r,t=a,n=s&&!l;clearTimeout(l),l=setTimeout(function(){l=null,s||o.apply(e,t)},i),n&&o.apply(e,t)}}function l(e){return Object.getOwnPropertyNames(e).length<=0}function d(e,n){var o=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\\b/,i={d:[],w:[]};return(e||"").split(" ").forEach(function(e){var t=e+(n?"."+n:"");t.startsWith(".")?(i.d.push(t),i.w.push(t)):i[o.test(e)?"w":"d"].push(t)}),i.d=i.d.join(" "),i.w=i.w.join(" "),i}function u(e,t){if("string"!=typeof e)throw new Error("Event name must be a string");var n=e.match(/([a-z]+\\.([a-z]+))/i),o={target:t};return null!==n&&(e=n[1],o.namespace=n[2]),new window.CustomEvent(e,{detail:o})}function c(e,t){return!!(e&&t&&2&e.compareDocumentPosition(t))}function f(e){return"string"==typeof e}r.default.Utils=r.default.Utils||{},r.default.Utils.escapeHTML=a,r.default.Utils.debounce=s,r.default.Utils.isObjectEmpty=l,r.default.Utils.splitEvents=d,r.default.Utils.createEvent=u,r.default.Utils.isNodeAfter=c,r.default.Utils.isString=f},{8:8}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.generateControlButton=a;var o,i=e(8),r=(o=i)&&o.__esModule?o:{default:o};function a(t,e,n,o,i,r){var a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:null;if("string"!=typeof t)throw new Error("`ariaControls` argument must be a string");if("string"!=typeof e)throw new Error("`ariaLabel` argument must be a string");if("string"!=typeof n)throw new Error("`title` argument must be a string");if("string"!=typeof o)throw new Error("`iconSprite` argument must be a string");if("string"!=typeof s)throw new Error("`ariaDescribedby` argument must be a string");if(!Array.isArray(i))throw new Error("`icons` argument must be an array");if("string"!=typeof r)throw new Error("`classPrefix` argument must be a string");var d=a?\'class="\'+a+\'" \':"",u=""!==s?\'aria-describedby="\'+s+\'" \':"",c=null!==l?\'aria-pressed="\'+l+\'"\':"",f=i.map(function(e){return\'<svg xmlns="http://www.w3.org/2000/svg" id="\'+t+"-"+e+\'" class="\'+r+e+\'" aria-hidden="true" focusable="false">\\n\\t\\t\\t\\t<use xlink:href="\'+o+"#"+e+\'"></use>\\n\\t\\t\\t</svg>\\n\'});return"<button "+d+\' type="button" aria-controls="\'+t+\'" title="\'+n+\'" aria-label="\'+e+\'" \'+u+" "+c+">\\n\\t\\t\\t"+f.join("")+"\\n\\t\\t</button>"}r.default.Utils=r.default.Utils||{},r.default.Utils.generateControlButton=a},{8:8}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.typeChecks=void 0,n.absolutizeUrl=l,n.formatType=d,n.getMimeFromType=u,n.getTypeFromFile=c,n.getExtension=f,n.normalizeExtension=p;var o,i=e(8),r=(o=i)&&o.__esModule?o:{default:o},a=e(28);var s=n.typeChecks=[];function l(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");var t=document.createElement("div");return t.innerHTML=\'<a href="\'+(0,a.escapeHTML)(e)+\'">x</a>\',t.firstChild.href}function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return e&&!t?c(e):t}function u(e){if("string"!=typeof e)throw new Error("`type` argument must be a string");return e&&-1<e.indexOf(";")?e.substr(0,e.indexOf(";")):e}function c(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");for(var t=0,n=s.length;t<n;t++){var o=s[t](e);if(o)return o}var i=p(f(e)),r="video/mp4";return i&&(~["mp4","m4v","ogg","ogv","webm","flv","mpeg"].indexOf(i)?r="video/"+i:"mov"===i?r="video/quicktime":~["mp3","oga","wav","mid","midi"].indexOf(i)&&(r="audio/"+i)),r}function f(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");var t=e.split("?")[0].split("\\\\").pop().split("/").pop();return~t.indexOf(".")?t.substring(t.lastIndexOf(".")+1):""}function p(e){if("string"!=typeof e)throw new Error("`extension` argument must be a string");switch(e){case"mp4":case"m4v":return"mp4";case"webm":case"webma":case"webmv":return"webm";case"ogg":case"oga":case"ogv":return"ogg";default:return e}}r.default.Utils=r.default.Utils||{},r.default.Utils.typeChecks=s,r.default.Utils.absolutizeUrl=l,r.default.Utils.formatType=d,r.default.Utils.getMimeFromType=u,r.default.Utils.getTypeFromFile=c,r.default.Utils.getExtension=f,r.default.Utils.normalizeExtension=p},{28:28,8:8}],31:[function(e,t,n){"use strict";var o,i=s(e(2)),r=s(e(4)),a=s(e(5));function s(e){return e&&e.__esModule?e:{default:e}}if([Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),function(){if("function"==typeof window.CustomEvent)return;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=i.default.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1,o=arguments.length;n<o;n++){var i=arguments[n];if(null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length-1;0<=--n&&t.item(n)!==this;);return-1<n}),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t=(this.document||this.ownerDocument).querySelectorAll(e),n=void 0,o=this;do{for(n=t.length;0<=--n&&t.item(n)!==o;);}while(n<0&&(o=o.parentElement));return o}),function(){for(var i=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-i)),o=window.setTimeout(function(){e(t+n)},n);return i=t+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),/firefox/i.test(navigator.userAgent)){var l=window.getComputedStyle;window.getComputedStyle=function(e,t){var n=l(e,t);return null===n?{getPropertyValue:function(){}}:n}}window.Promise||(window.Promise=r.default),(0,a.default)(),(o=window.Node||window.Element)&&o.prototype&&null===o.prototype.children&&Object.defineProperty(o.prototype,"children",{get:function(){for(var e=0,t=void 0,n=this.childNodes,o=[];t=n[e++];)1===t.nodeType&&o.push(t);return o}})},{2:2,4:4,5:5}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isDropFrame=C,n.secondsToTimeCode=a,n.timeCodeToSeconds=s,n.calculateTimeFormat=l,n.convertSMPTEtoSeconds=d;var o,i=e(8),r=(o=i)&&o.__esModule?o:{default:o};function C(){return!((0<arguments.length&&void 0!==arguments[0]?arguments[0]:25)%1==0)}function a(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:25,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"hh:mm:ss";e=!e||"number"!=typeof e||e<0?0:e;var a=Math.round(.066666*o),s=Math.round(o),l=24*Math.round(3600*o),d=Math.round(600*o),u=C(o)?";":":",c=void 0,f=void 0,p=void 0,m=void 0,h=Math.round(e*o);if(C(o)){h<0&&(h=l+h);var v=(h%=l)%d;h+=9*a*Math.floor(h/d),a<v&&(h+=a*Math.floor((v-a)/Math.round(60*s-a)));var g=Math.floor(h/s);c=Math.floor(Math.floor(g/60)/60),f=Math.floor(g/60)%60,p=n?g%60:Math.floor(h/s%60).toFixed(i)}else c=Math.floor(e/3600)%24,f=Math.floor(e/60)%60,p=n?Math.floor(e%60):Math.floor(e%60).toFixed(i);c=c<=0?0:c,p=60===(p=p<=0?0:p)?0:p,f=60===(f=f<=0?0:f)?0:f;for(var y=r.split(":"),E={},b=0,S=y.length;b<S;++b){for(var w="",x=0,P=y[b].length;x<P;x++)w.indexOf(y[b][x])<0&&(w+=y[b][x]);~["f","s","m","h"].indexOf(w)&&(E[w]=y[b].length)}var T=t||0<c?(c<10&&1<E.h?"0"+c:c)+":":"";return T+=(f<10&&1<E.m?"0"+f:f)+":",T+=""+(p<10&&1<E.s?"0"+p:p),n&&(T+=(m=(m=(h%s).toFixed(0))<=0?0:m)<10&&E.f?u+"0"+m:""+u+m),T}function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:25;if("string"!=typeof e)throw new TypeError("Time must be a string");if(0<e.indexOf(";")&&(e=e.replace(";",":")),!/\\d{2}(\\:\\d{2}){0,3}/i.test(e))throw new TypeError("Time code must have the format `00:00:00`");var n=e.split(":"),o=void 0,i=0,r=0,a=0,s=0,l=0,d=Math.round(.066666*t),u=Math.round(t),c=3600*u,f=60*u;switch(n.length){default:case 1:a=parseInt(n[0],10);break;case 2:r=parseInt(n[0],10),a=parseInt(n[1],10);break;case 3:i=parseInt(n[0],10),r=parseInt(n[1],10),a=parseInt(n[2],10);break;case 4:i=parseInt(n[0],10),r=parseInt(n[1],10),a=parseInt(n[2],10),s=parseInt(n[3],10)}return o=C(t)?c*i+f*r+u*a+s-d*((l=60*i+r)-Math.floor(l/10)):(c*i+f*r+t*a+s)/t,parseFloat(o.toFixed(3))}function l(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:25;e=!e||"number"!=typeof e||e<0?0:e;for(var o=Math.floor(e/3600)%24,i=Math.floor(e/60)%60,r=Math.floor(e%60),a=[[Math.floor((e%1*n).toFixed(3)),"f"],[r,"s"],[i,"m"],[o,"h"]],s=t.timeFormat,l=s[1]===s[0],d=l?2:1,u=s.length<d?s[d]:":",c=s[0],f=!1,p=0,m=a.length;p<m;p++)if(~s.indexOf(a[p][1]))f=!0;else if(f){for(var h=!1,v=p;v<m;v++)if(0<a[v][0]){h=!0;break}if(!h)break;l||(s=c+s),s=a[p][1]+u+s,l&&(s=a[p][1]+s),c=a[p][1]}t.timeFormat=s}function d(e){if("string"!=typeof e)throw new TypeError("Argument must be a string value");for(var t=~(e=e.replace(",",".")).indexOf(".")?e.split(".")[1].length:0,n=0,o=1,i=0,r=(e=e.split(":").reverse()).length;i<r;i++)o=1,0<i&&(o=Math.pow(60,i)),n+=Number(e[i])*o;return Number(n.toFixed(t))}r.default.Utils=r.default.Utils||{},r.default.Utils.secondsToTimeCode=a,r.default.Utils.timeCodeToSeconds=s,r.default.Utils.calculateTimeFormat=l,r.default.Utils.convertSMPTEtoSeconds=d},{8:8}]},{},[31,7,6,16,24,21,20,22,23,25,17,19,18,10,11,12,13,14,15]);'},function(t,e,n){n(0)(n(27))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(29))},function(t,e){t.exports='/**\n * @license\n * Video.js 7.10.2 <http://videojs.com/>\n * Copyright Brightcove, Inc. <https://www.brightcove.com/>\n * Available under Apache License Version 2.0\n * <https://github.com/videojs/video.js/blob/master/LICENSE>\n *\n * Includes vtt.js <https://github.com/mozilla/vtt.js>\n * Available under Apache License Version 2.0\n * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>\n */\n!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["global/window","global/document"],t):(e=e||self).videojs_7_10_2=t(e.window,e.document)}(this,function(T,d){"use strict";T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d;var h="7.10.2",l=[],e=function(o,u){return function(e,t,i){var n=u.levels[t],r=new RegExp("^("+n+")$");if("log"!==e&&i.unshift(e.toUpperCase()+":"),i.unshift(o+":"),l){l.push([].concat(i));var a=l.length-1e3;l.splice(0,0<a?a:0)}if(T.console){var s=T.console[e];s||"debug"!==e||(s=T.console.info||T.console.log),s&&n&&r.test(e)&&s[Array.isArray(i)?"apply":"call"](T.console,i)}}};var p=function t(i){function n(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r("log",a,t)}var r,a="info";return r=e(i,n),n.createLogger=function(e){return t(i+": "+e)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:a},n.level=function(e){if("string"==typeof e){if(!n.levels.hasOwnProperty(e))throw new Error(\'"\'+e+\'" in not a valid log level\');a=e}return a},(n.history=function(){return l?[].concat(l):[]}).filter=function(t){return(l||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})},n.history.clear=function(){l&&(l.length=0)},n.history.disable=function(){null!==l&&(l.length=0,l=null)},n.history.enable=function(){null===l&&(l=[])},n.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("error",a,t)},n.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("warn",a,t)},n.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("debug",a,t)},n}("VIDEOJS"),f=p.createLogger;function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var m=i(function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},t.apply(this,arguments)}e.exports=t}),n=Object.prototype.toString,a=function(e){return s(e)?Object.keys(e):[]};function r(t,i){a(t).forEach(function(e){return i(t[e],e)})}function g(i){for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Object.assign?m.apply(void 0,[i].concat(t)):(t.forEach(function(e){e&&r(e,function(e,t){i[t]=e})}),i)}function s(e){return!!e&&"object"==typeof e}function o(e){return s(e)&&"[object Object]"===n.call(e)&&e.constructor===Object}function u(e,t){if(!e||!t)return"";if("function"!=typeof T.getComputedStyle)return"";var i=T.getComputedStyle(e);return i?i.getPropertyValue(t)||i[t]:""}function c(e){return"string"==typeof e&&Boolean(e.trim())}function v(e){if(0<=e.indexOf(" "))throw new Error("class has illegal whitespace characters")}function y(){return d===T.document}function _(e){return s(e)&&1===e.nodeType}function b(){try{return T.parent!==T.self}catch(e){return!0}}function S(n){return function(e,t){if(!c(e))return d[n](null);c(t)&&(t=d.querySelector(t));var i=_(t)?t:d;return i[n]&&i[n](e)}}function k(e,i,t,n){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===t&&(t={});var r=d.createElement(e);return Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(p.warn("Setting attributes in the second argument of createEl()\\nhas been deprecated. Use the third argument instead.\\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+t+"."),r.setAttribute(e,t)):"textContent"===e?C(r,t):r[e]!==t&&(r[e]=t)}),Object.getOwnPropertyNames(t).forEach(function(e){r.setAttribute(e,t[e])}),n&&H(r,n),r}function C(e,t){return"undefined"==typeof e.textContent?e.innerText=t:e.textContent=t,e}function E(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function w(e,t){return v(t),e.classList?e.classList.contains(t):function(e){return new RegExp("(^|\\\\s)"+e+"($|\\\\s)")}(t).test(e.className)}function I(e,t){return e.classList?e.classList.add(t):w(e,t)||(e.className=(e.className+" "+t).trim()),e}function A(e,t){return e.classList?e.classList.remove(t):(v(t),e.className=e.className.split(/\\s+/).filter(function(e){return e!==t}).join(" ")),e}function x(e,t,i){var n=w(e,t);if("function"==typeof i&&(i=i(e,t)),"boolean"!=typeof i&&(i=!n),i!==n)return i?I(e,t):A(e,t),e}function P(i,n){Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];null===t||"undefined"==typeof t||!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})}function L(e){var t={},i=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&0<e.attributes.length)for(var n=e.attributes,r=n.length-1;0<=r;r--){var a=n[r].name,s=n[r].value;"boolean"!=typeof e[a]&&-1===i.indexOf(","+a+",")||(s=null!==s),t[a]=s}return t}function O(e,t){return e.getAttribute(t)}function D(e,t,i){e.setAttribute(t,i)}function M(e,t){e.removeAttribute(t)}function R(){d.body.focus(),d.onselectstart=function(){return!1}}function N(){d.onselectstart=function(){return!0}}function U(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(u(e,"height"))),i.width||(i.width=parseFloat(u(e,"width"))),i}}function F(e){if(!e||e&&!e.offsetParent)return{left:0,top:0,width:0,height:0};for(var t=e.offsetWidth,i=e.offsetHeight,n=0,r=0;n+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;);return{left:n,top:r,width:t,height:i}}function B(e,t){var i={},n=F(t.target),r=F(e),a=r.width,s=r.height,o=t.offsetY-(r.top-n.top),u=t.offsetX-(r.left-n.left);return t.changedTouches&&(u=t.changedTouches[0].pageX-r.left,o=t.changedTouches[0].pageY+r.top),i.y=1-Math.max(0,Math.min(1,o/s)),i.x=Math.max(0,Math.min(1,u/a)),i}function j(e){return s(e)&&3===e.nodeType}function V(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function q(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),_(e)||j(e)?e:"string"==typeof e&&/\\S/.test(e)?d.createTextNode(e):void 0}).filter(function(e){return e})}function H(t,e){return q(e).forEach(function(e){return t.appendChild(e)}),t}function W(e,t){return H(V(e),t)}function z(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var G,X=S("querySelector"),K=S("querySelectorAll"),Y=Object.freeze({__proto__:null,isReal:y,isEl:_,isInFrame:b,createEl:k,textContent:C,prependTo:E,hasClass:w,addClass:I,removeClass:A,toggleClass:x,setAttributes:P,getAttributes:L,getAttribute:O,setAttribute:D,removeAttribute:M,blockTextSelection:R,unblockTextSelection:N,getBoundingClientRect:U,findPosition:F,getPointerPosition:B,isTextNode:j,emptyEl:V,normalizeContent:q,appendContent:H,insertContent:W,isSingleLeftClick:z,$:X,$$:K}),$=!1,Q=function(){if(y()&&!1!==G.options.autoSetup){var e=Array.prototype.slice.call(d.getElementsByTagName("video")),t=Array.prototype.slice.call(d.getElementsByTagName("audio")),i=Array.prototype.slice.call(d.getElementsByTagName("video-js")),n=e.concat(t,i);if(n&&0<n.length)for(var r=0,a=n.length;r<a;r++){var s=n[r];if(!s||!s.getAttribute){J(1);break}void 0===s.player&&null!==s.getAttribute("data-setup")&&G(s)}else $||J(1)}};function J(e,t){t&&(G=t),T.setTimeout(Q,e)}function Z(){$=!0,T.removeEventListener("load",Z)}y()&&("complete"===d.readyState?Z():T.addEventListener("load",Z));function ee(e){var t=d.createElement("style");return t.className=e,t}function te(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}var ie,ne=3;function re(){return ne++}T.WeakMap||(ie=function(){function e(){this.vdata="vdata"+Math.floor(T.performance&&T.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var i=e[this.vdata]||re();return e[this.vdata]||(e[this.vdata]=i),this.data[i]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];p("We have no data for this element",e)},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var ae,se=T.WeakMap?new WeakMap:new ie;function oe(e,t){if(se.has(e)){var i=se.get(e);0===i.handlers[t].length&&(delete i.handlers[t],e.removeEventListener?e.removeEventListener(t,i.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&se.delete(e)}}function ue(t,i,e,n){e.forEach(function(e){t(i,e,n)})}function le(e){if(e.fixed_)return e;function t(){return!0}function i(){return!1}if(!e||!e.isPropagationStopped){var n=e||T.event;for(var r in e={},n)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&n.preventDefault||(e[r]=n[r]));if(e.target||(e.target=e.srcElement||d),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){n.preventDefault&&n.preventDefault(),e.returnValue=!1,n.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),e.cancelBubble=!0,n.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=i,e.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=i,null!==e.clientX&&void 0!==e.clientX){var a=d.documentElement,s=d.body;e.pageX=e.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var ce=function(){if("boolean"!=typeof ae){ae=!1;try{var e=Object.defineProperty({},"passive",{get:function(){ae=!0}});T.addEventListener("test",null,e),T.removeEventListener("test",null,e)}catch(e){}}return ae},de=["touchstart","touchmove"];function he(s,e,t){if(Array.isArray(e))return ue(he,s,e,t);se.has(s)||se.set(s,{});var o=se.get(s);if(o.handlers||(o.handlers={}),o.handlers[e]||(o.handlers[e]=[]),t.guid||(t.guid=re()),o.handlers[e].push(t),o.dispatcher||(o.disabled=!1,o.dispatcher=function(e,t){if(!o.disabled){e=le(e);var i=o.handlers[e.type];if(i)for(var n=i.slice(0),r=0,a=n.length;r<a&&!e.isImmediatePropagationStopped();r++)try{n[r].call(s,e,t)}catch(e){p.error(e)}}}),1===o.handlers[e].length)if(s.addEventListener){var i=!1;ce()&&-1<de.indexOf(e)&&(i={passive:!0}),s.addEventListener(e,o.dispatcher,i)}else s.attachEvent&&s.attachEvent("on"+e,o.dispatcher)}function pe(e,t,i){if(se.has(e)){var n=se.get(e);if(n.handlers){if(Array.isArray(t))return ue(pe,e,t,i);var r=function(e,t){n.handlers[t]=[],oe(e,t)};if(void 0!==t){var a=n.handlers[t];if(a)if(i){if(i.guid)for(var s=0;s<a.length;s++)a[s].guid===i.guid&&a.splice(s--,1);oe(e,t)}else r(e,t)}else for(var o in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},o)&&r(e,o)}}}function fe(e,t,i){var n=se.has(e)?se.get(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=le(t),n.dispatcher&&n.dispatcher.call(e,t,i),r&&!t.isPropagationStopped()&&!0===t.bubbles)fe.call(null,r,t,i);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){se.has(t.target)||se.set(t.target,{});var a=se.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function me(e,t,i){if(Array.isArray(t))return ue(me,e,t,i);function n(){pe(e,t,n),i.apply(this,arguments)}n.guid=i.guid=i.guid||re(),he(e,t,n)}function ge(e,t,i){function n(){pe(e,t,n),i.apply(this,arguments)}n.guid=i.guid=i.guid||re(),he(e,t,n)}function ve(e,t,i){t.guid||(t.guid=re());var n=t.bind(e);return n.guid=i?i+"_"+t.guid:t.guid,n}function ye(t,i){var n=T.performance.now();return function(){var e=T.performance.now();i<=e-n&&(t.apply(void 0,arguments),n=e)}}function _e(){}var be,Te=Object.freeze({__proto__:null,fixEvent:le,on:he,off:pe,trigger:fe,one:me,any:ge});_e.prototype.allowedEvents_={},_e.prototype.addEventListener=_e.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},he(this,e,t),this.addEventListener=i},_e.prototype.removeEventListener=_e.prototype.off=function(e,t){pe(this,e,t)},_e.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},me(this,e,t),this.addEventListener=i},_e.prototype.any=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},ge(this,e,t),this.addEventListener=i},_e.prototype.dispatchEvent=_e.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=le(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),fe(this,e)},_e.prototype.queueTrigger=function(e){var t=this;be=be||new Map;var i=e.type||e,n=be.get(this);n||(n=new Map,be.set(this,n));var r=n.get(i);n.delete(i),T.clearTimeout(r);var a=T.setTimeout(function(){0===n.size&&(n=null,be.delete(t)),t.trigger(e)},0);n.set(i,a)};function Se(e){return"string"==typeof e&&/\\S/.test(e)||Array.isArray(e)&&!!e.length}function ke(e){if(!e.nodeName&&!Ae(e))throw new Error("Invalid target; must be a DOM node or evented object.")}function Ce(e){if(!Se(e))throw new Error("Invalid event type; must be a non-empty string or array.")}function Ee(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")}function we(e,t){var i,n,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return r=a?(i=e.eventBusEl_,3<=t.length&&t.shift(),n=t[0],t[1]):(i=t[0],n=t[1],t[2]),ke(i),Ce(n),Ee(r),{isTargetingSelf:a,target:i,type:n,listener:r=ve(e,r)}}function Ie(e,t,i,n){ke(e),e.nodeName?Te[t](e,i,n):e[t](i,n)}var Ae=function(t){return t instanceof _e||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},xe={on:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=we(this,i),a=r.isTargetingSelf,s=r.target,o=r.type,u=r.listener;if(Ie(s,"on",o,u),!a){var l=function(){return e.off(s,o,u)};l.guid=u.guid;var c=function(){return e.off("dispose",l)};c.guid=u.guid,Ie(this,"on","dispose",l),Ie(s,"on","dispose",c)}},one:function(){for(var r=this,e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=we(this,t),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)Ie(s,"one",o,u);else{var l=function e(){r.off(s,o,e);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];u.apply(null,i)};l.guid=u.guid,Ie(s,"one",o,l)}},any:function(){for(var r=this,e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=we(this,t),a=n.isTargetingSelf,s=n.target,o=n.type,u=n.listener;if(a)Ie(s,"any",o,u);else{var l=function e(){r.off(s,o,e);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];u.apply(null,i)};l.guid=u.guid,Ie(s,"any",o,l)}},off:function(e,t,i){if(!e||Se(e))pe(this.eventBusEl_,e,t);else{var n=e,r=t;ke(n),Ce(r),Ee(i),i=ve(this,i),this.off("dispose",i),n.nodeName?(pe(n,r,i),pe(n,"dispose",i)):Ae(n)&&(n.off(r,i),n.off("dispose",i))}},trigger:function(e,t){return fe(this.eventBusEl_,e,t)}};function Pe(e,t){void 0===t&&(t={});var i=t.eventBusKey;if(i){if(!e[i].nodeName)throw new Error(\'The eventBusKey "\'+i+\'" does not refer to an element.\');e.eventBusEl_=e[i]}else e.eventBusEl_=k("span",{className:"vjs-event-bus"});return g(e,xe),e.eventedCallbacks&&e.eventedCallbacks.forEach(function(e){e()}),e.on("dispose",function(){e.off(),T.setTimeout(function(){e.eventBusEl_=null},0)}),e}var Le={state:{},setState:function(e){var i,n=this;return"function"==typeof e&&(e=e()),r(e,function(e,t){n.state[t]!==e&&((i=i||{})[t]={from:n.state[t],to:e}),n.state[t]=e}),i&&Ae(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function Oe(e,t){return g(e,Le),e.state=g({},e.state,t),"function"==typeof e.handleStateChanged&&Ae(e)&&e.on("statechanged",e.handleStateChanged),e}function De(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toLowerCase()})}function Me(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})}function Re(){for(var i={},e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){e&&r(e,function(e,t){o(e)?(o(i[t])||(i[t]={}),i[t]=Re(i[t],e)):i[t]=e})}),i}var Ne=function(){function e(){this.map_={}}var t=e.prototype;return t.has=function(e){return e in this.map_},t.delete=function(e){var t=this.has(e);return delete this.map_[e],t},t.set=function(e,t){return this.set_[e]=t,this},t.forEach=function(e,t){for(var i in this.map_)e.call(t,this.map_[i],i,this)},e}(),Ue=T.Map?T.Map:Ne,Fe=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var i in this.set_)e.call(t,i,i,this)},e}(),Be=T.Set?T.Set:Fe,je=function(){function l(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Re({},this.options_),t=this.options_=Re(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+re()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Pe(this,{eventBusKey:this.el_?"el_":null}),Oe(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Be,this.setIntervalIds_=new Be,this.rafIds_=new Be,this.namedRafs_=new Ue,(this.clearingTimersOnDispose_=!1)!==t.initChildren&&this.initChildren(),this.ready(i),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var e=l.prototype;return e.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),se.has(this.el_)&&se.delete(this.el_),this.el_=null),this.player_=null}},e.isDisposed=function(){return Boolean(this.isDisposed_)},e.player=function(){return this.player_},e.options=function(e){return e&&(this.options_=Re(this.options_,e)),this.options_},e.el=function(){return this.el_},e.createEl=function(e,t,i){return k(e,t,i)},e.localize=function(e,r,t){void 0===t&&(t=e);var i=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),a=n&&n[i],s=i&&i.split("-")[0],o=n&&n[s],u=t;return a&&a[e]?u=a[e]:o&&o[e]&&(u=o[e]),r&&(u=u.replace(/\\{(\\d+)\\}/g,function(e,t){var i=r[t-1],n=i;return"undefined"==typeof i&&(n=e),n})),u},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(e){return this.childIndex_[e]},e.getChild=function(e){if(e)return this.childNameIndex_[e]},e.getDescendant=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t=t.reduce(function(e,t){return e.concat(t)},[]);for(var n=this,r=0;r<t.length;r++)if(!(n=n.getChild(t[r]))||!n.getChild)return;return n},e.addChild=function(e,t,i){var n,r;if(void 0===t&&(t={}),void 0===i&&(i=this.children_.length),"string"==typeof e){r=Me(e);var a=t.componentClass||r;t.name=r;var s=l.getComponent(a);if(!s)throw new Error("Component "+a+" does not exist");if("function"!=typeof s)return null;n=new s(this.player_||this,t)}else n=e;if(n.parentComponent_&&n.parentComponent_.removeChild(n),this.children_.splice(i,0,n),n.parentComponent_=this,"function"==typeof n.id&&(this.childIndex_[n.id()]=n),(r=r||n.name&&Me(n.name()))&&(this.childNameIndex_[r]=n,this.childNameIndex_[De(r)]=n),"function"==typeof n.el&&n.el()){var o=null;this.children_[i+1]&&(this.children_[i+1].el_?o=this.children_[i+1].el_:_(this.children_[i+1])&&(o=this.children_[i+1])),this.contentEl().insertBefore(n.el(),o)}return n},e.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,i=this.children_.length-1;0<=i;i--)if(this.children_[i]===e){t=!0,this.children_.splice(i,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Me(e.name())]=null,this.childNameIndex_[De(e.name())]=null;var n=e.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},e.initChildren=function(){var r=this,n=this.options_.children;if(n){var e,a=this.options_,i=l.getComponent("Tech");(e=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(t){return!e.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(e){var t,i;return i="string"==typeof e?n[t=e]||r.options_[t]||{}:(t=e.name,e),{name:t,opts:i}}).filter(function(e){var t=l.getComponent(e.opts.componentClass||Me(e.name));return t&&!i.isTech(t)}).forEach(function(e){var t=e.name,i=e.opts;if(void 0!==a[t]&&(i=a[t]),!1!==i){!0===i&&(i={}),i.playerOptions=r.options_.playerOptions;var n=r.addChild(t,i);n&&(r[t]=n)}})}},e.buildCSSClass=function(){return""},e.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},e.$=function(e,t){return X(e,t||this.contentEl())},e.$$=function(e,t){return K(e,t||this.contentEl())},e.hasClass=function(e){return w(this.el_,e)},e.addClass=function(e){I(this.el_,e)},e.removeClass=function(e){A(this.el_,e)},e.toggleClass=function(e,t){x(this.el_,e,t)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(e){return O(this.el_,e)},e.setAttribute=function(e,t){D(this.el_,e,t)},e.removeAttribute=function(e){M(this.el_,e)},e.width=function(e,t){return this.dimension("width",e,t)},e.height=function(e,t){return this.dimension("height",e,t)},e.dimensions=function(e,t){this.width(e,!0),this.height(t)},e.dimension=function(e,t,i){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(i||this.trigger("componentresize"));if(!this.el_)return 0;var n=this.el_.style[e],r=n.indexOf("px");return-1!==r?parseInt(n.slice(0,r),10):parseInt(this.el_["offset"+Me(e)],10)},e.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=u(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var i="offset"+Me(e);t=this.el_[i]}return t},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},e.handleKeyPress=function(e){this.handleKeyDown(e)},e.emitTapEvents=function(){var n,t=0,r=null;this.on("touchstart",function(e){1===e.touches.length&&(r={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},t=T.performance.now(),n=!0)}),this.on("touchmove",function(e){if(1<e.touches.length)n=!1;else if(r){var t=e.touches[0].pageX-r.pageX,i=e.touches[0].pageY-r.pageY;10<Math.sqrt(t*t+i*i)&&(n=!1)}});function e(){n=!1}this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){!(r=null)===n&&T.performance.now()-t<200&&(e.preventDefault(),this.trigger("tap"))})},e.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t,i=ve(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){i(),this.clearInterval(t),t=this.setInterval(i,250)});var e=function(e){i(),this.clearInterval(t)};this.on("touchmove",i),this.on("touchend",e),this.on("touchcancel",e)}},e.setTimeout=function(e,t){var i,n=this;return e=ve(this,e),this.clearTimersOnDispose_(),i=T.setTimeout(function(){n.setTimeoutIds_.has(i)&&n.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i},e.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),T.clearTimeout(e)),e},e.setInterval=function(e,t){e=ve(this,e),this.clearTimersOnDispose_();var i=T.setInterval(e,t);return this.setIntervalIds_.add(i),i},e.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),T.clearInterval(e)),e},e.requestAnimationFrame=function(e){var t,i=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=ve(this,e),t=T.requestAnimationFrame(function(){i.rafIds_.has(t)&&i.rafIds_.delete(t),e()}),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},e.requestNamedAnimationFrame=function(e,t){var i=this;if(!this.namedRafs_.has(e)){this.clearTimersOnDispose_(),t=ve(this,t);var n=this.requestAnimationFrame(function(){t(),i.namedRafs_.has(e)&&i.namedRafs_.delete(e)});return this.namedRafs_.set(e,n),e}},e.cancelNamedAnimationFrame=function(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))},e.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),T.cancelAnimationFrame(e)),e):this.clearTimeout(e)},e.clearTimersOnDispose_=function(){var n=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(e){var t=e[0],i=e[1];n[t].forEach(function(e,t){return n[i](t)})}),n.clearingTimersOnDispose_=!1}))},l.registerComponent=function(e,t){if("string"!=typeof e||!e)throw new Error(\'Illegal component name, "\'+e+\'"; must be a non-empty string.\');var i,n=l.getComponent("Tech"),r=n&&n.isTech(t),a=l===t||l.prototype.isPrototypeOf(t.prototype);if(r||!a)throw i=r?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error(\'Illegal component, "\'+e+\'"; \'+i+".");e=Me(e),l.components_||(l.components_={});var s=l.getComponent("Player");if("Player"===e&&s&&s.players){var o=s.players,u=Object.keys(o);if(o&&0<u.length&&u.map(function(e){return o[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return l.components_[e]=t,l.components_[De(e)]=t},l.getComponent=function(e){if(e&&l.components_)return l.components_[e]},l}();je.prototype.supportsRaf_="function"==typeof T.requestAnimationFrame&&"function"==typeof T.cancelAnimationFrame,je.registerComponent("Component",je);var Ve=function(e){if(void 0===e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e};i(function(t){function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(e){return typeof e}:t.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}t.exports=i}),i(function(t){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}t.exports=i});var qe,He,We,ze,Ge=function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t},Xe=T.navigator&&T.navigator.userAgent||"",Ke=/AppleWebKit\\/([\\d.]+)/i.exec(Xe),Ye=Ke?parseFloat(Ke.pop()):null,$e=/iPod/i.test(Xe),Qe=(qe=Xe.match(/OS (\\d+)_/i))&&qe[1]?qe[1]:null,Je=/Android/i.test(Xe),Ze=function(){var e=Xe.match(/Android (\\d+)(?:\\.(\\d+))?(?:\\.(\\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),et=Je&&Ze<5&&Ye<537,tt=/Firefox/i.test(Xe),it=/Edg/i.test(Xe),nt=!it&&(/Chrome/i.test(Xe)||/CriOS/i.test(Xe)),rt=(He=Xe.match(/(Chrome|CriOS)\\/(\\d+)/))&&He[2]?parseFloat(He[2]):null,at=(We=/MSIE\\s(\\d+)\\.\\d/.exec(Xe),!(ze=We&&parseFloat(We[1]))&&/Trident\\/7.0/i.test(Xe)&&/rv:11.0/.test(Xe)&&(ze=11),ze),st=/Safari/i.test(Xe)&&!nt&&!Je&&!it,ot=/Windows/i.test(Xe),ut=y()&&("ontouchstart"in T||T.navigator.maxTouchPoints||T.DocumentTouch&&T.document instanceof T.DocumentTouch),lt=/iPad/i.test(Xe)||st&&ut&&!/iPhone/i.test(Xe),ct=/iPhone/i.test(Xe)&&!lt,dt=ct||lt||$e,ht=(st||dt)&&!nt,pt=Object.freeze({__proto__:null,IS_IPOD:$e,IOS_VERSION:Qe,IS_ANDROID:Je,ANDROID_VERSION:Ze,IS_NATIVE_ANDROID:et,IS_FIREFOX:tt,IS_EDGE:it,IS_CHROME:nt,CHROME_VERSION:rt,IE_VERSION:at,IS_SAFARI:st,IS_WINDOWS:ot,TOUCH_ENABLED:ut,IS_IPAD:lt,IS_IPHONE:ct,IS_IOS:dt,IS_ANY_SAFARI:ht});function ft(e,t,i,n){return function(e,t,i){if("number"!=typeof t||t<0||i<t)throw new Error("Failed to execute \'"+e+"\' on \'TimeRanges\': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").")}(e,n,i.length-1),i[n][t]}function mt(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ft.bind(null,"start",0,e),end:ft.bind(null,"end",1,e)}}function gt(e,t){return Array.isArray(e)?mt(e):void 0===e||void 0===t?mt():mt([[e,t]])}function vt(e,t){var i,n,r=0;if(!t)return 0;e&&e.length||(e=gt(0,0));for(var a=0;a<e.length;a++)i=e.start(a),t<(n=e.end(a))&&(n=t),r+=n-i;return r/t}for(var yt,_t={prefixed:!0},bt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Tt=bt[0],St=0;St<bt.length;St++)if(bt[St][1]in d){yt=bt[St];break}if(yt){for(var kt=0;kt<yt.length;kt++)_t[Tt[kt]]=yt[kt];_t.prefixed=yt[0]!==Tt[0]}function Ct(e){if(e instanceof Ct)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:s(e)&&("number"==typeof e.code&&(this.code=e.code),g(this,e)),this.message||(this.message=Ct.defaultMessages[this.code]||"")}Ct.prototype.code=0,Ct.prototype.message="",Ct.prototype.status=null,Ct.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Ct.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Et=0;Et<Ct.errorTypes.length;Et++)Ct[Ct.errorTypes[Et]]=Et,Ct.prototype[Ct.errorTypes[Et]]=Et;var wt=function(e,t){var i,n=null;try{i=JSON.parse(e,t)}catch(e){n=e}return[n,i]};function It(e){return null!=e&&"function"==typeof e.then}function At(e){It(e)&&e.then(null,function(e){})}function xt(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,i){return n[t]&&(e[t]=n[t]),e},{cues:n.cues&&Array.prototype.map.call(n.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})}var Pt=function(e){var t=e.$$("track"),i=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=xt(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===i.indexOf(e)}).map(xt))},Lt=function(e,i){return e.forEach(function(e){var t=i.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return t.addCue(e)})}),i.textTracks()},Ot=i(function(e,t){function i(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return s[e];var i,n=String(e);return(i=r[n.toLowerCase()])?i:(i=a[n.toLowerCase()])||(1===n.length?n.charCodeAt(0):void 0)}i.isEventKey=function(e,t){if(e&&"object"==typeof e){var i=e.which||e.keyCode||e.charCode;if(null==i)return!1;if("string"==typeof t){var n;if(n=r[t.toLowerCase()])return n===i;if(n=a[t.toLowerCase()])return n===i}else if("number"==typeof t)return t===i;return!1}};var r=(t=e.exports=i).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\\\":220,"]":221,"\'":222},a=t.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(n=97;n<123;n++)r[String.fromCharCode(n)]=n-32;for(var n=48;n<58;n++)r[n-48]=n;for(n=1;n<13;n++)r["f"+n]=n+111;for(n=0;n<10;n++)r["numpad "+n]=n+96;var s=t.names=t.title={};for(n in r)s[r[n]]=n;for(var o in a)r[o]=a[o]}),Dt=(Ot.code,Ot.codes,Ot.aliases,Ot.names,Ot.title,"vjs-modal-dialog"),Mt=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).opened_=i.hasBeenOpened_=i.hasBeenFilled_=!1,i.closeable(!i.options_.uncloseable),i.content(i.options_.content),i.contentEl_=k("div",{className:Dt+"-content"},{role:"document"}),i.descEl_=k("p",{className:Dt+"-description vjs-control-text",id:i.el().getAttribute("aria-describedby")}),C(i.descEl_,i.description()),i.el_.appendChild(i.descEl_),i.el_.appendChild(i.contentEl_),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},t.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},t.buildCSSClass=function(){return Dt+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},t.label=function(){return this.localize(this.options_.label||"Modal Window")},t.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},t.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},t.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},t.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},t.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,i=this.getChild("closeButton");if(t&&!i){var n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close)}!t&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},t.fill=function(){this.fillWith(this.content())},t.fillWith=function(e){var t=this.contentEl(),i=t.parentNode,n=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),W(t,e),this.trigger("modalfill"),n?i.insertBefore(t,n):i.appendChild(t);var r=this.getChild("closeButton");r&&i.appendChild(r.el_)},t.empty=function(){this.trigger("beforemodalempty"),V(this.contentEl()),this.trigger("modalempty")},t.content=function(e){return"undefined"!=typeof e&&(this.content_=e),this.content_},t.conditionalFocus_=function(){var e=d.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,!t.contains(e)&&t!==e||(this.previouslyActiveEl_=e,this.focus())},t.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},t.handleKeyDown=function(e){if(e.stopPropagation(),Ot.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(Ot.isEventKey(e,"Tab")){for(var t,i=this.focusableEls_(),n=this.el_.querySelector(":focus"),r=0;r<i.length;r++)if(n===i[r]){t=r;break}d.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||t!==i.length-1||(i[0].focus(),e.preventDefault())}},t.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(e){return(e instanceof T.HTMLAnchorElement||e instanceof T.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof T.HTMLInputElement||e instanceof T.HTMLSelectElement||e instanceof T.HTMLTextAreaElement||e instanceof T.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof T.HTMLIFrameElement||e instanceof T.HTMLObjectElement||e instanceof T.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")})},e}(je);Mt.prototype.options_={pauseOnOpen:!0,temporary:!0},je.registerComponent("ModalDialog",Mt);var Rt=function(n){function e(e){var t;void 0===e&&(e=[]),(t=n.call(this)||this).tracks_=[],Object.defineProperty(Ve(t),"length",{get:function(){return this.tracks_.length}});for(var i=0;i<e.length;i++)t.addTrack(e[i]);return t}Ge(e,n);var t=e.prototype;return t.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},t.removeTrack=function(e){for(var t,i=0,n=this.length;i<n;i++)if(this[i]===e){(t=this[i]).off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},t.getTrackById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},e}(_e);for(var Nt in Rt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Rt.prototype.allowedEvents_)Rt.prototype["on"+Nt]=null;function Ut(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].enabled=!1)}function Ft(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].selected=!1)}function Bt(e){var t=["protocol","hostname","port","pathname","search","hash","host"],i=d.createElement("a");i.href=e;var n,r=""===i.host&&"file:"!==i.protocol;r&&((n=d.createElement("div")).innerHTML=\'<a href="\'+e+\'"></a>\',i=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),d.body.appendChild(n));for(var a={},s=0;s<t.length;s++)a[t[s]]=i[t[s]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=T.location.protocol),r&&d.body.removeChild(n),a}function jt(e){if(!e.match(/^https?:\\/\\//)){var t=d.createElement("div");t.innerHTML=\'<a href="\'+e+\'">x</a>\',e=t.firstChild.href}return e}function Vt(e){if("string"==typeof e){var t=/^(\\/?)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?)(\\.([^\\.\\/\\?]+)))(?:[\\/]*|[\\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""}function qt(e,t){void 0===t&&(t=T.location);var i=Bt(e);return(":"===i.protocol?t.protocol:i.protocol)+i.host!==t.protocol+t.host}var Ht=function(n){function e(e){var t;void 0===e&&(e=[]);for(var i=e.length-1;0<=i;i--)if(e[i].enabled){Ut(e,e[i]);break}return(t=n.call(this,e)||this).changing_=!1,t}Ge(e,n);var t=e.prototype;return t.addTrack=function(e){var t=this;e.enabled&&Ut(this,e),n.prototype.addTrack.call(this,e),e.addEventListener&&(e.enabledChange_=function(){t.changing_||(t.changing_=!0,Ut(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))},t.removeTrack=function(e){n.prototype.removeTrack.call(this,e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)},e}(Rt),Wt=function(n){function e(e){var t;void 0===e&&(e=[]);for(var i=e.length-1;0<=i;i--)if(e[i].selected){Ft(e,e[i]);break}return(t=n.call(this,e)||this).changing_=!1,Object.defineProperty(Ve(t),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),t}Ge(e,n);var t=e.prototype;return t.addTrack=function(e){var t=this;e.selected&&Ft(this,e),n.prototype.addTrack.call(this,e),e.addEventListener&&(e.selectedChange_=function(){t.changing_||(t.changing_=!0,Ft(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))},t.removeTrack=function(e){n.prototype.removeTrack.call(this,e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)},e}(Rt),zt=function(i){function e(){return i.apply(this,arguments)||this}Ge(e,i);var t=e.prototype;return t.addTrack=function(e){var t=this;i.prototype.addTrack.call(this,e),this.queueChange_||(this.queueChange_=function(){return t.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return t.trigger("selectedlanguagechange")}),e.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)},t.removeTrack=function(e){i.prototype.removeTrack.call(this,e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},e}(Rt),Gt=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t},t.removeTrackElement_=function(e){for(var t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),Xt=function(){function t(e){t.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=t.prototype;return e.setCues_=function(e){var t=this.length||0,i=0,n=e.length;this.cues_=e,this.length_=e.length;function r(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}if(t<n)for(i=t;i<n;i++)r.call(this,i)},e.getCueById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},t}(),Kt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Yt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},$t={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Qt={disabled:"disabled",hidden:"hidden",showing:"showing"},Jt=function(a){function e(e){var t;void 0===e&&(e={}),t=a.call(this)||this;function i(e){Object.defineProperty(Ve(t),e,{get:function(){return n[e]},set:function(){}})}var n={id:e.id||"vjs_track_"+re(),kind:e.kind||"",label:e.label||"",language:e.language||""};for(var r in n)i(r);return t}return Ge(e,a),e}(_e),Zt=Object.freeze({__proto__:null,parseUrl:Bt,getAbsoluteURL:jt,getFileExtension:Vt,isCrossOrigin:qt}),ei=function(e){var t=ti.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}\n/**\n   * @license\n   * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>\n   * Copyright (c) 2014 David Bjrklund\n   * Available under the MIT license\n   * <https://github.com/kesla/parse-headers/blob/master/LICENCE>\n   */,ti=Object.prototype.toString;var ii=function(e){var r={};return e&&e.trim().split("\\n").forEach(function(e){var t=e.indexOf(":"),i=e.slice(0,t).trim().toLowerCase(),n=e.slice(t+1).trim();"undefined"==typeof r[i]?r[i]=n:Array.isArray(r[i])?r[i].push(n):r[i]=[r[i],n]}),r},ni=si,ri=si;function ai(e,t,i){var n=e;return ei(t)?(i=t,"string"==typeof e&&(n={uri:e})):n=m({},t,{uri:e}),n.callback=i,n}function si(e,t,i){return oi(t=ai(e,t,i))}function oi(n){if("undefined"==typeof n.callback)throw new Error("callback argument missing");var r=!1,a=function(e,t,i){r||(r=!0,n.callback(e,t,i))};function t(e){return clearTimeout(o),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,a(e,m)}function e(){if(!s){var e;clearTimeout(o),e=n.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var t=m,i=null;return 0!==e?(t={body:function(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(u),f)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:e,method:c,headers:{},url:l,rawRequest:u},u.getAllResponseHeaders&&(t.headers=ii(u.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),a(i,t,t.body)}}var i,s,o,u=n.xhr||null,l=(u=u||(n.cors||n.useXDR?new si.XDomainRequest:new si.XMLHttpRequest)).url=n.uri||n.url,c=u.method=n.method||"GET",d=n.body||n.data,h=u.headers=n.headers||{},p=!!n.sync,f=!1,m={body:void 0,headers:{},statusCode:0,method:c,url:l,rawRequest:u};if("json"in n&&!1!==n.json&&(f=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),d=JSON.stringify(!0===n.json?d:n.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(e,0)},u.onload=e,u.onerror=t,u.onprogress=function(){},u.onabort=function(){s=!0},u.ontimeout=t,u.open(c,l,!p,n.username,n.password),p||(u.withCredentials=!!n.withCredentials),!p&&0<n.timeout&&(o=setTimeout(function(){if(!s){s=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},n.timeout)),u.setRequestHeader)for(i in h)h.hasOwnProperty(i)&&u.setRequestHeader(i,h[i]);else if(n.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(u.responseType=n.responseType),"beforeSend"in n&&"function"==typeof n.beforeSend&&n.beforeSend(u),u.send(d||null),u}si.XMLHttpRequest=T.XMLHttpRequest||function(){},si.XDomainRequest="withCredentials"in new si.XMLHttpRequest?si.XMLHttpRequest:T.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(n){si["delete"===n?"del":n]=function(e,t,i){return(t=ai(e,t,i)).method=n.toUpperCase(),oi(t)}}),ni.default=ri;function ui(e,t){var i=new T.WebVTT.Parser(T,T.vttjs,T.WebVTT.StringDecoder()),n=[];i.oncue=function(e){t.addCue(e)},i.onparsingerror=function(e){n.push(e)},i.onflush=function(){t.trigger({type:"loadeddata",target:t})},i.parse(e),0<n.length&&(T.console&&T.console.groupCollapsed&&T.console.groupCollapsed("Text Track parsing errors for "+t.src),n.forEach(function(e){return p.error(e)}),T.console&&T.console.groupEnd&&T.console.groupEnd()),i.flush()}function li(e,n){var t={uri:e},i=qt(e);i&&(t.cors=i);var r="use-credentials"===n.tech_.crossOrigin();r&&(t.withCredentials=r),ni(t,ve(this,function(e,t,i){if(e)return p.error(e,t);n.loaded_=!0,"function"!=typeof T.WebVTT?n.tech_&&n.tech_.any(["vttjsloaded","vttjserror"],function(e){if("vttjserror"!==e.type)return ui(i,n);p.error("vttjs failed to load, stopping trying to process "+n.src)}):ui(i,n)}))}var ci=function(l){function e(e){var t;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var i=Re(e,{kind:$t[e.kind]||"subtitles",language:e.language||e.srclang||""}),n=Qt[i.mode]||"disabled",r=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(n="hidden"),(t=l.call(this,i)||this).tech_=i.tech,t.cues_=[],t.activeCues_=[],t.preload_=!1!==t.tech_.preloadTextTracks;var a=new Xt(t.cues_),s=new Xt(t.activeCues_),o=!1,u=ve(Ve(t),function(){this.activeCues=this.activeCues,o&&(this.trigger("cuechange"),o=!1)});return"disabled"!==n&&t.tech_.ready(function(){t.tech_.on("timeupdate",u)},!0),Object.defineProperties(Ve(t),{default:{get:function(){return r},set:function(){}},mode:{get:function(){return n},set:function(e){var t=this;Qt[e]&&(n=e,this.preload_||"disabled"===n||0!==this.cues.length||li(this.src,this),"disabled"!==n?this.tech_.ready(function(){t.tech_.on("timeupdate",u)},!0):this.tech_.off("timeupdate",u),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?a:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],i=0,n=this.cues.length;i<n;i++){var r=this.cues[i];r.startTime<=e&&r.endTime>=e?t.push(r):r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e&&t.push(r)}if(o=!1,t.length!==this.activeCues_.length)o=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(o=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),i.src?(t.src=i.src,t.preload_||(t.loaded_=!0),(t.preload_||r||"subtitles"!==i.kind&&"captions"!==i.kind)&&li(t.src,Ve(t))):t.loaded_=!0,t}Ge(e,l);var t=e.prototype;return t.addCue=function(e){var t=e;if(T.vttjs&&!(e instanceof T.vttjs.VTTCue)){for(var i in t=new T.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)i in t||(t[i]=e[i]);t.id=e.id,t.originalCue_=e}for(var n=this.tech_.textTracks(),r=0;r<n.length;r++)n[r]!==this&&n[r].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},t.removeCue=function(e){for(var t=this.cues_.length;t--;){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},e}(Jt);ci.prototype.allowedEvents_={cuechange:"cuechange"};var di=function(r){function e(e){var t;void 0===e&&(e={});var i=Re(e,{kind:Yt[e.kind]||""});t=r.call(this,i)||this;var n=!1;return Object.defineProperty(Ve(t),"enabled",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("enabledchange"))}}),i.enabled&&(t.enabled=i.enabled),t.loaded_=!0,t}return Ge(e,r),e}(Jt),hi=function(r){function e(e){var t;void 0===e&&(e={});var i=Re(e,{kind:Kt[e.kind]||""});t=r.call(this,i)||this;var n=!1;return Object.defineProperty(Ve(t),"selected",{get:function(){return n},set:function(e){"boolean"==typeof e&&e!==n&&(n=e,this.trigger("selectedchange"))}}),i.selected&&(t.selected=i.selected),t}return Ge(e,r),e}(Jt),pi=function(r){function e(e){var t,i;void 0===e&&(e={}),t=r.call(this)||this;var n=new ci(e);return t.kind=n.kind,t.src=n.src,t.srclang=n.language,t.label=n.label,t.default=n.default,Object.defineProperties(Ve(t),{readyState:{get:function(){return i}},track:{get:function(){return n}}}),i=0,n.addEventListener("loadeddata",function(){i=2,t.trigger({type:"load",target:Ve(t)})}),t}return Ge(e,r),e}(_e);pi.prototype.allowedEvents_={load:"load"},pi.NONE=0,pi.LOADING=1,pi.LOADED=2,pi.ERROR=3;var fi={audio:{ListClass:Ht,TrackClass:di,capitalName:"Audio"},video:{ListClass:Wt,TrackClass:hi,capitalName:"Video"},text:{ListClass:zt,TrackClass:ci,capitalName:"Text"}};Object.keys(fi).forEach(function(e){fi[e].getterName=e+"Tracks",fi[e].privateName=e+"Tracks_"});var mi={remoteText:{ListClass:zt,TrackClass:ci,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Gt,TrackClass:pi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},gi=m({},fi,mi);mi.names=Object.keys(mi),fi.names=Object.keys(fi),gi.names=[].concat(mi.names).concat(fi.names);var vi=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return yi.prototype=e,new yi};function yi(){}function _i(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function bi(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\\d+):(\\d{1,2})(:\\d{1,2})?\\.(\\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}function Ti(){this.values=vi(null)}function Si(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);if(2===s.length)t(s[0],s[1])}}function ki(t,e,s){var i=t;function n(){var e=bi(t);if(null===e)throw new _i(_i.Errors.BadTimeStamp,"Malformed timestamp: "+i);return t=t.replace(/^[^\\sa-zA-Z-]+/,""),e}function r(){t=t.replace(/^\\s+/,"")}if(r(),e.startTime=n(),r(),"--\\x3e"!==t.substr(0,3))throw new _i(_i.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by \'--\\x3e\'): "+i);t=t.substr(3),r(),e.endTime=n(),r(),function(e,t){var a=new Ti;Si(e,function(e,t){switch(e){case"region":for(var i=s.length-1;0<=i;i--)if(s[i].id===t){a.set(e,s[i].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var n=t.split(","),r=n[0];a.integer(e,r),a.percent(e,r)&&a.set("snapToLines",!1),a.alt(e,r,["auto"]),2===n.length&&a.alt("lineAlign",n[1],["start","center","end"]);break;case"position":n=t.split(","),a.percent(e,n[0]),2===n.length&&a.alt("positionAlign",n[1],["start","center","end"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","center","end","left","right"])}},/:/,/\\s/),t.region=a.get("region",null),t.vertical=a.get("vertical","");try{t.line=a.get("line","auto")}catch(e){}t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100);try{t.align=a.get("align","center")}catch(e){t.align=a.get("align","middle")}try{t.position=a.get("position","auto")}catch(e){t.position=a.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=a.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(t,e)}((_i.prototype=vi(Error.prototype)).constructor=_i).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Ti.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var Ci=d.createElement("textarea"),Ei={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},wi={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Ii={v:"title",lang:"lang"},Ai={rt:"ruby"};function xi(a,i){function e(){if(!i)return null;var e,t=i.match(/^([^<]*)(<[^>]*>?)?/);return e=t[1]?t[1]:t[2],i=i.substr(e.length),e}function t(e,t){var i=Ei[e];if(!i)return null;var n=a.document.createElement(i),r=Ii[e];return r&&t&&(n[r]=t.trim()),n}for(var n,r,s,o,u=a.document.createElement("div"),l=u,c=[];null!==(n=e());)if("<"!==n[0])l.appendChild(a.document.createTextNode((r=n,Ci.innerHTML=r,r=Ci.textContent,Ci.textContent="",r)));else{if("/"===n[1]){c.length&&c[c.length-1]===n.substr(2).replace(">","")&&(c.pop(),l=l.parentNode);continue}var d,h=bi(n.substr(1,n.length-2));if(h){d=a.document.createProcessingInstruction("timestamp",h),l.appendChild(d);continue}var p=n.match(/^<([^.\\s/0-9>]+)(\\.[^\\s\\\\>]+)?([^>\\\\]+)?(\\\\?)>?$/);if(!p)continue;if(!(d=t(p[1],p[3])))continue;if(s=l,Ai[(o=d).localName]&&Ai[o.localName]!==s.localName)continue;if(p[2]){var f=p[2].split(".");f.forEach(function(e){var t=/^bg_/.test(e),i=t?e.slice(3):e;if(wi.hasOwnProperty(i)){var n=t?"background-color":"color",r=wi[i];d.style[n]=r}}),d.className=f.join(" ")}c.push(p[1]),l.appendChild(d),l=d}return u}var Pi=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Li(e){for(var t=0;t<Pi.length;t++){var i=Pi[t];if(e>=i[0]&&e<=i[1])return!0}return!1}function Oi(){}function Di(e,t,i){Oi.call(this),this.cue=t,this.cueDiv=xi(e,t.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=e.document.createElement("div"),n={direction:function(e){var t=[],i="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var i=t.childNodes.length-1;0<=i;i--)e.push(t.childNodes[i])}function a(e){if(!e||!e.length)return null;var t=e.pop(),i=t.textContent||t.innerText;if(i){var n=i.match(/^.*(\\n|\\r)/);return n?n[e.length=0]:i}return"ruby"===t.tagName?a(e):t.childNodes?(r(e,t),a(e)):void 0}for(r(t,e);i=a(t);)for(var n=0;n<i.length;n++)if(Li(i.charCodeAt(n)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"center":r=t.position-t.size/2;break;case"end":r=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Mi(e){var t,i,n,r;if(e.div){i=e.div.offsetHeight,n=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||i,this.bottom=e.bottom||r+(e.height||i),this.width=e.width||n,this.lineHeight=void 0!==t?t:e.lineHeight}function Ri(e,t,o,u){var i=new Mi(t),n=t.cue,r=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,i=t.textTrackList,n=0,r=0;r<i.length&&i[r]!==t;r++)"showing"===i[r].mode&&n++;return-1*++n}(n),a=[];if(n.snapToLines){var s;switch(n.vertical){case"":a=["+y","-y"],s="height";break;case"rl":a=["+x","-x"],s="width";break;case"lr":a=["-x","+x"],s="width"}var l=i.lineHeight,c=l*Math.round(r),d=o[s]+l,h=a[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/l)*l),r<0&&(c+=""===n.vertical?o.height:o.width,a=a.reverse()),i.move(h,c)}else{var p=i.lineHeight/o.height*100;switch(n.lineAlign){case"center":r-=p/2;break;case"end":r-=p}switch(n.vertical){case"":t.applyStyles({top:t.formatStyle(r,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(r,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(r,"%")})}a=["+y","-x","+x","-y"],i=new Mi(t)}var f=function(e,t){for(var i,n=new Mi(e),r=1,a=0;a<t.length;a++){for(;e.overlapsOppositeAxis(o,t[a])||e.within(o)&&e.overlapsAny(u);)e.move(t[a]);if(e.within(o))return e;var s=e.intersectPercentage(o);s<r&&(i=new Mi(e),r=s),e=new Mi(n)}return i||n}(i,a);t.move(f.toCSSCompatValues(o))}function Ni(){}Oi.prototype.applyStyles=function(e,t){for(var i in t=t||this.div,e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},Oi.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Di.prototype=vi(Oi.prototype)).constructor=Di,Mi.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Mi.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Mi.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Mi.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Mi.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Mi.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Mi.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Mi.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||i}},Ni.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Ni.convertCueToDOMTree=function(e,t){return e&&t?xi(e,t):null};Ni.processCues=function(n,r,e){if(!n||!r||!e)return null;for(;e.firstChild;)e.removeChild(e.firstChild);var a=n.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",e.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(r)){var s=[],o=Mi.getSimpleBoxPosition(a),u={font:Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var e,t,i=0;i<r.length;i++)t=r[i],e=new Di(n,t,u),a.appendChild(e.div),Ri(0,e,o,s),t.displayState=e.div,s.push(Mi.getSimpleBoxPosition(e))}()}else for(var t=0;t<r.length;t++)a.appendChild(r[t].displayState)},(Ni.Parser=function(e,t,i){i||(i=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof _i))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var n=this;function t(){for(var e=n.buffer,t=0;t<e.length&&"\\r"!==e[t]&&"\\n"!==e[t];)++t;var i=e.substr(0,t);return"\\r"===e[t]&&++t,"\\n"===e[t]&&++t,n.buffer=e.substr(t),i}function i(e){e.match(/X-TIMESTAMP-MAP/)?Si(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":!function(e){var i=new Ti;Si(e,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",bi(t))}},/[^\\d]:/,/,/),n.ontimestampmap&&n.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}(t)}},/=/):Si(e,function(e,t){switch(e){case"Region":!function(e){var r=new Ti;if(Si(e,function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var n=new Ti;if(n.percent("x",i[0]),n.percent("y",i[1]),!n.has("x")||!n.has("y"))break;r.set(e+"X",n.get("x")),r.set(e+"Y",n.get("y"));break;case"scroll":r.alt(e,t,["up"])}},/=/,/\\s/),r.has("id")){var t=new(n.vttjs.VTTRegion||n.window.VTTRegion);t.width=r.get("width",100),t.lines=r.get("lines",3),t.regionAnchorX=r.get("regionanchorX",0),t.regionAnchorY=r.get("regionanchorY",100),t.viewportAnchorX=r.get("viewportanchorX",0),t.viewportAnchorY=r.get("viewportanchorY",100),t.scroll=r.get("scroll",""),n.onregion&&n.onregion(t),n.regionList.push({id:r.get("id"),region:t})}}(t)}},/:/)}e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===n.state){if(!/\\r\\n|\\n/.test(n.buffer))return this;var a=(r=t()).match(/^WEBVTT([ \\t].*)?$/);if(!a||!a[0])throw new _i(_i.Errors.BadSignature);n.state="HEADER"}for(var s=!1;n.buffer;){if(!/\\r\\n|\\n/.test(n.buffer))return this;switch(s?s=!1:r=t(),n.state){case"HEADER":/:/.test(r)?i(r):r||(n.state="ID");continue;case"NOTE":r||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \\t])/.test(r)){n.state="NOTE";break}if(!r)continue;n.cue=new(n.vttjs.VTTCue||n.window.VTTCue)(0,0,"");try{n.cue.align="center"}catch(e){n.cue.align="middle"}if(n.state="CUE",-1===r.indexOf("--\\x3e")){n.cue.id=r;continue}case"CUE":try{ki(r,n.cue,n.regionList)}catch(e){n.reportOrThrowError(e),n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var o=-1!==r.indexOf("--\\x3e");if(!r||o&&(s=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\\n"),n.cue.text+=r.replace(/\\u2028/g,"\\n").replace(/u2029/g,"\\n");continue;case"BADCUE":r||(n.state="ID");continue}}}catch(e){n.reportOrThrowError(e),"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\\n\\n",t.parse()),"INITIAL"===t.state)throw new _i(_i.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var Ui=Ni,Fi={"":1,lr:1,rl:1},Bi={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function ji(e){return"string"==typeof e&&(!!Bi[e.toLowerCase()]&&e.toLowerCase())}function Vi(e,t,i){this.hasBeenReset=!1;var n="",r=!1,a=e,s=t,o=i,u=null,l="",c=!0,d="auto",h="start",p="auto",f="auto",m=100,g="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(e){n=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");s=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return u},set:function(e){u=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return l},set:function(e){var t=function(e){return"string"==typeof e&&(!!Fi[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");l=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=ji(e);t&&(h=t,this.hasBeenReset=!0)}},position:{enumerable:!0,get:function(){return p},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");p=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return f},set:function(e){var t=ji(e);t&&(f=t,this.hasBeenReset=!0)}},size:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");m=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return g},set:function(e){var t=ji(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");g=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Vi.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var qi=Vi,Hi={"":!0,up:!0};function Wi(e){return"number"==typeof e&&0<=e&&e<=100}function zi(){var t=100,i=3,n=0,r=100,a=0,s=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!Wi(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");i=e}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(e){if(!Wi(e))throw new Error("RegionAnchorX must be between 0 and 100.");r=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!Wi(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!Wi(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!Wi(e))throw new Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return o},set:function(e){var t=function(e){return"string"==typeof e&&(!!Hi[e.toLowerCase()]&&e.toLowerCase())}(e);!1===t||(o=t)}}})}var Gi=i(function(e){var t=e.exports={WebVTT:Ui,VTTCue:qi,VTTRegion:zi};T.vttjs=t,T.WebVTT=t.WebVTT;var i=t.VTTCue,n=t.VTTRegion,r=T.VTTCue,a=T.VTTRegion;t.shim=function(){T.VTTCue=i,T.VTTRegion=n},t.restore=function(){T.VTTCue=r,T.VTTRegion=a},T.VTTCue||t.shim()});Gi.WebVTT,Gi.VTTCue,Gi.VTTRegion;var Xi=function(t){function i(i,e){var n;return void 0===i&&(i={}),void 0===e&&(e=function(){}),i.reportTouchActivity=!1,(n=t.call(this,null,i,e)||this).hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),gi.names.forEach(function(e){var t=gi[e];i&&i[t.getterName]&&(n[t.privateName]=i[t.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){!1===i["native"+e+"Tracks"]&&(n["featuresNative"+e+"Tracks"]=!1)}),!1===i.nativeCaptions||!1===i.nativeTextTracks?n.featuresNativeTextTracks=!1:!0!==i.nativeCaptions&&!0!==i.nativeTextTracks||(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.preloadTextTracks=!1!==i.preloadTextTracks,n.autoRemoteTextTracks_=new gi.text.ListClass,n.initTrackListeners(),i.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}Ge(i,t);var e=i.prototype;return e.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},e.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ve(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)},e.onDurationChange=function(e){this.duration_=this.duration()},e.buffered=function(){return gt(0,0)},e.bufferedPercent=function(){return vt(this.buffered(),this.duration_)},e.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.dispose=function(){this.clearTracks(fi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.clearTracks=function(e){var r=this;(e=[].concat(e)).forEach(function(e){for(var t=r[e+"Tracks"]()||[],i=t.length;i--;){var n=t[i];"text"===e&&r.removeRemoteTextTrack(n),t.removeTrack(n)}})},e.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var i=e[t];this.removeRemoteTextTrack(i)}},e.reset=function(){},e.crossOrigin=function(){},e.setCrossOrigin=function(){},e.error=function(e){return void 0!==e&&(this.error_=new Ct(e),this.trigger("error")),this.error_},e.played=function(){return this.hasStarted_?gt(0,0):gt()},e.setScrubbing=function(){},e.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.initTrackListeners=function(){var r=this;fi.names.forEach(function(e){function t(){r.trigger(e+"trackchange")}var i=fi[e],n=r[i.getterName]();n.addEventListener("removetrack",t),n.addEventListener("addtrack",t),r.on("dispose",function(){n.removeEventListener("removetrack",t),n.removeEventListener("addtrack",t)})})},e.addWebVttScript_=function(){var e=this;if(!T.WebVTT)if(d.body.contains(this.el())){if(!this.options_["vtt.js"]&&o(Gi)&&0<Object.keys(Gi).length)return void this.trigger("vttjsloaded");var t=d.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),T.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},e.emulateTextTracks=function(){function t(e){return n.addTrack(e.track)}function i(e){return n.removeTrack(e.track)}var e=this,n=this.textTracks(),r=this.remoteTextTracks();r.on("addtrack",t),r.on("removetrack",i),this.addWebVttScript_();function a(){return e.trigger("texttrackchange")}function s(){a();for(var e=0;e<n.length;e++){var t=n[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}}s(),n.addEventListener("change",s),n.addEventListener("addtrack",s),n.addEventListener("removetrack",s),this.on("dispose",function(){r.off("addtrack",t),r.off("removetrack",i),n.removeEventListener("change",s),n.removeEventListener("addtrack",s),n.removeEventListener("removetrack",s);for(var e=0;e<n.length;e++){n[e].removeEventListener("cuechange",a)}})},e.addTextTrack=function(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,i,n,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,i&&(r.label=i),n&&(r.language=n),r.tech=e;var s=new gi.text.TrackClass(r);return a.addTrack(s),s}(this,e,t,i)},e.createRemoteTextTrack=function(e){var t=Re(e,{tech:this});return new mi.remoteTextEl.TrackClass(t)},e.addRemoteTextTrack=function(e,t){var i=this;void 0===e&&(e={});var n=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(p.warn(\'Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js\'),t=!0),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),!0!==t&&this.ready(function(){return i.autoRemoteTextTracks_.addTrack(n.track)}),n},e.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},e.getVideoPlaybackQuality=function(){return{}},e.requestPictureInPicture=function(){var e=this.options_.Promise||T.Promise;if(e)return e.reject()},e.disablePictureInPicture=function(){return!0},e.setDisablePictureInPicture=function(){},e.setPoster=function(){},e.playsinline=function(){},e.setPlaysinline=function(){},e.overrideNativeAudioTracks=function(){},e.overrideNativeVideoTracks=function(){},e.canPlayType=function(){return""},i.canPlayType=function(){return""},i.canPlaySource=function(e,t){return i.canPlayType(e.type)},i.isTech=function(e){return e.prototype instanceof i||e instanceof i||e===i},i.registerTech=function(e,t){if(i.techs_||(i.techs_={}),!i.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!i.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!i.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Me(e),i.techs_[e]=t,i.techs_[De(e)]=t,"Tech"!==e&&i.defaultTechOrder_.push(e),t},i.getTech=function(e){if(e)return i.techs_&&i.techs_[e]?i.techs_[e]:(e=Me(e),T&&T.videojs&&T.videojs[e]?(p.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),T.videojs[e]):void 0)},i}(je);gi.names.forEach(function(e){var t=gi[e];Xi.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Xi.prototype.featuresVolumeControl=!0,Xi.prototype.featuresMuteControl=!0,Xi.prototype.featuresFullscreenResize=!1,Xi.prototype.featuresPlaybackRate=!1,Xi.prototype.featuresProgressEvents=!1,Xi.prototype.featuresSourceset=!1,Xi.prototype.featuresTimeupdateEvents=!1,Xi.prototype.featuresNativeTextTracks=!1,Xi.withSourceHandlers=function(r){r.registerSourceHandler=function(e,t){var i=r.sourceHandlers;i=i||(r.sourceHandlers=[]),void 0===t&&(t=i.length),i.splice(t,0,e)},r.canPlayType=function(e){for(var t,i=r.sourceHandlers||[],n=0;n<i.length;n++)if(t=i[n].canPlayType(e))return t;return""},r.selectSourceHandler=function(e,t){for(var i=r.sourceHandlers||[],n=0;n<i.length;n++)if(i[n].canHandleSource(e,t))return i[n];return null},r.canPlaySource=function(e,t){var i=r.selectSourceHandler(e,t);return i?i.canHandleSource(e,t):""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(e){var t=r.selectSourceHandler(e,this.options_);t||(r.nativeSourceHandler?t=r.nativeSourceHandler:p.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),t!==r.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=t.handleSource(e,this,this.options_),this.one("dispose",this.disposeSourceHandler)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},je.registerComponent("Tech",Xi),Xi.registerTech("Tech",Xi),Xi.defaultTechOrder_=[];var Ki={},Yi={},$i={};function Qi(e,t,i){e.setTimeout(function(){return function i(n,e,r,a,s,o){void 0===n&&(n={});void 0===e&&(e=[]);void 0===s&&(s=[]);void 0===o&&(o=!1);var t=e,u=t[0],l=t.slice(1);if("string"==typeof u)i(n,Ki[u],r,a,s,o);else if(u){var c=rn(a,u);if(!c.setSource)return s.push(c),i(n,l,r,a,s,o);c.setSource(g({},n),function(e,t){if(e)return i(n,l,r,a,s,o);s.push(c),i(t,n.type===t.type?l:Ki[t.type],r,a,s,o)})}else l.length?i(n,l,r,a,s,o):o?r(n,s):i(n,Ki["*"],r,a,s,!0)}(t,Ki[t.type],i,e)},1)}function Ji(e,t,i,n){void 0===n&&(n=null);var r="call"+Me(i),a=e.reduce(nn(r),n),s=a===$i,o=s?null:t[i](a);return function(e,t,i,n){for(var r=e.length-1;0<=r;r--){var a=e[r];a[t]&&a[t](n,i)}}(e,i,o,s),o}var Zi={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},en={setCurrentTime:1,setMuted:1,setVolume:1},tn={play:1,pause:1};function nn(i){return function(e,t){return e===$i?$i:t[i]?t[i](e):e}}function rn(e,t){var i=Yi[e.id()],n=null;if(null==i)return n=t(e),Yi[e.id()]=[[t,n]],n;for(var r=0;r<i.length;r++){var a=i[r],s=a[0],o=a[1];s===t&&(n=o)}return null===n&&(n=t(e),i.push([t,n])),n}function an(e){void 0===e&&(e="");var t=Vt(e);return sn[t.toLowerCase()]||""}var sn={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};function on(e){if(!e.type){var t=an(e.src);t&&(e.type=t)}return e}var un=function(l){function e(e,t,i){var n,r=Re({createEl:!1},t);if(n=l.call(this,e,r,i)||this,t.playerOptions.sources&&0!==t.playerOptions.sources.length)e.src(t.playerOptions.sources);else for(var a=0,s=t.playerOptions.techOrder;a<s.length;a++){var o=Me(s[a]),u=Xi.getTech(o);if(o||(u=je.getComponent(o)),u&&u.isSupported()){e.loadTech_(o);break}}return n}return Ge(e,l),e}(je);je.registerComponent("MediaLoader",un);var ln=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).emitTapEvents(),i.enable(),i}Ge(e,r);var t=e.prototype;return t.createEl=function(e,t,i){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===i&&(i={}),t=g({innerHTML:\'<span aria-hidden="true" class="vjs-icon-placeholder"></span>\',className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&p.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),i=g({role:"button"},i),this.tabIndex_=t.tabIndex;var n=r.prototype.createEl.call(this,e,t,i);return this.createControlTextEl(n),n},t.dispose=function(){this.controlTextEl_=null,r.prototype.dispose.call(this)},t.createControlTextEl=function(e){return this.controlTextEl_=k("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},t.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e,C(this.controlTextEl_,i),this.nonIconControl||t.setAttribute("title",i)},t.buildCSSClass=function(){return"vjs-control vjs-button "+r.prototype.buildCSSClass.call(this)},t.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!=typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},t.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!=typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},t.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},t.handleKeyDown=function(e){Ot.isEventKey(e,"Space")||Ot.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):r.prototype.handleKeyDown.call(this,e)},e}(je);je.registerComponent("ClickableComponent",ln);var cn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update(),e.on("posterchange",ve(Ve(i),i.update)),i}Ge(e,n);var t=e.prototype;return t.dispose=function(){this.player().off("posterchange",this.update),n.prototype.dispose.call(this)},t.createEl=function(){return k("div",{className:"vjs-poster",tabIndex:-1})},t.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},t.setSrc=function(e){var t="";e&&(t=\'url("\'+e+\'")\'),this.el_.style.backgroundImage=t},t.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&0<this.player_.eme.sessions.length;!this.player_.tech(!0)||(at||it)&&t||this.player_.tech(!0).focus(),this.player_.paused()?At(this.player_.play()):this.player_.pause()}},e}(ln);je.registerComponent("PosterImage",cn);var dn="#222",hn={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:\'"Andale Mono", "Lucida Console", monospace\',monospaceSerif:\'"Courier New", monospace\',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:\'"Comic Sans MS", Impact, fantasy\',script:\'"Monotype Corsiva", cursive\',smallcaps:\'"Andale Mono", "Lucida Console", monospace, sans-serif\'};function pn(e,t){var i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");i=e.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function fn(e,t,i){try{e.style[t]=i}catch(e){return}}var mn=function(a){function e(i,e,t){var n;n=a.call(this,i,e,t)||this;var r=ve(Ve(n),n.updateDisplay);return i.on("loadstart",ve(Ve(n),n.toggleDisplay)),i.on("texttrackchange",r),i.on("loadedmetadata",ve(Ve(n),n.preselectTrack)),i.ready(ve(Ve(n),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",r),i.on("playerresize",r),T.addEventListener("orientationchange",r),i.on("dispose",function(){return T.removeEventListener("orientationchange",r)});for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}})),n}Ge(e,a);var t=e.prototype;return t.preselectTrack=function(){for(var e,t,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,s=0;s<r.length;s++){var o=r[s];a&&a.enabled&&a.language&&a.language===o.language&&o.kind in n?i=o.kind===a.kind?o:i||o:a&&!a.enabled?t=e=i=null:o.default&&("descriptions"!==o.kind||e?o.kind in n&&!t&&(t=o):e=o)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},t.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){"function"==typeof T.WebVTT&&T.WebVTT.processCues(T,[],this.el_)},t.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var i=[],n=0;n<e.length;++n){var r=e[n];"showing"===r.mode&&i.push(r)}this.updateForTrack(i)}else{for(var a=null,s=null,o=e.length;o--;){var u=e[o];"showing"===u.mode&&("descriptions"===u.kind?a=u:s=u)}s?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(s)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},t.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),i=e.activeCues,n=i.length;n--;){var r=i[n];if(r){var a=r.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&fn(a.firstChild,"color",pn(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&fn(a.firstChild,"backgroundColor",pn(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?fn(a,"backgroundColor",pn(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+dn:"raised"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+dn:"depressed"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+dn:"uniform"===t.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+dn)),t.fontPercent&&1!==t.fontPercent){var s=T.parseFloat(a.style.fontSize);a.style.fontSize=s*t.fontPercent+"px",a.style.height="auto",a.style.top="auto"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=hn[t.fontFamily])}}},t.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"==typeof T.WebVTT&&!e.every(function(e){return!e.activeCues})){for(var t=[],i=0;i<e.length;++i)for(var n=e[i],r=0;r<n.activeCues.length;++r)t.push(n.activeCues[r]);T.WebVTT.processCues(T,t,this.el_);for(var a=0;a<e.length;++a){for(var s=e[a],o=0;o<s.activeCues.length;++o){var u=s.activeCues[o].displayState;I(u,"vjs-text-track-cue"),I(u,"vjs-text-track-cue-"+(s.language?s.language:a))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},e}(je);je.registerComponent("TextTrackDisplay",mn);var gn=function(r){function e(){return r.apply(this,arguments)||this}return Ge(e,r),e.prototype.createEl=function(){var e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=k("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[t])}),n=r.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return n.appendChild(i),n},e}(je);je.registerComponent("LoadingSpinner",gn);var vn=function(t){function e(){return t.apply(this,arguments)||this}Ge(e,t);var i=e.prototype;return i.createEl=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={}),t=g({innerHTML:\'<span aria-hidden="true" class="vjs-icon-placeholder"></span>\',className:this.buildCSSClass()},t),i=g({type:"button"},i);var n=je.prototype.createEl.call(this,"button",t,i);return this.createControlTextEl(n),n},i.addChild=function(e,t){void 0===t&&(t={});var i=this.constructor.name;return p.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead."),je.prototype.addChild.call(this,e,t)},i.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyDown=function(e){Ot.isEventKey(e,"Space")||Ot.isEventKey(e,"Enter")?e.stopPropagation():t.prototype.handleKeyDown.call(this,e)},e}(ln);je.registerComponent("Button",vn);var yn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).mouseused_=!1,i.on("mousedown",i.handleMouseDown),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var i=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&0<this.player_.eme.sessions.length;return At(t),void(!this.player_.tech(!0)||(at||it)&&i||this.player_.tech(!0).focus())}var n=this.player_.getChild("controlBar"),r=n&&n.getChild("playToggle");if(r){var a=function(){return r.focus()};It(t)?t.then(a,function(){}):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},t.handleKeyDown=function(e){this.mouseused_=!1,n.prototype.handleKeyDown.call(this,e)},t.handleMouseDown=function(e){this.mouseused_=!0},e}(vn);yn.prototype.controlText_="Play Video",je.registerComponent("BigPlayButton",yn);var _n=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).controlText(t&&t.controlText||i.localize("Close")),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-close-button "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},t.handleKeyDown=function(e){Ot.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):n.prototype.handleKeyDown.call(this,e)},e}(vn);je.registerComponent("CloseButton",_n);var bn=function(n){function e(e,t){var i;return void 0===t&&(t={}),i=n.call(this,e,t)||this,t.replay=void 0===t.replay||t.replay,i.on(e,"play",i.handlePlay),i.on(e,"pause",i.handlePause),t.replay&&i.on(e,"ended",i.handleEnded),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},t.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},t.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},t.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(vn);bn.prototype.controlText_="Play",je.registerComponent("PlayToggle",bn);function Tn(e,t){e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(r=n=i="-"),(r=0<r||0<s?r+":":"")+(n=((r||10<=a)&&n<10?"0"+n:n)+":")+(i=i<10?"0"+i:i)}var Sn=Tn;function kn(e,t){return void 0===t&&(t=e),Sn(e,t)}var Cn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,["timeupdate","ended"],i.updateContent),i.updateTextNode_(),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){var e=this.buildCSSClass(),t=n.prototype.createEl.call(this,"div",{className:e+" vjs-time-control vjs-control",innerHTML:\'<span class="vjs-control-text" role="presentation">\'+this.localize(this.labelText_)+"</span>"});return this.contentEl_=k("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),t.appendChild(this.contentEl_),t},t.dispose=function(){this.contentEl_=null,this.textNode_=null,n.prototype.dispose.call(this)},t.updateTextNode_=function(e){var t=this;void 0===e&&(e=0),e=kn(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(t.contentEl_){var e=t.textNode_;t.textNode_=d.createTextNode(t.formattedTime_),t.textNode_&&(e?t.contentEl_.replaceChild(t.textNode_,e):t.contentEl_.appendChild(t.textNode_))}}))},t.updateContent=function(e){},e}(je);Cn.prototype.labelText_="Time",Cn.prototype.controlText_="Time",je.registerComponent("TimeDisplay",Cn);var En=function(e){function t(){return e.apply(this,arguments)||this}Ge(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(Cn);En.prototype.labelText_="Current Time",En.prototype.controlText_="Current Time",je.registerComponent("CurrentTimeDisplay",En);var wn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"durationchange",i.updateContent),i.on(e,"loadstart",i.updateContent),i.on(e,"loadedmetadata",i.updateContent),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-duration"},t.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},e}(Cn);wn.prototype.labelText_="Duration",wn.prototype.controlText_="Duration",je.registerComponent("DurationDisplay",wn);var In=function(e){function t(){return e.apply(this,arguments)||this}return Ge(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(je);je.registerComponent("TimeDivider",In);var An=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"durationchange",i.updateContent),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-remaining-time"},t.createEl=function(){var e=n.prototype.createEl.call(this);return e.insertBefore(k("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e},t.updateContent=function(e){var t;"number"==typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},e}(Cn);An.prototype.labelText_="Remaining Time",An.prototype.controlText_="Remaining Time",je.registerComponent("RemainingTimeDisplay",An);var xn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateShowing(),i.on(i.player(),"durationchange",i.updateShowing),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=k("div",{className:"vjs-live-display",innerHTML:\'<span class="vjs-control-text">\'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},t.dispose=function(){this.contentEl_=null,n.prototype.dispose.call(this)},t.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},e}(je);je.registerComponent("LiveDisplay",xn);var Pn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateLiveEdgeStatus(),i.player_.liveTracker&&i.on(i.player_.liveTracker,"liveedgechange",i.updateLiveEdgeStatus),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=k("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},t.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},t.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},t.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,n.prototype.dispose.call(this)},e}(vn);Pn.prototype.controlText_="Seek to live, currently playing live",je.registerComponent("SeekToLive",Pn);function Ln(e,t,i){return e=Number(e),Math.min(i,Math.max(t,isNaN(e)?t:e))}var On=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.enable(),i}Ge(e,n);var t=e.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},t.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},t.createEl=function(e,t,i){return void 0===t&&(t={}),void 0===i&&(i={}),t.className=t.className+" vjs-slider",t=g({tabIndex:0},t),i=g({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),n.prototype.createEl.call(this,e,t,i)},t.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||nt||e.preventDefault(),R(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},t.handleMouseMove=function(e){},t.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;N(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},t.update=function(){var t=this;if(this.el_&&this.bar){var i=this.getProgress();return i===this.progress_||(this.progress_=i,this.requestNamedAnimationFrame("Slider#update",function(){var e=t.vertical()?"height":"width";t.bar.el().style[e]=(100*i).toFixed(2)+"%"})),i}},t.getProgress=function(){return Number(Ln(this.getPercent(),0,1).toFixed(4))},t.calculateDistance=function(e){var t=B(this.el_,e);return this.vertical()?t.y:t.x},t.handleKeyDown=function(e){Ot.isEventKey(e,"Left")||Ot.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):Ot.isEventKey(e,"Right")||Ot.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):n.prototype.handleKeyDown.call(this,e)},t.handleClick=function(e){e.stopPropagation(),e.preventDefault()},t.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(je);je.registerComponent("Slider",On);function Dn(e,t){return Ln(e/t*100,0,100).toFixed(2)+"%"}var Mn=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).partEls_=[],i.on(e,"progress",i.update),i}Ge(e,r);var t=e.prototype;return t.createEl=function(){var e=r.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),t=k("span",{className:"vjs-control-text"}),i=k("span",{textContent:this.localize("Loaded")}),n=d.createTextNode(": ");return this.percentageEl_=k("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(n),t.appendChild(this.percentageEl_),e},t.dispose=function(){this.partEls_=null,this.percentageEl_=null,r.prototype.dispose.call(this)},t.update=function(e){var d=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var e=d.player_.liveTracker,t=d.player_.buffered(),i=e&&e.isLive()?e.seekableEnd():d.player_.duration(),n=d.player_.bufferedEnd(),r=d.partEls_,a=Dn(n,i);d.percent_!==a&&(d.el_.style.width=a,C(d.percentageEl_,a),d.percent_=a);for(var s=0;s<t.length;s++){var o=t.start(s),u=t.end(s),l=r[s];l||(l=d.el_.appendChild(k()),r[s]=l),l.dataset.start===o&&l.dataset.end===u||(l.dataset.start=o,l.dataset.end=u,l.style.left=Dn(o,n),l.style.width=Dn(u-o,n))}for(var c=r.length;c>t.length;c--)d.el_.removeChild(r[c-1]);r.length=t.length})},e}(je);je.registerComponent("LoadProgressBar",Mn);var Rn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update=ye(ve(Ve(i),i.update),30),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},t.update=function(e,t,i){var n=F(this.el_),r=U(this.player_.el()),a=e.width*t;if(r&&n){var s=e.left-r.left+a,o=e.width-a+(r.right-e.right),u=n.width/2;s<u?u+=u-s:o<u&&(u=o),u<0?u=0:u>n.width&&(u=n.width),this.el_.style.right="-"+u+"px",this.write(i)}},t.write=function(e){C(this.el_,e)},t.updateTime=function(r,a,s,o){var u=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var e,t=u.player_.duration();if(u.player_.liveTracker&&u.player_.liveTracker.isLive()){var i=u.player_.liveTracker.liveWindow(),n=i-a*i;e=(n<1?"":"-")+kn(n,i)}else e=kn(s,t);u.update(r,a,e),o&&o()})},e}(je);je.registerComponent("TimeTooltip",Rn);var Nn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update=ye(ve(Ve(i),i.update),30),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},t.update=function(e,t){var i=this.getChild("timeTooltip");if(i){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,n)}},e}(je);Nn.prototype.options_={children:[]},dt||Je||Nn.prototype.options_.children.push("timeTooltip"),je.registerComponent("PlayProgressBar",Nn);var Un=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).update=ye(ve(Ve(i),i.update),30),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.update=function(e,t){var i=this,n=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,n,function(){i.el_.style.left=e.width*t+"px"})},e}(je);Un.prototype.options_={children:["timeTooltip"]},je.registerComponent("MouseTimeDisplay",Un);var Fn=function(a){function e(e,t){var i;return(i=a.call(this,e,t)||this).setEventHandlers_(),i}Ge(e,a);var t=e.prototype;return t.setEventHandlers_=function(){this.update_=ve(this,this.update),this.update=ye(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in d&&"visibilityState"in d&&this.on(d,"visibilitychange",this.toggleVisibility_)},t.toggleVisibility_=function(e){d.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},t.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},t.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},t.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update=function(e){var n=this,r=a.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),t=n.player_.liveTracker,i=n.player_.duration();t&&t.isLive()&&(i=n.player_.liveTracker.liveCurrentTime()),n.percent_!==r&&(n.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),n.percent_=r),n.currentTime_===e&&n.duration_===i||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[kn(e,i),kn(i,i)],"{1} of {2}")),n.currentTime_=e,n.duration_=i),n.bar&&n.bar.update(U(n.el()),n.getProgress())}),r},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.getPercent=function(){var e,t=this.getCurrentTime_(),i=this.player_.liveTracker;return i&&i.isLive()?(e=(t-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},t.handleMouseDown=function(e){z(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),a.prototype.handleMouseDown.call(this,e))},t.handleMouseMove=function(e){if(z(e)){var t,i=this.calculateDistance(e),n=this.player_.liveTracker;if(n&&n.isLive()){if(.99<=i)return void n.seekToLiveEdge();var r=n.seekableStart(),a=n.liveCurrentTime();if(a<=(t=r+i*n.liveWindow())&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=i*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},t.enable=function(){a.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},t.disable=function(){a.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},t.handleMouseUp=function(e){a.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?At(this.player_.play()):this.update_()},t.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},t.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},t.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyDown=function(e){if(Ot.isEventKey(e,"Space")||Ot.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(Ot.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(0);else if(Ot.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(Ot(e))){e.preventDefault(),e.stopPropagation();var t=10*(Ot.codes[Ot(e)]-Ot.codes[0])/100;this.player_.currentTime(this.player_.duration()*t)}else Ot.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):Ot.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):a.prototype.handleKeyDown.call(this,e)},t.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in d&&"visibilityState"in d&&this.off(d,"visibilitychange",this.toggleVisibility_),a.prototype.dispose.call(this)},e}(On);Fn.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},dt||Je||Fn.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),je.registerComponent("SeekBar",Fn);var Bn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).handleMouseMove=ye(ve(Ve(i),i.handleMouseMove),30),i.throttledHandleMouseSeek=ye(ve(Ve(i),i.handleMouseSeek),30),i.enable(),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var i=t.getChild("playProgressBar"),n=t.getChild("mouseTimeDisplay");if(i||n){var r=t.el(),a=F(r),s=B(r,e).x;s=Ln(s,0,1),n&&n.update(a,s),i&&i.update(a,t.getProgress())}}},t.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},t.enabled=function(){return this.enabled_},t.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},t.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},t.handleMouseDown=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},e}(je);Bn.prototype.options_={children:["seekBar"]},je.registerComponent("ProgressControl",Bn);var jn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,["enterpictureinpicture","leavepictureinpicture"],i.handlePictureInPictureChange),i.on(e,["disablepictureinpicturechanged","loadedmetadata"],i.handlePictureInPictureEnabledChange),i.disable(),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-picture-in-picture-control "+n.prototype.buildCSSClass.call(this)},t.handlePictureInPictureEnabledChange=function(){d.pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},t.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},t.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},e}(vn);jn.prototype.controlText_="Picture-in-Picture",je.registerComponent("PictureInPictureToggle",jn);var Vn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"fullscreenchange",i.handleFullscreenChange),!1===d[e.fsApi_.fullscreenEnabled]&&i.disable(),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-fullscreen-control "+n.prototype.buildCSSClass.call(this)},t.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},t.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(vn);Vn.prototype.controlText_="Fullscreen",je.registerComponent("FullscreenToggle",Vn);var qn=function(e){function t(){return e.apply(this,arguments)||this}return Ge(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:\'<span class="vjs-control-text"></span>\'})},t}(je);je.registerComponent("VolumeLevel",qn);var Hn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on("slideractive",i.updateLastVolume_),i.on(e,"volumechange",i.updateARIAAttributes),e.ready(function(){return i.updateARIAAttributes()}),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(e){z(e)&&n.prototype.handleMouseDown.call(this,e)},t.handleMouseMove=function(e){z(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},t.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},t.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},e}(On);Hn.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Hn.prototype.playerEvent="volumechange",je.registerComponent("VolumeBar",Hn);var Wn=function(n){function e(e,t){var i;return void 0===t&&(t={}),t.vertical=t.vertical||!1,"undefined"!=typeof t.volumeBar&&!o(t.volumeBar)||(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),i=n.call(this,e,t)||this,function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(Ve(i),e),i.throttledHandleMouseMove=ye(ve(Ve(i),i.handleMouseMove),30),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on(i.volumeBar,["focus","slideractive"],function(){i.volumeBar.addClass("vjs-slider-active"),i.addClass("vjs-slider-active"),i.trigger("slideractive")}),i.on(i.volumeBar,["blur","sliderinactive"],function(){i.volumeBar.removeClass("vjs-slider-active"),i.removeClass("vjs-slider-active"),i.trigger("sliderinactive")}),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},t.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},e}(je);Wn.prototype.options_={children:["volumeBar"]},je.registerComponent("VolumeControl",Wn);var zn=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(Ve(i),e),i.on(e,["loadstart","volumechange"],i.update),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(e){var t=this.player_.volume(),i=this.player_.lastVolume_();if(0===t){var n=i<.1?.1:i;this.player_.volume(n),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},t.update=function(e){this.updateIcon_(),this.updateControlText_()},t.updateIcon_=function(){var e=this.player_.volume(),t=3;dt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var i=0;i<4;i++)A(this.el_,"vjs-vol-"+i);I(this.el_,"vjs-vol-"+t)},t.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},e}(vn);zn.prototype.controlText_="Mute",je.registerComponent("MuteToggle",zn);var Gn=function(n){function e(e,t){var i;return void 0===t&&(t={}),"undefined"!=typeof t.inline?t.inline=t.inline:t.inline=!0,"undefined"!=typeof t.volumeControl&&!o(t.volumeControl)||(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),(i=n.call(this,e,t)||this).on(e,["loadstart"],i.volumePanelState_),i.on(i.muteToggle,"keyup",i.handleKeyPress),i.on(i.volumeControl,"keyup",i.handleVolumeControlKeyUp),i.on("keydown",i.handleKeyPress),i.on("mouseover",i.handleMouseOver),i.on("mouseout",i.handleMouseOut),i.on(i.volumeControl,["slideractive"],i.sliderActive_),i.on(i.volumeControl,["sliderinactive"],i.sliderInactive_),i}Ge(e,n);var t=e.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},t.dispose=function(){this.handleMouseOut(),n.prototype.dispose.call(this)},t.handleVolumeControlKeyUp=function(e){Ot.isEventKey(e,"Esc")&&this.muteToggle.focus()},t.handleMouseOver=function(e){this.addClass("vjs-hover"),he(d,"keyup",ve(this,this.handleKeyPress))},t.handleMouseOut=function(e){this.removeClass("vjs-hover"),pe(d,"keyup",ve(this,this.handleKeyPress))},t.handleKeyPress=function(e){Ot.isEventKey(e,"Esc")&&this.handleMouseOut()},e}(je);Gn.prototype.options_={children:["muteToggle","volumeControl"]},je.registerComponent("VolumePanel",Gn);var Xn=function(n){function e(e,t){var i;return i=n.call(this,e,t)||this,t&&(i.menuButton_=t.menuButton),i.focusedChild_=-1,i.on("keydown",i.handleKeyDown),i.boundHandleBlur_=ve(Ve(i),i.handleBlur),i.boundHandleTapClick_=ve(Ve(i),i.handleTapClick),i}Ge(e,n);var t=e.prototype;return t.addEventListenerForItem=function(e){e instanceof je&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},t.removeEventListenerForItem=function(e){e instanceof je&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},t.removeChild=function(e){"string"==typeof e&&(e=this.getChild(e)),this.removeEventListenerForItem(e),n.prototype.removeChild.call(this,e)},t.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},t.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=k(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=n.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),he(t,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),t},t.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,n.prototype.dispose.call(this)},t.handleBlur=function(e){var t=e.relatedTarget||d.activeElement;if(!this.children().some(function(e){return e.el()===t})){var i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}},t.handleTapClick=function(t){if(this.menuButton_){this.menuButton_.unpressButton();var e=this.children();if(!Array.isArray(e))return;var i=e.filter(function(e){return e.el()===t.target})[0];if(!i)return;"CaptionSettingsMenuItem"!==i.name()&&this.menuButton_.focus()}},t.handleKeyDown=function(e){Ot.isEventKey(e,"Left")||Ot.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(Ot.isEventKey(e,"Right")||Ot.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},t.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},t.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},t.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},e}(je);je.registerComponent("Menu",Xn);var Kn=function(r){function e(e,t){var i;void 0===t&&(t={}),(i=r.call(this,e,t)||this).menuButton_=new vn(e,t),i.menuButton_.controlText(i.controlText_),i.menuButton_.el_.setAttribute("aria-haspopup","true");var n=vn.prototype.buildCSSClass();return i.menuButton_.el_.className=i.buildCSSClass()+" "+n,i.menuButton_.removeClass("vjs-control"),i.addChild(i.menuButton_),i.update(),i.enabled_=!0,i.on(i.menuButton_,"tap",i.handleClick),i.on(i.menuButton_,"click",i.handleClick),i.on(i.menuButton_,"keydown",i.handleKeyDown),i.on(i.menuButton_,"mouseenter",function(){i.addClass("vjs-hover"),i.menu.show(),he(d,"keyup",ve(Ve(i),i.handleMenuKeyUp))}),i.on("mouseleave",i.handleMouseLeave),i.on("keydown",i.handleSubmenuKeyDown),i}Ge(e,r);var t=e.prototype;return t.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},t.createMenu=function(){var e=new Xn(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=k("li",{className:"vjs-menu-title",innerHTML:Me(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var i=new je(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)e.addItem(this.items[n]);return e},t.createItems=function(){},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},t.buildWrapperCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+vn.prototype.buildCSSClass()+" "+r.prototype.buildCSSClass.call(this)},t.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+r.prototype.buildCSSClass.call(this)},t.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},t.dispose=function(){this.handleMouseLeave(),r.prototype.dispose.call(this)},t.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},t.handleMouseLeave=function(e){this.removeClass("vjs-hover"),pe(d,"keyup",ve(this,this.handleMenuKeyUp))},t.focus=function(){this.menuButton_.focus()},t.blur=function(){this.menuButton_.blur()},t.handleKeyDown=function(e){Ot.isEventKey(e,"Esc")||Ot.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),Ot.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(Ot.isEventKey(e,"Up")||Ot.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},t.handleMenuKeyUp=function(e){(Ot.isEventKey(e,"Esc")||Ot.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},t.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},t.handleSubmenuKeyDown=function(e){(Ot.isEventKey(e,"Esc")||Ot.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),Ot.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},t.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),dt&&b())return;this.menu.focus()}},t.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},t.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},t.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(je);je.registerComponent("MenuButton",Kn);var Yn=function(a){function e(e,t){var i,n=t.tracks;if((i=a.call(this,e,t)||this).items.length<=1&&i.hide(),!n)return Ve(i);var r=ve(Ve(i),i.update);return n.addEventListener("removetrack",r),n.addEventListener("addtrack",r),i.player_.on("ready",r),i.player_.on("dispose",function(){n.removeEventListener("removetrack",r),n.removeEventListener("addtrack",r)}),i}return Ge(e,a),e}(Kn);je.registerComponent("TrackButton",Yn);var $n=["Tab","Esc","Up","Down","Right","Left"],Qn=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).selectable=t.selectable,i.isSelected_=t.selected||!1,i.multiSelectable=t.multiSelectable,i.selected(i.isSelected_),i.selectable?i.multiSelectable?i.el_.setAttribute("role","menuitemcheckbox"):i.el_.setAttribute("role","menuitemradio"):i.el_.setAttribute("role","menuitem"),i}Ge(e,n);var t=e.prototype;return t.createEl=function(e,t,i){return this.nonIconControl=!0,n.prototype.createEl.call(this,"li",g({className:"vjs-menu-item",innerHTML:\'<span class="vjs-menu-item-text">\'+this.localize(this.options_.label)+"</span>",tabIndex:-1},t),i)},t.handleKeyDown=function(t){$n.some(function(e){return Ot.isEventKey(t,e)})||n.prototype.handleKeyDown.call(this,t)},t.handleClick=function(e){this.selected(!0)},t.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(ln);je.registerComponent("MenuItem",Qn);var Jn=function(u){function e(e,t){var n,i=t.track,r=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected="showing"===i.mode,(n=u.call(this,e,t)||this).track=i,n.kinds=(t.kinds||[t.kind||n.track.kind]).filter(Boolean);function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply(Ve(n),t)}function s(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleSelectedLanguageChange.apply(Ve(n),t)}var o;e.on(["loadstart","texttrackchange"],a),r.addEventListener("change",a),r.addEventListener("selectedlanguagechange",s),n.on("dispose",function(){e.off(["loadstart","texttrackchange"],a),r.removeEventListener("change",a),r.removeEventListener("selectedlanguagechange",s)}),void 0===r.onchange&&n.on(["tap","click"],function(){if("object"!=typeof T.Event)try{o=new T.Event("change")}catch(e){}o||(o=d.createEvent("Event")).initEvent("change",!0,!0),r.dispatchEvent(o)});return n.handleTracksChange(),n}Ge(e,u);var t=e.prototype;return t.handleClick=function(e){var t=this.track,i=this.player_.textTracks();if(u.prototype.handleClick.call(this,e),i)for(var n=0;n<i.length;n++){var r=i[n];-1!==this.kinds.indexOf(r.kind)&&(r===t?"showing"!==r.mode&&(r.mode="showing"):"disabled"!==r.mode&&(r.mode="disabled"))}},t.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},t.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},t.dispose=function(){this.track=null,u.prototype.dispose.call(this)},e}(Qn);je.registerComponent("TextTrackMenuItem",Jn);var Zn=function(i){function e(e,t){return t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,i.call(this,e,t)||this}Ge(e,i);var t=e.prototype;return t.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!0,n=0,r=t.length;n<r;n++){var a=t[n];if(-1<this.options_.kinds.indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i!==this.isSelected_&&this.selected(i)},t.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),i=!0,n=0,r=t.length;n<r;n++){var a=t[n];if(-1<["captions","descriptions","subtitles"].indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(Jn);je.registerComponent("OffTextTrackMenuItem",Zn);var er=function(i){function e(e,t){return void 0===t&&(t={}),t.tracks=e.textTracks(),i.call(this,e,t)||this}return Ge(e,i),e.prototype.createItems=function(e,t){var i;void 0===e&&(e=[]),void 0===t&&(t=Jn),this.label_&&(i=this.label_+" off"),e.push(new Zn(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;var n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<n.length;r++){var a=n[r];if(-1<this.kinds_.indexOf(a.kind)){var s=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});s.addClass("vjs-"+a.kind+"-menu-item"),e.push(s)}}return e},e}(Yn);je.registerComponent("TextTrackButton",er);var tr=function(s){function e(e,t){var i,n=t.track,r=t.cue,a=e.currentTime();return t.selectable=!0,t.multiSelectable=!1,t.label=r.text,t.selected=r.startTime<=a&&a<r.endTime,(i=s.call(this,e,t)||this).track=n,i.cue=r,n.addEventListener("cuechange",ve(Ve(i),i.update)),i}Ge(e,s);var t=e.prototype;return t.handleClick=function(e){s.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},t.update=function(e){var t=this.cue,i=this.player_.currentTime();this.selected(t.startTime<=i&&i<t.endTime)},e}(Qn);je.registerComponent("ChaptersTrackMenuItem",tr);var ir=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildWrapperCSSClass.call(this)},t.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),n.prototype.update.call(this)},t.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_)}}},t.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var i=e[t];if(i.kind===this.kind_)return i}},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Me(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),n.prototype.createMenu.call(this)},t.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var i=0,n=t.length;i<n;i++){var r=t[i],a=new tr(this.player_,{track:this.track_,cue:r});e.push(a)}return e},e}(er);ir.prototype.kind_="chapters",ir.prototype.controlText_="Chapters",je.registerComponent("ChaptersButton",ir);var nr=function(s){function e(e,t,i){var n;n=s.call(this,e,t,i)||this;var r=e.textTracks(),a=ve(Ve(n),n.handleTracksChange);return r.addEventListener("change",a),n.on("dispose",function(){r.removeEventListener("change",a)}),n}Ge(e,s);var t=e.prototype;return t.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!1,n=0,r=t.length;n<r;n++){var a=t[n];if(a.kind!==this.kind_&&"showing"===a.mode){i=!0;break}}i?this.disable():this.enable()},t.buildCSSClass=function(){return"vjs-descriptions-button "+s.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+s.prototype.buildWrapperCSSClass.call(this)},e}(er);nr.prototype.kind_="descriptions",nr.prototype.controlText_="Descriptions",je.registerComponent("DescriptionsButton",nr);var rr=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildWrapperCSSClass.call(this)},e}(er);rr.prototype.kind_="subtitles",rr.prototype.controlText_="Subtitles",je.registerComponent("SubtitlesButton",rr);var ar=function(n){function e(e,t){var i;return t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",(i=n.call(this,e,t)||this).addClass("vjs-texttrack-settings"),i.controlText(", opens "+t.kind+" settings dialog"),i}return Ge(e,n),e.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},e}(Jn);je.registerComponent("CaptionSettingsMenuItem",ar);var sr=function(n){function e(e,t,i){return n.call(this,e,t,i)||this}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-captions-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-captions-button "+n.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new ar(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,e)},e}(er);sr.prototype.kind_="captions",sr.prototype.controlText_="Captions",je.registerComponent("CaptionsButton",sr);var or=function(r){function e(){return r.apply(this,arguments)||this}return Ge(e,r),e.prototype.createEl=function(e,t,i){var n=\'<span class="vjs-menu-item-text">\'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(n+=\'\\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\\n        <span class="vjs-control-text"> \'+this.localize("Captions")+"</span>\\n      "),n+="</span>",r.prototype.createEl.call(this,e,g({innerHTML:n},t),i)},e}(Jn);je.registerComponent("SubsCapsMenuItem",or);var ur=function(n){function e(e,t){var i;return void 0===t&&(t={}),(i=n.call(this,e,t)||this).label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(i.player_.language_)&&(i.label_="captions"),i.menuButton_.controlText(Me(i.label_)),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new ar(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=n.prototype.createItems.call(this,e,or)},e}(er);ur.prototype.kinds_=["captions","subtitles"],ur.prototype.controlText_="Subtitles",je.registerComponent("SubsCapsButton",ur);var lr=function(s){function e(e,t){var n,i=t.track,r=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,(n=s.call(this,e,t)||this).track=i,n.addClass("vjs-"+i.kind+"-menu-item");function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply(Ve(n),t)}return r.addEventListener("change",a),n.on("dispose",function(){r.removeEventListener("change",a)}),n}Ge(e,s);var t=e.prototype;return t.createEl=function(e,t,i){var n=\'<span class="vjs-menu-item-text">\'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(n+=\'\\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\\n        <span class="vjs-control-text"> \'+this.localize("Descriptions")+"</span>\\n      "),n+="</span>",s.prototype.createEl.call(this,e,g({innerHTML:n},t),i)},t.handleClick=function(e){var t=this.player_.audioTracks();s.prototype.handleClick.call(this,e);for(var i=0;i<t.length;i++){var n=t[i];n.enabled=n===this.track}},t.handleTracksChange=function(e){this.selected(this.track.enabled)},e}(Qn);je.registerComponent("AudioTrackMenuItem",lr);var cr=function(i){function e(e,t){return void 0===t&&(t={}),t.tracks=e.audioTracks(),i.call(this,e,t)||this}Ge(e,i);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-audio-button "+i.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-audio-button "+i.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),i=0;i<t.length;i++){var n=t[i];e.push(new lr(this.player_,{track:n,selectable:!0,multiSelectable:!1}))}return e},e}(Yn);cr.prototype.controlText_="Audio Track",je.registerComponent("AudioTrackButton",cr);var dr=function(a){function e(e,t){var i,n=t.rate,r=parseFloat(n,10);return t.label=n,t.selected=1===r,t.selectable=!0,t.multiSelectable=!1,(i=a.call(this,e,t)||this).label=n,i.rate=r,i.on(e,"ratechange",i.update),i}Ge(e,a);var t=e.prototype;return t.handleClick=function(e){a.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},t.update=function(e){this.selected(this.player().playbackRate()===this.rate)},e}(Qn);dr.prototype.contentElType="button",je.registerComponent("PlaybackRateMenuItem",dr);var hr=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).updateVisibility(),i.updateLabel(),i.on(e,"loadstart",i.updateVisibility),i.on(e,"ratechange",i.updateLabel),i}Ge(e,n);var t=e.prototype;return t.createEl=function(){var e=n.prototype.createEl.call(this);return this.labelEl_=k("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},t.dispose=function(){this.labelEl_=null,n.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildWrapperCSSClass.call(this)},t.createMenu=function(){var e=new Xn(this.player()),t=this.playbackRates();if(t)for(var i=t.length-1;0<=i;i--)e.addChild(new dr(this.player(),{rate:t[i]+"x"}));return e},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(e){for(var t=this.player().playbackRate(),i=this.playbackRates(),n=i[0],r=0;r<i.length;r++)if(i[r]>t){n=i[r];break}this.player().playbackRate(n)},t.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},t.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(Kn);hr.prototype.controlText_="Playback Rate",je.registerComponent("PlaybackRateMenuButton",hr);var pr=function(e){function t(){return e.apply(this,arguments)||this}Ge(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(je);je.registerComponent("Spacer",pr);var fr=function(t){function e(){return t.apply(this,arguments)||this}Ge(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},i.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="",e},e}(pr);je.registerComponent("CustomControlSpacer",fr);var mr=function(e){function t(){return e.apply(this,arguments)||this}return Ge(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(je);mr.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in d&&mr.prototype.options_.children.splice(mr.prototype.options_.children.length-1,0,"pictureInPictureToggle"),je.registerComponent("ControlBar",mr);var gr=function(n){function e(e,t){var i;return(i=n.call(this,e,t)||this).on(e,"error",i.open),i}Ge(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-error-display "+n.prototype.buildCSSClass.call(this)},t.content=function(){var e=this.player().error();return e?this.localize(e.message):""},e}(Mt);gr.prototype.options_=m({},Mt.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),je.registerComponent("ErrorDisplay",gr);var vr="vjs-text-track-settings",yr=["#000","Black"],_r=["#00F","Blue"],br=["#0FF","Cyan"],Tr=["#0F0","Green"],Sr=["#F0F","Magenta"],kr=["#F00","Red"],Cr=["#FFF","White"],Er=["#FF0","Yellow"],wr=["1","Opaque"],Ir=["0.5","Semi-Transparent"],Ar=["0","Transparent"],xr={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[yr,Cr,kr,Tr,_r,Er,Sr,br]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[wr,Ir,Ar]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Cr,yr,kr,Tr,_r,Er,Sr,br]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[wr,Ir]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ar,Ir,wr]}};function Pr(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}xr.windowColor.options=xr.backgroundColor.options;var Lr=function(n){function e(e,t){var i;return t.temporary=!1,(i=n.call(this,e,t)||this).updateDisplay=ve(Ve(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=k("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===t.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),r(xr,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}Ge(e,n);var t=e.prototype;return t.dispose=function(){this.endDialog=null,n.prototype.dispose.call(this)},t.createElSelect_=function(e,t,i){var n=this;void 0===t&&(t=""),void 0===i&&(i="label");var r=xr[e],a=r.id.replace("%s",this.id_),s=[t,a].join(" ").trim();return["<"+i+\' id="\'+a+\'" class="\'+("label"===i?"vjs-label":"")+\'">\',this.localize(r.label),"</"+i+">",\'<select aria-labelledby="\'+s+\'">\'].concat(r.options.map(function(e){var t=a+"-"+e[1].replace(/\\W+/g,"");return[\'<option id="\'+t+\'" value="\'+e[0]+\'" \',\'aria-labelledby="\'+s+" "+t+\'">\',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return[\'<fieldset class="vjs-fg-color vjs-track-setting">\',\'<legend id="\'+e+\'">\',this.localize("Text"),"</legend>",this.createElSelect_("color",e),\'<span class="vjs-text-opacity vjs-opacity">\',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var e="captions-background-"+this.id_;return[\'<fieldset class="vjs-bg-color vjs-track-setting">\',\'<legend id="\'+e+\'">\',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),\'<span class="vjs-bg-opacity vjs-opacity">\',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var e="captions-window-"+this.id_;return[\'<fieldset class="vjs-window-color vjs-track-setting">\',\'<legend id="\'+e+\'">\',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),\'<span class="vjs-window-opacity vjs-opacity">\',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return k("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return k("div",{className:"vjs-track-settings-font",innerHTML:[\'<fieldset class="vjs-font-percent vjs-track-setting">\',this.createElSelect_("fontPercent","","legend"),"</fieldset>",\'<fieldset class="vjs-edge-style vjs-track-setting">\',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",\'<fieldset class="vjs-font-family vjs-track-setting">\',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var e=this.localize("restore all settings to the default values");return k("div",{className:"vjs-track-settings-controls",innerHTML:[\'<button type="button" class="vjs-default-button" title="\'+e+\'">\',this.localize("Reset"),\'<span class="vjs-control-text"> \'+e+"</span>","</button>",\'<button type="button" class="vjs-done-button">\'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var r=this;return function(i,n,e){return void 0===e&&(e=0),a(i).reduce(function(e,t){return n(e,i[t],t)},e)}(xr,function(e,t,i){var n=function(e,t){return Pr(e.options[e.options.selectedIndex].value,t)}(r.$(t.selector),t.parser);return void 0!==n&&(e[i]=n),e},{})},t.setValues=function(i){var n=this;r(xr,function(e,t){!function(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(Pr(e.options[n].value,i)===t){e.selectedIndex=n;break}}(n.$(e.selector),i[t],e.parser)})},t.setDefaults=function(){var i=this;r(xr,function(e){var t=e.hasOwnProperty("default")?e.default:0;i.$(e.selector).selectedIndex=t})},t.restoreSettings=function(){var e;try{e=JSON.parse(T.localStorage.getItem(vr))}catch(e){p.warn(e)}e&&this.setValues(e)},t.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?T.localStorage.setItem(vr,JSON.stringify(e)):T.localStorage.removeItem(vr)}catch(e){p.warn(e)}}},t.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},e}(Mt);je.registerComponent("TextTrackSettings",Lr);var Or=function(a){function e(e,t){var i,n=t.ResizeObserver||T.ResizeObserver;null===t.ResizeObserver&&(n=!1);var r=Re({createEl:!n,reportTouchActivity:!1},t);return(i=a.call(this,e,r)||this).ResizeObserver=t.ResizeObserver||T.ResizeObserver,i.loadListener_=null,i.resizeObserver_=null,i.debouncedHandler_=function(n,r,a,s){var o;void 0===s&&(s=T);function e(){var e=this,t=arguments,i=function(){i=o=null,a||n.apply(e,t)};!o&&a&&n.apply(e,t),s.clearTimeout(o),o=s.setTimeout(i,r)}return e.cancel=function(){s.clearTimeout(o),o=null},e}(function(){i.resizeHandler()},100,!1,Ve(i)),n?(i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_),i.resizeObserver_.observe(e.el())):(i.loadListener_=function(){if(i.el_&&i.el_.contentWindow){var e=i.debouncedHandler_,t=i.unloadListener_=function(){pe(this,"resize",e),pe(this,"unload",t),t=null};he(i.el_.contentWindow,"unload",t),he(i.el_.contentWindow,"resize",e)}},i.one("load",i.loadListener_)),i}Ge(e,a);var t=e.prototype;return t.createEl=function(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},t.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},t.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,a.prototype.dispose.call(this)},e}(je);je.registerComponent("ResizeManager",Or);var Dr={trackingThreshold:30,liveTolerance:15},Mr=function(r){function e(e,t){var i,n=Re(Dr,t,{createEl:!1});return(i=r.call(this,e,n)||this).reset_(),i.on(i.player_,"durationchange",i.handleDurationchange),at&&"hidden"in d&&"visibilityState"in d&&i.on(d,"visibilitychange",i.handleVisibilityChange),i}Ge(e,r);var t=e.prototype;return t.handleVisibilityChange=function(){this.player_.duration()===1/0&&(d.hidden?this.stopTracking():this.startTracking())},t.trackLive_=function(){var e=this.player_.seekable();if(e&&e.length){var t=Number(T.performance.now().toFixed(4)),i=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i;var n=this.liveCurrentTime(),r=this.player_.currentTime(),a=this.player_.paused()||this.seekedBehindLive_||Math.abs(n-r)>this.options_.liveTolerance;this.timeupdateSeen_&&n!==1/0||(a=!1),a!==this.behindLiveEdge_&&(this.behindLiveEdge_=a,this.trigger("liveedgechange"))}},t.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},t.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},t.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},t.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&2<e,this.skipNextSeeked_=!1,this.trackLive_()},t.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},t.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},t.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},t.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0},t.seekableStart=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0},t.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},t.isLive=function(){return this.isTracking()},t.atLiveEdge=function(){return!this.behindLiveEdge()},t.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},t.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},t.behindLiveEdge=function(){return this.behindLiveEdge_},t.isTracking=function(){return"number"==typeof this.trackingInterval_},t.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},t.dispose=function(){this.off(d,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),r.prototype.dispose.call(this)},e}(je);je.registerComponent("LiveTracker",Mr);function Rr(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var i=e.$$("source"),n=[],r="";if(!i.length)return!1;for(var a=0;a<i.length;a++){var s=i[a].src;s&&-1===n.indexOf(s)&&n.push(s)}return!!n.length&&(1===n.length&&(r=n[0]),e.triggerSourceset(r),!0)}function Nr(e,t){for(var i={},n=0;n<e.length&&!((i=Object.getOwnPropertyDescriptor(e[n],t))&&i.set&&i.get);n++);return i.enumerable=!0,i.configurable=!0,i}function Ur(a){var s=a.el();if(!s.resetSourceWatch_){var t={},e=function(e){return Nr([e.el(),T.HTMLMediaElement.prototype,T.Element.prototype,Vr],"innerHTML")}(a),i=function(r){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=r.apply(s,t);return Rr(a),n}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){s[e]&&(t[e]=s[e],s[e]=i(t[e]))}),Object.defineProperty(s,"innerHTML",Re(e,{set:i(e.set)})),s.resetSourceWatch_=function(){s.resetSourceWatch_=null,Object.keys(t).forEach(function(e){s[e]=t[e]}),Object.defineProperty(s,"innerHTML",e)},a.one("sourceset",s.resetSourceWatch_)}}function Fr(n){if(n.featuresSourceset){var r=n.el();if(!r.resetSourceset_){var i=function(e){return Nr([e.el(),T.HTMLMediaElement.prototype,qr],"src")}(n),a=r.setAttribute,t=r.load;Object.defineProperty(r,"src",Re(i,{set:function(e){var t=i.set.call(r,e);return n.triggerSourceset(r.src),t}})),r.setAttribute=function(e,t){var i=a.call(r,e,t);return/src/i.test(e)&&n.triggerSourceset(r.src),i},r.load=function(){var e=t.call(r);return Rr(n)||(n.triggerSourceset(""),Ur(n)),e},r.currentSrc?n.triggerSourceset(r.currentSrc):Rr(n)||Ur(n),r.resetSourceset_=function(){r.resetSourceset_=null,r.load=t,r.setAttribute=a,Object.defineProperty(r,"src",i),r.resetSourceWatch_&&r.resetSourceWatch_()}}}}function Br(t,i,n,e){function r(e){return Object.defineProperty(t,i,{value:e,enumerable:!0,writable:!0})}void 0===e&&(e=!0);var a={configurable:!0,enumerable:!0,get:function(){var e=n();return r(e),e}};return e&&(a.set=r),Object.defineProperty(t,i,a)}var jr,Vr=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=d.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var i=d.createDocumentFragment();t.childNodes.length;)i.appendChild(t.childNodes[0]);return this.innerText="",T.Element.prototype.appendChild.call(this,i),this.innerHTML}}),qr=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?jt(T.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return T.Element.prototype.setAttribute.call(this,"src",e),e}}),Hr=function(c){function o(e,t){var i;i=c.call(this,e,t)||this;var n=e.source,r=!1;if(n&&(i.el_.currentSrc!==n.src||e.tag&&3===e.tag.initNetworkState_)?i.setSource(n):i.handleLateInit_(i.el_),e.enableSourceset&&i.setupSourcesetHandling_(),i.el_.hasChildNodes()){for(var a=i.el_.childNodes,s=a.length,o=[];s--;){var u=a[s];"track"===u.nodeName.toLowerCase()&&(i.featuresNativeTextTracks?(i.remoteTextTrackEls().addTrackElement_(u),i.remoteTextTracks().addTrack(u.track),i.textTracks().addTrack(u.track),r||i.el_.hasAttribute("crossorigin")||!qt(u.src)||(r=!0)):o.push(u))}for(var l=0;l<o.length;l++)i.el_.removeChild(o[l])}return i.proxyNativeTracks_(),i.featuresNativeTextTracks&&r&&p.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn\'t used.\\nThis may prevent text tracks from loading."),i.restoreMetadataTracksInIOSNativePlayer_(),(ut||ct||et)&&!0===e.nativeControlsForTouch&&i.setControls(!0),i.proxyWebkitFullscreen_(),i.triggerReady(),i}Ge(o,c);var e=o.prototype;return e.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),o.disposeMediaElement(this.el_),this.options_=null,c.prototype.dispose.call(this)},e.setupSourcesetHandling_=function(){Fr(this)},e.restoreMetadataTracksInIOSNativePlayer_=function(){function e(){i=[];for(var e=0;e<n.length;e++){var t=n[e];"metadata"===t.kind&&i.push({track:t,storedMode:t.mode})}}var i,n=this.textTracks();e(),n.addEventListener("change",e),this.on("dispose",function(){return n.removeEventListener("change",e)});function r(){for(var e=0;e<i.length;e++){var t=i[e];"disabled"===t.track.mode&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode)}n.removeEventListener("change",r)}this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",e),n.removeEventListener("change",r),n.addEventListener("change",r)}),this.on("webkitendfullscreen",function(){n.removeEventListener("change",e),n.addEventListener("change",e),n.removeEventListener("change",r)})},e.overrideNative_=function(e,t){var i=this;if(t===this["featuresNative"+e+"Tracks"]){var n=e.toLowerCase();this[n+"TracksListeners_"]&&Object.keys(this[n+"TracksListeners_"]).forEach(function(e){i.el()[n+"Tracks"].removeEventListener(e,i[n+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[n+"TracksListeners_"]=null,this.proxyNativeTracksForType_(n)}},e.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},e.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},e.proxyNativeTracksForType_=function(i){var n=this,e=fi[i],r=this.el()[e.getterName],a=this[e.getterName]();if(this["featuresNative"+e.capitalName+"Tracks"]&&r&&r.addEventListener){var s={change:function(e){var t={type:"change",target:a,currentTarget:a,srcElement:a};a.trigger(t),"text"===i&&n[mi.remoteText.getterName]().trigger(t)},addtrack:function(e){a.addTrack(e.track)},removetrack:function(e){a.removeTrack(e.track)}},t=function(){for(var e=[],t=0;t<a.length;t++){for(var i=!1,n=0;n<r.length;n++)if(r[n]===a[t]){i=!0;break}i||e.push(a[t])}for(;e.length;)a.removeTrack(e.shift())};this[e.getterName+"Listeners_"]=s,Object.keys(s).forEach(function(t){var i=s[t];r.addEventListener(t,i),n.on("dispose",function(e){return r.removeEventListener(t,i)})}),this.on("loadstart",t),this.on("dispose",function(e){return n.off("loadstart",t)})}},e.proxyNativeTracks_=function(){var t=this;fi.names.forEach(function(e){t.proxyNativeTracksForType_(e)})},e.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),o.disposeMediaElement(e),e=t}else{e=d.createElement("video");var i=Re({},this.options_.tag&&L(this.options_.tag));ut&&!0===this.options_.nativeControlsForTouch||delete i.controls,P(e,g(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}"undefined"!=typeof this.options_.preload&&D(e,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);for(var n=["loop","muted","playsinline","autoplay"],r=0;r<n.length;r++){var a=n[r],s=this.options_[a];"undefined"!=typeof s&&(s?D(e,a,a):M(e,a),e[a]=s)}return e},e.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,i=function(){t=!0};this.on("loadstart",i);var n=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",n),void this.ready(function(){this.off("loadstart",i),this.off("loadedmetadata",n),t||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),2<=e.readyState&&r.push("loadeddata"),3<=e.readyState&&r.push("canplay"),4<=e.readyState&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})}},e.setScrubbing=function(e){this.isScrubbing_=e},e.setCurrentTime=function(e){try{this.isScrubbing_&&this.el_.fastSeek&&ht?this.el_.fastSeek(e):this.el_.currentTime=e}catch(e){p(e,"Video is not ready. (Video.js)")}},e.duration=function(){var t=this;if(this.el_.duration===1/0&&Je&&nt&&0===this.el_.currentTime){return this.on("timeupdate",function e(){0<t.el_.currentTime&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))}),NaN}return this.el_.duration||NaN},e.width=function(){return this.el_.offsetWidth},e.height=function(){return this.el_.offsetHeight},e.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},i=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",function(){e.off("webkitbeginfullscreen",i),e.off("webkitendfullscreen",t)})}},e.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=T.navigator&&T.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},e.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)At(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},e.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},e.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},e.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},e.reset=function(){o.resetMediaElement(this.el_)},e.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.setControls=function(e){this.el_.controls=!!e},e.addTextTrack=function(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):c.prototype.addTextTrack.call(this,e,t,i)},e.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return c.prototype.createRemoteTextTrack.call(this,e);var t=d.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t},e.addRemoteTextTrack=function(e,t){var i=c.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},e.removeRemoteTextTrack=function(e){if(c.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),i=t.length;i--;)e!==t[i]&&e!==t[i].track||this.el().removeChild(t[i])},e.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return"undefined"!=typeof this.el().webkitDroppedFrameCount&&"undefined"!=typeof this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),T.performance&&"function"==typeof T.performance.now?e.creationTime=T.performance.now():T.performance&&T.performance.timing&&"number"==typeof T.performance.timing.navigationStart&&(e.creationTime=T.Date.now()-T.performance.timing.navigationStart),e},o}(Xi);Br(Hr,"TEST_VID",function(){if(y()){var e=d.createElement("video"),t=d.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}}),Hr.isSupported=function(){try{Hr.TEST_VID.volume=.5}catch(e){return!1}return!(!Hr.TEST_VID||!Hr.TEST_VID.canPlayType)},Hr.canPlayType=function(e){return Hr.TEST_VID.canPlayType(e)},Hr.canPlaySource=function(e,t){return Hr.canPlayType(e.type)},Hr.canControlVolume=function(){try{var e=Hr.TEST_VID.volume;return Hr.TEST_VID.volume=e/2+.1,e!==Hr.TEST_VID.volume}catch(e){return!1}},Hr.canMuteVolume=function(){try{var e=Hr.TEST_VID.muted;return Hr.TEST_VID.muted=!e,Hr.TEST_VID.muted?D(Hr.TEST_VID,"muted","muted"):M(Hr.TEST_VID,"muted"),e!==Hr.TEST_VID.muted}catch(e){return!1}},Hr.canControlPlaybackRate=function(){if(Je&&nt&&rt<58)return!1;try{var e=Hr.TEST_VID.playbackRate;return Hr.TEST_VID.playbackRate=e/2+.1,e!==Hr.TEST_VID.playbackRate}catch(e){return!1}},Hr.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(d.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(d.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(d.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(d.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Hr.supportsNativeTextTracks=function(){return ht||dt&&nt},Hr.supportsNativeVideoTracks=function(){return!(!Hr.TEST_VID||!Hr.TEST_VID.videoTracks)},Hr.supportsNativeAudioTracks=function(){return!(!Hr.TEST_VID||!Hr.TEST_VID.audioTracks)},Hr.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(e){var t=e[0],i=e[1];Br(Hr.prototype,t,function(){return Hr[i]()},!0)}),Hr.prototype.movingMediaElementInDOM=!dt,Hr.prototype.featuresFullscreenResize=!0,Hr.prototype.featuresProgressEvents=!0,Hr.prototype.featuresTimeupdateEvents=!0,Hr.patchCanPlayType=function(){4<=Ze&&!tt&&!nt&&(jr=Hr.TEST_VID&&Hr.TEST_VID.constructor.prototype.canPlayType,Hr.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\\/(?:x-|vnd\\.apple\\.)mpegurl/i.test(e)?"maybe":jr.call(this,e)})},Hr.unpatchCanPlayType=function(){var e=Hr.TEST_VID.constructor.prototype.canPlayType;return jr&&(Hr.TEST_VID.constructor.prototype.canPlayType=jr),e},Hr.patchCanPlayType(),Hr.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Hr.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),i=t.length;i--;)e.removeChild(t[i]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Hr.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Hr.prototype["set"+Me(t)]=function(e){(this.el_[t]=e)?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(e){Hr.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(t){Hr.prototype["set"+Me(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(e){Hr.prototype[e]=function(){return this.el_[e]()}}),Xi.withSourceHandlers(Hr),Hr.nativeSourceHandler={},Hr.nativeSourceHandler.canPlayType=function(e){try{return Hr.TEST_VID.canPlayType(e)}catch(e){return""}},Hr.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Hr.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=Vt(e.src);return Hr.nativeSourceHandler.canPlayType("video/"+i)}return""},Hr.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},Hr.nativeSourceHandler.dispose=function(){},Hr.registerSourceHandler(Hr.nativeSourceHandler),Xi.registerTech("Html5",Hr);var Wr=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],zr={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Gr=["tiny","xsmall","small","medium","large","xlarge","huge"],Xr={};Gr.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Xr[e]="vjs-layout-"+t});var Kr={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Yr=function(c){function l(e,t,i){var n;if(e.id=e.id||t.id||"vjs_video_"+re(),(t=g(l.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var r=e.closest("[lang]");r&&r.getAttribute&&(t.language=r.getAttribute("lang"))}else for(var a=e;a&&1===a.nodeType;){if(L(a).hasOwnProperty("lang")){t.language=a.getAttribute("lang");break}a=a.parentNode}if((n=c.call(this,null,t,i)||this).boundDocumentFullscreenChange_=ve(Ve(n),n.documentFullscreenChange_),n.boundFullWindowOnEscKey_=ve(Ve(n),n.fullWindowOnEscKey),n.isFullscreen_=!1,n.log=f(n.id_),n.fsApi_=_t,n.isPosterFromTech_=!1,n.queuedCallbacks_=[],n.isReady_=!1,n.hasStarted_=!1,n.userActive_=!1,n.debugEnabled_=!1,!n.options_||!n.options_.techOrder||!n.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(n.tag=e,n.tagAttributes=e&&L(e),n.language(n.options_.language),t.languages){var s={};Object.getOwnPropertyNames(t.languages).forEach(function(e){s[e.toLowerCase()]=t.languages[e]}),n.languages_=s}else n.languages_=l.prototype.options_.languages;n.resetCache_(),n.poster_=t.poster||"",n.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),n.changingSrc_=!1,n.playCallbacks_=[],n.playTerminatedQueue_=[],e.hasAttribute("autoplay")?n.autoplay(!0):n.autoplay(n.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(e){if("function"!=typeof n[e])throw new Error(\'plugin "\'+e+\'" does not exist\')}),n.scrubbing_=!1,n.el_=n.createEl(),Pe(Ve(n),{eventBusKey:"el_"}),n.fsApi_.requestFullscreen&&(he(d,n.fsApi_.fullscreenchange,n.boundDocumentFullscreenChange_),n.on(n.fsApi_.fullscreenchange,n.boundDocumentFullscreenChange_)),n.fluid_&&n.on("playerreset",n.updateStyleEl_);var o=Re(n.options_);t.plugins&&Object.keys(t.plugins).forEach(function(e){n[e](t.plugins[e])}),t.debug&&n.debug(!0),n.options_.playerOptions=o,n.middleware_=[],n.initChildren(),n.isAudio("audio"===e.nodeName.toLowerCase()),n.controls()?n.addClass("vjs-controls-enabled"):n.addClass("vjs-controls-disabled"),n.el_.setAttribute("role","region"),n.isAudio()?n.el_.setAttribute("aria-label",n.localize("Audio Player")):n.el_.setAttribute("aria-label",n.localize("Video Player")),n.isAudio()&&n.addClass("vjs-audio"),n.flexNotSupported_()&&n.addClass("vjs-no-flex"),ut&&n.addClass("vjs-touch-enabled"),dt||n.addClass("vjs-workinghover"),l.players[n.id_]=Ve(n);var u=h.split(".")[0];return n.addClass("vjs-v"+u),n.userActive(!0),n.reportUserActivity(),n.one("play",n.listenForUserActivity_),n.on("stageclick",n.handleStageClick_),n.on("keydown",n.handleKeyDown),n.breakpoints(n.options_.breakpoints),n.responsive(n.options_.responsive),n}Ge(l,c);var e=l.prototype;return e.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),pe(d,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),pe(d,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),l.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function(e){Yi[e.id()]=null}(this),gi.names.forEach(function(e){var t=gi[e],i=n[t.getterName]();i&&i.off&&i.off()}),c.prototype.dispose.call(this)},e.createEl=function(){var t,i=this.tag,e=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),n="video-js"===this.tag.tagName.toLowerCase();e?t=this.el_=i.parentNode:n||(t=this.el_=c.prototype.createEl.call(this,"div"));var r=L(i);if(n){for(t=this.el_=i,i=this.tag=d.createElement("video");t.children.length;)i.appendChild(t.firstChild);w(t,"video-js")||I(t,"video-js"),t.appendChild(i),e=this.playerElIngest_=t,Object.keys(t).forEach(function(e){try{i[e]=t[e]}catch(e){}})}if(i.setAttribute("tabindex","-1"),r.tabindex="-1",(at||nt&&ot)&&(i.setAttribute("role","application"),r.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in r&&delete r.width,"height"in r&&delete r.height,Object.getOwnPropertyNames(r).forEach(function(e){n&&"class"===e||t.setAttribute(e,r[e]),n&&i.setAttribute(e,r[e])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=t.player=this,this.addClass("vjs-paused"),!0!==T.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=ee("vjs-styles-dimensions");var a=X(".vjs-styles-defaults"),s=X("head");s.insertBefore(this.styleEl_,a?a.nextSibling:s.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var o=i.getElementsByTagName("a"),u=0;u<o.length;u++){var l=o.item(u);I(l,"vjs-hidden"),l.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!e&&i.parentNode.insertBefore(t,i),E(i,t),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=t},e.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):p.warn(\'crossOrigin must be "anonymous" or "use-credentials", given "\'+e+\'"\')},e.width=function(e){return this.dimension("width",e)},e.height=function(e){return this.dimension("height",e)},e.dimension=function(e,t){var i=e+"_";if(void 0===t)return this[i]||0;if(""===t||"auto"===t)return this[i]=void 0,void this.updateStyleEl_();var n=parseFloat(t);isNaN(n)?p.error(\'Improper value "\'+t+\'" supplied for for \'+e):(this[i]=n,this.updateStyleEl_())},e.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,Ae(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),function(e,t){Ae(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))}(function(){this.on("playerreset",this.updateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},e.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\\d+\\:\\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},e.updateStyleEl_=function(){if(!0!==T.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,i,n=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),r=n[1]/n[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/r:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*r,i=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(i),te(this.styleEl_,"\\n      ."+i+" {\\n        width: "+e+"px;\\n        height: "+t+"px;\\n      }\\n\\n      ."+i+".vjs-fluid {\\n        padding-top: "+100*r+"%;\\n      }\\n    ")}else{var a="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,o=this.tech_&&this.tech_.el();o&&(0<=a&&(o.width=a),0<=s&&(o.height=s))}},e.loadTech_=function(e,t){var i=this;this.tech_&&this.unloadTech_();var n=Me(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==n&&this.tag&&(Xi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};gi.names.forEach(function(e){var t=gi[e];a[t.getterName]=i[t.privateName]}),g(a,this.options_[n]),g(a,this.options_[r]),g(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var s=Xi.getTech(e);if(!s)throw new Error("No Tech named \'"+n+"\' exists! \'"+n+"\' should be registered using videojs.registerTech()\'");this.tech_=new s(a),this.tech_.ready(ve(this,this.handleTechReady_),!0),Lt(this.textTracksJson_||[],this.tech_),Wr.forEach(function(e){i.on(i.tech_,e,i["handleTech"+Me(e)+"_"])}),Object.keys(zr).forEach(function(t){i.on(i.tech_,t,function(e){0===i.tech_.playbackRate()&&i.tech_.seeking()?i.queuedCallbacks_.push({callback:i["handleTech"+zr[t]+"_"].bind(i),event:e}):i["handleTech"+zr[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===n&&this.tag||E(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.unloadTech_=function(){var i=this;gi.names.forEach(function(e){var t=gi[e];i[t.privateName]=i[t.getterName]()}),this.textTracksJson_=Pt(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.tech=function(e){return void 0===e&&p.warn("Using the tech directly can be dangerous. I hope you know what you\'re doing.\\nSee https://github.com/videojs/video.js/issues/2617 for more info.\\n"),this.tech_},e.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},e.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},e.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},e.manualAutoplay_=function(t){var n=this;if(this.tech_&&"string"==typeof t){var e,i=function(){var e=n.muted();n.muted(!0);function t(){n.muted(e)}n.playTerminatedQueue_.push(t);var i=n.play();if(It(i))return i.catch(t)};if("any"===t&&!0!==this.muted()?It(e=this.play())&&(e=e.catch(i)):e="muted"===t&&!0!==this.muted()?i():this.play(),It(e))return e.then(function(){n.trigger({type:"autoplay-success",autoplay:t})}).catch(function(e){n.trigger({type:"autoplay-failure",autoplay:t})})}},e.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter(function(e){return e.src===t});if(i.length)return i[0].type;for(var n=e.$$("source"),r=0;r<n.length;r++){var a=n[r];if(a.type&&a.src&&a.src===t)return a.type}return an(t)}(this,t)),this.cache_.source=Re({},e,{src:t,type:i});for(var n=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],a=this.$$("source"),s=[],o=0;o<a.length;o++){var u=L(a[o]);r.push(u),u.src&&u.src===t&&s.push(u.src)}s.length&&!n.length?this.cache_.sources=r:n.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},e.handleTechSourceset_=function(e){var i=this;if(!this.changingSrc_){var t=function(e){return i.updateSourceCaches_(e)},n=this.currentSource().src,r=e.src;n&&!/^blob:/.test(n)&&/^blob:/.test(r)&&(this.lastSource_&&(this.lastSource_.tech===r||this.lastSource_.player===n)||(t=function(){})),t(r),e.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var t=i.techGet("currentSrc");i.lastSource_.tech=t,i.updateSourceCaches_(t)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},e.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},e.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting");var i=this.currentTime();this.on("timeupdate",function e(){i!==t.currentTime()&&(t.removeClass("vjs-waiting"),t.off("timeupdate",e))})},e.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},e.handleTechFirstPlay_=function(){this.options_.starttime&&(p.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.handleTechClick_=function(e){z(e)&&this.controls_&&(this.paused()?At(this.play()):this.pause())},e.handleTechDoubleClick_=function(t){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,t):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},e.handleTechTap_=function(){this.userActive(!this.userActive())},e.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.handleTechTouchEnd_=function(e){e.preventDefault()},e.handleStageClick_=function(){this.reportUserActivity()},e.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.documentFullscreenChange_=function(e){var t=e.target.player;if(!t||t===this){var i=this.el(),n=d[this.fsApi_.fullscreenElement]===i;!n&&i.matches?n=i.matches(":"+this.fsApi_.fullscreen):!n&&i.msMatchesSelector&&(n=i.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(n)}},e.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},e.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},e.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},e.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},e.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},e.handleTechError_=function(){var e=this.tech_.error();this.error(e)},e.handleTechTextData_=function(e,t){var i=null;1<arguments.length&&(i=t),this.trigger("textdata",i)},e.getCache=function(){return this.cache_},e.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},e.techCall_=function(e,t){this.ready(function(){if(e in en)return function(e,t,i,n){return t[i](e.reduce(nn(i),n))}(this.middleware_,this.tech_,e,t);if(e in tn)return Ji(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw p(e),e}},!0)},e.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in Zi)return function(e,t,i){return e.reduceRight(nn(i),t[i]())}(this.middleware_,this.tech_,t);if(t in tn)return Ji(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw p("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw p("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw p(e),e}}},e.play=function(){var t=this,e=this.options_.Promise||T.Promise;return e?new e(function(e){t.play_(e)}):this.play_()},e.play_=function(e){var t=this;void 0===e&&(e=At),this.playCallbacks_.push(e);var i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(i||!ht&&!dt||this.load());var n=this.techGet_("play");null===n?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(n)},e.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},e.runPlayCallbacks_=function(t){var e=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],e.forEach(function(e){e(t)})},e.pause=function(){this.techCall_("pause")},e.paused=function(){return!1!==this.techGet_("paused")},e.played=function(){return this.techGet_("played")||gt(0,0)},e.scrubbing=function(e){if("undefined"==typeof e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.currentTime=function(e){return"undefined"!=typeof e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},e.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},e.remainingTime=function(){return this.duration()-this.currentTime()},e.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=gt(0,0)),e},e.bufferedPercent=function(){return vt(this.buffered(),this.duration())},e.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),i=e.end(e.length-1);return t<i&&(i=t),i},e.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},e.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},e.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},e.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},e.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.isFullscreen=function(e){if(void 0===e)return this.isFullscreen_;var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()},e.requestFullscreen=function(s){var e=this.options_.Promise||T.Promise;if(e){var o=this;return new e(function(e,i){function n(){o.off("fullscreenerror",r),o.off("fullscreenchange",t)}function t(){n(),e()}function r(e,t){n(),i(t)}o.one("fullscreenchange",t),o.one("fullscreenerror",r);var a=o.requestFullscreenHelper_(s);if(a)return a.then(n,n),a})}return this.requestFullscreenHelper_()},e.requestFullscreenHelper_=function(e){var t,i=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var n=this.el_[this.fsApi_.requestFullscreen](t);return n&&n.then(function(){return i.isFullscreen(!0)},function(){return i.isFullscreen(!1)}),n}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},e.exitFullscreen=function(){var e=this.options_.Promise||T.Promise;if(e){var s=this;return new e(function(e,i){function n(){s.off("fullscreenerror",r),s.off("fullscreenchange",t)}function t(){n(),e()}function r(e,t){n(),i(t)}s.one("fullscreenchange",t),s.one("fullscreenerror",r);var a=s.exitFullscreenHelper_();if(a)return a.then(n,n),a})}return this.exitFullscreenHelper_()},e.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=d[this.fsApi_.exitFullscreen]();return t&&t.then(function(){return e.isFullscreen(!1)}),t}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},e.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=d.documentElement.style.overflow,he(d,"keydown",this.boundFullWindowOnEscKey_),d.documentElement.style.overflow="hidden",I(d.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.fullWindowOnEscKey=function(e){Ot.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,pe(d,"keydown",this.boundFullWindowOnEscKey_),d.documentElement.style.overflow=this.docOrigOverflow,A(d.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.disablePictureInPicture=function(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")},e.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},e.requestPictureInPicture=function(){if("pictureInPictureEnabled"in d&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},e.exitPictureInPicture=function(){if("pictureInPictureEnabled"in d)return d.exitPictureInPicture()},e.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){!function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)}(this.el_.ownerDocument.activeElement)&&("function"==typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},e.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},i=t.fullscreenKey,n=void 0===i?function(e){return Ot.isEventKey(e,"f")}:i,r=t.muteKey,a=void 0===r?function(e){return Ot.isEventKey(e,"m")}:r,s=t.playPauseKey,o=void 0===s?function(e){return Ot.isEventKey(e,"k")||Ot.isEventKey(e,"Space")}:s;if(n.call(this,e)){e.preventDefault(),e.stopPropagation();var u=je.getComponent("FullscreenToggle");!1!==d[this.fsApi_.fullscreenEnabled]&&u.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation(),je.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(o.call(this,e)){e.preventDefault(),e.stopPropagation(),je.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},e.canPlayType=function(e){for(var t,i=0,n=this.options_.techOrder;i<n.length;i++){var r=n[i],a=Xi.getTech(r);if(a=a||je.getComponent(r)){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else p.error(\'The "\'+r+\'" tech is undefined. Skipped browser support check for that tech.\')}return""},e.selectSource=function(e){function t(e,i,n){var r;return e.some(function(t){return i.some(function(e){if(r=n(t,e))return!0})}),r}function i(e,t){var i=e[0];if(e[1].canPlaySource(t,r.options_[i.toLowerCase()]))return{source:t,tech:i}}var n,r=this,a=this.options_.techOrder.map(function(e){return[e,Xi.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];return i?i.isSupported():(p.error(\'The "\'+t+\'" tech is undefined. Skipped browser support check for that tech.\'),!1)});return(this.options_.sourceOrder?t(e,a,(n=i,function(e,t){return n(t,e)})):t(a,e,i))||!1},e.src=function(e){var i=this;if("undefined"==typeof e)return this.cache_.src||"";var n=function t(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){e=t(e),Array.isArray(e)?i=i.concat(e):s(e)&&i.push(e)}),e=i}else e="string"==typeof e&&e.trim()?[on({src:e})]:s(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[on(e)]:[];return e}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),Qi(this,n[0],function(e,t){if(i.middleware_=t,i.cache_.sources=n,i.updateSourceCaches_(e),i.src_(e))return 1<n.length?i.src(n.slice(1)):(i.changingSrc_=!1,i.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void i.triggerReady());!function(e,t){e.forEach(function(e){return e.setTech&&e.setTech(t)})}(t,i.tech_)})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},e.src_=function(e){var t=this,i=this.selectSource([e]);return!i||(function(e,t){return Me(e)===Me(t)}(i.tech,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(function(){t.changingSrc_=!1})),!1)},e.load=function(){this.techCall_("load")},e.reset=function(){var e=this,t=this.options_.Promise||T.Promise;this.paused()||!t?this.doReset_():At(this.play().then(function(){return e.doReset_()}))},e.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Ae(this)&&this.trigger("playerreset")},e.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},e.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,i=e.remainingTimeDisplay;t&&t.updateContent(),i&&i.updateContent()},e.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},e.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},e.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},e.currentSource=function(){return this.cache_.source||{}},e.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},e.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t="undefined"==typeof t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},e.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},e.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},e.poster=function(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Ct(e),this.addClass("vjs-error"),p.error("(CODE:"+this.error_.code+" "+Ct.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},e.reportUserActivity=function(e){this.userActivity_=!0},e.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.listenForUserActivity_=function(){function e(e){r(),this.clearInterval(t)}var t,i,n,r=ve(this,this.reportUserActivity);this.on("mousedown",function(){r(),this.clearInterval(t),t=this.setInterval(r,250)}),this.on("mousemove",function(e){e.screenX===i&&e.screenY===n||(i=e.screenX,n=e.screenY,r())}),this.on("mouseup",e),this.on("mouseleave",e);var a,s=this.getChild("controlBar");!s||dt||Je||(s.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),s.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",r),this.on("keyup",r),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},e.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},e.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},e.addTextTrack=function(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)},e.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},e.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)},e.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},e.languages=function(){return Re(l.prototype.options_.languages,this.languages_)},e.toJSON=function(){var e=Re(this.options_),t=e.tracks;e.tracks=[];for(var i=0;i<t.length;i++){var n=t[i];(n=Re(n)).player=void 0,e.tracks[i]=n}return e},e.createModal=function(e,t){var i=this;(t=t||{}).content=e||"";var n=new Mt(this,t);return this.addChild(n),n.on("dispose",function(){i.removeChild(n)}),n.open(),n},e.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),i=0;i<Gr.length;i++){var n=Gr[i];if(t<=this.breakpoints_[n]){if(e===n)return;e&&this.removeClass(Xr[e]),this.addClass(Xr[n]),this.breakpoint_=n;break}}},e.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},e.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=g({},Kr,e),this.updateCurrentBreakpoint_()),g(this.breakpoints_)},e.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},e.currentBreakpoint=function(){return this.breakpoint_},e.currentBreakpointClass=function(){return Xr[this.breakpoint_]||""},e.loadMedia=function(e,t){var i=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=Re(e);var n=this.cache_.media,r=n.artwork,a=n.poster,s=n.src,o=n.textTracks;!r&&a&&(this.cache_.media.artwork=[{src:a,type:an(a)}]),s&&this.src(s),a&&this.poster(a),Array.isArray(o)&&o.forEach(function(e){return i.addRemoteTextTrack(e,!1)}),this.ready(t)}},e.getMedia=function(){if(this.cache_.media)return Re(this.cache_.media);var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:an(t.poster)}]),t},l.getTagSettings=function(e){var t={sources:[],tracks:[]},i=L(e),n=i["data-setup"];if(w(e,"vjs-fill")&&(i.fill=!0),w(e,"vjs-fluid")&&(i.fluid=!0),null!==n){var r=wt(n||"{}"),a=r[0],s=r[1];a&&p.error(a),g(i,s)}if(g(t,i),e.hasChildNodes())for(var o=e.childNodes,u=0,l=o.length;u<l;u++){var c=o[u],d=c.nodeName.toLowerCase();"source"===d?t.sources.push(L(c)):"track"===d&&t.tracks.push(L(c))}return t},e.flexNotSupported_=function(){var e=d.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},e.debug=function(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},l}(je);gi.names.forEach(function(e){var t=gi[e];Yr.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),Yr.prototype.crossorigin=Yr.prototype.crossOrigin,Yr.players={};var $r=T.navigator;Yr.prototype.options_={techOrder:Xi.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:$r&&($r.languages&&$r.languages[0]||$r.userLanguage||$r.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){Yr.prototype[e]=function(){return this.techGet_(e)}}),Wr.forEach(function(e){Yr.prototype["handleTech"+Me(e)+"_"]=function(){return this.trigger(e)}}),je.registerComponent("Player",Yr);var Qr=i(function(i){function n(e,t){return i.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}i.exports=n});function Jr(e){return oa.hasOwnProperty(e)}function Zr(e){return Jr(e)?oa[e]:void 0}function ea(e,t){e[sa]=e[sa]||{},e[sa][t]=!0}function ta(e,t,i){var n=(i?"before":"")+"pluginsetup";e.trigger(n,t),e.trigger(n+":"+t.name,t)}function ia(r,a){return a.prototype.name=r,function(){ta(this,{name:r,plugin:a,instance:null},!0);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=ra(a,[this].concat(t));return this[r]=function(){return n},ta(this,n.getEventHash()),n}}var na=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}},ra=i(function(n){function r(e,t,i){return na()?n.exports=r=Reflect.construct:n.exports=r=function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&Qr(r,i.prototype),r},r.apply(null,arguments)}n.exports=r}),aa="plugin",sa="activePlugins_",oa={},ua=function(){function i(e){if(this.constructor===i)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Pe(this),delete this.trigger,Oe(this,this.constructor.defaultState),ea(e,this.name),this.dispose=ve(this,this.dispose),e.on("dispose",this.dispose)}var e=i.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},e.trigger=function(e,t){return void 0===t&&(t={}),fe(this.eventBusEl_,e,this.getEventHash(t))},e.handleStateChanged=function(e){},e.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[sa][e]=!1,this.player=this.state=null,t[e]=ia(e,oa[e])},i.isBasic=function(e){var t="string"==typeof e?Zr(e):e;return"function"==typeof t&&!i.prototype.isPrototypeOf(t.prototype)},i.registerPlugin=function(e,t){if("string"!=typeof e)throw new Error(\'Illegal plugin name, "\'+e+\'", must be a string, was \'+typeof e+".");if(Jr(e))p.warn(\'A plugin named "\'+e+\'" already exists. You may want to avoid re-registering plugins!\');else if(Yr.prototype.hasOwnProperty(e))throw new Error(\'Illegal plugin name, "\'+e+\'", cannot share a name with an existing player method!\');if("function"!=typeof t)throw new Error(\'Illegal plugin for "\'+e+\'", must be a function, was \'+typeof t+".");return oa[e]=t,e!==aa&&(i.isBasic(t)?Yr.prototype[e]=function(t,i){function n(){ta(this,{name:t,plugin:i,instance:null},!0);var e=i.apply(this,arguments);return ea(this,t),ta(this,{name:t,plugin:i,instance:e}),e}return Object.keys(i).forEach(function(e){n[e]=i[e]}),n}(e,t):Yr.prototype[e]=ia(e,t)),t},i.deregisterPlugin=function(e){if(e===aa)throw new Error("Cannot de-register base plugin.");Jr(e)&&(delete oa[e],delete Yr.prototype[e])},i.getPlugins=function(e){var i;return void 0===e&&(e=Object.keys(oa)),e.forEach(function(e){var t=Zr(e);t&&((i=i||{})[e]=t)}),i},i.getPluginVersion=function(e){var t=Zr(e);return t&&t.VERSION||""},i}();ua.getPlugin=Zr,ua.BASE_PLUGIN_NAME=aa,ua.registerPlugin(aa,ua),Yr.prototype.usingPlugin=function(e){return!!this[sa]&&!0===this[sa][e]},Yr.prototype.hasPlugin=function(e){return!!Jr(e)};var la=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qr(e,t)},ca=function(e){return 0===e.indexOf("#")?e.slice(1):e};function da(e,i,t){var n=da.getPlayer(e);if(n)return i&&p.warn(\'Player "\'+e+\'" is already initialised. Options will not be applied.\'),t&&n.ready(t),n;var r="string"==typeof e?X("#"+ca(e)):e;if(!_(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");r.ownerDocument.defaultView&&r.ownerDocument.body.contains(r)||p.warn("The element supplied is not included in the DOM"),i=i||{},da.hooks("beforesetup").forEach(function(e){var t=e(r,Re(i));s(t)&&!Array.isArray(t)?i=Re(i,t):p.error("please return an object in beforesetup hooks")});var a=je.getComponent("Player");return n=new a(r,i,t),da.hooks("setup").forEach(function(e){return e(n)}),n}if(da.hooks_={},da.hooks=function(e,t){return da.hooks_[e]=da.hooks_[e]||[],t&&(da.hooks_[e]=da.hooks_[e].concat(t)),da.hooks_[e]},da.hook=function(e,t){da.hooks(e,t)},da.hookOnce=function(i,e){da.hooks(i,[].concat(e).map(function(t){return function e(){return da.removeHook(i,e),t.apply(void 0,arguments)}}))},da.removeHook=function(e,t){var i=da.hooks(e).indexOf(t);return!(i<=-1)&&(da.hooks_[e]=da.hooks_[e].slice(),da.hooks_[e].splice(i,1),!0)},!0!==T.VIDEOJS_NO_DYNAMIC_STYLE&&y()){var ha=X(".vjs-styles-defaults");if(!ha){ha=ee("vjs-styles-defaults");var pa=X("head");pa&&pa.insertBefore(ha,pa.firstChild),te(ha,"\\n      .video-js {\\n        width: 300px;\\n        height: 150px;\\n      }\\n\\n      .vjs-fluid {\\n        padding-top: 56.25%\\n      }\\n    ")}}function fa(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}J(1,da),da.VERSION=h,da.options=Yr.prototype.options_,da.getPlayers=function(){return Yr.players},da.getPlayer=function(e){var t,i=Yr.players;if("string"==typeof e){var n=ca(e),r=i[n];if(r)return r;t=X("#"+n)}else t=e;if(_(t)){var a=t,s=a.player,o=a.playerId;if(s||i[o])return s||i[o]}},da.getAllPlayers=function(){return Object.keys(Yr.players).map(function(e){return Yr.players[e]}).filter(Boolean)},da.players=Yr.players,da.getComponent=je.getComponent,da.registerComponent=function(e,t){Xi.isTech(t)&&p.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),je.registerComponent.call(je,e,t)},da.getTech=Xi.getTech,da.registerTech=Xi.registerTech,da.use=function(e,t){Ki[e]=Ki[e]||[],Ki[e].push(t)},Object.defineProperty(da,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(da.middleware,"TERMINATOR",{value:$i,writeable:!1,enumerable:!0}),da.browser=pt,da.TOUCH_ENABLED=ut,da.extend=function(e,t){void 0===t&&(t={});var i=function(){e.apply(this,arguments)},n={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),n=t):"function"==typeof t&&(i=t),la(i,e),e&&(i.super_=e),n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i},da.mergeOptions=Re,da.bind=ve,da.registerPlugin=ua.registerPlugin,da.deregisterPlugin=ua.deregisterPlugin,da.plugin=function(e,t){return p.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),ua.registerPlugin(e,t)},da.getPlugins=ua.getPlugins,da.getPlugin=ua.getPlugin,da.getPluginVersion=ua.getPluginVersion,da.addLanguage=function(e,t){var i;return e=(""+e).toLowerCase(),da.options.languages=Re(da.options.languages,((i={})[e]=t,i)),da.options.languages[e]},da.log=p,da.createLogger=f,da.createTimeRange=da.createTimeRanges=gt,da.formatTime=kn,da.setFormatTime=function(e){Sn=e},da.resetFormatTime=function(){Sn=Tn},da.parseUrl=Bt,da.isCrossOrigin=qt,da.EventTarget=_e,da.on=he,da.one=me,da.off=pe,da.trigger=fe,da.xhr=ni,da.TextTrack=ci,da.AudioTrack=di,da.VideoTrack=hi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){da[e]=function(){return p.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Y[e].apply(null,arguments)}}),da.computedStyle=u,da.dom=Y,da.url=Zt,da.defineLazyProperty=Br;var ma=fa(i(function(e,t){var i,c,n,r,d;i=/^((?:[a-zA-Z0-9+\\-.]+:)?)(\\/\\/[^\\/?#]*)?((?:[^\\/\\?#]*\\/)*.*?)??(;.*?)?(\\?.*?)?(#.*?)?$/,c=/^([^\\/?#]*)(.*)$/,n=/(?:\\/|^)\\.(?=\\/)/g,r=/(?:\\/|^)\\.\\.\\/(?!\\.\\.\\/).*?(?=\\/)/g,d={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=d.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=d.normalizePath(n.path),d.buildURLFromParts(n)}var r=d.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=d.normalizePath(r.path),d.buildURLFromParts(r)):t;var a=d.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var s=c.exec(a.path);a.netLoc=s[1],a.path=s[2]}a.netLoc&&!a.path&&(a.path="/");var o={scheme:a.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=a.netLoc,"/"!==r.path[0]))if(r.path){var u=a.path,l=u.substring(0,u.lastIndexOf("/")+1)+r.path;o.path=d.normalizePath(l)}else o.path=a.path,r.params||(o.params=a.params,r.query||(o.query=a.query));return null===o.path&&(o.path=i.alwaysNormalize?d.normalizePath(r.path):r.path),d.buildURLFromParts(o)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(r,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=d})),ga=fa(T),va=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\\/\\//i.test(e)||(e=ma.default.buildAbsoluteURL(ga.default.location&&ga.default.location.href||"",e)),ma.default.buildAbsoluteURL(e,t))},ya=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),-1<i},t.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,r=0;r<n;++r)i[r].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(t){this.on("data",function(e){t.push(e)})},e}();function _a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var ba=_a(T);function Ta(e){for(var t,i=e.split(new RegExp(\'(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))\')),n={},r=i.length;r--;)""!==i[r]&&((t=/([^=]*)=(.*)/.exec(i[r]).slice(1))[0]=t[0].replace(/^\\s+|\\s+$/g,""),t[1]=t[1].replace(/^\\s+|\\s+$/g,""),t[1]=t[1].replace(/^[\'"](.*)[\'"]$/g,"$1"),n[t[0]]=t[1]);return n}var Sa=function(e){for(var t=function(e){return ba.default.atob?ba.default.atob(e):Buffer.from(e,"base64").toString("binary")}(e),i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i},ka=function(t){function e(){var e;return(e=t.call(this)||this).buffer="",e}return Ge(e,t),e.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\\n");-1<t;t=this.buffer.indexOf("\\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},e}(ya),Ca=function(t){function e(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}Ge(e,t);var i=e.prototype;return i.push=function(n){var u,l,c=this;0!==(n=n.trim()).length&&("#"===n[0]?this.tagMappers.reduce(function(e,t){var i=t(n);return i===n?e:e.concat([i])},[n]).forEach(function(e){for(var t=0;t<c.customParsers.length;t++)if(c.customParsers[t].call(c,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\\r",""),u=/^#EXTM3U/.exec(e))c.trigger("data",{type:"tag",tagType:"m3u"});else{if(u=/^#EXTINF:?([0-9\\.]*)?,?(.*)?$/.exec(e))return l={type:"tag",tagType:"inf"},u[1]&&(l.duration=parseFloat(u[1])),u[2]&&(l.title=u[2]),void c.trigger("data",l);if(u=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return l={type:"tag",tagType:"targetduration"},u[1]&&(l.duration=parseInt(u[1],10)),void c.trigger("data",l);if(u=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return l={type:"tag",tagType:"totalduration"},u[1]&&(l.duration=parseInt(u[1],10)),void c.trigger("data",l);if(u=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return l={type:"tag",tagType:"version"},u[1]&&(l.version=parseInt(u[1],10)),void c.trigger("data",l);if(u=/^#EXT-X-MEDIA-SEQUENCE:?(\\-?[0-9.]*)?/.exec(e))return l={type:"tag",tagType:"media-sequence"},u[1]&&(l.number=parseInt(u[1],10)),void c.trigger("data",l);if(u=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\\-?[0-9.]*)?/.exec(e))return l={type:"tag",tagType:"discontinuity-sequence"},u[1]&&(l.number=parseInt(u[1],10)),void c.trigger("data",l);if(u=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return l={type:"tag",tagType:"playlist-type"},u[1]&&(l.playlistType=u[1]),void c.trigger("data",l);if(u=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return l={type:"tag",tagType:"byterange"},u[1]&&(l.length=parseInt(u[1],10)),u[2]&&(l.offset=parseInt(u[2],10)),void c.trigger("data",l);if(u=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return l={type:"tag",tagType:"allow-cache"},u[1]&&(l.allowed=!/NO/.test(u[1])),void c.trigger("data",l);if(u=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(l={type:"tag",tagType:"map"},u[1]){var i=Ta(u[1]);if(i.URI&&(l.uri=i.URI),i.BYTERANGE){var n=i.BYTERANGE.split("@"),r=n[0],a=n[1];l.byterange={},r&&(l.byterange.length=parseInt(r,10)),a&&(l.byterange.offset=parseInt(a,10))}}c.trigger("data",l)}else if(u=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(l={type:"tag",tagType:"stream-inf"},u[1]){if(l.attributes=Ta(u[1]),l.attributes.RESOLUTION){var s=l.attributes.RESOLUTION.split("x"),o={};s[0]&&(o.width=parseInt(s[0],10)),s[1]&&(o.height=parseInt(s[1],10)),l.attributes.RESOLUTION=o}l.attributes.BANDWIDTH&&(l.attributes.BANDWIDTH=parseInt(l.attributes.BANDWIDTH,10)),l.attributes["PROGRAM-ID"]&&(l.attributes["PROGRAM-ID"]=parseInt(l.attributes["PROGRAM-ID"],10))}c.trigger("data",l)}else{if(u=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return l={type:"tag",tagType:"media"},u[1]&&(l.attributes=Ta(u[1])),void c.trigger("data",l);if(u=/^#EXT-X-ENDLIST/.exec(e))c.trigger("data",{type:"tag",tagType:"endlist"});else if(u=/^#EXT-X-DISCONTINUITY/.exec(e))c.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(u=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return l={type:"tag",tagType:"program-date-time"},u[1]&&(l.dateTimeString=u[1],l.dateTimeObject=new Date(u[1])),void c.trigger("data",l);if(u=/^#EXT-X-KEY:?(.*)$/.exec(e))return l={type:"tag",tagType:"key"},u[1]&&(l.attributes=Ta(u[1]),l.attributes.IV&&("0x"===l.attributes.IV.substring(0,2).toLowerCase()&&(l.attributes.IV=l.attributes.IV.substring(2)),l.attributes.IV=l.attributes.IV.match(/.{8}/g),l.attributes.IV[0]=parseInt(l.attributes.IV[0],16),l.attributes.IV[1]=parseInt(l.attributes.IV[1],16),l.attributes.IV[2]=parseInt(l.attributes.IV[2],16),l.attributes.IV[3]=parseInt(l.attributes.IV[3],16),l.attributes.IV=new Uint32Array(l.attributes.IV))),void c.trigger("data",l);if(u=/^#EXT-X-START:?(.*)$/.exec(e))return l={type:"tag",tagType:"start"},u[1]&&(l.attributes=Ta(u[1]),l.attributes["TIME-OFFSET"]=parseFloat(l.attributes["TIME-OFFSET"]),l.attributes.PRECISE=/YES/.test(l.attributes.PRECISE)),void c.trigger("data",l);if(u=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return l={type:"tag",tagType:"cue-out-cont"},u[1]?l.data=u[1]:l.data="",void c.trigger("data",l);if(u=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return l={type:"tag",tagType:"cue-out"},u[1]?l.data=u[1]:l.data="",void c.trigger("data",l);if(u=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return l={type:"tag",tagType:"cue-in"},u[1]?l.data=u[1]:l.data="",void c.trigger("data",l);c.trigger("data",{type:"tag",data:e.slice(4)})}}}else c.trigger("data",{type:"comment",text:e.slice(1)})}):this.trigger("data",{type:"uri",uri:n}))},i.addParser=function(e){var t=this,i=e.expression,n=e.customType,r=e.dataParser,a=e.segment;"function"!=typeof r&&(r=function(e){return e}),this.customParsers.push(function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:r(e),customType:n,segment:a}),!0})},i.addTagMapper=function(e){var t=e.expression,i=e.map;this.tagMappers.push(function(e){return t.test(e)?i(e):e})},e}(ya),Ea=function(t){function e(){var e;(e=t.call(this)||this).lineStream=new ka,e.parseStream=new Ca,e.lineStream.pipe(e.parseStream);var r,a,s=Ve(e),o=[],u={},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var d=0;return e.parseStream.on("data",function(t){var i,n;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&((u.byterange=e).length=t.length,"offset"in t||(t.offset=d)),"offset"in t&&((u.byterange=e).offset=t.offset),d=e.offset+e.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<t.duration&&(u.duration=t.duration),0===t.duration&&(u.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:Sa(t.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},"undefined"!=typeof t.attributes.IV&&(a.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else a=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,c=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){r={},t.uri&&(r.uri=t.uri),t.byterange&&(r.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes?(u.attributes||(u.attributes={}),m(u.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var e=this.manifest.mediaGroups[t.attributes.TYPE];e[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},i=e[t.attributes["GROUP-ID"]],(n={default:/yes/i.test(t.attributes.DEFAULT)}).default?n.autoselect=!0:n.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(n.language=t.attributes.LANGUAGE),t.attributes.URI&&(n.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(n.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(n.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(n.forced=/yes/i.test(t.attributes.FORCED)),i[t.attributes.NAME]=n}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,u.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){"undefined"==typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),u.dateTimeString=t.dateTimeString,u.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){u.cueOut=t.data},"cue-out-cont":function(){u.cueOutCont=t.data},"cue-in":function(){u.cueIn=t.data}}[t.tagType]||function(){}).call(s)},uri:function(){u.uri=t.uri,o.push(u),!this.manifest.targetDuration||"duration"in u||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),u.duration=this.manifest.targetDuration),a&&(u.key=a),u.timeline=c,r&&(u.map=r),u={}},comment:function(){},custom:function(){t.segment?(u.custom=u.custom||{},u.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(s)}),e}Ge(e,t);var i=e.prototype;return i.push=function(e){this.lineStream.push(e)},i.end=function(){this.lineStream.push("\\n")},i.addParser=function(e){this.parseStream.addParser(e)},i.addTagMapper=function(e){this.parseStream.addTagMapper(e)},e}(ya),wa=i(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=/^(audio|video|application)\\/(x-|vnd\\.apple\\.)?mpegurl/i,n=/^application\\/dash\\+xml/i;t.simpleTypeFromSourceType=function(e){return i.test(e)?"hls":n.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null}});\n/*! @name m3u8-parser @version 4.5.0 @license Apache-2.0 */t(wa);var Ia=wa.simpleTypeFromSourceType,Aa=/[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]/,xa=new RegExp("[\\\\-\\\\.0-9"+Aa.source.slice(1,-1)+"\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040]"),Pa=new RegExp("^"+Aa.source+xa.source+"*(?::"+Aa.source+xa.source+"*)?$"),La=0,Oa=1,Da=2,Ma=3,Ra=4,Na=5,Ua=6,Fa=7;function Ba(){}function ja(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function Va(e,t,i,n,r,a){for(var s,o=++t,u=La;;){var l=e.charAt(o);switch(l){case"=":if(u===Oa)s=e.slice(t,o),u=Ma;else{if(u!==Da)throw new Error("attribute equal must after attrName");u=Ma}break;case"\'":case\'"\':if(u===Ma||u===Oa){if(u===Oa&&(a.warning(\'attribute value must after "="\'),s=e.slice(t,o)),t=o+1,!(0<(o=e.indexOf(l,t))))throw new Error("attribute value no end \'"+l+"\' match");c=e.slice(t,o).replace(/&#?\\w+;/g,r),i.add(s,c,t-1),u=Na}else{if(u!=Ra)throw new Error(\'attribute value must after "="\');c=e.slice(t,o).replace(/&#?\\w+;/g,r),i.add(s,c,t),a.warning(\'attribute "\'+s+\'" missed start quot(\'+l+")!!"),t=o+1,u=Na}break;case"/":switch(u){case La:i.setTagName(e.slice(t,o));case Na:case Ua:case Fa:u=Fa,i.closed=!0;case Ra:case Oa:case Da:break;default:throw new Error("attribute invalid close char(\'/\')")}break;case"":return a.error("unexpected end of input"),u==La&&i.setTagName(e.slice(t,o)),o;case">":switch(u){case La:i.setTagName(e.slice(t,o));case Na:case Ua:case Fa:break;case Ra:case Oa:"/"===(c=e.slice(t,o)).slice(-1)&&(i.closed=!0,c=c.slice(0,-1));case Da:u===Da&&(c=s),u==Ra?(a.warning(\'attribute "\'+c+\'" missed quot(")!!\'),i.add(s,c.replace(/&#?\\w+;/g,r),t)):("http://www.w3.org/1999/xhtml"===n[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning(\'attribute "\'+c+\'" missed value!! "\'+c+\'" instead!!\'),i.add(c,c,t));break;case Ma:throw new Error("attribute value missed!!")}return o;case"":l=" ";default:if(l<=" ")switch(u){case La:i.setTagName(e.slice(t,o)),u=Ua;break;case Oa:s=e.slice(t,o),u=Da;break;case Ra:var c=e.slice(t,o).replace(/&#?\\w+;/g,r);a.warning(\'attribute "\'+c+\'" missed quot(")!!\'),i.add(s,c,t);case Na:u=Ua}else switch(u){case Da:i.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&s.match(/^(?:disabled|checked|selected)$/i)||a.warning(\'attribute "\'+s+\'" missed value!! "\'+s+\'" instead2!!\'),i.add(s,s,t),t=o,u=Oa;break;case Na:a.warning(\'attribute space is required"\'+s+\'"!!\');case Ua:u=Oa,t=o;break;case Ma:u=Ra,t=o;break;case Fa:throw new Error("elements closed character \'/\' and \'>\' must be connected to")}}o++}}function qa(e,t,i){for(var n=e.tagName,r=null,a=e.length;a--;){var s=e[a],o=s.qName,u=s.value;if(0<(h=o.indexOf(":")))var l=s.prefix=o.slice(0,h),c=o.slice(h+1),d="xmlns"===l&&c;else l=null,d="xmlns"===(c=o)&&"";s.localName=c,!1!==d&&(null==r&&(r={},za(i,i={})),i[d]=r[d]=u,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,u))}for(a=e.length;a--;){(l=(s=e[a]).prefix)&&("xml"===l&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(s.uri=i[l||""]))}var h;c=0<(h=n.indexOf(":"))?(l=e.prefix=n.slice(0,h),e.localName=n.slice(h+1)):(l=null,e.localName=n);var p=e.uri=i[l||""];if(t.startElement(p,c,n,e),!e.closed)return e.currentNSMap=i,e.localNSMap=r,!0;if(t.endElement(p,c,n),r)for(l in r)t.endPrefixMapping(l)}function Ha(e,t,i,n,r){if(/^(?:script|textarea)$/i.test(i)){var a=e.indexOf("</"+i+">",t),s=e.substring(t+1,a);if(/[&<]/.test(s))return/^script$/i.test(i)||(s=s.replace(/&#?\\w+;/g,n)),r.characters(s,0,s.length),a}return t+1}function Wa(e,t,i,n){var r=n[i];return null==r&&((r=e.lastIndexOf("</"+i+">"))<t&&(r=e.lastIndexOf("</"+i)),n[i]=r),r<t}function za(e,t){for(var i in e)t[i]=e[i]}function Ga(e,t,i,n){switch(e.charAt(t+2)){case"-":return"-"!==e.charAt(t+3)?-1:t<(r=e.indexOf("--\\x3e",t+4))?(i.comment(e,t+4,r-t-4),r+3):(n.error("Unclosed comment"),-1);default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return i.startCDATA(),i.characters(e,t+9,r-t-9),i.endCDATA(),r+3}var a=function(e,t){var i,n=[],r=/\'[^\']+\'|"[^"]+"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;r.lastIndex=t,r.exec(e);for(;i=r.exec(e);)if(n.push(i),i[1])return n}(e,t),s=a.length;if(1<s&&/!doctype/i.test(a[0][0])){var o=a[1][0],u=3<s&&/^public$/i.test(a[2][0])&&a[3][0],l=4<s&&a[4][0],c=a[s-1];return i.startDTD(o,u&&u.replace(/^([\'"])(.*?)\\1$/,"$2"),l&&l.replace(/^([\'"])(.*?)\\1$/,"$2")),i.endDTD(),c.index+c[0].length}}return-1}function Xa(e,t,i){var n=e.indexOf("?>",t);if(n){var r=e.substring(t,n).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);if(r){r[0].length;return i.processingInstruction(r[1],r[2]),n+2}return-1}return-1}function Ka(e){}function Ya(e,t){return e.__proto__=t,e}Ba.prototype={parse:function(e,t,i){var n=this.domBuilder;n.startDocument(),za(t,t={}),function(i,e,n,r,a){function s(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(65535<e){var t=55296+((e-=65536)>>10),i=56320+(1023&e);return String.fromCharCode(t,i)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(a.error("entity not found:"+e),e)}function t(e){if(f<e){var t=i.substring(f,e).replace(/&#?\\w+;/g,s);d&&o(f),r.characters(t,0,e-f),f=e}}function o(e,t){for(;l<=e&&(t=c.exec(i));)u=t.index,l=u+t[0].length,d.lineNumber++;d.columnNumber=e-u+1}var u=0,l=0,c=/.*(?:\\r\\n?|\\n)|.*$/g,d=r.locator,h=[{currentNSMap:e}],p={},f=0;for(;;){try{var m=i.indexOf("<",f);if(m<0){if(!i.substr(f).match(/^\\s*$/)){var g=r.doc,v=g.createTextNode(i.substr(f));g.appendChild(v),r.currentElement=v}return}switch(f<m&&t(m),i.charAt(m+1)){case"/":var y=i.indexOf(">",m+3),_=i.substring(m+2,y),b=h.pop();y<0?(_=i.substring(m+2).replace(/[\\s<].*/,""),a.error("end tag name: "+_+" is not complete:"+b.tagName),y=m+1+_.length):_.match(/\\s</)&&(_=_.replace(/[\\s<].*/,""),a.error("end tag name: "+_+" maybe not complete"),y=m+1+_.length);var T=b.localNSMap,S=b.tagName==_;if(S||b.tagName&&b.tagName.toLowerCase()==_.toLowerCase()){if(r.endElement(b.uri,b.localName,_),T)for(var k in T)r.endPrefixMapping(k);S||a.fatalError("end tag name: "+_+" is not match the current start tagName:"+b.tagName)}else h.push(b);y++;break;case"?":d&&o(m),y=Xa(i,m,r);break;case"!":d&&o(m),y=Ga(i,m,r,a);break;default:d&&o(m);var C=new Ka,E=h[h.length-1].currentNSMap,w=(y=Va(i,m,C,E,s,a),C.length);if(!C.closed&&Wa(i,y,C.tagName,p)&&(C.closed=!0,n.nbsp||a.warning("unclosed xml attribute")),d&&w){for(var I=ja(d,{}),A=0;A<w;A++){var x=C[A];o(x.offset),x.locator=ja(d,{})}r.locator=I,qa(C,r,E)&&h.push(C),r.locator=d}else qa(C,r,E)&&h.push(C);"http://www.w3.org/1999/xhtml"!==C.uri||C.closed?y++:y=Ha(i,y,C.tagName,s,r)}}catch(e){a.error("element parse error: "+e),y=-1}f<y?f=y:t(Math.max(m,f)+1)}}(e,t,i,n,this.errorHandler),n.endDocument()}},Ka.prototype={setTagName:function(e){if(!Pa.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,i){if(!Pa.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},Ya({},Ya.prototype)instanceof Ya||(Ya=function(e,t){function i(){}for(t in i.prototype=t,i=new i,e)i[t]=e[t];return i});var $a={XMLReader:Ba};function Qa(e,t){for(var i in e)t[i]=e[i]}function Ja(e,t){var i=e.prototype;if(Object.create){var n=Object.create(t.prototype);i.__proto__=n}if(!(i instanceof t)){var r=function(){};r.prototype=t.prototype,Qa(i,r=new r),e.prototype=i=r}i.constructor!=e&&(i.constructor=e)}var Za="http://www.w3.org/1999/xhtml",es={},ts=es.ELEMENT_NODE=1,is=es.ATTRIBUTE_NODE=2,ns=es.TEXT_NODE=3,rs=es.CDATA_SECTION_NODE=4,as=es.ENTITY_REFERENCE_NODE=5,ss=es.ENTITY_NODE=6,os=es.PROCESSING_INSTRUCTION_NODE=7,us=es.COMMENT_NODE=8,ls=es.DOCUMENT_NODE=9,cs=es.DOCUMENT_TYPE_NODE=10,ds=es.DOCUMENT_FRAGMENT_NODE=11,hs=es.NOTATION_NODE=12,ps={},fs={},ms=(ps.INDEX_SIZE_ERR=(fs[1]="Index size error",1),ps.DOMSTRING_SIZE_ERR=(fs[2]="DOMString size error",2),ps.HIERARCHY_REQUEST_ERR=(fs[3]="Hierarchy request error",3)),gs=(ps.WRONG_DOCUMENT_ERR=(fs[4]="Wrong document",4),ps.INVALID_CHARACTER_ERR=(fs[5]="Invalid character",5),ps.NO_DATA_ALLOWED_ERR=(fs[6]="No data allowed",6),ps.NO_MODIFICATION_ALLOWED_ERR=(fs[7]="No modification allowed",7),ps.NOT_FOUND_ERR=(fs[8]="Not found",8)),vs=(ps.NOT_SUPPORTED_ERR=(fs[9]="Not supported",9),ps.INUSE_ATTRIBUTE_ERR=(fs[10]="Attribute in use",10));ps.INVALID_STATE_ERR=(fs[11]="Invalid state",11),ps.SYNTAX_ERR=(fs[12]="Syntax error",12),ps.INVALID_MODIFICATION_ERR=(fs[13]="Invalid modification",13),ps.NAMESPACE_ERR=(fs[14]="Invalid namespace",14),ps.INVALID_ACCESS_ERR=(fs[15]="Invalid access",15);function ys(e,t){if(t instanceof Error)var i=t;else i=this,Error.call(this,fs[e]),this.message=fs[e],Error.captureStackTrace&&Error.captureStackTrace(this,ys);return i.code=e,t&&(this.message=this.message+": "+t),i}function _s(){}function bs(e,t){this._node=e,this._refresh=t,Ts(this)}function Ts(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var i=e._refresh(e._node);Qs(e,"length",i.length),Qa(i,e),e._inc=t}}function Ss(){}function ks(e,t){for(var i=e.length;i--;)if(e[i]===t)return i}function Cs(e,t,i,n){if(n?t[ks(t,n)]=i:t[t.length++]=i,e){var r=(i.ownerElement=e).ownerDocument;r&&(n&&Ls(r,e,n),function(e,t,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==i.namespaceURI&&(t._nsMap[i.prefix?i.localName:""]=i.value)}(r,e,i))}}function Es(e,t,i){var n=ks(t,i);if(!(0<=n))throw ys(gs,new Error(e.tagName+"@"+i));for(var r=t.length-1;n<r;)t[n]=t[++n];if(t.length=r,e){var a=e.ownerDocument;a&&(Ls(a,e,i),i.ownerElement=null)}}function ws(e){if(this._features={},e)for(var t in e)this._features=e[t]}function Is(){}function As(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||\'"\'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function xs(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(xs(e,t))return!0}while(e=e.nextSibling)}function Ps(){}function Ls(e,t,i){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==i.namespaceURI&&delete t._nsMap[i.prefix?i.localName:""]}function Os(e,t,i){if(e&&e._inc){e._inc++;var n=t.childNodes;if(i)n[n.length++]=i;else{for(var r=t.firstChild,a=0;r;)r=(n[a++]=r).nextSibling;n.length=a}}}function Ds(e,t){var i=t.previousSibling,n=t.nextSibling;return i?i.nextSibling=n:e.firstChild=n,n?n.previousSibling=i:e.lastChild=i,Os(e.ownerDocument,e),t}function Ms(e,t,i){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===ds){var r=t.firstChild;if(null==r)return t;var a=t.lastChild}else r=a=t;var s=i?i.previousSibling:e.lastChild;for(r.previousSibling=s,a.nextSibling=i,s?s.nextSibling=r:e.firstChild=r,null==i?e.lastChild=a:i.previousSibling=a;r.parentNode=e,r!==a&&(r=r.nextSibling););return Os(e.ownerDocument||e,e),t.nodeType==ds&&(t.firstChild=t.lastChild=null),t}function Rs(){this._nsMap={}}function Ns(){}function Us(){}function Fs(){}function Bs(){}function js(){}function Vs(){}function qs(){}function Hs(){}function Ws(){}function zs(){}function Gs(){}function Xs(){}function Ks(e,t){var i=[],n=9==this.nodeType?this.documentElement:this,r=n.prefix,a=n.namespaceURI;if(a&&null==r&&null==(r=n.lookupPrefix(a)))var s=[{namespace:a,prefix:null}];return $s(this,i,e,t,s),i.join("")}function Ys(e,t,i){var n=e.prefix||"",r=e.namespaceURI;if(!n&&!r)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;for(var a=i.length;a--;){var s=i[a];if(s.prefix==n)return s.namespace!=r}return!0}function $s(e,t,i,n,r){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case ts:r=r||[];var a=e.attributes,s=a.length,o=e.firstChild,u=e.tagName;i=Za===e.namespaceURI||i,t.push("<",u);for(var l=0;l<s;l++){"xmlns"==(c=a.item(l)).prefix?r.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&r.push({prefix:"",namespace:c.value})}for(l=0;l<s;l++){var c;if(Ys(c=a.item(l),0,r)){var d=c.prefix||"",h=c.namespaceURI,p=d?" xmlns:"+d:" xmlns";t.push(p,\'="\',h,\'"\'),r.push({prefix:d,namespace:h})}$s(c,t,i,n,r)}if(Ys(e,0,r)){d=e.prefix||"",h=e.namespaceURI,p=d?" xmlns:"+d:" xmlns";t.push(p,\'="\',h,\'"\'),r.push({prefix:d,namespace:h})}if(o||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),i&&/^script$/i.test(u))for(;o;)o.data?t.push(o.data):$s(o,t,i,n,r),o=o.nextSibling;else for(;o;)$s(o,t,i,n,r),o=o.nextSibling;t.push("</",u,">")}else t.push("/>");return;case ls:case ds:for(o=e.firstChild;o;)$s(o,t,i,n,r),o=o.nextSibling;return;case is:return t.push(" ",e.name,\'="\',e.value.replace(/[<&"]/g,As),\'"\');case ns:return t.push(e.data.replace(/[<&]/g,As));case rs:return t.push("<![CDATA[",e.data,"]]>");case us:return t.push("\\x3c!--",e.data,"--\\x3e");case cs:var f=e.publicId,m=e.systemId;if(t.push("<!DOCTYPE ",e.name),f)t.push(\' PUBLIC "\',f),m&&"."!=m&&t.push(\'" "\',m),t.push(\'">\');else if(m&&"."!=m)t.push(\' SYSTEM "\',m,\'">\');else{var g=e.internalSubset;g&&t.push(" [",g,"]"),t.push(">")}return;case os:return t.push("<?",e.target," ",e.data,"?>");case as:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function Qs(e,t,i){e[t]=i}ys.prototype=Error.prototype,Qa(ps,ys),_s.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var i=[],n=0;n<this.length;n++)$s(this[n],i,e,t);return i.join("")}},bs.prototype.item=function(e){return Ts(this),this[e]},Ja(bs,_s),Ss.prototype={length:0,item:_s.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==e)return i}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new ys(vs);var i=this.getNamedItem(e.nodeName);return Cs(this._ownerElement,this,e,i),i},setNamedItemNS:function(e){var t,i=e.ownerElement;if(i&&i!=this._ownerElement)throw new ys(vs);return t=this.getNamedItemNS(e.namespaceURI,e.localName),Cs(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return Es(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var i=this.getNamedItemNS(e,t);return Es(this._ownerElement,this,i),i},getNamedItemNS:function(e,t){for(var i=this.length;i--;){var n=this[i];if(n.localName==t&&n.namespaceURI==e)return n}return null}},ws.prototype={hasFeature:function(e,t){var i=this._features[e.toLowerCase()];return!(!i||t&&!(t in i))},createDocument:function(e,t,i){var n=new Ps;if(n.implementation=this,n.childNodes=new _s,(n.doctype=i)&&n.appendChild(i),t){var r=n.createElementNS(e,t);n.appendChild(r)}return n},createDocumentType:function(e,t,i){var n=new Vs;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=i,n}},Is.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Ms(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return Ds(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,i,n){var r=new i.constructor;for(var a in i){var s=i[a];"object"!=typeof s&&s!=r[a]&&(r[a]=s)}i.childNodes&&(r.childNodes=new _s);r.ownerDocument=t;switch(r.nodeType){case ts:var o=i.attributes,u=r.attributes=new Ss,l=o.length;u._ownerElement=r;for(var c=0;c<l;c++)r.setAttributeNode(e(t,o.item(c),!0));break;case is:n=!0}if(n)for(var d=i.firstChild;d;)r.appendChild(e(t,d,n)),d=d.nextSibling;return r}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==ns&&e.nodeType==ns?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var i=t._nsMap;if(i)for(var n in i)if(i[n]==e)return n;t=t.nodeType==is?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var i=t._nsMap;if(i&&e in i)return i[e];t=t.nodeType==is?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},Qa(es,Is),Qa(es,Is.prototype),Ps.prototype={nodeName:"#document",nodeType:ls,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=ds)return null==this.documentElement&&e.nodeType==ts&&(this.documentElement=e),Ms(this,e,t),e.ownerDocument=this,e;for(var i=e.firstChild;i;){var n=i.nextSibling;this.insertBefore(i,t),i=n}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),Ds(this,e)},importNode:function(e,t){return function e(t,i,n){var r;switch(i.nodeType){case ts:(r=i.cloneNode(!1)).ownerDocument=t;case ds:break;case is:n=!0}r=r||i.cloneNode(!1);r.ownerDocument=t;r.parentNode=null;if(n)for(var a=i.firstChild;a;)r.appendChild(e(t,a,n)),a=a.nextSibling;return r}(this,e,t)},getElementById:function(t){var i=null;return xs(this.documentElement,function(e){if(e.nodeType==ts&&e.getAttribute("id")==t)return i=e,!0}),i},createElement:function(e){var t=new Rs;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new _s,(t.attributes=new Ss)._ownerElement=t},createDocumentFragment:function(){var e=new zs;return e.ownerDocument=this,e.childNodes=new _s,e},createTextNode:function(e){var t=new Fs;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Bs;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new js;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var i=new Gs;return i.ownerDocument=this,i.tagName=i.target=e,i.nodeValue=i.data=t,i},createAttribute:function(e){var t=new Ns;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new Ws;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var i=new Rs,n=t.split(":"),r=i.attributes=new Ss;return i.childNodes=new _s,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=e,2==n.length?(i.prefix=n[0],i.localName=n[1]):i.localName=t,r._ownerElement=i},createAttributeNS:function(e,t){var i=new Ns,n=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=e,i.specified=!0,2==n.length?(i.prefix=n[0],i.localName=n[1]):i.localName=t,i}},Ja(Ps,Is),Ps.prototype.getElementsByTagName=(Rs.prototype={nodeType:ts,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===ds?this.insertBefore(e,null):function(e,t){var i=t.parentNode;if(i){var n=e.lastChild;i.removeChild(t);n=e.lastChild}return n=e.lastChild,t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,Os(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);return i&&i.value||""},setAttributeNS:function(e,t,i){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+i,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(n){return new bs(this,function(t){var i=[];return xs(t,function(e){e===t||e.nodeType!=ts||"*"!==n&&e.tagName!=n||i.push(e)}),i})},getElementsByTagNameNS:function(n,r){return new bs(this,function(t){var i=[];return xs(t,function(e){e===t||e.nodeType!==ts||"*"!==n&&e.namespaceURI!==n||"*"!==r&&e.localName!=r||i.push(e)}),i})}}).getElementsByTagName,Ps.prototype.getElementsByTagNameNS=Rs.prototype.getElementsByTagNameNS,Ja(Rs,Is),Ns.prototype.nodeType=is,Ja(Ns,Is),Us.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(fs[ms])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){i=this.data.substring(0,e)+i+this.data.substring(e+t),this.nodeValue=this.data=i,this.length=i.length}},Ja(Us,Is),Fs.prototype={nodeName:"#text",nodeType:ns,splitText:function(e){var t=this.data,i=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(i);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},Ja(Fs,Us),Bs.prototype={nodeName:"#comment",nodeType:us},Ja(Bs,Us),js.prototype={nodeName:"#cdata-section",nodeType:rs},Ja(js,Us),Vs.prototype.nodeType=cs,Ja(Vs,Is),qs.prototype.nodeType=hs,Ja(qs,Is),Hs.prototype.nodeType=ss,Ja(Hs,Is),Ws.prototype.nodeType=as,Ja(Ws,Is),zs.prototype.nodeName="#document-fragment",zs.prototype.nodeType=ds,Ja(zs,Is),Gs.prototype.nodeType=os,Ja(Gs,Is),Xs.prototype.serializeToString=function(e,t,i){return Ks.call(e,t,i)},Is.prototype.toString=Ks;try{if(Object.defineProperty){Object.defineProperty(bs.prototype,"length",{get:function(){return Ts(this),this.$$length}}),Object.defineProperty(Is.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case ts:case ds:var i=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&i.push(e(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case ts:case ds:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Qs=function(e,t,i){e["$$"+t]=i}}}catch(e){}function Js(e){return!!e&&"object"==typeof e}function Zs(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce(function(t,i){return Object.keys(i).forEach(function(e){Array.isArray(t[e])&&Array.isArray(i[e])?t[e]=t[e].concat(i[e]):Js(t[e])&&Js(i[e])?t[e]=Zs(t[e],i[e]):t[e]=i[e]}),t},{})}function eo(e){return e.reduce(function(e,t){return e.concat(t)},[])}function to(e){if(!e.length)return[];for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}function io(e){var t=e.baseUrl,i=void 0===t?"":t,n=e.source,r=void 0===n?"":n,a=e.range,s=void 0===a?"":a,o=e.indexRange,u=void 0===o?"":o,l={uri:r,resolvedUri:va(i||"",r)};if(s||u){var c=(s||u).split("-"),d=parseInt(c[0],10),h=parseInt(c[1],10);l.byterange={length:h-d+1,offset:d}}return l}function no(e){var t=e.type,i=void 0===t?"static":t,n=e.duration,r=e.timescale,a=void 0===r?1:r,s=e.sourceDuration,o=No[i](e),u=function(e,t){for(var i=[],n=e;n<t;n++)i.push(n);return i}(o.start,o.end).map(function(o){return function(e,t){var i=o.duration,n=o.timescale,r=void 0===n?1:n,a=o.periodIndex,s=o.startNumber;return{number:(void 0===s?1:s)+e,duration:i/r,timeline:a,time:t*i}}}(e));if("static"===i){var l=u.length-1;u[l].duration=s-n/a*l}return u}function ro(e){var t=e.baseUrl,i=e.initialization,n=void 0===i?{}:i,r=e.sourceDuration,a=e.indexRange,s=void 0===a?"":a,o=e.duration;if(!t)throw new Error(Do);var u=io({baseUrl:t,source:n.sourceURL,range:n.range}),l=io({baseUrl:t,source:t,indexRange:s});if(l.map=u,o){var c=no(e);c.length&&(l.duration=c[0].duration,l.timeline=c[0].timeline)}else r&&(l.duration=r,l.timeline=0);return l.number=0,[l]}function ao(e,t,i){for(var n=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,a=e.timeline||0,s=e.sidx.byterange,o=s.offset+s.length,u=t.timescale,l=t.references.filter(function(e){return 1!==e.referenceType}),c=[],d=o+t.firstOffset,h=0;h<l.length;h++){var p=t.references[h],f=p.referencedSize,m=p.subsegmentDuration,g=ro({baseUrl:i,timescale:u,timeline:a,periodIndex:a,duration:m,sourceDuration:r,indexRange:d+"-"+(d+f-1)})[0];n&&(g.map=n),c.push(g),d+=f}return e.segments=c,e}function so(e){return function(t){return Object.keys(t).map(function(e){return t[e]})}(e.reduce(function(e,t){var i,n=t.attributes.id+(t.attributes.lang||"");e[n]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(i=e[n].segments).push.apply(i,t.segments),t.attributes.contentProtection&&(e[n].attributes.contentProtection=t.attributes.contentProtection)):e[n]=t;return e},{})).map(function(e){return e.discontinuityStarts=function(e,n){return e.reduce(function(e,t,i){return t[n]&&e.push(i),e},[])}(e.segments,"discontinuity"),e})}function oo(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var i in e){var n=e[i];if(n.sidx){var r=n.sidx.uri+"-"+(s=n.sidx.byterange,void 0,o=s.offset+s.length-1,s.offset+"-"+o),a=t[r]&&t[r].sidx;n.sidx&&a&&ao(n,a,n.sidx.resolvedUri)}}var s,o;return e}function uo(e){var t,i=e.attributes,n=e.segments,r=e.sidx,a={attributes:(t={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),r&&(a.sidx=r),a}function lo(e,t,i){var n;if(void 0===i&&(i={}),!e.length)return{};var r=e[0].attributes,a=r.sourceDuration,s=r.type,o=void 0===s?"static":s,u=r.suggestedPresentationDelay,l=r.minimumUpdatePeriod,c=so(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(uo),d=so(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),h=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),p={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:a,playlists:oo(c,i)};return 0<=l&&(p.minimumUpdatePeriod=1e3*l),t&&(p.locations=t),"dynamic"===o&&(p.suggestedPresentationDelay=u),d.length&&(p.mediaGroups.AUDIO.audio=function(e,s){var o;void 0===s&&(s={});var t=e.reduce(function(e,t){var i=t.attributes.role&&t.attributes.role.value||"",n=t.attributes.lang||"",r="main";if(n){var a=i?" ("+i+")":"";r=t.attributes.lang+a}return e[r]&&e[r].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth||(e[r]={language:n,autoselect:!0,default:"main"===i,playlists:oo([function(e){var t,i=e.attributes,n=e.segments,r=e.sidx,a={attributes:(t={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),r&&(a.sidx=r),a}(t)],s),uri:""},"undefined"==typeof o&&"main"===i&&((o=t).default=!0)),e},{});o||(t[Object.keys(t)[0]].default=!0);return t}(d,i)),h.length&&(p.mediaGroups.SUBTITLES.subs=function(e,n){return void 0===n&&(n={}),e.reduce(function(e,t){var i=t.attributes.lang||"text";return e[i]||(e[i]={language:i,default:!1,autoselect:!1,playlists:oo([function(e){var t,i=e.attributes,n=e.segments;"undefined"==typeof n&&(n=[{uri:i.baseUrl,timeline:i.periodIndex,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration);var r=((t={NAME:i.id,BANDWIDTH:i.bandwidth})["PROGRAM-ID"]=1,t);return i.codecs&&(r.CODECS=i.codecs),{attributes:r,uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:i.baseUrl||"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1}}(t)],n),uri:""}),e},{})}(h,i)),p}function co(e,t){for(var i,n,r,a,s,o,u,l,c,d,h,p,f=e.type,m=void 0===f?"static":f,g=e.minimumUpdatePeriod,v=void 0===g?0:g,y=e.media,_=void 0===y?"":y,b=e.sourceDuration,T=e.timescale,S=void 0===T?1:T,k=e.startNumber,C=void 0===k?1:k,E=e.periodIndex,w=[],I=-1,A=0;A<t.length;A++){var x=t[A],P=x.d,L=x.r||0,O=x.t||0;I<0&&(I=O),O&&I<O&&(I=O);var D=void 0;if(L<0){var M=A+1;D=M===t.length?"dynamic"===m&&0<v&&0<_.indexOf("$Number$")?(n=I,r=P,void 0,a=(i=e).NOW,s=i.clientOffset,o=i.availabilityStartTime,u=i.timescale,l=void 0===u?1:u,c=i.start,d=void 0===c?0:c,h=i.minimumUpdatePeriod,p=(a+s)/1e3+(void 0===h?0:h)-(o+d),Math.ceil((p*l-n)/r)):(b*S-I)/P:(t[M].t-I)/P}else D=L+1;for(var R=C+w.length+D,N=C+w.length;N<R;)w.push({number:N,duration:P/S,time:I,timeline:E}),I+=P,N++}return w}function ho(e,t){return e.replace(Uo,function(a){return function(e,t,i,n){if("$$"===e)return"$";if("undefined"==typeof a[t])return e;var r=""+a[t];return"RepresentationID"===t?r:(n=i?parseInt(n,10):1)<=r.length?r:new Array(n-r.length+1).join("0")+r}}(t))}function po(i,e){var n={RepresentationID:i.id,Bandwidth:i.bandwidth||0},t=i.initialization,r=void 0===t?{sourceURL:"",range:""}:t,a=io({baseUrl:i.baseUrl,source:ho(r.sourceURL,n),range:r.range});return function(e,t){return e.duration||t?e.duration?no(e):co(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(i,e).map(function(e){n.Number=e.number,n.Time=e.time;var t=ho(i.media||"",n);return{uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:va(i.baseUrl||"",t),map:a,number:e.number}})}function fo(t,e){var i=t.duration,n=t.segmentUrls,r=void 0===n?[]:n;if(!i&&!e||i&&e)throw new Error(Mo);var a,s=r.map(function(e){return function(e,t){var i=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,a=io({baseUrl:i,source:r.sourceURL,range:r.range}),s=io({baseUrl:i,source:t.media,range:t.mediaRange});return s.map=a,s}(t,e)});return i&&(a=no(t)),e&&(a=co(t,e)),a.map(function(e,t){if(s[t]){var i=s[t];return i.timeline=e.timeline,i.duration=e.duration,i.number=e.number,i}}).filter(function(e){return e})}function mo(e){var t,i,n=e.attributes,r=e.segmentInfo;r.template?(i=po,t=Zs(n,r.template)):r.base?(i=ro,t=Zs(n,r.base)):r.list&&(i=fo,t=Zs(n,r.list));var a={attributes:n};if(!i)return a;var s=i(t,r.timeline);if(t.duration){var o=t,u=o.duration,l=o.timescale,c=void 0===l?1:l;t.duration=u/c}else s.length?t.duration=s.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0;return a.attributes=t,a.segments=s,r.base&&t.indexRange&&(a.sidx=s[0],a.segments=[]),a}function go(e,t){return to(e.childNodes).filter(function(e){return e.tagName===t})}function vo(e){return e.textContent.trim()}function yo(e){var t=/P(?:(\\d*)Y)?(?:(\\d*)M)?(?:(\\d*)D)?(?:T(?:(\\d*)H)?(?:(\\d*)M)?(?:([\\d.]*)S)?)?/.exec(e);if(!t)return 0;var i=t.slice(1),n=i[0],r=i[1],a=i[2],s=i[3],o=i[4],u=i[5];return 31536e3*parseFloat(n||0)+2592e3*parseFloat(r||0)+86400*parseFloat(a||0)+3600*parseFloat(s||0)+60*parseFloat(o||0)+parseFloat(u||0)}function _o(e){return e&&e.attributes?to(e.attributes).reduce(function(e,t){var i=Fo[t.name]||Fo.DEFAULT;return e[t.name]=i(t.value),e},{}):{}}function bo(e,i){return i.length?eo(e.map(function(t){return i.map(function(e){return va(t,vo(e))})})):e}function To(e){var t=go(e,"SegmentTemplate")[0],i=go(e,"SegmentList")[0],n=i&&go(i,"SegmentURL").map(function(e){return Zs({tag:"SegmentURL"},_o(e))}),r=go(e,"SegmentBase")[0],a=i||t,s=a&&go(a,"SegmentTimeline")[0],o=i||r||t,u=o&&go(o,"Initialization")[0],l=t&&_o(t);l&&u?l.initialization=u&&_o(u):l&&l.initialization&&(l.initialization={sourceURL:l.initialization});var c={template:l,timeline:s&&go(s,"S").map(function(e){return _o(e)}),list:i&&Zs(_o(i),{segmentUrls:n,initialization:_o(u)}),base:r&&Zs(_o(r),{initialization:_o(u)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c}function So(c,d,h){return function(e){var t=_o(e),i=bo(d,go(e,"BaseURL")),n=go(e,"Role")[0],r={role:_o(n)},a=Zs(c,t,r),s=function(e){return e.reduce(function(e,t){var i=_o(t),n=Bo[i.schemeIdUri];if(n){e[n]={attributes:i};var r=go(t,"cenc:pssh")[0];if(r){var a=vo(r),s=a&&Sa(a);e[n].pssh=s}}return e},{})}(go(e,"ContentProtection"));Object.keys(s).length&&(a=Zs(a,{contentProtection:s}));var o=To(e),u=go(e,"Representation"),l=Zs(h,o);return eo(u.map(function(a,s,o){return function(e){var t=go(e,"BaseURL"),i=bo(s,t),n=Zs(a,_o(e)),r=To(e);return i.map(function(e){return{segmentInfo:Zs(o,r),attributes:Zs(n,{baseUrl:e})}})}}(a,i,l)))}}function ko(e,t){void 0===t&&(t={});var i=t,n=i.manifestUri,r=void 0===n?"":n,a=i.NOW,s=void 0===a?Date.now():a,o=i.clientOffset,u=void 0===o?0:o,l=go(e,"Period");if(!l.length)throw new Error(Po);var c=go(e,"Location"),d=_o(e),h=bo([r],go(e,"BaseURL"));return d.sourceDuration=d.mediaPresentationDuration||0,d.NOW=s,d.clientOffset=u,c.length&&(d.locations=c.map(vo)),{locations:d.locations,representationInfo:eo(l.map(function(l,c){return function(e,t){var i=bo(c,go(e,"BaseURL")),n=_o(e),r=parseInt(n.id,10),a=T.isNaN(r)?t:r,s=Zs(l,{periodIndex:a}),o=go(e,"AdaptationSet"),u=To(e);return eo(o.map(So(s,i,u)))}}(d,h)))}}function Co(e){if(""===e)throw new Error(Lo);var t=(new xo).parseFromString(e,"application/xml"),i=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!i||i&&0<i.getElementsByTagName("parsererror").length)throw new Error(Oo);return i}function Eo(e,t){void 0===t&&(t={});var i=ko(Co(e),t),n=function(e){return e.map(mo)}(i.representationInfo);return lo(n,i.locations,t.sidxMapping)}function wo(e){return function(e){var t=go(e,"UTCTiming")[0];if(!t)return null;var i=_o(t);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Ro)}return i}(Co(e))}var Io={DOMImplementation:ws,XMLSerializer:Xs},Ao=i(function(e,t){function i(e){this.options=e||{locator:{}}}function l(){this.cdata=!1}function c(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function d(e){if(e)return"\\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function r(e,t,i){return"string"==typeof e?e.substr(t,i):e.length>=t+i||t?new java.lang.String(e,t,i)+"":e}function h(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}i.prototype.parseFromString=function(e,t){var i=this.options,n=new p,r=i.domBuilder||new l,a=i.errorHandler,s=i.locator,o=i.xmlns||{},u={lt:"<",gt:">",amp:"&",quot:\'"\',apos:"\'"};return s&&r.setDocumentLocator(s),n.errorHandler=function(n,e,r){if(!n){if(e instanceof l)return e;n=e}var a={},s=n instanceof Function;function t(t){var i=n[t];!i&&s&&(i=2==n.length?function(e){n(t,e)}:n),a[t]=i&&function(e){i("[xmldom "+t+"]\\t"+e+d(r))}||function(){}}return r=r||{},t("warning"),t("error"),t("fatalError"),a}(a,r,s),n.domBuilder=i.domBuilder||r,/\\/x?html?$/.test(t)&&(u.nbsp="",u.copy="",o[""]="http://www.w3.org/1999/xhtml"),o.xml=o.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,o,u):n.errorHandler.error("invalid doc source"),r.doc},l.prototype={startDocument:function(){this.doc=(new n).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,i,n){var r=this.doc,a=r.createElementNS(e,i||t),s=n.length;h(this,a),this.currentElement=a,this.locator&&c(this.locator,a);for(var o=0;o<s;o++){e=n.getURI(o);var u=n.getValue(o),l=(i=n.getQName(o),r.createAttributeNS(e,i));this.locator&&c(n.getLocator(o),l),l.value=l.nodeValue=u,a.setAttributeNode(l)}},endElement:function(e,t,i){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var i=this.doc.createProcessingInstruction(e,t);this.locator&&c(this.locator,i),h(this,i)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){if(e=r.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&c(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,i){e=r.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&c(this.locator,n),h(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,i){var n=this.doc.implementation;if(n&&n.createDocumentType){var r=n.createDocumentType(e,t,i);this.locator&&c(this.locator,r),h(this,r)}},warning:function(e){},error:function(e){},fatalError:function(e){throw e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\\w+/g,function(e){l.prototype[e]=function(){return null}});var p=$a.XMLReader,n=t.DOMImplementation=Io.DOMImplementation;t.XMLSerializer=Io.XMLSerializer,t.DOMParser=i}),xo=(Ao.DOMImplementation,Ao.XMLSerializer,Ao.DOMParser),Po="INVALID_NUMBER_OF_PERIOD",Lo="DASH_EMPTY_MANIFEST",Oo="DASH_INVALID_XML",Do="NO_BASE_URL",Mo="SEGMENT_TIME_UNSPECIFIED",Ro="UNSUPPORTED_UTC_TIMING_SCHEME",No={static:function(e){var t=e.duration,i=e.timescale,n=void 0===i?1:i,r=e.sourceDuration;return{start:0,end:Math.ceil(r/(t/n))}},dynamic:function(e){var t=e.NOW,i=e.clientOffset,n=e.availabilityStartTime,r=e.timescale,a=void 0===r?1:r,s=e.duration,o=e.start,u=void 0===o?0:o,l=e.minimumUpdatePeriod,c=void 0===l?0:l,d=e.timeShiftBufferDepth,h=void 0===d?1/0:d,p=(t+i)/1e3,f=n+u,m=p+c-f,g=Math.ceil(m*a/s),v=Math.floor((p-f-h)*a/s),y=Math.floor((p-f)*a/s);return{start:Math.max(0,v),end:Math.min(g,y)}}},Uo=/\\$([A-z]*)(?:(%0)([0-9]+)d)?\\$/g,Fo={mediaPresentationDuration:function(e){return yo(e)},availabilityStartTime:function(e){return function(e){return/^\\d+-\\d+-\\d+T\\d+:\\d+:\\d+(\\.\\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)}(e)/1e3},minimumUpdatePeriod:function(e){return yo(e)},suggestedPresentationDelay:function(e){return yo(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return yo(e)},start:function(e){return yo(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?yo(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Bo={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},jo=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},r=i.getUint16(22);for(t=24;r;t+=12,r--)n.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&i.getUint32(t),subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&i.getUint32(t+8)});return n},Vo=i(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});function n(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)}function r(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,n(e));try{return decodeURIComponent(escape(t))}catch(e){}return t}function i(e,t){void 0===t&&(t=0);var i=(e=n(e))[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+i:10+i}function a(e,t){return void 0===t&&(t=0),(e=n(e)).length-t<10||"ID3"!==r(e.subarray(t,t+3))?t:a(e,t+=i(e,t))}var s={aac:function(e){var t=a(e);return e.length>=t+2&&255==(255&e[t])&&224==(224&e[t+1])&&16==(22&e[t+1])},mp3:function(e){var t=a(e);return e.length>=t+2&&255==(255&e[t])&&224==(224&e[t+1])&&2==(6&e[t+1])},webm:function(e){return 4<=e.length&&26==(255&e[0])&&69==(255&e[1])&&223==(255&e[2])&&163==(255&e[3])},mp4:function(e){return 8<=e.length&&/^(f|s)typ$/.test(r(e.subarray(4,8)))&&!/^ftyp3g$/.test(r(e.subarray(4,10)))},"3gp":function(e){return 10<=e.length&&/^ftyp3g$/.test(r(e.subarray(4,10)))},ts:function(e){if(e.length<189&&1<=e.length)return 71===e[0];for(var t=0;t+188<e.length&&t<188;){if(71===e[t]&&71===e[t+188])return!0;t+=1}return!1},flac:function(e){return 4<=e.length&&/^fLaC$/.test(r(e.subarray(0,4)))},ogg:function(e){return 4<=e.length&&/^OggS$/.test(r(e.subarray(0,4)))}},o=Object.keys(s).filter(function(e){return"ts"!==e}).concat("ts");o.forEach(function(e){var t=s[e];s[e]=function(e){return t(n(e))}});t.detectContainerForBytes=function(e){e=n(e);for(var t=0;t<o.length;t++){var i=o[t];if(s[i](e))return i}return""},t.getId3Offset=a,t.id3Size=i,t.isLikely=s,t.isLikelyFmp4MediaSegment=function(e){e=n(e);for(var t=0;t<e.length;){var i=(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0;if("moof"===r(e.subarray(t+4,t+8)))return!0;0==i||i+t>e.length?t=e.length:t+=i}return!1}});t(Vo);var qo=Vo.detectContainerForBytes,Ho=Vo.getId3Offset,Wo=(Vo.id3Size,Vo.isLikely,Vo.isLikelyFmp4MediaSegment),zo=i(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});function s(e){return e instanceof Uint8Array?e:new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0)}t.bytesToString=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,s(e));try{return decodeURIComponent(escape(t))}catch(e){}return t},t.concatTypedArrays=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.reduce(function(e,t){return e+=t&&(t.byteLength||t.length)||0},0),r=new Uint8Array(n),a=0;return t.forEach(function(e){e=s(e),r.set(e,a),a+=e.byteLength}),r},t.isTypedArray=function(e){return ArrayBuffer.isView(e)},t.stringToBytes=function(e,t){void 0===t&&(t=!1);return"string"!=typeof e&&e&&"function"==typeof e.toString&&(e=e.toString()),"string"!=typeof e?[]:(t||(e=unescape(encodeURIComponent(e))),e.split("").map(function(e){return 255&e.charCodeAt(0)}))},t.toUint8=s});t(zo);zo.bytesToString;function Go(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var i;return!!a[e]&&(i=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(i,1),-1<i)},this.trigger=function(e){var t,i,n,r;if(t=a[e])if(2===arguments.length)for(n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else{for(r=[],i=arguments.length,i=1;i<arguments.length;++i)r.push(arguments[i]);for(n=t.length,i=0;i<n;++i)t[i].apply(this,r)}},this.dispose=function(){a={}}}}var Xo=zo.concatTypedArrays,Ko=(zo.isTypedArray,zo.stringToBytes),Yo=zo.toUint8,$o=27,Qo=15,Jo=21;Go.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),this.on("partialdone",function(e){t.partialFlush(e)}),this.on("endedtimeline",function(e){t.endTimeline(e)}),this.on("reset",function(e){t.reset(e)}),t},Go.prototype.push=function(e){this.trigger("data",e)},Go.prototype.flush=function(e){this.trigger("done",e)},Go.prototype.partialFlush=function(e){this.trigger("partialdone",e)},Go.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},Go.prototype.reset=function(e){this.trigger("reset",e)};function Zo(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}new Go;function eu(e){var t=31&e[1];return t<<=8,t|=e[2]}function tu(e){return!!(64&e[1])}function iu(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function nu(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}function ru(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return i=0<=i?i:0,(16&e[t+5])>>4?i+20:i+10}function au(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var su,ou,uu,lu,cu={parseType:function(e,t){var i=eu(e);return 0===i?"pat":i===t?"pmt":t?"pes":null},parsePat:function(e){var t=tu(e),i=4+iu(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=tu(e),n=4+iu(e);if(i&&(n+=e[n]+1),1&e[n+5]){var r;r=3+((15&e[n+1])<<8|e[n+2])-4;for(var a=12+((15&e[n+10])<<8|e[n+11]);a<r;){var s=n+a;t[(31&e[s+1])<<8|e[s+2]]=e[s],a+=5+((15&e[s+3])<<8|e[s+4])}return t}},parsePayloadUnitStartIndicator:tu,parsePesType:function(e,t){switch(t[eu(e)]){case $o:return"video";case Qo:return"audio";case Jo:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!tu(e))return null;var t=4+iu(e);if(t>=e.byteLength)return null;var i,n=null;return 192&(i=e[t+7])&&((n={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,n.pts*=4,n.pts+=(6&e[t+13])>>>1,n.dts=n.pts,64&i&&(n.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,n.dts*=4,n.dts+=(6&e[t+18])>>>1)),n},videoPacketContainsKeyFrame:function(e){for(var t=4+iu(e),i=e.subarray(t),n=0,r=0,a=!1;r<i.byteLength-3;r++)if(1===i[r+2]){n=r+5;break}for(;n<i.byteLength;)switch(i[n]){case 0:if(0!==i[n-1]){n+=2;break}if(0!==i[n-2]){n++;break}for(r+3!==n-2&&"slice_layer_without_partitioning_rbsp_idr"===nu(31&i[r+3])&&(a=!0);1!==i[++n]&&n<i.length;);r=n-2,n+=3;break;case 1:if(0!==i[n-1]||0!==i[n-2]){n+=3;break}"slice_layer_without_partitioning_rbsp_idr"===nu(31&i[r+3])&&(a=!0),r=n-2,n+=3;break;default:n+=3}return i=i.subarray(r),n-=r,r=0,i&&3<i.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===nu(31&i[r+3])&&(a=!0),a}},du=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],hu={isLikelyAacData:function(e){var t=function e(t,i){return t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0)?i:e(t,i+=ru(t,i))}(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},parseId3TagSize:ru,parseAdtsSize:function(e,t){var i=(224&e[t+5])>>5,n=e[t+4]<<3;return 6144&e[t+3]|n|i},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return du[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i,n;t=10,64&e[5]&&(t+=4,t+=au(e.subarray(10,14)));do{if((i=au(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){n=e.subarray(t+10,t+i+10);for(var r=0;r<n.byteLength;r++)if(0===n[r]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(function(e,t,i){var n,r="";for(n=t;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}(n,0,r)))break;var a=n.subarray(r+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return s*=4,s+=3&a[7]}}t+=10,t+=i}while(t<e.byteLength);return null}},pu=9e4,fu=(su=function(e){return 9e4*e},ou=function(e,t){return e*t},uu=function(e){return e/9e4},lu=function(e,t){return e/t},pu),mu=Zo,gu={};gu.ts=cu,gu.aac=hu;function vu(e,t,i){for(var n,r,a,s,o=0,u=Cu,l=!1;u<=e.byteLength;)if(71!==e[o]||71!==e[u]&&u!==e.byteLength)o++,u++;else{switch(n=e.subarray(o,u),gu.ts.parseType(n,t.pid)){case"pes":r=gu.ts.parsePesType(n,t.table),a=gu.ts.parsePayloadUnitStartIndicator(n),"audio"===r&&a&&(s=gu.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),l=!0)}if(l)break;o+=Cu,u+=Cu}for(o=(u=e.byteLength)-Cu,l=!1;0<=o;)if(71!==e[o]||71!==e[u]&&u!==e.byteLength)o--,u--;else{switch(n=e.subarray(o,u),gu.ts.parseType(n,t.pid)){case"pes":r=gu.ts.parsePesType(n,t.table),a=gu.ts.parsePayloadUnitStartIndicator(n),"audio"===r&&a&&(s=gu.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),l=!0)}if(l)break;o-=Cu,u-=Cu}}function yu(e,t,i){for(var n,r,a,s,o,u,l,c=0,d=Cu,h=!1,p={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(n=e.subarray(c,d),gu.ts.parseType(n,t.pid)){case"pes":if(r=gu.ts.parsePesType(n,t.table),a=gu.ts.parsePayloadUnitStartIndicator(n),"video"===r&&(a&&!h&&(s=gu.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),h=!0),!i.firstKeyFrame)){if(a&&0!==p.size){for(o=new Uint8Array(p.size),u=0;p.data.length;)l=p.data.shift(),o.set(l,u),u+=l.byteLength;if(gu.ts.videoPacketContainsKeyFrame(o)){var f=gu.ts.parsePesTime(o);f&&(i.firstKeyFrame=f,i.firstKeyFrame.type="video")}p.size=0}p.data.push(n),p.size+=n.byteLength}}if(h&&i.firstKeyFrame)break;c+=Cu,d+=Cu}for(c=(d=e.byteLength)-Cu,h=!1;0<=c;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(n=e.subarray(c,d),gu.ts.parseType(n,t.pid)){case"pes":r=gu.ts.parsePesType(n,t.table),a=gu.ts.parsePayloadUnitStartIndicator(n),"video"===r&&a&&(s=gu.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),h=!0)}if(h)break;c-=Cu,d-=Cu}}function _u(e){var t={pid:null,table:null},i={};for(var n in function(e,t){for(var i,n=0,r=Cu;r<e.byteLength;)if(71!==e[n]||71!==e[r])n++,r++;else{switch(i=e.subarray(n,r),gu.ts.parseType(i,t.pid)){case"pat":t.pid||(t.pid=gu.ts.parsePat(i));break;case"pmt":t.table||(t.table=gu.ts.parsePmt(i))}if(t.pid&&t.table)return;n+=Cu,r+=Cu}}(e,t),t.table){if(t.table.hasOwnProperty(n))switch(t.table[n]){case $o:i.video=[],yu(e,t,i),0===i.video.length&&delete i.video;break;case Qo:i.audio=[],vu(e,t,i),0===i.audio.length&&delete i.audio}}return i}var bu,Tu,Su,ku=pu,Cu=188,Eu=function(e,t){var i;return(i=gu.aac.isLikelyAacData(e)?function(e){for(var t,i=!1,n=0,r=null,a=null,s=0,o=0;3<=e.length-o;){switch(gu.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){i=!0;break}if((s=gu.aac.parseId3TagSize(e,o))>e.length){i=!0;break}null===a&&(t=e.subarray(o,o+s),a=gu.aac.parseAacTimestamp(t)),o+=s;break;case"audio":if(e.length-o<7){i=!0;break}if((s=gu.aac.parseAdtsSize(e,o))>e.length){i=!0;break}null===r&&(t=e.subarray(o,o+s),r=gu.aac.parseSampleRate(t)),n++,o+=s;break;default:o++}if(i)return null}if(null===r||null===a)return null;var u=ku/r;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*n*u,pts:a+1024*n*u}]}}(e):_u(e))&&(i.audio||i.video)?(function(e,t){if(e.audio&&e.audio.length){var i=t;"undefined"==typeof i&&(i=e.audio[0].dts),e.audio.forEach(function(e){e.dts=mu(e.dts,i),e.pts=mu(e.pts,i),e.dtsTime=e.dts/ku,e.ptsTime=e.pts/ku})}if(e.video&&e.video.length){var n=t;if("undefined"==typeof n&&(n=e.video[0].dts),e.video.forEach(function(e){e.dts=mu(e.dts,n),e.pts=mu(e.pts,n),e.dtsTime=e.dts/ku,e.ptsTime=e.pts/ku}),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=mu(r.dts,n),r.pts=mu(r.pts,n),r.dtsTime=r.dts/ku,r.ptsTime=r.dts/ku}}}(i,t),i):null},wu=function(e){return e>>>0},Iu=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},Au=wu,xu=function e(t,i){var n,r,a,s,o,u=[];if(!i.length)return null;for(n=0;n<t.byteLength;)r=Au(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]),a=Iu(t.subarray(n+4,n+8)),s=1<r?n+r:t.byteLength,a===i[0]&&(1===i.length?u.push(t.subarray(n+8,s)):(o=e(t.subarray(n+8,s),i.slice(1))).length&&(u=u.concat(o))),n=s;return u},Pu=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],s=8&n.flags[2],o=16&n.flags[2],u=32&n.flags[2],l=65536&n.flags[0],c=131072&n.flags[0];return t=8,r&&(t+=4,n.baseDataOffset=i.getUint32(12),t+=4),a&&(n.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(n.defaultSampleDuration=i.getUint32(t),t+=4),o&&(n.defaultSampleSize=i.getUint32(t),t+=4),u&&(n.defaultSampleFlags=i.getUint32(t)),l&&(n.durationIsEmpty=!0),!r&&c&&(n.baseDataOffsetIsMoof=!0),n},Lu=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Ou=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],u=4&i.flags[1],l=8&i.flags[1],c=n.getUint32(4),d=8;for(r&&(i.dataOffset=n.getInt32(d),d+=4),a&&c&&(t={flags:Lu(e.subarray(d,d+4))},d+=4,s&&(t.duration=n.getUint32(d),d+=4),o&&(t.size=n.getUint32(d),d+=4),l&&(1===i.version?t.compositionTimeOffset=n.getInt32(d):t.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(t),c--);c--;)t={},s&&(t.duration=n.getUint32(d),d+=4),o&&(t.size=n.getUint32(d),d+=4),u&&(t.flags=Lu(e.subarray(d,d+4)),d+=4),l&&(1===i.version?t.compositionTimeOffset=n.getInt32(d):t.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(t);return i},Du=wu,Mu=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:Du(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=Du(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},Ru=wu,Nu=function(e){return("00"+e.toString(16)).slice(-2)};bu=function(r,e){var t,i,n;return t=xu(e,["moof","traf"]),i=[].concat.apply([],t.map(function(n){return xu(n,["tfhd"]).map(function(e){var t,i;return t=Ru(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),i=r[t]||9e4,(xu(n,["tfdt"]).map(function(e){var t,i;return t=e[0],i=Ru(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(i*=Math.pow(2,32),i+=Ru(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i})[0]||1/0)/i})})),n=Math.min.apply(null,i),isFinite(n)?n:0},Tu=function(e){var t=xu(e,["moov","trak"]),h=[];return t.forEach(function(e){var t,i,n={},r=xu(e,["tkhd"])[0];r&&(i=(t=new DataView(r.buffer,r.byteOffset,r.byteLength)).getUint8(0),n.id=0===i?t.getUint32(12):t.getUint32(20));var a=xu(e,["mdia","hdlr"])[0];if(a){var s=Iu(a.subarray(8,12));n.type="vide"===s?"video":"soun"===s?"audio":s}var o=xu(e,["mdia","minf","stbl","stsd"])[0];if(o){var u=o.subarray(8);n.codec=Iu(u.subarray(4,8));var l,c=xu(u,[n.codec])[0];c&&(/^[a-z]vc[1-9]$/i.test(n.codec)?(l=c.subarray(78),"avcC"===Iu(l.subarray(4,8))&&11<l.length?(n.codec+=".",n.codec+=Nu(l[9]),n.codec+=Nu(l[10]),n.codec+=Nu(l[11])):n.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(n.codec)&&(l=c.subarray(28),"esds"===Iu(l.subarray(4,8))&&20<l.length&&0!==l[19]?(n.codec+="."+Nu(l[19]),n.codec+="."+Nu(l[20]>>>2&63).replace(/^0/,"")):n.codec="mp4a.40.2"))}var d=xu(e,["mdia","mdhd"])[0];d&&(n.timescale=Su(d)),h.push(n)}),h};var Uu=bu,Fu=Tu,Bu=(Su=function(e){var t=0===e[0]?12:20;return Ru(e[t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])},i(function(e,t){function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e?e.replace(/avc1\\.(\\d+)\\.(\\d+)/i,function(e,t,i){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(i).toString(16)).slice(-2)}):e}function n(e){return e.map(r)}function a(e){void 0===e&&(e="");var t=e.split(","),a={};return t.forEach(function(r){r=r.trim(),["video","audio"].forEach(function(e){var t=l[e].exec(r.toLowerCase());if(t&&!(t.length<=1)){var i=r.substring(0,t[1].length),n=r.replace(i,"");a[e]={type:i,details:n}}})}),a}function s(e){return void 0===e&&(e=""),l.audio.test(e.trim().toLowerCase())}function o(e){if(e&&"string"==typeof e){var t=e.toLowerCase().split(",").map(function(e){return r(e.trim())}),i="video";1===t.length&&s(t[0])&&(i="audio");var n="mp4";return t.every(function(e){return l.mp4.test(e)})?n="mp4":t.every(function(e){return l.webm.test(e)})?n="webm":t.every(function(e){return l.ogg.test(e)})&&(n="ogg"),i+"/"+n+\';codecs="\'+e+\'"\'}}var u=i(T),l={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/};t.DEFAULT_AUDIO_CODEC="mp4a.40.2",t.DEFAULT_VIDEO_CODEC="avc1.4d400d",t.browserSupportsCodec=function(e){return void 0===e&&(e=""),u.default.MediaSource&&u.default.MediaSource.isTypeSupported&&u.default.MediaSource.isTypeSupported(o(e))||!1},t.codecsFromDefault=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var n in i){var r=i[n];if(r.default&&r.playlists)return a(r.playlists[0].attributes.CODECS)}return null},t.getMimeForCodec=o,t.isAudioCodec=s,t.isVideoCodec=function(e){return void 0===e&&(e=""),l.video.test(e.trim().toLowerCase())},t.mapLegacyAvcCodecs=function(e){return e.replace(/avc1\\.(\\d+)\\.(\\d+)/i,function(e){return n([e])[0]})},t.muxerSupportsCodec=function(e){return void 0===e&&(e=""),e.toLowerCase().split(",").every(function(e){return e=e.trim(),l.muxerVideo.test(e)||l.muxerAudio.test(e)})},t.parseCodecs=a,t.translateLegacyCodec=r,t.translateLegacyCodecs=n}));t(Bu);function ju(e,t,i){return e&&i&&i.responseURL&&t!==i.responseURL?i.responseURL:t}function Vu(e,t){return e+"-"+t}function qu(e){var t=e.manifestString,i=e.customTagParsers,n=void 0===i?[]:i,r=e.customTagMappers,a=void 0===r?[]:r,s=new Ea;return n.forEach(function(e){return s.addParser(e)}),a.forEach(function(e){return s.addTagMapper(e)}),s.push(t),s.end(),s.manifest}function Hu(r,a){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in r.mediaGroups[e])for(var i in r.mediaGroups[e][t]){var n=r.mediaGroups[e][t][i];a(n,e,t,i)}})}function Wu(e){var t=e.playlist,i=e.uri,n=e.id;t.id=n,i&&(t.uri=i),t.attributes=t.attributes||{}}function zu(s,e){s.uri=e;for(var t=0;t<s.playlists.length;t++)if(!s.playlists[t].uri){var i="placeholder-uri-"+t;s.playlists[t].uri=i}Hu(s,function(e,t,i,n){if(e.playlists&&e.playlists.length&&!e.playlists[0].uri){var r="placeholder-uri-"+t+"-"+i+"-"+n,a=Vu(0,r);e.playlists[0].uri=r,e.playlists[0].id=a,s.playlists[a]=e.playlists[0],s.playlists[r]=e.playlists[0]}}),function(e){for(var t=e.playlists.length;t--;){var i=e.playlists[t];Wu({playlist:i,id:Vu(t,i.uri)}),i.resolvedUri=$l(e.uri,i.uri),e.playlists[i.id]=i,(e.playlists[i.uri]=i).attributes.BANDWIDTH||Ql.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(s),function(t){Hu(t,function(e){e.uri&&(e.resolvedUri=$l(t.uri,e.uri))})}(s)}function Gu(e,t){e.resolvedUri||(e.resolvedUri=$l(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=$l(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=$l(t,e.map.uri))}function Xu(e,t){var i=Jl(e,{}),n=i.playlists[t.id];if(!n)return null;if(n.segments&&t.segments&&n.segments.length===t.segments.length&&n.endList===t.endList&&n.mediaSequence===t.mediaSequence)return null;var r=Jl(n,t);n.segments&&(r.segments=function(e,t,i){var n=t.slice();i=i||0;for(var r=Math.min(e.length,t.length+i),a=i;a<r;a++)n[a-i]=Jl(e[a],n[a-i]);return n}(n.segments,t.segments,t.mediaSequence-n.mediaSequence)),r.segments.forEach(function(e){Gu(e,r.resolvedUri)});for(var a=0;a<i.playlists.length;a++)i.playlists[a].id===t.id&&(i.playlists[a]=r);return i.playlists[t.id]=r,i.playlists[t.uri]=r,i}function Ku(e,t){var i=e.segments[e.segments.length-1];return t&&i&&i.duration?1e3*i.duration:500*(e.targetDuration||10)}function Yu(e,t){var i,n=[];if(e&&e.length)for(i=0;i<e.length;i++)t(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return da.createTimeRanges(n)}function $u(e,i){return Yu(e,function(e,t){return e-.1<=i&&i<=t+.1})}function Qu(e,t){return Yu(e,function(e){return t<=e-ec})}function Ju(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")}function Zu(e){for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}function el(e,t,i){if("undefined"==typeof t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence)return 0;var n=function(e,t){var i=0,n=t-e.mediaSequence,r=e.segments[n];if(r){if("undefined"!=typeof r.start)return{result:r.start,precise:!0};if("undefined"!=typeof r.end)return{result:r.end-r.duration,precise:!0}}for(;n--;){if("undefined"!=typeof(r=e.segments[n]).end)return{result:i+r.end,precise:!0};if(i+=r.duration,"undefined"!=typeof r.start)return{result:i+r.start,precise:!0}}return{result:i,precise:!1}}(e,t);if(n.precise)return n.result;var r=function(e,t){for(var i,n=0,r=t-e.mediaSequence;r<e.segments.length;r++){if("undefined"!=typeof(i=e.segments[r]).start)return{result:i.start-n,precise:!0};if(n+=i.duration,"undefined"!=typeof i.end)return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t);return r.precise?r.result:n.result+i}function tl(e,t,i){if(!e)return 0;if("number"!=typeof i&&(i=0),"undefined"==typeof t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return T.Infinity}return el(e,t,i)}function il(e,t,i){var n=0;if(i<t){var r=[i,t];t=r[0],i=r[1]}if(t<0){for(var a=t;a<Math.min(0,i);a++)n+=e.targetDuration;t=0}for(var s=t;s<i;s++)n+=e.segments[s].duration;return n}function nl(e,t){if(!e.segments.length)return 0;var i=e.segments.length,n=e.segments[i-1].duration||e.targetDuration,r="number"==typeof t?t:n+2*e.targetDuration;if(0===r)return i;for(var a=0;i--&&!(r<=(a+=e.segments[i].duration)););return Math.max(0,i)}function rl(e,t,i,n){if(!e||!e.segments)return null;if(e.endList)return tl(e);if(null===t)return null;t=t||0;var r=i?nl(e,n):e.segments.length;return el(e,e.mediaSequence+r,t)}function al(e){return e.excludeUntil&&e.excludeUntil>Date.now()}function sl(e){return e.excludeUntil&&e.excludeUntil===1/0}function ol(e){var t=al(e);return!e.disabled&&!t}function ul(e,t){return t.attributes&&t.attributes[e]}function ll(e,t){if(1===e.playlists.length)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!ol(e)&&(e.attributes.BANDWIDTH||0)<i}).length}function cl(e,t,i,n){var r="arraybuffer"===e.responseType?e.response:e.responseText;!t&&r&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=r.byteLength||r.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),i.headers&&(e.responseHeaders=i.headers),t&&"ETIMEDOUT"===t.code&&(e.timedout=!0),t||e.aborted||200===i.statusCode||206===i.statusCode||0===i.statusCode||(t=new Error("XHR Failed with a response of: "+(e&&(r||e.responseText)))),n(t,e)}function dl(){return function e(t,i){t=rc({timeout:45e3},t);var n=e.beforeRequest||da.Vhs.xhr.beforeRequest;if(n&&"function"==typeof n){var r=n(t);r&&(t=r)}var a=nc(t,function(e,t){return cl(a,e,t,i)}),s=a.abort;return a.abort=function(){return a.aborted=!0,s.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}}function hl(e){var t={};return e.byterange&&(t.Range=function(e){var t=e.offset+e.length-1;return"bytes="+e.offset+"-"+t}(e.byterange)),t}function pl(e,t){var i=e.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")}function fl(e){return 32<=e&&e<126?String.fromCharCode(e):"."}function ml(i){var n={};return Object.keys(i).forEach(function(e){var t=i[e];ArrayBuffer.isView(t)?n[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:n[e]=t}),n}function gl(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}function vl(e){return e.resolvedUri}function yl(e){for(var t=Array.prototype.slice.call(e),i="",n=0;n<t.length/16;n++)i+=t.slice(16*n,16*n+16).map(pl).join("")+" "+t.slice(16*n,16*n+16).map(fl).join("")+"\\n";return i}function _l(e){var t=e.playlist,i=e.time,n=void 0===i?void 0:i,r=e.callback;if(!r)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===n)return r({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var i,n=0,r=0;r<t.segments.length&&!(e<=(n=(i=t.segments[r]).videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:n+i.duration));r++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(n<e){if(e>n+.25*a.duration)return null;i=a}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:n-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}}(n,t);if(!a)return r({message:"valid programTime was not found"});if("estimate"===a.type)return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var s={mediaSeconds:n},o=function(e,t){if(!t.dateTimeObject)return null;var i=t.videoTimingInfo.transmuxerPrependedSeconds,n=e-(t.videoTimingInfo.transmuxedPresentationStart+i);return new Date(t.dateTimeObject.getTime()+1e3*n)}(n,a.segment);return o&&(s.programDateTime=o.toISOString()),r(null,s)}function bl(e){var t=e.programTime,i=e.playlist,n=e.retryCount,r=void 0===n?2:n,a=e.seekTo,s=e.pauseAfterSeek,o=void 0===s||s,u=e.tech,l=e.callback;if(!l)throw new Error("seekToProgramTime: callback must be provided");if("undefined"==typeof t||!i||!a)return l({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!u.hasStarted_)return l({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++){if(!e.segments[t].dateTimeObject)return!1}return!0}(i))return l({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var c=function(e,t){var i;try{i=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var n=t.segments[0];if(i<n.dateTimeObject)return null;for(var r=0;r<t.segments.length-1;r++){if(n=t.segments[r],i<t.segments[r+1].dateTimeObject)break}var a=t.segments[t.segments.length-1],s=a.dateTimeObject,o=a.videoTimingInfo?function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds}(a.videoTimingInfo):a.duration+.25*a.duration;return new Date(s.getTime()+1e3*o)<i?null:(s<i&&(n=a),{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:ic.duration(t,t.mediaSequence+t.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"})}(t,i);if(!c)return l({message:t+" was not found in the stream"});var d=c.segment,h=function(e,t){var i,n;try{i=new Date(e),n=new Date(t)}catch(e){}var r=i.getTime();return(n.getTime()-r)/1e3}(d.dateTimeObject,t);if("estimate"===c.type)return 0===r?l({message:t+" is not buffered yet. Try again"}):(a(c.estimatedStart+h),void u.one("seeked",function(){bl({programTime:t,playlist:i,retryCount:r-1,seekTo:a,pauseAfterSeek:o,tech:u,callback:l})}));var p=d.start+h;u.one("seeked",function(){return l(null,u.currentTime())}),o&&u.pause(),a(p)}function Tl(e,t){if(4===e.readyState)return t()}function Sl(e){var t=e.masterXml,i=e.srcUrl,n=e.clientOffset,r=e.sidxMapping,a=Eo(t,{manifestUri:i,clientOffset:n,sidxMapping:r});return zu(a,i),a}function kl(e,t){for(var s=!0,o=sc(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),i=0;i<t.playlists.length;i++){var n=Xu(o,t.playlists[i]);n&&(o=n,s=!1)}return Hu(t,function(e,t,i,n){if(e.playlists&&e.playlists.length){var r=e.playlists[0].id,a=Xu(o,e.playlists[0]);a&&((o=a).mediaGroups[t][i][n].playlists[0]=o.playlists[r],s=!1)}}),t.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(s=!1),s?null:o}function Cl(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t}function El(e,t){var i,n,r={};for(var a in e){var s=e[a].sidx;if(s){var o=Cl(s);if(!t[o])break;var u=t[o].sidxInfo;i=u,n=s,(Boolean(!i.map&&!n.map)||Boolean(i.map&&n.map&&i.map.byterange.offset===n.map.byterange.offset&&i.map.byterange.length===n.map.byterange.length))&&i.uri===n.uri&&i.byterange.offset===n.byterange.offset&&i.byterange.length===n.byterange.length&&(r[o]=t[o])}}return r}function wl(o,e,u,l,t,c){var d={uri:ju(t.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:u},h=da.mergeOptions(d,{responseType:"arraybuffer",headers:hl(d)});return function(e,t,r){function a(e,t,i,n){return t.abort(),u=!0,r(e,t,i,n)}function i(e,t){if(!u){if(e)return a(e,t,"",o);var i=t.responseText.substring(o&&o.byteLength||0,t.responseText.length);if(o=Xo(o,Ko(i,!0)),s=s||Ho(o),o.length<10||s&&o.length<s+2)return Tl(t,function(){return a(e,t,"",o)});var n=qo(o);return"ts"===n&&o.length<188?Tl(t,function(){return a(e,t,"",o)}):!n&&o.length<376?Tl(t,function(){return a(e,t,"",o)}):a(null,t,n,o)}}var s,o=[],u=!1,n=t({uri:e,beforeSend:function(t){t.overrideMimeType("text/plain; charset=x-user-defined"),t.addEventListener("progress",function(e){e.total,e.loaded;return cl(t,null,{statusCode:t.status},i)})}},function(e,t){return cl(n,e,t,i)});return n}(d.uri,l,function(e,t,i,n){if(e)return c(e,t);if(!i||"mp4"!==i)return c({status:t.status,message:"Unsupported "+(i||"unknown")+" container type for sidx segment at URL: "+d.uri,response:"",playlist:u,internal:!0,blacklistDuration:1/0,code:2},t);var r=d.byterange,a=r.offset,s=r.length;if(n.length>=s+a)return c(e,{response:n.subarray(a,a+s),status:t.status,uri:t.uri});o.request=l(h,c)})}function Il(e){for(var t=new Uint8Array(new ArrayBuffer(e.length)),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t.buffer}function Al(e){var t=e.transmuxer,i=e.bytes,n=e.audioAppendStart,r=e.gopsToAlignWith,a=e.isPartial,s=e.remux,o=e.onData,u=e.onTrackInfo,l=e.onAudioTimingInfo,c=e.onVideoTimingInfo,d=e.onVideoSegmentTimingInfo,h=e.onId3,p=e.onCaptions,f=e.onDone,m={isPartial:a,buffer:[]};if(t.onmessage=function(e){Bl&&("data"===e.data.action&&function(e,t,i){var n=e.data.segment,r=n.type,a=n.initSegment,s=n.captions,o=n.captionStreams,u=n.metadata,l=n.videoFrameDtsTime,c=n.videoFramePtsTime;t.buffer.push({captions:s,captionStreams:o,metadata:u});var d=e.data.segment.boxes||{data:e.data.segment.data},h={type:r,data:new Uint8Array(d.data,d.data.byteOffset,d.data.byteLength),initSegment:new Uint8Array(a.data,a.byteOffset,a.byteLength)};"undefined"!=typeof l&&(h.videoFrameDtsTime=l),"undefined"!=typeof c&&(h.videoFramePtsTime=c),i(h)}(e,m,o),"trackinfo"===e.data.action&&u(e.data.trackInfo),"gopInfo"===e.data.action&&function(e,t){t.gopInfo=e.data.gopInfo}(e,m),"audioTimingInfo"===e.data.action&&l(e.data.audioTimingInfo),"videoTimingInfo"===e.data.action&&c(e.data.videoTimingInfo),"videoSegmentTimingInfo"===e.data.action&&d(e.data.videoSegmentTimingInfo),"id3Frame"===e.data.action&&h([e.data.id3Frame],e.data.id3Frame.dispatchType),"caption"===e.data.action&&p(e.data.caption),"transmuxed"===e.data.type&&(t.onmessage=null,function(e){var t=e.transmuxedData,i=e.callback;t.buffer=[],i(t)}({transmuxedData:m,callback:f}),cc()))},n&&t.postMessage({action:"setAudioAppendStart",appendStart:n}),Array.isArray(r)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:r}),"undefined"!=typeof s&&t.postMessage({action:"setRemux",remux:s}),i.byteLength){var g=i instanceof ArrayBuffer?i:i.buffer,v=i instanceof ArrayBuffer?0:i.byteOffset;t.postMessage({action:"push",data:g,byteOffset:v,byteLength:i.byteLength},[g])}t.postMessage({action:a?"partialFlush":"flush"})}function xl(e,t){e.postMessage({action:t}),cc()}function Pl(e,t){Bl?lc.push(xl.bind(null,t,e)):xl(t,Bl=e)}function Ll(e){Bl?lc.push(e):Al(Bl=e)}function Ol(e){e.forEach(function(e){e.abort()})}function Dl(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:mc,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:gc,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:fc,xhr:t}:null}function Ml(e){var i=e.segment,t=e.bytes,n=e.isPartial,r=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn,d=i.map&&i.map.tracks||{},h=Boolean(d.audio&&d.video),p=a.bind(null,i,"audio","start"),f=a.bind(null,i,"audio","end"),m=a.bind(null,i,"video","start"),g=a.bind(null,i,"video","end");if(!n&&!i.lastReachedChar){var v=function(e,t){var i=Eu(e,t*fu);if(!i)return null;var n={hasVideo:i.video&&2===i.video.length||!1,hasAudio:i.audio&&2===i.audio.length||!1};return n.hasVideo&&(n.videoStart=i.video[0].ptsTime),n.hasAudio&&(n.audioStart=i.audio[0].ptsTime),n}(t,i.baseStartTime);v&&(r(i,{hasAudio:v.hasAudio,hasVideo:v.hasVideo,isMuxed:h}),r=null,v.hasAudio&&!h&&p(v.audioStart),v.hasVideo&&m(v.videoStart),m=p=null)}Ll({bytes:t,transmuxer:i.transmuxer,audioAppendStart:i.audioAppendStart,gopsToAlignWith:i.gopsToAlignWith,isPartial:n,remux:h,onData:function(e){e.type="combined"===e.type?"video":e.type,l(i,e)},onTrackInfo:function(e){r&&(h&&(e.isMuxed=!0),r(i,e))},onAudioTimingInfo:function(e){p&&"undefined"!=typeof e.start&&(p(e.start),p=null),f&&"undefined"!=typeof e.end&&f(e.end)},onVideoTimingInfo:function(e){m&&"undefined"!=typeof e.start&&(m(e.start),m=null),g&&"undefined"!=typeof e.end&&g(e.end)},onVideoSegmentTimingInfo:function(e){s(e)},onId3:function(e,t){o(i,e,t)},onCaptions:function(e){u(i,[e])},onDone:function(e){c&&!n&&(e.type="combined"===e.type?"video":e.type,c(null,i,e))}})}function Rl(e){var n=e.segment,r=e.bytes,t=e.isPartial,i=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn,d=new Uint8Array(r);if(Wo(d)){n.isFmp4=!0;var h=n.map.tracks,p={isFmp4:!0,hasVideo:!!h.video,hasAudio:!!h.audio};h.audio&&h.audio.codec&&"enca"!==h.audio.codec&&(p.audioCodec=h.audio.codec),h.video&&h.video.codec&&"encv"!==h.video.codec&&(p.videoCodec=h.video.codec),h.video&&h.audio&&(p.isMuxed=!0),i(n,p);var f=Uu(n.map.timescales,d);p.hasAudio&&!p.isMuxed&&a(n,"audio","start",f),p.hasVideo&&a(n,"video","start",f);var m=function(e){l(n,{data:r,type:p.hasAudio&&!p.isMuxed?"audio":"video"}),e&&e.length&&u(n,e),c(null,n,{})};if(!h.video||!r.byteLength||!n.transmuxer)return void m();var g=r instanceof ArrayBuffer?r:r.buffer,v=r instanceof ArrayBuffer?0:r.byteOffset;return n.transmuxer.addEventListener("message",function e(t){if("mp4Captions"===t.data.action){n.transmuxer.removeEventListener("message",e);var i=t.data.data;n.bytes=r=new Uint8Array(i,i.byteOffset||0,i.byteLength),m(t.data.captions)}}),void n.transmuxer.postMessage({action:"pushMp4Captions",timescales:n.map.timescales,trackIds:[h.video.id],data:g,byteOffset:v,byteLength:r.byteLength},[g])}if(n.transmuxer){if("undefined"==typeof n.container&&(n.container=qo(d)),"ts"!==n.container&&"aac"!==n.container)return i(n,{hasAudio:!1,hasVideo:!1}),void c(null,n,{});Ml({segment:n,bytes:r,isPartial:t,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,dataFn:l,doneFn:c})}else c(null,n,{})}function Nl(e){var i=e.activeXhrs,n=e.decryptionWorker,r=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.id3Fn,u=e.captionsFn,l=e.dataFn,c=e.doneFn,d=0,h=!1;return function(e,t){if(!h){if(e)return h=!0,Ol(i),c(e,t);if((d+=1)===i.length){if(t.endOfAllRequests=Date.now(),t.encryptedBytes)return function(e){var t,n=e.decryptionWorker,r=e.segment,a=e.trackInfoFn,s=e.timingInfoFn,o=e.videoSegmentTimingInfoFn,u=e.id3Fn,l=e.captionsFn,c=e.dataFn,d=e.doneFn;n.addEventListener("message",function e(t){if(t.data.source===r.requestId){n.removeEventListener("message",e);var i=t.data.decrypted;r.bytes=new Uint8Array(i.bytes,i.byteOffset,i.byteLength),Rl({segment:r,bytes:r.bytes,isPartial:!1,trackInfoFn:a,timingInfoFn:s,videoSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,dataFn:c,doneFn:d})}}),t=r.key.bytes.slice?r.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(r.key.bytes)),n.postMessage(ml({source:r.requestId,encrypted:r.encryptedBytes,key:t,iv:r.key.iv}),[r.encryptedBytes.buffer,t.buffer])}({decryptionWorker:n,segment:t,trackInfoFn:r,timingInfoFn:a,videoSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,dataFn:l,doneFn:c});Rl({segment:t,bytes:t.bytes,isPartial:!1,trackInfoFn:r,timingInfoFn:a,videoSegmentTimingInfoFn:s,id3Fn:o,captionsFn:u,dataFn:l,doneFn:c})}}}}function Ul(e){var n=e.segment,r=e.progressFn,a=e.trackInfoFn,s=e.timingInfoFn,o=e.videoSegmentTimingInfoFn,u=e.id3Fn,l=e.captionsFn,c=e.dataFn,d=e.handlePartialData;return function(e){var t=e.target;if(!t.aborted){if(d&&!n.key&&t.responseText&&8<=t.responseText.length){var i=Il(t.responseText.substring(n.lastReachedChar||0));!n.lastReachedChar&&Wo(new Uint8Array(i))||(n.lastReachedChar=t.responseText.length,Rl({segment:n,bytes:i,isPartial:!0,trackInfoFn:a,timingInfoFn:s,videoSegmentTimingInfoFn:o,id3Fn:u,captionsFn:l,dataFn:c}))}return n.stats=da.mergeOptions(n.stats,function(e){var t=e.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return i.bytesReceived=e.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i}(e)),!n.stats.firstBytesReceivedAt&&n.stats.bytesReceived&&(n.stats.firstBytesReceivedAt=Date.now()),r(e,n)}}}function Fl(e){var t=e.xhr,i=e.xhrOptions,n=e.decryptionWorker,r=e.segment,a=e.abortFn,s=e.progressFn,o=e.trackInfoFn,u=e.timingInfoFn,l=e.videoSegmentTimingInfoFn,c=e.id3Fn,d=e.captionsFn,h=e.dataFn,p=e.doneFn,f=e.handlePartialData,m=[],g=Nl({activeXhrs:m,decryptionWorker:n,trackInfoFn:o,timingInfoFn:u,videoSegmentTimingInfoFn:l,id3Fn:c,captionsFn:d,dataFn:h,doneFn:p});if(r.key&&!r.key.bytes){var v=t(da.mergeOptions(i,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),function(a,s){return function(e,t){var i=t.response,n=Dl(e,t);if(n)return s(n,a);if(16!==i.byteLength)return s({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:fc,xhr:t},a);var r=new DataView(i);return a.key.bytes=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]),s(null,a)}}(r,g));m.push(v)}if(r.map&&!r.map.bytes){var y=t(da.mergeOptions(i,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:hl(r.map)}),function(e){var a=e.segment,s=e.finishProcessingFn;return function(e,t){var i=t.response,n=Dl(e,t);if(n)return s(n,a);if(0===i.byteLength)return s({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:fc,xhr:t},a);a.map.bytes=new Uint8Array(t.response);var r=qo(a.map.bytes);return"mp4"!==r?s({status:t.status,message:"Found unsupported "+(r||"unknown")+" container for initialization segment at URL: "+t.uri,code:fc,internal:!0,xhr:t},a):(Fu(a.map.bytes).forEach(function(e){a.map.tracks=a.map.tracks||{},a.map.tracks[e.type]||(a.map.tracks[e.type]=e).id&&e.timescale&&(a.map.timescales=a.map.timescales||{},a.map.timescales[e.id]=e.timescale)}),s(null,a))}}({segment:r,finishProcessingFn:g}));m.push(y)}var _=da.mergeOptions(i,{uri:r.resolvedUri,responseType:"arraybuffer",headers:hl(r)});f&&(_.responseType="text",_.beforeSend=function(e){e.overrideMimeType("text/plain; charset=x-user-defined")});var b=t(_,function(e){var a=e.segment,s=e.finishProcessingFn,o=e.responseType;return function(e,t){var i=t.response,n=Dl(e,t);if(n)return s(n,a);var r="arraybuffer"!==o&&t.responseText?Il(t.responseText.substring(a.lastReachedChar||0)):t.response;return 0===i.byteLength?s({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:fc,xhr:t},a):(a.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(t),a.key?a.encryptedBytes=new Uint8Array(r):a.bytes=new Uint8Array(r),s(null,a))}}({segment:r,finishProcessingFn:g,responseType:_.responseType}));b.addEventListener("progress",Ul({segment:r,progressFn:s,trackInfoFn:o,timingInfoFn:u,videoSegmentTimingInfoFn:l,id3Fn:c,captionsFn:d,dataFn:h,handlePartialData:f})),m.push(b);var T={};return m.forEach(function(e){e.addEventListener("loadend",function(e){var t=e.loadendState,i=e.abortFn;return function(e){e.target.aborted&&i&&!t.calledAbortFn&&(i(),t.calledAbortFn=!0)}}({loadendState:T,abortFn:a}))}),function(){return Ol(m)}}var Bl,jl=Bu.DEFAULT_AUDIO_CODEC,Vl=Bu.DEFAULT_VIDEO_CODEC,ql=Bu.browserSupportsCodec,Hl=Bu.codecsFromDefault,Wl=Bu.getMimeForCodec,zl=Bu.isAudioCodec,Gl=Bu.isVideoCodec,Xl=(Bu.mapLegacyAvcCodecs,Bu.muxerSupportsCodec),Kl=Bu.parseCodecs,Yl=Bu.translateLegacyCodec,$l=(Bu.translateLegacyCodecs,va),Ql=da.log,Jl=da.mergeOptions,Zl=function(c){function e(e,t,i){var n;if(void 0===i&&(i={}),n=c.call(this)||this,!e)throw new Error("A non-empty playlist URL or object is required");var r=i,a=r.withCredentials,s=void 0!==a&&a,o=r.handleManifestRedirects,u=void 0!==o&&o;n.src=e,n.vhs_=t,n.withCredentials=s,n.handleManifestRedirects=u;var l=t.options_;return n.customTagParsers=l&&l.customTagParsers||[],n.customTagMappers=l&&l.customTagMappers||[],n.state="HAVE_NOTHING",n.on("mediaupdatetimeout",function(){"HAVE_METADATA"===n.state&&(n.state="HAVE_CURRENT_METADATA",n.request=n.vhs_.xhr({uri:$l(n.master.uri,n.media().uri),withCredentials:n.withCredentials},function(e,t){if(n.request)return e?n.playlistRequestError(n.request,n.media(),"HAVE_METADATA"):void n.haveMetadata({playlistString:n.request.responseText,url:n.media().uri,id:n.media().id})}))}),n}Ge(e,c);var t=e.prototype;return t.playlistRequestError=function(e,t,i){var n=t.uri,r=t.id;this.request=null,i&&(this.state=i),this.error={playlist:this.master.playlists[r],status:e.status,message:"HLS playlist request error at URL: "+n+".",responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")},t.haveMetadata=function(e){var t=this,i=e.playlistString,n=e.playlistObject,r=e.url,a=e.id;this.request=null,this.state="HAVE_METADATA";var s=n||qu({manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers});Wu({playlist:s,uri:r,id:a});var o=Xu(this.master,s);this.targetDuration=s.targetDuration,o?(this.master=o,this.media_=this.master.playlists[a]):this.trigger("playlistunchanged"),this.media().endList||(T.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=T.setTimeout(function(){t.trigger("mediaupdatetimeout")},Ku(this.media(),!!o))),this.trigger("loadedplaylist")},t.dispose=function(){this.trigger("dispose"),this.stopRequest(),T.clearTimeout(this.mediaUpdateTimeout),T.clearTimeout(this.finalRenditionTimeout),this.off()},t.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},t.media=function(i,e){var n=this;if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof i){if(!this.master.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.master.playlists[i]}if(T.clearTimeout(this.finalRenditionTimeout),e){var t=i.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=T.setTimeout(this.media.bind(this,i,!1),t)}else{var r=this.state,a=!this.media_||i.id!==this.media_.id;if(this.master.playlists[i.id].endList||i.endList&&i.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=i,void(a&&(this.trigger("mediachanging"),"HAVE_MASTER"===r?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(a){if(this.state="SWITCHING_MEDIA",this.request){if(i.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.vhs_.xhr({uri:i.resolvedUri,withCredentials:this.withCredentials},function(e,t){if(n.request){if(i.resolvedUri=ju(n.handleManifestRedirects,i.resolvedUri,t),e)return n.playlistRequestError(n.request,i,r);n.haveMetadata({playlistString:t.responseText,url:i.uri,id:i.id}),"HAVE_MASTER"===r?n.trigger("loadedmetadata"):n.trigger("mediachange")}})}}},t.pause=function(){this.stopRequest(),T.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},t.load=function(e){var t=this;T.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(e){var n=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=T.setTimeout(function(){return t.load()},n)}else this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()},t.start=function(){var n=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=T.location.href),this.src.resolvedUri=this.src.uri,void setTimeout(function(){n.setupInitialPlaylist(n.src)},0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(e,t){if(n.request){if(n.request=null,e)return n.error={status:t.status,message:"HLS playlist request error at URL: "+n.src+".",responseText:t.responseText,code:2},"HAVE_NOTHING"===n.state&&(n.started=!1),n.trigger("error");n.src=ju(n.handleManifestRedirects,n.src,t);var i=qu({manifestString:t.responseText,customTagParsers:n.customTagParsers,customTagMappers:n.customTagMappers});n.setupInitialPlaylist(i)}})},t.srcUri=function(){return"string"==typeof this.src?this.src:this.src.uri},t.setupInitialPlaylist=function(e){if(this.state="HAVE_MASTER",e.playlists)return this.master=e,zu(this.master,this.srcUri()),e.playlists.forEach(function(t){t.segments&&t.segments.forEach(function(e){Gu(e,t.resolvedUri)})}),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var t=this.srcUri()||T.location.href;this.master=function(e,t){var i=Vu(0,t),n={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:T.location.href,resolvedUri:T.location.href,playlists:[{uri:t,id:i,resolvedUri:t,attributes:{}}]};return n.playlists[i]=n.playlists[0],n.playlists[t]=n.playlists[0],n}(0,t),this.haveMetadata({playlistObject:e,url:t,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},e}(da.EventTarget),ec=1/30,tc=da.createTimeRange,ic={duration:tl,seekable:function(e,t,i){var n=t||0,r=rl(e,t,!0,i);return null===r?tc():tc(n,r)},safeLiveIndex:nl,getMediaInfoForTime:function(e,t,i,n){var r,a=e.segments.length,s=t-n;if(s<0){if(0<i)for(r=i-1;0<=r;r--)if(0<(s+=e.segments[r].duration+ec))return{mediaIndex:r,startTime:n-il(e,i,r)};return{mediaIndex:0,startTime:t}}if(i<0){for(r=i;r<0;r++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};i=0}for(r=i;r<a;r++)if((s-=e.segments[r].duration+ec)<0)return{mediaIndex:r,startTime:n+il(e,i,r)};return{mediaIndex:a-1,startTime:t}},isEnabled:ol,isDisabled:function(e){return e.disabled},isBlacklisted:al,isIncompatible:sl,playlistEnd:rl,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},hasAttribute:ul,estimateSegmentRequestTime:function(e,t,i,n){return void 0===n&&(n=0),ul("BANDWIDTH",i)?(e*i.attributes.BANDWIDTH-8*n)/t:NaN},isLowestEnabledRendition:ll},nc=da.xhr,rc=da.mergeOptions,ac=Object.freeze({__proto__:null,createTransferableMessage:ml,initSegmentId:gl,segmentKeyId:vl,hexDump:yl,tagDump:function(e){var t=e.bytes;return yl(t)},textRanges:function(e){var t,i,n,r="";for(t=0;t<e.length;t++)r+=(n=t,(i=e).start(n)+"-"+i.end(n)+" ");return r}}),sc=da.mergeOptions,oc=function(c){function e(e,t,i,n){var r;void 0===i&&(i={}),r=c.call(this)||this;var a=i,s=a.withCredentials,o=void 0!==s&&s,u=a.handleManifestRedirects,l=void 0!==u&&u;if(r.vhs_=t,r.withCredentials=o,r.handleManifestRedirects=l,!e)throw new Error("A non-empty playlist URL or object is required");return r.on("minimumUpdatePeriod",function(){r.refreshXml_()}),r.on("mediaupdatetimeout",function(){r.refreshMedia_(r.media().id)}),r.state="HAVE_NOTHING",r.loadedPlaylists_={},"string"==typeof e?(r.srcUrl=e,r.sidxMapping_={},Ve(r)):(r.setupChildLoader(n,e),r)}Ge(e,c);var t=e.prototype;return t.setupChildLoader=function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t},t.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},T.clearTimeout(this.minimumUpdatePeriodTimeout_),T.clearTimeout(this.mediaRequest_),T.clearTimeout(this.mediaUpdateTimeout),this.off()},t.hasPendingRequest=function(){return this.request||this.mediaRequest_},t.stopRequest=function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}},t.sidxRequestFinished_=function(r,a,s,o){var u=this;return function(e,t){if(u.request){if(u.request=null,e)return u.error="object"==typeof e?e:{status:t.status,message:"DASH playlist request error at URL: "+r.uri,response:t.response,code:2},s&&(u.state=s),void u.trigger("error");var i=Yo(t.response),n=jo(i.subarray(8));return o(a,n)}}},t.media=function(i){var n=this;if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var r=this.state;if("string"==typeof i){if(!this.master.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.master.playlists[i]}var e=!this.media_||i.id!==this.media_.id;if(e&&this.loadedPlaylists_[i.id]&&this.loadedPlaylists_[i.id].endList)return this.state="HAVE_METADATA",this.media_=i,void(e&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(e)if(this.media_&&this.trigger("mediachanging"),i.sidx){var t,a;a=this.masterPlaylistLoader_?(t=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.sidxMapping_):(t=this.master,this.sidxMapping_);var s=Cl(i.sidx);a[s]={sidxInfo:i.sidx},this.request=wl(this,i.sidx,i,this.vhs_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(i,t,r,function(e,t){if(!e||!t)throw new Error("failed to request sidx");a[s].sidx=t,n.haveMetadata({startingState:r,playlist:e.playlists[i.id]})}))}else this.mediaRequest_=T.setTimeout(this.haveMetadata.bind(this,{startingState:r,playlist:i}),0)},t.haveMetadata=function(e){var t=e.startingState,i=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")},t.pause=function(){this.stopRequest(),T.clearTimeout(this.mediaUpdateTimeout),T.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)},t.load=function(e){var t=this;T.clearTimeout(this.mediaUpdateTimeout),T.clearTimeout(this.minimumUpdatePeriodTimeout_);var i=this.media();if(e){var n=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=T.setTimeout(function(){return t.load()},n)}else this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()},t.start=function(){var i=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=T.setTimeout(this.haveMaster_.bind(this),0):this.request=this.vhs_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(i.request){if(i.request=null,e)return i.error={status:t.status,message:"DASH playlist request error at URL: "+i.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===i.state&&(i.started=!1),i.trigger("error");i.masterXml_=t.responseText,t.responseHeaders&&t.responseHeaders.date?i.masterLoaded_=Date.parse(t.responseHeaders.date):i.masterLoaded_=Date.now(),i.srcUrl=ju(i.handleManifestRedirects,i.srcUrl,t),i.syncClientServerClock_(i.onClientServerClockSync_.bind(i))}})},t.syncClientServerClock_=function(n){var r=this,a=wo(this.masterXml_);return null===a?(this.clientOffset_=this.masterLoaded_-Date.now(),n()):"DIRECT"===a.method?(this.clientOffset_=a.value-Date.now(),n()):void(this.request=this.vhs_.xhr({uri:$l(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(e,t){if(r.request){if(e)return r.clientOffset_=r.masterLoaded_-Date.now(),n();var i;i="HEAD"===a.method?t.responseHeaders&&t.responseHeaders.date?Date.parse(t.responseHeaders.date):r.masterLoaded_:Date.parse(t.responseText),r.clientOffset_=i-Date.now(),n()}}))},t.haveMaster_=function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.updateMainManifest_(Sl({masterXml:this.masterXml_,srcUrl:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_})),this.trigger("loadedplaylist"))},t.updateMinimumUpdatePeriodTimeout_=function(){var t=this;T.clearTimeout(this.minimumUpdatePeriodTimeout_);function e(e){t.minimumUpdatePeriodTimeout_=T.setTimeout(function(){t.trigger("minimumUpdatePeriod")},e)}var i=this.master&&this.master.minimumUpdatePeriod;0<i?e(i):0===i&&(this.media()?e(1e3*this.media().targetDuration):this.one("loadedplaylist",function(){e(1e3*t.media().targetDuration)}))},t.onClientServerClockSync_=function(){this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.updateMinimumUpdatePeriodTimeout_()},t.updateMainManifest_=function(e){if(this.master=e,this.master.locations&&this.master.locations.length){var t=this.master.locations[0];t!==this.srcUrl&&(this.srcUrl=t)}},t.refreshXml_=function(){var o=this;this.request=this.vhs_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(o.request){if(o.request=null,e)return o.error={status:t.status,message:"DASH playlist request error at URL: "+o.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===o.state&&(o.started=!1),o.trigger("error");o.masterXml_=t.responseText,o.sidxMapping_=function(e,t,i,a){var n=Eo(e,{manifestUri:t,clientOffset:i}),s=El(n.playlists,a);return Hu(n,function(e,t,i,n){if(e.playlists&&e.playlists.length){var r=e.playlists;s=sc(s,El(r,a))}}),s}(o.masterXml_,o.srcUrl,o.clientOffset_,o.sidxMapping_);var i=Sl({masterXml:o.masterXml_,srcUrl:o.srcUrl,clientOffset:o.clientOffset_,sidxMapping:o.sidxMapping_}),n=kl(o.master,i),r=o.media().sidx;if(n)if(r){var a=Cl(r);if(!o.sidxMapping_[a]){var s=o.media();o.request=wl(o,s.sidx,s,o.vhs_.xhr,{handleManifestRedirects:o.handleManifestRedirects},o.sidxRequestFinished_(s,i,o.state,function(e,t){if(!e||!t)throw new Error("failed to request sidx on minimumUpdatePeriod");o.sidxMapping_[a].sidx=t,o.updateMinimumUpdatePeriodTimeout_(),o.refreshMedia_(o.media().id)}))}}else o.updateMainManifest_(n),o.media_&&(o.media_=o.master.playlists[o.media_.id]);o.updateMinimumUpdatePeriodTimeout_()}})},t.refreshMedia_=function(e){var t,i,n=this;if(!e)throw new Error("refreshMedia_ must take a media id");i=this.masterPlaylistLoader_?(t=this.masterPlaylistLoader_.master,Sl({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_})):(t=this.master,Sl({masterXml:this.masterXml_,srcUrl:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_}));var r=kl(t,i);r?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=r:this.master=r,this.media_=r.playlists[e]):(this.media_=t.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=T.setTimeout(function(){n.trigger("mediaupdatetimeout")},Ku(this.media(),!!r))),this.trigger("loadedplaylist")},e}(da.EventTarget),uc={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},lc=[],cc=function(){Bl=null,lc.length&&("function"==typeof(Bl=lc.shift())?Bl():Al(Bl))},dc=function(e){Pl("reset",e)},hc=function(){Bl=null,lc.length=0},pc=function(e){Pl("endTimeline",e)},fc=2,mc=-101,gc=-102,vc="undefined"!=typeof window?window:{},yc="undefined"==typeof Symbol?"__target":Symbol(),_c="application/javascript",bc=vc.BlobBuilder||vc.WebKitBlobBuilder||vc.MozBlobBuilder||vc.MSBlobBuilder,Tc=vc.URL||vc.webkitURL||Tc&&Tc.msURL,Sc=vc.Worker;function kc(r,a){return function(e){var t=this;if(!a)return new Sc(r);if(Sc&&!e){var i=Ic(a.toString().replace(/^function.+?{/,"").slice(0,-1));return this[yc]=new Sc(i),function(e,t){if(!e||!t)return;var i=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Tc.revokeObjectURL(e.objURL),i.call(e)}}(this[yc],i),this[yc]}var n={postMessage:function(e){t.onmessage&&setTimeout(function(){t.onmessage({data:e,target:n})})}};a.call(n),this.postMessage=function(e){setTimeout(function(){n.onmessage({data:e,target:t})})},this.isThisThread=!0}}if(Sc){var Cc,Ec=Ic("self.onmessage = function () {}"),wc=new Uint8Array(1);try{(Cc=new Sc(Ec)).postMessage(wc,[wc.buffer])}catch(e){Sc=null}finally{Tc.revokeObjectURL(Ec),Cc&&Cc.terminate()}}function Ic(t){try{return Tc.createObjectURL(new Blob([t],{type:_c}))}catch(e){var i=new bc;return i.append(t),Tc.createObjectURL(i.getBlob(type))}}function Ac(e,t){var i=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&i.AUDIO&&e.mediaGroups.AUDIO[i.AUDIO]}function xc(e,t){var i=t.attributes||{},n=function(e){var t=e.attributes||{};if(t.CODECS)return Kl(t.CODECS)}(t)||{};if(Ac(e,t)&&!n.audio&&!function(e,t){if(!Ac(e,t))return!0;var i=t.attributes||{},n=e.mediaGroups.AUDIO[i.AUDIO];for(var r in n)if(!n[r].uri&&!n[r].playlists)return!0;return!1}(e,t)){var r=Hl(e,i.AUDIO);r&&(n.audio=r.audio)}var a={};return n.video&&(a.video=Yl(""+n.video.type+n.video.details)),n.audio&&(a.audio=Yl(""+n.audio.type+n.audio.details)),a}function Pc(e){return da.log.debug?da.log.debug.bind(da,"VHS:",e+" >"):function(){}}function Lc(e){if(e&&e.playlist){var t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})}}function Oc(e,t){if(!e)return"";var i=T.getComputedStyle(e);return i?i[t]:""}function Dc(e,n){var r=e.slice();e.sort(function(e,t){var i=n(e,t);return 0===i?r.indexOf(e)-r.indexOf(t):i})}function Mc(e,t){var i,n;return e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||T.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(n=t.attributes.BANDWIDTH),i-(n=n||T.Number.MAX_VALUE)}function Rc(e){var t=e.inbandTextTracks,i=e.metadataArray,n=e.timestampOffset,r=e.videoDuration;if(i){var a=T.WebKitDataCue||T.VTTCue,s=t.metadataTrack_;if(s&&(i.forEach(function(e){var i=e.cueTime+n;!("number"!=typeof i||T.isNaN(i)||i<0)&&i<1/0&&e.frames.forEach(function(e){var t=new a(i,i,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return da.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return da.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return da.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),s.addCue(t)})}),s.cues&&s.cues.length)){for(var o=s.cues,u=[],l=0;l<o.length;l++)o[l]&&u.push(o[l]);var c=u.reduce(function(e,t){var i=e[t.startTime]||[];return i.push(t),e[t.startTime]=i,e},{}),d=Object.keys(c).sort(function(e,t){return Number(e)-Number(t)});d.forEach(function(e,t){var i=c[e],n=Number(d[t+1])||r;i.forEach(function(e){e.endTime=n})})}}}function Nc(e,t,i){var n,r;if(i&&i.cues)for(n=i.cues.length;n--;)(r=i.cues[n]).startTime>=e&&r.endTime<=t&&i.removeCue(r)}function Uc(e){return"number"==typeof e&&isFinite(e)}function Fc(e){return e+"TimingInfo"}function Bc(e){var t=e.segmentTimeline,i=e.currentTimeline,n=e.startOfSegment,r=e.buffered;return e.overrideCheck||t!==i?r.length?r.end(r.length-1):n:null}function jc(e){var t=e.timelineChangeController,i=e.currentTimeline,n=e.segmentTimeline,r=e.loaderType,a=e.audioDisabled;if(i===n)return!1;if("audio"===r){var s=t.lastTimelineChange({type:"main"});return!s||s.to!==n}if("main"===r&&a){var o=t.pendingTimelineChange({type:"audio"});return!o||o.to!==n}return!1}var Vc=new kc("./transmuxer-worker.worker.js",function(e,t){var Zt=this;\n/*! @name @videojs/http-streaming @version 2.2.4 @license Apache-2.0 */!function(){function e(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var i;return!!a[e]&&(i=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(i,1),-1<i)},this.trigger=function(e){var t,i,n,r;if(t=a[e])if(2===arguments.length)for(n=t.length,i=0;i<n;++i)t[i].call(this,arguments[1]);else{for(r=[],i=arguments.length,i=1;i<arguments.length;++i)r.push(arguments[i]);for(n=t.length,i=0;i<n;++i)t[i].apply(this,r)}},this.dispose=function(){a={}}}}e.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),this.on("partialdone",function(e){t.partialFlush(e)}),this.on("endedtimeline",function(e){t.endTimeline(e)}),this.on("reset",function(e){t.reset(e)}),t},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var l,t,i,r,a,n,s,o,u,c,d,h,p,f,m,g,v,y,_,b,T,S,k,C,E,w,I,A,x,P,L,O,D,M,R,N,U,F,B,j,V=e,q=Math.pow(2,32)-1;!function(){var e;if(S={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in S)S.hasOwnProperty(e)&&(S[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);k=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),E=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),C=new Uint8Array([0,0,0,1]),w=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),I=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),A={video:w,audio:I},L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),P=new Uint8Array([0,0,0,0,0,0,0,0]),O=new Uint8Array([0,0,0,0,0,0,0,0]),D=O,M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),R=O,x=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),l=function(e){var t,i,n=[],r=0;for(t=1;t<arguments.length;t++)n.push(arguments[t]);for(t=n.length;t--;)r+=n[t].byteLength;for(i=new Uint8Array(r+8),new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,i.byteLength),i.set(e,4),t=0,r=8;t<n.length;t++)i.set(n[t],r),r+=n[t].byteLength;return i},t=function(){return l(S.dinf,l(S.dref,L))},i=function(e){return l(S.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},m=function(e){return l(S.hdlr,A[e])},f=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),l(S.mdhd,t)},p=function(e){return l(S.mdia,f(e),m(e.type),n(e))},a=function(e){return l(S.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},n=function(e){return l(S.minf,"video"===e.type?l(S.vmhd,x):l(S.smhd,P),t(),v(e))},s=function(e,t){for(var i=[],n=t.length;n--;)i[n]=_(t[n]);return l.apply(null,[S.moof,a(e)].concat(i))},o=function(e){for(var t=e.length,i=[];t--;)i[t]=d(e[t]);return l.apply(null,[S.moov,c(4294967295)].concat(i).concat(u(e)))},u=function(e){for(var t=e.length,i=[];t--;)i[t]=b(e[t]);return l.apply(null,[S.mvex].concat(i))},c=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return l(S.mvhd,t)},g=function(e){var t,i,n=e.samples||[],r=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)t=n[i].flags,r[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return l(S.sdtp,r)},v=function(e){return l(S.stbl,y(e),l(S.stts,R),l(S.stsc,D),l(S.stsz,M),l(S.stco,O))},y=function(e){return l(S.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?N(e):U(e))},N=function(e){var t,i,n=e.sps||[],r=e.pps||[],a=[],s=[];for(t=0;t<n.length;t++)a.push((65280&n[t].byteLength)>>>8),a.push(255&n[t].byteLength),a=a.concat(Array.prototype.slice.call(n[t]));for(t=0;t<r.length;t++)s.push((65280&r[t].byteLength)>>>8),s.push(255&r[t].byteLength),s=s.concat(Array.prototype.slice.call(r[t]));if(i=[S.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l(S.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([n.length],a,[r.length],s))),l(S.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var o=e.sarRatio[0],u=e.sarRatio[1];i.push(l(S.pasp,new Uint8Array([(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u])))}return l.apply(null,i)},U=function(e){return l(S.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),i(e))},h=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return l(S.tkhd,t)},_=function(e){var t,i,n,r,a,s;return t=l(S.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(1+q)),s=Math.floor(e.baseMediaDecodeTime%(1+q)),i=l(S.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),92,"audio"===e.type?(n=T(e,92),l(S.traf,t,i,n)):(r=g(e),n=T(e,r.length+92),l(S.traf,t,i,n,r))},d=function(e){return e.duration=e.duration||4294967295,l(S.trak,h(e),p(e))},b=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),l(S.trex,t)},j=function(e,t){var i=0,n=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(n=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,i|n|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},B=function(e,t){var i,n,r,a,s,o;for(t+=20+16*(a=e.samples||[]).length,r=j(a,t),(n=new Uint8Array(r.length+16*a.length)).set(r),i=r.length,o=0;o<a.length;o++)s=a[o],n[i++]=(4278190080&s.duration)>>>24,n[i++]=(16711680&s.duration)>>>16,n[i++]=(65280&s.duration)>>>8,n[i++]=255&s.duration,n[i++]=(4278190080&s.size)>>>24,n[i++]=(16711680&s.size)>>>16,n[i++]=(65280&s.size)>>>8,n[i++]=255&s.size,n[i++]=s.flags.isLeading<<2|s.flags.dependsOn,n[i++]=s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,n[i++]=61440&s.flags.degradationPriority,n[i++]=15&s.flags.degradationPriority,n[i++]=(4278190080&s.compositionTimeOffset)>>>24,n[i++]=(16711680&s.compositionTimeOffset)>>>16,n[i++]=(65280&s.compositionTimeOffset)>>>8,n[i++]=255&s.compositionTimeOffset;return l(S.trun,n)},F=function(e,t){var i,n,r,a,s,o;for(t+=20+8*(a=e.samples||[]).length,r=j(a,t),(i=new Uint8Array(r.length+8*a.length)).set(r),n=r.length,o=0;o<a.length;o++)s=a[o],i[n++]=(4278190080&s.duration)>>>24,i[n++]=(16711680&s.duration)>>>16,i[n++]=(65280&s.duration)>>>8,i[n++]=255&s.duration,i[n++]=(4278190080&s.size)>>>24,i[n++]=(16711680&s.size)>>>16,i[n++]=(65280&s.size)>>>8,i[n++]=255&s.size;return l(S.trun,i)},T=function(e,t){return"audio"===e.type?F(e,t):B(e,t)};r=function(){return l(S.ftyp,k,C,k,E)};function H(e,t){var i={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return i.dataOffset=t,i.compositionTimeOffset=e.pts-e.dts,i.duration=e.duration,i.size=4*e.length,i.size+=e.byteLength,e.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i}function W(e){for(var t=[];e--;)t.push(0);return t}function z(){if(!X){var e={96e3:[ue,[227,64],W(154),[56]],88200:[ue,[231],W(170),[56]],64e3:[ue,[248,192],W(240),[56]],48e3:[ue,[255,192],W(268),[55,148,128],W(54),[112]],44100:[ue,[255,192],W(268),[55,163,128],W(84),[112]],32e3:[ue,[255,192],W(268),[55,234],W(226),[112]],24e3:[ue,[255,192],W(268),[55,255,128],W(268),[111,112],W(126),[224]],16e3:[ue,[255,192],W(268),[55,255,128],W(268),[111,255],W(269),[223,108],W(195),[1,192]],12e3:[le,W(268),[3,127,248],W(268),[6,255,240],W(268),[13,255,224],W(268),[27,253,128],W(259),[56]],11025:[le,W(268),[3,127,248],W(268),[6,255,240],W(268),[13,255,224],W(268),[27,255,192],W(268),[55,175,128],W(108),[112]],8e3:[le,W(268),[3,121,16],W(47),[7]]};X=function(i){return Object.keys(i).reduce(function(e,t){return e[t]=new Uint8Array(i[t].reduce(function(e,t){return e.concat(t)},[])),e},{})}(e)}return X}function G(){G.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Me(0,0),new Me(0,1),new Me(1,0),new Me(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))},this)}var X,K,Y,$,Q,J=function(e){return l(S.mdat,e)},Z=s,ee=function(e){var t,i=r(),n=o(e);return(t=new Uint8Array(i.byteLength+n.byteLength)).set(i),t.set(n,i.byteLength),t},te=function(e){var t,i,n=[],r=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,t=n.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(n.length&&(n.duration=i.dts-n.dts,r.byteLength+=n.byteLength,r.nalCount+=n.length,r.duration+=n.duration,r.push(n)),(n=[i]).byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(n.keyFrame=!0),n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i));return r.length&&(!n.duration||n.duration<=0)&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.length,r.duration+=n.duration,r.push(n),r},ie=function(e){var t,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(n.length&&(r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration),(n=[i]).nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return r.length&&n.duration<=0&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r},ne=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},re=function(e,t){var i,n,r,a,s,o=t||0,u=[];for(i=0;i<e.length;i++)for(a=e[i],n=0;n<a.length;n++)s=a[n],o+=(r=H(s,o)).size,u.push(r);return u},ae=function(e){var t,i,n,r,a,s,o=0,u=e.byteLength,l=e.nalCount,c=new Uint8Array(u+4*l),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(r=e[t],i=0;i<r.length;i++)for(a=r[i],n=0;n<a.length;n++)s=a[n],d.setUint32(o,s.data.byteLength),o+=4,c.set(s.data,o),o+=s.data.byteLength;return c},se=function(e,t){var i,n=[];return i=H(e,t||0),n.push(i),n},oe=function(e){var t,i,n=0,r=e.byteLength,a=e.length,s=new Uint8Array(r+4*a),o=new DataView(s.buffer);for(t=0;t<e.length;t++)i=e[t],o.setUint32(n,i.data.byteLength),n+=4,s.set(i.data,n),n+=i.data.byteLength;return s},ue=[33,16,5,32,164,27],le=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ce=9e4,de=(Y=function(e,t){return e*t},$=function(e){return e/9e4}),he=(Q=function(e,t){return e/t},function(e,t){return K(Q(e,t))}),pe=function(e,t){return Y($(e),t)},fe=function(e,t,i){return $(i?e:e-t)},me=K=function(e){return 9e4*e},ge=de,ve=function(e,t,i,n){var r,a,s,o,u,l=0,c=0,d=0;if(t.length&&(r=he(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(ce/(e.samplerate/1024)),i&&n&&(l=r-Math.max(i,n),d=(c=Math.floor(l/a))*a),!(c<1||ce/2<d))){for(s=(s=z()[e.samplerate])||t[0].data,o=0;o<c;o++)u=t[0],t.splice(0,0,{data:s,dts:u.dts-a,pts:u.pts-a});e.baseMediaDecodeTime-=Math.floor(pe(d,e.samplerate))}},ye=function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},_e=function(e){var t,i,n=[];for(t=0;t<e.length;t++)i=e[t],n.push({size:i.data.byteLength,duration:1024});return n},be=function(e){var t,i,n=0,r=new Uint8Array(function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].data.byteLength;return i}(e));for(t=0;t<e.length;t++)i=e[t],r.set(i.data,n),n+=i.data.byteLength;return r},Te=ce,Se=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},ke=function(e,t){var i,n=e.minSegmentDts;return t||(n-=e.timelineStartInfo.dts),i=e.timelineStartInfo.baseMediaDecodeTime,i+=n,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/Te,i=Math.floor(i)),i},Ce=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Ee=function(e){for(var t=0,i={payloadType:-1,payloadSize:0},n=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)n+=255,t++;for(n+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!i.payload&&4===n){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){i.payloadType=n,i.payloadSize=r,i.payload=e.subarray(t,t+r);break}i.payload=void 0}t+=r,r=n=0}return i},we=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ie=function(e,t){var i,n,r,a,s=[];if(!(64&t[0]))return s;for(n=31&t[0],i=0;i<n;i++)a={type:3&t[2+(r=3*i)],pts:e},4&t[2+r]&&(a.ccData=t[3+r]<<8|t[4+r],s.push(a));return s},Ae=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},xe=4;(G.prototype=new V).push=function(e){var t,i,n;if("sei_rbsp"===e.nalUnitType&&(t=Ee(e.escapedRBSP)).payloadType===xe&&(i=we(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=Ie(e.pts,i),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},G.prototype.flushCCStreams=function(t){this.ccStreams_.forEach(function(e){return"flush"===t?e.flush():e.partialFlush()},this)},G.prototype.flushStream=function(e){this.captionPackets_.length&&(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0),this.flushCCStreams(e)},G.prototype.flush=function(){return this.flushStream("flush")},G.prototype.partialFlush=function(){return this.flushStream("partialFlush")},G.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},G.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},G.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},G.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},G.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};function Pe(e){return null===e?"":(e=Oe[e]||e,String.fromCharCode(e))}function Le(){for(var e=[],t=15;t--;)e.push("");return e}var Oe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},De=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Me=function e(t,i){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,n,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),n=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Le();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Le();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Le()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(n,r))a=Pe((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(n,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Pe((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(n,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(n,r))this.column_+=3&r;else if(this.isPAC(n,r)){var s=De.indexOf(7968&t);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(n)&&(0===r&&(r=null),a=Pe(n),a+=Pe(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Me.prototype=new V,Me.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return""}}).join("\\n").replace(/^\\n+|\\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Me.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Le(),this.nonDisplayed_=Le(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Me.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Me.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},Me.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},Me.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},Me.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},Me.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},Me.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},Me.prototype.isNormalChar=function(e){return 32<=e&&e<=127},Me.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Le(),this.displayed_=Le()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Me.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,i)},Me.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Me.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];i+=t,this.nonDisplayed_[this.row_]=i},Me.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];i+=t,this.displayed_[this.row_]=i},Me.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Me.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];i+=t,this.displayed_[this.row_]=i};function Re(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}function Ne(e){var t,i;Ne.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===i&&(i=e.dts),e.dts=Re(e.dts,i),e.pts=Re(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){t=i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}var Ue={CaptionStream:G,Cea608Stream:Me},Fe={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};Ne.prototype=new V;function Be(e,t,i){var n,r="";for(n=t;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}function je(e,t,i){return decodeURIComponent(Be(e,t,i))}function Ve(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var qe,He=Ne,We={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=je(e.data,1,t),e.value=je(e.data,t+1,e.data.length).replace(/\\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=je(e.data,1,t),e.url=je(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,i;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(i=e.data,unescape(Be(i,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(qe=function(e){var t,u={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},l=0,c=[],d=0;if(qe.prototype.init.call(this),this.dispatchType=Fe.METADATA_STREAM_TYPE.toString(16),u.descriptor)for(t=0;t<u.descriptor.length;t++)this.dispatchType+=("00"+u.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,n,r,a;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(d=0,c.length=0),0===c.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))u.debug;else if(c.push(e),d+=e.data.byteLength,1===c.length&&(l=Ve(e.data.subarray(6,10)),l+=10),!(d<l)){for(t={data:new Uint8Array(l),frames:[],pts:c[0].pts,dts:c[0].dts},a=0;a<l;)t.data.set(c[0].data.subarray(0,l-a),a),a+=c[0].data.byteLength,d-=c[0].data.byteLength,c.shift();i=10,64&t.data[5]&&(i+=4,i+=Ve(t.data.subarray(10,14)),l-=Ve(t.data.subarray(16,20)));do{if((n=Ve(t.data.subarray(i+4,i+8)))<1)return;if((r={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+n+10)}).key=r.id,We[r.id]&&(We[r.id](r),"com.apple.streaming.transportStreamTimestamp"===r.owner)){var s=r.data,o=(1&s[3])<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2;o*=4,o+=3&s[7],r.timeStamp=o,void 0===t.pts&&void 0===t.dts&&(t.pts=r.timeStamp,t.dts=r.timeStamp),this.trigger("timestamp",r)}t.frames.push(r),i+=10,i+=n}while(i<l);this.trigger("data",t)}}}).prototype=new V;var ze,Ge,Xe,Ke=qe,Ye=He;(ze=function(){var r=new Uint8Array(188),a=0;ze.prototype.init.call(this),this.push=function(e){var t,i=0,n=188;for(a?((t=new Uint8Array(e.byteLength+a)).set(r.subarray(0,a)),t.set(e,a),a=0):t=e;n<t.byteLength;)71!==t[i]||71!==t[n]?(i++,n++):(this.trigger("data",t.subarray(i,n)),i+=188,n+=188);i<t.byteLength&&(r.set(t.subarray(i),0),a=t.byteLength-i)},this.flush=function(){188===a&&71===r[0]&&(this.trigger("data",r),a=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){a=0,this.trigger("reset")}}).prototype=new V,(Ge=function(){var n,r,a,s;Ge.prototype.init.call(this),(s=this).packetsWaitingForPmt=[],this.programMapTable=void 0,n=function(e,t){var i=0;t.payloadUnitStartIndicator&&(i+=e[i]+1),"pat"===t.type?r(e.subarray(i),t):a(e.subarray(i),t)},r=function(e,t){t.section_number=e[7],t.last_section_number=e[8],s.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=s.pmtPid},a=function(e,t){var i,n;if(1&e[5]){for(s.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,n=12+((15&e[10])<<8|e[11]);n<i;){var r=e[n],a=(31&e[n+1])<<8|e[n+2];r===Fe.H264_STREAM_TYPE&&null===s.programMapTable.video?s.programMapTable.video=a:r===Fe.ADTS_STREAM_TYPE&&null===s.programMapTable.audio?s.programMapTable.audio=a:r===Fe.METADATA_STREAM_TYPE&&(s.programMapTable["timed-metadata"][a]=r),n+=5+((15&e[n+3])<<8|e[n+4])}t.programMapTable=s.programMapTable}},this.push=function(e){var t={},i=4;if(t.payloadUnitStartIndicator=!!(64&e[1]),t.pid=31&e[1],t.pid<<=8,t.pid|=e[2],1<(48&e[3])>>>4&&(i+=e[i]+1),0===t.pid)t.type="pat",n(e.subarray(i),t),this.trigger("data",t);else if(t.pid===this.pmtPid)for(t.type="pmt",n(e.subarray(i),t),this.trigger("data",t);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,i,t]):this.processPes_(e,i,t)},this.processPes_=function(e,t,i){i.pid===this.programMapTable.video?i.streamType=Fe.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=Fe.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new V,Ge.STREAM_TYPES={h264:27,adts:15},(Xe=function(){function n(e,t,i){var n,r,a=new Uint8Array(e.size),s={type:t},o=0,u=0;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,o=0;o<e.data.length;o++)r=e.data[o],a.set(r.data,u),u+=r.data.byteLength;!function(e,t){var i;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(i=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&i&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])}(a,s),n="video"===t||s.packetLength<=e.size,(i||n)&&(e.size=0,e.data.length=0),n&&l.trigger("data",s)}}var t,l=this,r={data:[],size:0},a={data:[],size:0},s={data:[],size:0};Xe.prototype.init.call(this),this.push=function(i){({pat:function(){},pes:function(){var e,t;switch(i.streamType){case Fe.H264_STREAM_TYPE:e=r,t="video";break;case Fe.ADTS_STREAM_TYPE:e=a,t="audio";break;case Fe.METADATA_STREAM_TYPE:e=s,t="timed-metadata";break;default:return}i.payloadUnitStartIndicator&&n(e,t,!0),e.data.push(i),e.size+=i.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]};null!==(t=i.programMapTable).video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),l.trigger("data",e)}})[i.type]()},this.reset=function(){r.size=0,r.data.length=0,a.size=0,a.data.length=0,this.trigger("reset")},this.flushStreams_=function(){n(r,"video"),n(a,"audio"),n(s,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new V;var $e={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:ze,TransportParseStream:Ge,ElementaryStream:Xe,TimestampRolloverStream:Ye,CaptionStream:Ue.CaptionStream,Cea608Stream:Ue.Cea608Stream,MetadataStream:Ke};for(var Qe in Fe)Fe.hasOwnProperty(Qe)&&($e[Qe]=Fe[Qe]);var Je,Ze=$e,et=ce,tt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Je=function(u){var l,c=0;Je.prototype.init.call(this),this.push=function(e){var t,i,n,r,a,s,o=0;if(u||(c=0),"audio"===e.type)for(l?(r=l,(l=new Uint8Array(r.byteLength+e.data.byteLength)).set(r),l.set(e.data,r.byteLength)):l=e.data;o+5<l.length;)if(255===l[o]&&240==(246&l[o+1])){if(i=2*(1&~l[o+1]),t=(3&l[o+3])<<11|l[o+4]<<3|(224&l[o+5])>>5,s=(a=1024*(1+(3&l[o+6])))*et/tt[(60&l[o+2])>>>2],n=o+t,l.byteLength<n)return;if(this.trigger("data",{pts:e.pts+c*s,dts:e.dts+c*s,sampleCount:a,audioobjecttype:1+(l[o+2]>>>6&3),channelcount:(1&l[o+2])<<2|(192&l[o+3])>>>6,samplerate:tt[(60&l[o+2])>>>2],samplingfrequencyindex:(60&l[o+2])>>>2,samplesize:16,data:l.subarray(o+7+i,n)}),c++,l.byteLength===n)return void(l=void 0);l=l.subarray(n)}else o++},this.flush=function(){c=0,this.trigger("done")},this.reset=function(){l=void 0,this.trigger("reset")},this.endTimeline=function(){l=void 0,this.trigger("endedtimeline")}}).prototype=new V;var it,nt,rt,at=Je,st=function(n){var r=n.byteLength,a=0,s=0;this.length=function(){return 8*r},this.bitsAvailable=function(){return 8*r+s},this.loadWord=function(){var e=n.byteLength-r,t=new Uint8Array(4),i=Math.min(4,r);if(0===i)throw new Error("no bytes available");t.set(n.subarray(e,e+i)),a=new DataView(t.buffer).getUint32(0),s=8*i,r-=i},this.skipBits=function(e){var t;e<s||(e-=s,e-=8*(t=Math.floor(e/8)),r-=t,this.loadWord()),a<<=e,s-=e},this.readBits=function(e){var t=Math.min(s,e),i=a>>>32-t;return 0<(s-=t)?a<<=t:0<r&&this.loadWord(),0<(t=e-t)?i<<t|this.readBits(t):i},this.skipLeadingZeros=function(){var e;for(e=0;e<s;++e)if(0!=(a&2147483648>>>e))return a<<=e,s-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(nt=function(){var n,r,a=0;nt.prototype.init.call(this),this.push=function(e){for(var t,i=(r=r?((t=new Uint8Array(r.byteLength+e.data.byteLength)).set(r),t.set(e.data,r.byteLength),t):e.data).byteLength;a<i-3;a++)if(1===r[a+2]){n=a+5;break}for(;n<i;)switch(r[n]){case 0:if(0!==r[n-1]){n+=2;break}if(0!==r[n-2]){n++;break}for(a+3!==n-2&&this.trigger("data",r.subarray(a+3,n-2));1!==r[++n]&&n<i;);a=n-2,n+=3;break;case 1:if(0!==r[n-1]||0!==r[n-2]){n+=3;break}this.trigger("data",r.subarray(a+3,n-2)),a=n-2,n+=3;break;default:n+=3}r=r.subarray(a),n-=a,a=0},this.reset=function(){r=null,a=0,this.trigger("reset")},this.flush=function(){r&&3<r.byteLength&&this.trigger("data",r.subarray(a+3)),r=null,a=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new V,rt={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(it=function(){var i,n,r,a,s,o,_,t=new nt;it.prototype.init.call(this),(i=this).push=function(e){"video"===e.type&&(n=e.trackId,r=e.pts,a=e.dts,t.push(e))},t.on("data",function(e){var t={trackId:n,pts:r,dts:a,data:e};switch(31&e[0]){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp",t.escapedRBSP=s(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp",t.escapedRBSP=s(e.subarray(1)),t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp"}i.trigger("data",t)}),t.on("done",function(){i.trigger("done")}),t.on("partialdone",function(){i.trigger("partialdone")}),t.on("reset",function(){i.trigger("reset")}),t.on("endedtimeline",function(){i.trigger("endedtimeline")}),this.flush=function(){t.flush()},this.partialFlush=function(){t.partialFlush()},this.reset=function(){t.reset()},this.endTimeline=function(){t.endTimeline()},_=function(e,t){var i,n=8,r=8;for(i=0;i<e;i++)0!==r&&(r=(n+t.readExpGolomb()+256)%256),n=0===r?n:r},s=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},o=function(e){var t,i,n,r,a,s,o,u,l,c,d,h,p,f=0,m=0,g=0,v=0,y=1;if(i=(t=new st(e)).readUnsignedByte(),r=t.readUnsignedByte(),n=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),rt[i]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,p=0;p<d;p++)t.readBoolean()&&_(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),o=t.readUnsignedExpGolomb(),p=0;p<o;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),l=t.readUnsignedExpGolomb(),0===(c=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(f=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}h&&(y=h[0]/h[1])}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*f-2*m)*y),height:(2-c)*(l+1)*16-2*g-2*v,sarRatio:h}}}).prototype=new V;function ot(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return i=0<=i?i:0,(16&e[t+5])>>4?i+20:i+10}var ut,lt={H264Stream:it,NalByteStream:nt},ct=function(e){var t=function e(t,i){return t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0)?i:e(t,i+=ot(t,i))}(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},dt=ot,ht=function(e,t){var i=(224&e[t+5])>>5,n=e[t+4]<<3;return 6144&e[t+3]|n|i};(ut=function(){var o=new Uint8Array,u=0;ut.prototype.init.call(this),this.setTimestamp=function(e){u=e},this.push=function(e){var t,i,n,r,a=0,s=0;for(o.length?(r=o.length,(o=new Uint8Array(e.byteLength+r)).set(o.subarray(0,r)),o.set(e,r)):o=e;3<=o.length-s;)if(o[s]!=="I".charCodeAt(0)||o[s+1]!=="D".charCodeAt(0)||o[s+2]!=="3".charCodeAt(0))if(255!=(255&o[s])||240!=(240&o[s+1]))s++;else{if(o.length-s<7)break;if(s+(a=ht(o,s))>o.length)break;n={type:"audio",data:o.subarray(s,s+a),pts:u,dts:u},this.trigger("data",n),s+=a}else{if(o.length-s<10)break;if(s+(a=dt(o,s))>o.length)break;i={type:"timed-metadata",data:o.subarray(s,s+a)},this.trigger("data",i),s+=a}t=o.length-s,o=0<t?o.subarray(s):new Uint8Array},this.reset=function(){o=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){o=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new V;function pt(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function ft(e,t,i,n,r,a){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(n-t),pts:e+(r-i)},prependedContentDuration:a,baseMediaDecodeTime:e}}var mt,gt,vt,yt,_t=ut,bt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Tt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],St=lt.H264Stream,kt=ct,Ct=ce;(gt=function(a,s){var o=[],u=0,l=0,c=0,d=1/0;s=s||{},gt.prototype.init.call(this),this.push=function(t){Ce(a,t),a&&bt.forEach(function(e){a[e]=t[e]}),o.push(t)},this.setEarliestDts=function(e){l=e},this.setVideoBaseMediaDecodeTime=function(e){d=e},this.setAudioAppendStart=function(e){c=e},this.flush=function(){var e,t,i,n,r;0!==o.length&&(e=ye(o,a,l),a.baseMediaDecodeTime=ke(a,s.keepOriginalTimestamps),ve(a,e,c,d),a.samples=_e(e),i=J(be(e)),o=[],t=Z(u,[a]),n=new Uint8Array(t.byteLength+i.byteLength),u++,n.set(t),n.set(i,t.byteLength),Se(a),r=Math.ceil(1024*Ct/a.samplerate),e.length&&this.trigger("timingInfo",{start:e[0].pts,end:e[0].pts+e.length*r}),this.trigger("data",{track:a,boxes:n})),this.trigger("done","AudioSegmentStream")},this.reset=function(){Se(a),o=[],this.trigger("reset")}}).prototype=new V,(mt=function(c,d){var t,i,h=0,p=[],f=[];d=d||{},mt.prototype.init.call(this),delete c.minPTS,this.gopCache_=[],this.push=function(e){Ce(c,e),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,c.sps=[e.data],Tt.forEach(function(e){c[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.data,c.pps=[e.data]),p.push(e)},this.flush=function(){for(var e,t,i,n,r,a,s,o,u=0;p.length&&"access_unit_delimiter_rbsp"!==p[0].nalUnitType;)p.shift();if(0===p.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(e=te(p),(i=ie(e))[0][0].keyFrame||((t=this.getGopForFusion_(p[0],c))?(u=t.duration,i.unshift(t),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.pts=t.pts,i.dts=t.dts,i.duration+=t.duration):i=ne(i)),f.length){var l;if(!(l=d.alignGopsAtEnd?this.alignGopsAtEnd_(i):this.alignGopsAtStart_(i)))return this.gopCache_.unshift({gop:i.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),p=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Se(c),i=l}Ce(c,i),c.samples=re(i),r=J(ae(i)),c.baseMediaDecodeTime=ke(c,d.keepOriginalTimestamps),this.trigger("processedGopsInfo",i.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),s=i[0],o=i[i.length-1],this.trigger("segmentTimingInfo",ft(c.baseMediaDecodeTime,s.dts,s.pts,o.dts+o.duration,o.pts+o.duration,u)),this.trigger("timingInfo",{start:i[0].pts,end:i[i.length-1].pts+i[i.length-1].duration}),this.gopCache_.unshift({gop:i.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),p=[],this.trigger("baseMediaDecodeTime",c.baseMediaDecodeTime),this.trigger("timelineStartInfo",c.timelineStartInfo),n=Z(h,[c]),a=new Uint8Array(n.byteLength+r.byteLength),h++,a.set(n),a.set(r,n.byteLength),this.trigger("data",{track:c,boxes:a}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),p=[],this.gopCache_.length=0,f.length=0,this.trigger("reset")},this.resetStream_=function(){Se(c),i=t=void 0},this.getGopForFusion_=function(e){var t,i,n,r,a,s=1/0;for(a=0;a<this.gopCache_.length;a++)n=(r=this.gopCache_[a]).gop,c.pps&&pt(c.pps[0],r.pps[0])&&c.sps&&pt(c.sps[0],r.sps[0])&&(n.dts<c.timelineStartInfo.dts||-1e4<=(t=e.dts-n.dts-n.duration)&&t<=45e3&&(!i||t<s)&&(i=r,s=t));return i?i.gop:null},this.alignGopsAtStart_=function(e){var t,i,n,r,a,s,o,u;for(a=e.byteLength,s=e.nalCount,o=e.duration,t=i=0;t<f.length&&i<e.length&&(n=f[t],r=e[i],n.pts!==r.pts);)r.pts>n.pts?t++:(i++,a-=r.byteLength,s-=r.nalCount,o-=r.duration);return 0===i?e:i===e.length?null:((u=e.slice(i)).byteLength=a,u.duration=o,u.nalCount=s,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,i,n,r,a,s,o;for(t=f.length-1,i=e.length-1,a=null,s=!1;0<=t&&0<=i;){if(n=f[t],r=e[i],n.pts===r.pts){s=!0;break}n.pts>r.pts?t--:(t===f.length-1&&(a=i),i--)}if(!s&&null===a)return null;if(0===(o=s?i:a))return e;var u=e.slice(o),l=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=l.byteLength,u.duration=l.duration,u.nalCount=l.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){f=e}}).prototype=new V,(yt=function(e,t){this.numberOfTracks=0,this.metadataStream=t,"undefined"!=typeof(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,yt.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new V,yt.prototype.flush=function(e){var t,i,n,r,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,Tt.forEach(function(e){s.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,bt.forEach(function(e){s.info[e]=this.audioTrack[e]},this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,n=ee(this.pendingTracks),s.initSegment=new Uint8Array(n.byteLength),s.initSegment.set(n),s.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)s.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=fe(t.startPts,o,this.keepOriginalTimestamps),t.endTime=fe(t.endPts,o,this.keepOriginalTimestamps),s.captionStreams[t.stream]=!0,s.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(i=this.pendingMetadata[r]).cueTime=fe(i.pts,o,this.keepOriginalTimestamps),s.metadata.push(i);for(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),r=0;r<s.captions.length;r++)t=s.captions[r],this.trigger("caption",t);for(r=0;r<s.metadata.length;r++)i=s.metadata[r],this.trigger("id3Frame",i)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},yt.prototype.setRemux=function(e){this.remuxTracks=e},(vt=function(n){var r,a,s=this,i=!0;vt.prototype.init.call(this),n=n||{},this.baseMediaDecodeTime=n.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new Ze.MetadataStream,t.aacStream=new _t,t.audioTimestampRolloverStream=new Ze.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Ze.TimestampRolloverStream("timed-metadata"),t.adtsStream=new at,t.coalesceStream=new yt(n,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type&&"audio"!==e.type||t.audioSegmentStream||(a=a||{timelineStartInfo:{baseMediaDecodeTime:s.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new gt(a,n),t.audioSegmentStream.on("timingInfo",s.trigger.bind(s,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream),s.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!r}))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};(this.transmuxPipeline_=i).type="ts",i.metadataStream=new Ze.MetadataStream,i.packetStream=new Ze.TransportPacketStream,i.parseStream=new Ze.TransportParseStream,i.elementaryStream=new Ze.ElementaryStream,i.timestampRolloverStream=new Ze.TimestampRolloverStream,i.adtsStream=new at,i.h264Stream=new St,i.captionStream=new Ze.CaptionStream,i.coalesceStream=new yt(n,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",function(e){var t;if("metadata"===e.type){for(t=e.tracks.length;t--;)r||"video"!==e.tracks[t].type?a||"audio"!==e.tracks[t].type||((a=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime):(r=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime;r&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new mt(r,n),i.videoSegmentStream.on("timelineStartInfo",function(e){a&&!n.keepOriginalTimestamps&&(a.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts-s.baseMediaDecodeTime))}),i.videoSegmentStream.on("processedGopsInfo",s.trigger.bind(s,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",s.trigger.bind(s,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",function(e){a&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),i.videoSegmentStream.on("timingInfo",s.trigger.bind(s,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),a&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new gt(a,n),i.audioSegmentStream.on("timingInfo",s.trigger.bind(s,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),s.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!r})}}),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",function(e){e.dispatchType=i.metadataStream.dispatchType,s.trigger("id3Frame",e)}),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;n.keepOriginalTimestamps||(this.baseMediaDecodeTime=e),a&&(a.timelineStartInfo.dts=void 0,a.timelineStartInfo.pts=void 0,Se(a),t.audioTimestampRolloverStream&&t.audioTimestampRolloverStream.discontinuity()),r&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),r.timelineStartInfo.dts=void 0,r.timelineStartInfo.pts=void 0,Se(r),t.captionStream.reset()),t.timestampRolloverStream&&t.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){a&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(e){var t=this.transmuxPipeline_;n.remux=e,t&&t.coalesceStream&&t.coalesceStream.setRemux(e)},this.alignGopsWith=function(e){r&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(i){var t=kt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new V;function Et(a,s){var o=[],u=0,l=0,c=0,d=1/0,h=null,p=null;s=s||{},Et.prototype.init.call(this),this.push=function(t){Ce(a,t),a&&bt.forEach(function(e){a[e]=t[e]}),o.push(t)},this.setEarliestDts=function(e){l=e},this.setVideoBaseMediaDecodeTime=function(e){d=e},this.setAudioAppendStart=function(e){c=e},this.processFrames_=function(){var e,t,i,n,r;0!==o.length&&0!==(e=ye(o,a,l)).length&&(a.baseMediaDecodeTime=ke(a,s.keepOriginalTimestamps),ve(a,e,c,d),a.samples=_e(e),i=J(be(e)),o=[],t=Z(u,[a]),u++,a.initSegment=ee([a]),(n=new Uint8Array(t.byteLength+i.byteLength)).set(t),n.set(i,t.byteLength),Se(a),null===h&&(p=h=e[0].pts),p+=e.length*(1024*At/a.samplerate),r={start:h},this.trigger("timingInfo",r),this.trigger("data",{track:a,boxes:n}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:h,end:p}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){Se(a),p=h=null},this.reset=function(){this.resetTiming_(),o=[],this.trigger("reset")}}var wt={Transmuxer:vt,VideoSegmentStream:mt,AudioSegmentStream:gt,AUDIO_PROPERTIES:bt,VIDEO_PROPERTIES:Tt,generateVideoSegmentTimingInfo:ft}.Transmuxer,It={Adts:at,h264:lt},At=ce;Et.prototype=new V;function xt(o,u){var t,i,l,c=0,d=[],h=[],p=null,f=null,m=!0;u=u||{},xt.prototype.init.call(this),this.push=function(e){Ce(o,e),"undefined"==typeof o.timelineStartInfo.dts&&(o.timelineStartInfo.dts=e.dts),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,o.sps=[e.data],Tt.forEach(function(e){o[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.data,o.pps=[e.data]),d.push(e)},this.processNals_=function(e){var t;for(d=h.concat(d);d.length&&"access_unit_delimiter_rbsp"!==d[0].nalUnitType;)d.shift();if(0!==d.length){var i=te(d);if(i.length)if(h=i[i.length-1],e&&(i.pop(),i.duration-=h.duration,i.nalCount-=h.length,i.byteLength-=h.byteLength),i.length){if(this.trigger("timelineStartInfo",o.timelineStartInfo),m){if(!(l=ie(i))[0][0].keyFrame){if(!(l=ne(l))[0][0].keyFrame)return d=[].concat.apply([],i).concat(h),void(h=[]);(i=[].concat.apply([],l)).duration=l.duration}m=!1}for(null===p&&(p=i[0].pts,f=p),f+=i.duration,this.trigger("timingInfo",{start:p,end:f}),t=0;t<i.length;t++){var n=i[t];o.samples=se(n);var r=J(oe(n));Se(o),Ce(o,n),o.baseMediaDecodeTime=ke(o,u.keepOriginalTimestamps);var a=Z(c,[o]);c++,o.initSegment=ee([o]);var s=new Uint8Array(a.byteLength+r.byteLength);s.set(a),s.set(r,a.byteLength),this.trigger("data",{track:o,boxes:s,sequence:c,videoFrameDts:n.dts,videoFramePts:n.pts})}d=[]}else d=[]}},this.resetTimingAndConfig_=function(){i=t=void 0,f=p=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),h=[],d=[],m=!0,this.trigger("reset")}}var Pt=Et;xt.prototype=new V;function Lt(e){return e.prototype=new V,e.prototype.init.call(e),e}function Ot(t,i){t.on("data",i.trigger.bind(i,"data")),t.on("done",i.trigger.bind(i,"done")),t.on("partialdone",i.trigger.bind(i,"partialdone")),t.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),t.on("audioTimingInfo",i.trigger.bind(i,"audioTimingInfo")),t.on("videoTimingInfo",i.trigger.bind(i,"videoTimingInfo")),t.on("trackinfo",i.trigger.bind(i,"trackinfo")),t.on("id3Frame",function(e){e.dispatchType=t.metadataStream.dispatchType,e.cueTime=de(e.pts),i.trigger("id3Frame",e)}),t.on("caption",function(e){i.trigger("caption",e)})}function Dt(i){var n=null,r=!0;i=i||{},Dt.prototype.init.call(this),i.baseMediaDecodeTime=i.baseMediaDecodeTime||0,this.push=function(e){if(r){var t=Rt(e);!t||n&&"aac"===n.type?t||n&&"ts"===n.type||(n=function(i){var n={type:"ts",tracks:{audio:null,video:null},packet:new Ze.TransportPacketStream,parse:new Ze.TransportParseStream,elementary:new Ze.ElementaryStream,timestampRollover:new Ze.TimestampRolloverStream,adts:new It.Adts,h264:new It.h264.H264Stream,captionStream:new Ze.CaptionStream,metadataStream:new Ze.MetadataStream};return n.headOfPipeline=n.packet,n.packet.pipe(n.parse).pipe(n.elementary).pipe(n.timestampRollover),n.timestampRollover.pipe(n.h264),n.h264.pipe(n.captionStream),n.timestampRollover.pipe(n.metadataStream),n.timestampRollover.pipe(n.adts),n.elementary.on("data",function(e){if("metadata"===e.type){for(var t=0;t<e.tracks.length;t++)n.tracks[e.tracks[t].type]||(n.tracks[e.tracks[t].type]=e.tracks[t],n.tracks[e.tracks[t].type].timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime);n.tracks.video&&!n.videoSegmentStream&&(n.videoSegmentStream=new Mt(n.tracks.video,i),n.videoSegmentStream.on("timelineStartInfo",function(e){n.tracks.audio&&!i.keepOriginalTimestamps&&n.audioSegmentStream.setEarliestDts(e.dts-i.baseMediaDecodeTime)}),n.videoSegmentStream.on("timingInfo",n.trigger.bind(n,"videoTimingInfo")),n.videoSegmentStream.on("data",function(e){n.trigger("data",{type:"video",data:e})}),n.videoSegmentStream.on("done",n.trigger.bind(n,"done")),n.videoSegmentStream.on("partialdone",n.trigger.bind(n,"partialdone")),n.videoSegmentStream.on("endedtimeline",n.trigger.bind(n,"endedtimeline")),n.h264.pipe(n.videoSegmentStream)),n.tracks.audio&&!n.audioSegmentStream&&(n.audioSegmentStream=new Pt(n.tracks.audio,i),n.audioSegmentStream.on("data",function(e){n.trigger("data",{type:"audio",data:e})}),n.audioSegmentStream.on("done",n.trigger.bind(n,"done")),n.audioSegmentStream.on("partialdone",n.trigger.bind(n,"partialdone")),n.audioSegmentStream.on("endedtimeline",n.trigger.bind(n,"endedtimeline")),n.audioSegmentStream.on("timingInfo",n.trigger.bind(n,"audioTimingInfo")),n.adts.pipe(n.audioSegmentStream)),n.trigger("trackinfo",{hasAudio:!!n.tracks.audio,hasVideo:!!n.tracks.video})}}),n.captionStream.on("data",function(e){var t;t=n.tracks.video&&n.tracks.video.timelineStartInfo.pts||0,e.startTime=fe(e.startPts,t,i.keepOriginalTimestamps),e.endTime=fe(e.endPts,t,i.keepOriginalTimestamps),n.trigger("caption",e)}),(n=Lt(n)).metadataStream.on("data",n.trigger.bind(n,"id3Frame")),n}(i),Ot(n,this)):(n=function(t){var i={type:"aac",tracks:{audio:null},metadataStream:new Ze.MetadataStream,aacStream:new _t,audioRollover:new Ze.TimestampRolloverStream("audio"),timedMetadataRollover:new Ze.TimestampRolloverStream("timed-metadata"),adtsStream:new at(!0)};return i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioRollover).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataRollover).pipe(i.metadataStream),i.metadataStream.on("timestamp",function(e){i.aacStream.setTimestamp(e.timeStamp)}),i.aacStream.on("data",function(e){"timed-metadata"!==e.type&&"audio"!==e.type||i.audioSegmentStream||(i.tracks.audio=i.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"},i.audioSegmentStream=new Pt(i.tracks.audio,t),i.audioSegmentStream.on("data",function(e){i.trigger("data",{type:"audio",data:e})}),i.audioSegmentStream.on("partialdone",i.trigger.bind(i,"partialdone")),i.audioSegmentStream.on("done",i.trigger.bind(i,"done")),i.audioSegmentStream.on("endedtimeline",i.trigger.bind(i,"endedtimeline")),i.audioSegmentStream.on("timingInfo",i.trigger.bind(i,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream),i.trigger("trackinfo",{hasAudio:!!i.tracks.audio,hasVideo:!!i.tracks.video}))}),(i=Lt(i)).metadataStream.on("data",i.trigger.bind(i,"id3Frame")),i}(i),Ot(n,this)),r=!1}n.headOfPipeline.push(e)},this.flush=function(){n&&(r=!0,n.headOfPipeline.flush())},this.partialFlush=function(){n&&n.headOfPipeline.partialFlush()},this.endTimeline=function(){n&&n.headOfPipeline.endTimeline()},this.reset=function(){n&&n.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(e){i.keepOriginalTimestamps||(i.baseMediaDecodeTime=e),n&&(n.tracks.audio&&(n.tracks.audio.timelineStartInfo.dts=void 0,n.tracks.audio.timelineStartInfo.pts=void 0,Se(n.tracks.audio),n.audioRollover&&n.audioRollover.discontinuity()),n.tracks.video&&(n.videoSegmentStream&&(n.videoSegmentStream.gopCache_=[]),n.tracks.video.timelineStartInfo.dts=void 0,n.tracks.video.timelineStartInfo.pts=void 0,Se(n.tracks.video)),n.timestampRollover&&n.timestampRollover.discontinuity())},this.setRemux=function(e){i.remux=e,n&&n.coalesceStream&&n.coalesceStream.setRemux(e)},this.setAudioAppendStart=function(e){n&&n.tracks.audio&&n.audioSegmentStream&&n.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){}}var Mt=xt,Rt=ct;Dt.prototype=new V;function Nt(e,t){for(var i=e,n=0;n<t.length;n++){var r=t[n];if(i<r.size)return r;i-=r.size}return null}function Ut(e,c){var n=Ht(e,["moof","traf"]),t=Ht(e,["mdat"]),d={},r=[];return t.forEach(function(e,t){var i=n[t];r.push({mdat:e,traf:i})}),r.forEach(function(e){var t,i=e.mdat,n=e.traf,r=Ht(n,["tfhd"]),a=Kt(r[0]),s=a.trackId,o=Ht(n,["tfdt"]),u=0<o.length?zt(o[0]).baseMediaDecodeTime:0,l=Ht(n,["trun"]);c===s&&0<l.length&&(t=function(e,t,i){var n,r,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),u=[];for(r=0;r+4<e.length;r+=a)if(a=o.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var l=e.subarray(r+1,r+1+a),c=Nt(r,t);if(n={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:Yt(l),trackId:i},c)n.pts=c.pts,n.dts=c.dts,s=c;else{if(!s)break;n.pts=s.pts,n.dts=s.dts}u.push(n)}return u}(i,function(e,t,i){var n=t,r=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,o=[];return e.forEach(function(e){var t=Xt(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=n,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=n+e.compositionTimeOffset,n+=e.duration}),o=o.concat(t)}),o}(l,u,a),s),d[s]||(d[s]=[]),d[s]=d[s].concat(t))}),d}function Ft(e){return"AudioSegmentStream"===e?"audio":"VideoSegmentStream"===e?"video":""}var Bt=Dt,jt=function(e){return e>>>0},Vt=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},qt=jt,Ht=function e(t,i){var n,r,a,s,o,u=[];if(!i.length)return null;for(n=0;n<t.byteLength;)r=qt(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]),a=Vt(t.subarray(n+4,n+8)),s=1<r?n+r:t.byteLength,a===i[0]&&(1===i.length?u.push(t.subarray(n+8,s)):(o=e(t.subarray(n+8,s),i.slice(1))).length&&(u=u.concat(o))),n=s;return u},Wt=jt,zt=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:Wt(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=Wt(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},Gt=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Xt=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],u=4&i.flags[1],l=8&i.flags[1],c=n.getUint32(4),d=8;for(r&&(i.dataOffset=n.getInt32(d),d+=4),a&&c&&(t={flags:Gt(e.subarray(d,d+4))},d+=4,s&&(t.duration=n.getUint32(d),d+=4),o&&(t.size=n.getUint32(d),d+=4),l&&(1===i.version?t.compositionTimeOffset=n.getInt32(d):t.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(t),c--);c--;)t={},s&&(t.duration=n.getUint32(d),d+=4),o&&(t.size=n.getUint32(d),d+=4),u&&(t.flags=Gt(e.subarray(d,d+4)),d+=4),l&&(1===i.version?t.compositionTimeOffset=n.getInt32(d):t.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(t);return i},Kt=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],s=8&n.flags[2],o=16&n.flags[2],u=32&n.flags[2],l=65536&n.flags[0],c=131072&n.flags[0];return t=8,r&&(t+=4,n.baseDataOffset=i.getUint32(12),t+=4),a&&(n.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(n.defaultSampleDuration=i.getUint32(t),t+=4),o&&(n.defaultSampleSize=i.getUint32(t),t+=4),u&&(n.defaultSampleFlags=i.getUint32(t)),l&&(n.durationIsEmpty=!0),!r&&c&&(n.baseDataOffsetIsMoof=!0),n},Yt=Ae,$t=Ue.CaptionStream,Qt=function(){var t,a,s,o,u,i,n=!1;this.isInitialized=function(){return n},this.init=function(e){t=new $t,n=!0,i=!!e&&e.isPartial,t.on("data",function(e){e.startTime=e.startPts/o,e.endTime=e.endPts/o,u.captions.push(e),u.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length)&&(s!==e[0]||o!==t[s])},this.parse=function(e,t,i){var n;if(!this.isInitialized())return null;if(!t||!i)return null;if(this.isNewInit(t,i))s=t[0],o=i[s];else if(null===s||!o)return a.push(e),null;for(;0<a.length;){var r=a.shift();this.parse(r,t,i)}return null!==(n=function(e,t,i){return null===t?null:{seiNals:Ut(e,t)[t],timescale:i}}(e,s,o))&&n.seiNals?(this.pushNals(n.seiNals),this.flushStream(),u):null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach(function(e){t.push(e)})},this.flushStream=function(){if(!this.isInitialized())return null;i?t.partialFlush():t.flush()},this.clearParsedCaptions=function(){u.captions=[],u.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){a=[],o=s=null,u?this.clearParsedCaptions():u={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},Jt=function(){function e(e,t){this.options=t||{},this.self=e,this.init()}var t=e.prototype;return t.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=this.options.handlePartialData?new Bt(this.options):new wt(this.options),this.options.handlePartialData?function(n,e){e.on("data",function(e){var t={data:e.data.track.initSegment.buffer,byteOffset:e.data.track.initSegment.byteOffset,byteLength:e.data.track.initSegment.byteLength},i={boxes:{data:e.data.boxes.buffer,byteOffset:e.data.boxes.byteOffset,byteLength:e.data.boxes.byteLength},initSegment:t,type:e.type,sequence:e.data.sequence};"undefined"!=typeof e.data.videoFrameDts&&(i.videoFrameDtsTime=ge(e.data.videoFrameDts)),"undefined"!=typeof e.data.videoFramePts&&(i.videoFramePtsTime=ge(e.data.videoFramePts)),n.postMessage({action:"data",segment:i},[i.boxes.data,i.initSegment.data])}),e.on("id3Frame",function(e){n.postMessage({action:"id3Frame",id3Frame:e})}),e.on("caption",function(e){n.postMessage({action:"caption",caption:e})}),e.on("done",function(e){n.postMessage({action:"done",type:Ft(e)})}),e.on("partialdone",function(e){n.postMessage({action:"partialdone",type:Ft(e)})}),e.on("endedsegment",function(e){n.postMessage({action:"endedSegment",type:Ft(e)})}),e.on("trackinfo",function(e){n.postMessage({action:"trackinfo",trackInfo:e})}),e.on("audioTimingInfo",function(e){if(null!==e.start){var t={start:ge(e.start)};e.end&&(t.end=ge(e.end)),n.postMessage({action:"audioTimingInfo",audioTimingInfo:t})}else n.postMessage({action:"audioTimingInfo",audioTimingInfo:e})}),e.on("videoTimingInfo",function(e){var t={start:ge(e.start)};e.end&&(t.end=ge(e.end)),n.postMessage({action:"videoTimingInfo",videoTimingInfo:t})})}(this.self,this.transmuxer):function(n,e){e.on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};var i=e.data;e.data=i.buffer,n.postMessage({action:"data",segment:e,byteOffset:i.byteOffset,byteLength:i.byteLength},[e.data])}),e.on("done",function(e){n.postMessage({action:"done"})}),e.on("gopInfo",function(e){n.postMessage({action:"gopInfo",gopInfo:e})}),e.on("videoSegmentTimingInfo",function(e){var t={start:{decode:ge(e.start.dts),presentation:ge(e.start.pts)},end:{decode:ge(e.end.dts),presentation:ge(e.end.pts)},baseMediaDecodeTime:ge(e.baseMediaDecodeTime)};e.prependedContentDuration&&(t.prependedContentDuration=ge(e.prependedContentDuration)),n.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}),e.on("id3Frame",function(e){n.postMessage({action:"id3Frame",id3Frame:e})}),e.on("caption",function(e){n.postMessage({action:"caption",caption:e})}),e.on("trackinfo",function(e){n.postMessage({action:"trackinfo",trackInfo:e})}),e.on("audioTimingInfo",function(e){n.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:ge(e.start),end:ge(e.end)}})}),e.on("videoTimingInfo",function(e){n.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:ge(e.start),end:ge(e.end)}})})}(this.self,this.transmuxer)},t.pushMp4Captions=function(e){this.captionParser||(this.captionParser=new Qt,this.captionParser.init());var t=new Uint8Array(e.data,e.byteOffset,e.byteLength),i=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:i&&i.captions||[],data:t.buffer},[t.buffer])},t.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},t.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},t.push=function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)},t.reset=function(){this.transmuxer.reset()},t.setTimestampOffset=function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(me(t)))},t.setAudioAppendStart=function(e){this.transmuxer.setAudioAppendStart(Math.ceil(me(e.appendStart)))},t.setRemux=function(e){this.transmuxer.setRemux(e.remux)},t.flush=function(e){this.transmuxer.flush(),Zt.postMessage({action:"done",type:"transmuxed"})},t.partialFlush=function(e){this.transmuxer.partialFlush(),Zt.postMessage({action:"partialdone",type:"transmuxed"})},t.endTimeline=function(){this.transmuxer.endTimeline(),Zt.postMessage({action:"endedtimeline",type:"transmuxed"})},t.alignGopsWith=function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())},e}();new function(t){t.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new Jt(t,e.data.options):(this.messageHandlers||(this.messageHandlers=new Jt(t)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}(Zt)}()}),qc=Pc("PlaylistSelector"),Hc=function(n){function e(e,t){var i;if(i=n.call(this)||this,!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return i.bandwidth=e.bandwidth,i.throughput={rate:0,count:0},i.roundTrip=NaN,i.resetStats_(),i.mediaIndex=null,i.hasPlayed_=e.hasPlayed,i.currentTime_=e.currentTime,i.seekable_=e.seekable,i.seeking_=e.seeking,i.duration_=e.duration,i.mediaSource_=e.mediaSource,i.vhs_=e.vhs,i.loaderType_=e.loaderType,i.currentMediaInfo_=void 0,i.startingMediaInfo_=void 0,i.segmentMetadataTrack_=e.segmentMetadataTrack,i.goalBufferLength_=e.goalBufferLength,i.sourceType_=e.sourceType,i.sourceUpdater_=e.sourceUpdater,i.inbandTextTracks_=e.inbandTextTracks,i.state_="INIT",i.handlePartialData_=e.handlePartialData,i.timelineChangeController_=e.timelineChangeController,i.shouldSaveSegmentTimingInfo_=!0,i.checkBufferTimeout_=null,i.error_=void 0,i.currentTimeline_=-1,i.pendingSegment_=null,i.xhrOptions_=null,i.pendingSegments_=[],i.audioDisabled_=!1,i.isPendingTimestampOffset_=!1,i.gopBuffer_=[],i.timeMapping_=0,i.safeAppend_=11<=da.browser.IE_VERSION,i.appendInitSegment_={audio:!0,video:!0},i.playlistOfLastInitSegment_={audio:null,video:null},i.callQueue_=[],i.loadQueue_=[],i.metadataQueue_={id3:[],caption:[]},i.activeInitSegmentId_=null,i.initSegments_={},i.cacheEncryptionKeys_=e.cacheEncryptionKeys,i.keyCache_={},i.decrypter_=e.decrypter,i.syncController_=e.syncController,i.syncPoint_={segmentIndex:0,time:0},i.transmuxer_=i.createTransmuxer_(),i.triggerSyncInfoUpdate_=function(){return i.trigger("syncinfoupdate")},i.syncController_.on("syncinfoupdate",i.triggerSyncInfoUpdate_),i.mediaSource_.addEventListener("sourceopen",function(){i.isEndOfStream_()||(i.ended_=!1)}),i.fetchAtBuffer_=!1,i.logger_=Pc("SegmentLoader["+i.loaderType_+"]"),Object.defineProperty(Ve(i),"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e,this.trigger("statechange"))}}),i.sourceUpdater_.on("ready",function(){i.hasEnoughInfoToAppend_()&&i.processCallQueue_()}),"main"===i.loaderType_&&i.timelineChangeController_.on("pendingtimelinechange",function(){i.hasEnoughInfoToAppend_()&&i.processCallQueue_()}),"audio"===i.loaderType_&&i.timelineChangeController_.on("timelinechange",function(){i.hasEnoughInfoToLoad_()&&i.processLoadQueue_(),i.hasEnoughInfoToAppend_()&&i.processCallQueue_()}),i}Ge(e,n);var t=e.prototype;return t.createTransmuxer_=function(){var e=new Vc;return e.postMessage({action:"init",options:{remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,handlePartialData:this.handlePartialData_}}),e},t.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0},t.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&(this.transmuxer_.terminate(),hc()),this.resetStats_(),this.checkBufferTimeout_&&T.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},t.setAudio=function(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},t.abort=function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},t.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_)},t.checkForAbort_=function(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)},t.error=function(e){return"undefined"!=typeof e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_},t.endOfStream=function(){this.ended_=!0,this.transmuxer_&&dc(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},t.buffered_=function(){if(!this.sourceUpdater_||!this.startingMediaInfo_)return da.createTimeRanges();if("main"===this.loaderType_){var e=this.startingMediaInfo_,t=e.hasAudio,i=e.hasVideo,n=e.isMuxed;if(i&&t&&!this.audioDisabled_&&!n)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},t.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=gl(e),n=this.initSegments_[i];return t&&!n&&e.bytes&&(this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),n||e},t.segmentKey=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=vl(e),n=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!n&&e.bytes&&(this.keyCache_[i]=n={resolvedUri:e.resolvedUri,bytes:e.bytes});var r={resolvedUri:(n||e).resolvedUri};return n&&(r.bytes=n.bytes),r},t.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},t.load=function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}},t.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},t.playlist=function(e,t){if(void 0===t&&(t={}),e){var i=this.playlist_,n=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var r=null;if(i&&(i.id?r=i.id:i.uri&&(r=i.uri)),this.logger_("playlist update ["+r+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri)return null===this.mediaIndex&&!this.handlePartialData_||this.resyncLoader(),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var a=e.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),n&&(n.mediaIndex-=a,0<=n.mediaIndex&&(n.segment=e.segments[n.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(i,e)}},t.pause=function(){this.checkBufferTimeout_&&(T.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},t.paused=function(){return null===this.checkBufferTimeout_},t.resetEverything=function(e){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"})},t.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},t.resyncLoader=function(){this.transmuxer_&&dc(this.transmuxer_),this.mediaIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},t.remove=function(e,t,i){if(void 0===i&&(i=function(){}),t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.currentMediaInfo_){var n=1,r=function(){0===--n&&i()};for(var a in this.audioDisabled_||(n++,this.sourceUpdater_.removeAudio(e,t,r)),"main"===this.loaderType_&&this.currentMediaInfo_&&this.currentMediaInfo_.hasVideo&&(this.gopBuffer_=function(e,t,i,n){for(var r=Math.ceil((t-n)*fu),a=Math.ceil((i-n)*fu),s=e.slice(),o=e.length;o--&&!(e[o].pts<=a););if(-1===o)return s;for(var u=o+1;u--&&!(e[u].pts<=r););return u=Math.max(u,0),s.splice(u,o-u+1),s}(this.gopBuffer_,e,t,this.timeMapping_),n++,this.sourceUpdater_.removeVideo(e,t,r)),this.inbandTextTracks_)Nc(e,t,this.inbandTextTracks_[a]);Nc(e,t,this.segmentMetadataTrack_),r()}},t.monitorBuffer_=function(){this.checkBufferTimeout_&&T.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=T.setTimeout(this.monitorBufferTick_.bind(this),1)},t.monitorBufferTick_=function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&T.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=T.setTimeout(this.monitorBufferTick_.bind(this),500)},t.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.buffered_(),t=this.checkBuffer_(e,this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);t&&(t.timestampOffset=Bc({segmentTimeline:t.timeline,currentTimeline:this.currentTimeline_,startOfSegment:t.startOfSegment,buffered:e,overrideCheck:this.isPendingTimestampOffset_}),this.isPendingTimestampOffset_=!1,"number"==typeof t.timestampOffset&&this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline}),this.loadSegment_(t))}},t.isEndOfStream_=function(e,t){if(void 0===e&&(e=this.mediaIndex),void 0===t&&(t=this.playlist_),!t||!this.mediaSource_)return!1;var i=e+1===t.segments.length;return t.endList&&"open"===this.mediaSource_.readyState&&i},t.checkBuffer_=function(e,t,i,n,r,a){var s=0;e.length&&(s=e.end(e.length-1));var o=Math.max(0,s-r);if(!t.segments.length)return null;if(o>=this.goalBufferLength_())return null;if(!n&&1<=o)return null;var u,l=null,c=!1;if(null===a)l=this.getSyncSegmentCandidate_(t),c=!0;else if(null!==i){var d=t.segments[i];u=d&&d.end?d.end:s,l=i+1}else if(this.fetchAtBuffer_){var h=ic.getMediaInfoForTime(t,s,a.segmentIndex,a.time);l=h.mediaIndex,u=h.startTime}else{var p=ic.getMediaInfoForTime(t,r,a.segmentIndex,a.time);l=p.mediaIndex,u=p.startTime}var f=this.generateSegmentInfo_(t,l,u,c);return!f||this.mediaSource_&&this.playlist_&&f.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()?void 0:(this.logger_("checkBuffer_ returning "+f.uri,{segmentInfo:f,playlist:t,currentMediaIndex:i,nextMediaIndex:l,startOfSegment:u,isSyncRequest:c}),f)},t.getSyncSegmentCandidate_=function(e){var t=this;if(-1===this.currentTimeline_)return 0;var i=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)},t.generateSegmentInfo_=function(e,t,i,n){if(t<0||t>=e.segments.length)return null;var r,a,s=e.segments[t],o=this.sourceUpdater_.audioBuffered(),u=this.sourceUpdater_.videoBuffered();return o.length&&(r=o.end(o.length-1)-this.sourceUpdater_.audioTimestampOffset()),u.length&&(a=function(e,t,i){if("undefined"==typeof t||null===t||!e.length)return[];var n,r=Math.ceil((t-i+3)*fu);for(n=0;n<e.length&&!(e[n].pts>r);n++);return e.slice(n)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),{requestId:"segment-loader-"+Math.random(),uri:s.resolvedUri,mediaIndex:t,isSyncRequest:n,startOfSegment:i,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:s.timeline,duration:s.duration,segment:s,byteLength:0,transmuxer:this.transmuxer_,audioAppendStart:r,gopsToAlignWith:a}},t.abortRequestEarly_=function(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),i=e.bandwidth,n=this.pendingSegment_.duration,r=ic.estimateSegmentRequestTime(n,i,this.playlist_,e.bytesReceived),a=function(e,t,i){return void 0===i&&(i=1),((e.length?e.end(e.length-1):0)-t)/i}(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(r<=a)return!1;var s=function(e){var t=e.master,i=e.currentTime,n=e.bandwidth,r=e.duration,a=e.segmentDuration,s=e.timeUntilRebuffer,o=e.currentTimeline,u=e.syncController,l=t.playlists.filter(function(e){return!ic.isIncompatible(e)}),c=l.filter(ic.isEnabled);c.length||(c=l.filter(function(e){return!ic.isDisabled(e)}));var d=c.filter(ic.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var t=u.getSyncPoint(e,r,o,i)?1:2;return{playlist:e,rebufferingImpact:ic.estimateSegmentRequestTime(a,n,e)*t-s}}),h=d.filter(function(e){return e.rebufferingImpact<=0});return Dc(h,function(e,t){return Mc(t.playlist,e.playlist)}),h.length?h[0]:(Dc(d,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),d[0]||null)}({master:this.vhs_.playlists.master,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(s){var o=r-a-s.rebufferingImpact,u=.5;return a<=ec&&(u=1),!s.playlist||s.playlist.uri===this.playlist_.uri||o<u?!1:(this.bandwidth=s.playlist.attributes.BANDWIDTH*uc.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}},t.handleAbort_=function(){this.mediaRequestsAborted+=1},t.handleProgress_=function(e,t){this.checkForAbort_(t.requestId)||this.abortRequestEarly_(t.stats)||this.trigger("progress")},t.handleTrackInfo_=function(e,t){this.checkForAbort_(e.requestId)||this.abortRequestEarly_(e.stats)||this.checkForIllegalMediaSwitch(t)||(t=t||{},function(e,t){if(!e&&!t||!e&&t||e&&!t)return!1;if(e===t)return!0;var i=Object.keys(e).sort(),n=Object.keys(t).sort();if(i.length!==n.length)return!1;for(var r=0;r<i.length;r++){var a=i[r];if(a!==n[r])return!1;if(e[a]!==t[a])return!1}return!0}(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(e.requestId)||this.abortRequestEarly_(e.stats)||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))},t.handleTimingInfo_=function(e,t,i,n){if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats)){var r=this.pendingSegment_,a=Fc(t);r[a]=r[a]||{},r[a][i]=n,this.logger_("timinginfo: "+t+" - "+i+" - "+n),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},t.handleCaptions_=function(e,t){var s=this;if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats))if(0!==t.length)if(this.pendingSegment_.hasAppendedData_){var o=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),u={};t.forEach(function(e){u[e.stream]=u[e.stream]||{startTime:1/0,captions:[],endTime:0};var t=u[e.stream];t.startTime=Math.min(t.startTime,e.startTime+o),t.endTime=Math.max(t.endTime,e.endTime+o),t.captions.push(e)}),Object.keys(u).forEach(function(e){var t=u[e],i=t.startTime,n=t.endTime,r=t.captions,a=s.inbandTextTracks_;s.logger_("adding cues from "+i+" -> "+n+" for "+e),function(e,t,i){if(!e[i]){t.trigger({type:"usage",name:"vhs-608"}),t.trigger({type:"usage",name:"hls-608"});var n=t.textTracks().getTrackById(i);e[i]=n||t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}}(a,s.vhs_.tech_,e),Nc(i,n,a[e]),function(e){var i=e.inbandTextTracks,t=e.captionArray,n=e.timestampOffset;if(t){var r=T.WebKitDataCue||T.VTTCue;t.forEach(function(e){var t=e.stream;i[t].addCue(new r(e.startTime+n,e.endTime+n,e.text))})}}({captionArray:r,inbandTextTracks:a,timestampOffset:o})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));else this.logger_("SegmentLoader received no captions from a caption event")},t.handleId3_=function(e,t,i){if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats))if(this.pendingSegment_.hasAppendedData_){var n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();!function(e,t,i){e.metadataTrack_||(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=t)}(this.inbandTextTracks_,i,this.vhs_.tech_),Rc({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:n,videoDuration:this.duration_()})}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i))},t.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(e){return e()}),this.metadataQueue_.caption.forEach(function(e){return e()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},t.processCallQueue_=function(){var e=this.callQueue_;this.callQueue_=[],e.forEach(function(e){return e()})},t.processLoadQueue_=function(){var e=this.loadQueue_;this.loadQueue_=[],e.forEach(function(e){return e()})},t.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return!0;var e=this.pendingSegment_;return!!e&&(!this.currentMediaInfo_||!jc({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},t.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready())return!1;var e=this.pendingSegment_;if(!e||!e.trackInfo)return!1;if(!this.handlePartialData_){var t=this.currentMediaInfo_,i=t.hasAudio,n=t.hasVideo,r=t.isMuxed;if(n&&!e.videoTimingInfo)return!1;if(i&&!this.audioDisabled_&&!r&&!e.audioTimingInfo)return!1}return!jc({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})},t.handleData_=function(e,t){if(!this.checkForAbort_(e.requestId)&&!this.abortRequestEarly_(e.stats))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.segment),"closed"!==this.mediaSource_.readyState){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[Fc(t.type)].start;else{var n,r="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo;r&&(n=this.handlePartialData_?t.videoFramePtsTime:i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:r,firstVideoFrameTimeForData:n,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}else this.callQueue_.push(this.handleData_.bind(this,e,t))},t.updateAppendInitSegmentStatus=function(e,t){"main"!==this.loaderType_||"number"!=typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)},t.getInitSegmentAndUpdateState_=function(e){var t=e.type,i=e.initSegment,n=e.map,r=e.playlist;if(n){var a=gl(n);if(this.activeInitSegmentId_===a)return null;i=this.initSegmentForMap(n,!0).bytes,this.activeInitSegmentId_=a}return i&&this.appendInitSegment_[t]?(this.playlistOfLastInitSegment_[t]=r,this.appendInitSegment_[t]=!!n,this.activeInitSegmentId_=null,i):null},t.appendToSourceBuffer_=function(e){var t=this,i=e.segmentInfo,n=e.type,r=e.initSegment,a=e.data,s=[a],o=a.byteLength;r&&(s.unshift(r),o+=r.byteLength);var u=function(e){var t,i=0;return e.bytes&&(t=new Uint8Array(e.bytes),e.segments.forEach(function(e){t.set(e,i),i+=e.byteLength})),t}({bytes:o,segments:s});this.sourceUpdater_.appendBuffer({segmentInfo:i,type:n,bytes:u},function(e){e&&(t.error(n+" append of "+u.length+"b failed for segment #"+i.mediaIndex+" in playlist "+i.playlist.id),t.trigger("appenderror"))})},t.handleVideoSegmentTimingInfo_=function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var i=this.pendingSegment_.segment;i.videoTimingInfo||(i.videoTimingInfo={}),i.videoTimingInfo.transmuxerPrependedSeconds=t.prependedContentDuration||0,i.videoTimingInfo.transmuxedPresentationStart=t.start.presentation,i.videoTimingInfo.transmuxedPresentationEnd=t.end.presentation,i.videoTimingInfo.baseMediaDecodeTime=t.baseMediaDecodeTime}},t.appendData_=function(e,t){var i=t.type,n=t.data;if(n&&n.byteLength&&("audio"!==i||!this.audioDisabled_)){var r=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:r,data:n})}},t.loadSegment_=function(i){var n=this;this.state="WAITING",this.pendingSegment_=i,this.trimBackBuffer_(i),"number"==typeof i.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(i):this.loadQueue_.push(function(){var e=n.buffered_();"number"==typeof i.timestampOffset&&(i.timestampOffset=Bc({segmentTimeline:i.timeline,currentTimeline:n.currentTimeline_,startOfSegment:i.startOfSegment,buffered:e,overrideCheck:!0})),delete i.audioAppendStart;var t=n.sourceUpdater_.audioBuffered();t.length&&(i.audioAppendStart=t.end(t.length-1)-n.sourceUpdater_.audioTimestampOffset()),n.updateTransmuxerAndRequestSegment_(i)})},t.updateTransmuxerAndRequestSegment_=function(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));var t=this.createSimplifiedSegmentObj_(e);e.abortRequests=Fl({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,handlePartialData:this.handlePartialData_,abortFn:this.handleAbort_.bind(this),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleVideoSegmentTimingInfo_.bind(this,e.requestId),captionsFn:this.handleCaptions_.bind(this),id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this)})},t.trimBackBuffer_=function(e){var t=function(e,t,i){var n=t-uc.BACK_BUFFER_LENGTH;e.length&&(n=Math.max(n,e.start(0)));var r=t-i;return Math.min(r,n)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<t&&this.remove(0,t)},t.createSimplifiedSegmentObj_=function(e){var t=e.segment,i={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith},n=e.playlist.segments[e.mediaIndex];if(n&&n.end&&n.timeline===t.timeline&&(i.baseStartTime=n.end+e.timestampOffset),t.key){var r=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);i.key=this.segmentKey(t.key),i.key.iv=r}return t.map&&(i.map=this.initSegmentForMap(t.map)),i},t.saveTransferStats_=function(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)},t.saveBandwidthRelatedStats_=function(e){this.bandwidth=e.bandwidth,this.roundTrip=e.roundTripTime,this.pendingSegment_.byteLength=e.bytesReceived},t.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},t.segmentRequestFinished_=function(e,t,i){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));else if(this.saveTransferStats_(t.stats),this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId){if(e){if(this.pendingSegment_=null,this.state="READY",e.code===gc)return;return this.pause(),e.code===mc?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error"))}this.saveBandwidthRelatedStats_(t.stats);var n=this.pendingSegment_;n.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=function(e,t,i){if(!t.length)return e;if(i)return t.slice();for(var n=t[0].pts,r=0;r<e.length&&!(e[r].pts>=n);r++);return e.slice(0,r).concat(t)}(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING";var r=this.isEndOfStream_(n.mediaIndex,n.playlist),a=null!==this.mediaIndex,s=n.timeline!==this.currentTimeline_&&0<n.timeline;!n.isFmp4&&(r||a&&s)&&pc(this.transmuxer_),this.trigger("appending"),this.waitForAppendsToComplete_(n)}},t.setTimeMapping_=function(e){var t=this.syncController_.mappingForTimeline(e);null!==t&&(this.timeMapping_=t)},t.updateMediaSecondsLoaded_=function(e){"number"==typeof e.start&&"number"==typeof e.end?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration},t.shouldUpdateTransmuxerTimestampOffset_=function(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())},t.trueSegmentStart_=function(e){var t=e.currentStart,i=e.playlist,n=e.mediaIndex,r=e.firstVideoFrameTimeForData,a=e.currentVideoTimestampOffset,s=e.useVideoTimingInfo,o=e.videoTimingInfo,u=e.audioTimingInfo;if("undefined"!=typeof t)return t;if(!s)return u.start;var l=i.segments[n-1];return 0!==n&&l&&"undefined"!=typeof l.start&&l.end===r+a?o.start:r},t.waitForAppendsToComplete_=function(e){if(!this.currentMediaInfo_)return this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),void this.trigger("error");var t=this.currentMediaInfo_,i=t.hasAudio,n=t.hasVideo,r=t.isMuxed,a="main"===this.loaderType_&&n,s=!this.audioDisabled_&&i&&!r;if(e.waitingOnAppends=0,!e.hasAppendedData_)return e.timingInfo||"number"!=typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),void this.checkAppendsDone_(e);a&&e.waitingOnAppends++,s&&e.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),s&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))},t.checkAppendsDone_=function(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())},t.checkForIllegalMediaSwitch=function(e){var t=function(e,t,i){return"main"===e&&t&&i?i.hasAudio||i.hasVideo?t.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can\'t switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can\'t switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.currentMediaInfo_,e);return!!t&&(this.error({message:t,blacklistDuration:1/0}),this.trigger("error"),!0)},t.updateSourceBufferTimestampOffset_=function(e){if(null!==e.timestampOffset&&"number"==typeof e.timingInfo.start&&!e.changedTimestampOffset&&"main"===this.loaderType_){var t=!1;e.timestampOffset-=e.timingInfo.start,e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}},t.updateTimingInfoEnd_=function(e){e.timingInfo=e.timingInfo||{};var t="main"===this.loaderType_&&this.currentMediaInfo_.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;t&&(e.timingInfo.end="number"==typeof t.end?t.end:t.start+e.duration)},t.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_;if(this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_}),this.logger_(function(e){var t=e.segment,i=t.start,n=t.end,r=e.playlist,a=r.mediaSequence,s=r.id,o=r.segments,u=void 0===o?[]:o,l=e.mediaIndex,c=e.timeline;return["appending ["+l+"] of ["+a+", "+(a+u.length)+"] from playlist ["+s+"]","["+i+" => "+n+"] in timeline ["+c+"]"].join(" ")}(e)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest)this.trigger("syncinfoupdate");else{this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");var t=e.segment;if(t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration)this.resetEverything();else null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.isEndOfStream_(e.mediaIndex,e.playlist)&&this.endOfStream(),this.trigger("appended"),this.paused()||this.monitorBuffer_()}},t.recordThroughput_=function(e){var t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,n=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(n-t)/++this.throughput.count},t.addSegmentMetadataCue_=function(e){if(this.segmentMetadataTrack_){var t=e.segment,i=t.start,n=t.end;if(Uc(i)&&Uc(n)){Nc(i,n,this.segmentMetadataTrack_);var r=T.WebKitDataCue||T.VTTCue,a={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:n},s=new r(i,n,JSON.stringify(a));s.value=a,this.segmentMetadataTrack_.addCue(s)}}},e}(da.EventTarget);function Wc(){}function zc(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})}function Gc(e,t){var i=t[e+"Buffer"];return i&&i.updating||t.queuePending[e]}function Xc(e,t){if(0!==t.queue.length){var i=0,n=t.queue[i];if("mediaSource"!==n.type){if("mediaSource"!==e&&t.started_&&"closed"!==t.mediaSource.readyState&&!Gc(e,t)){if(n.type!==e){if(null===(i=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if("mediaSource"===n.type)return null;if(n.type===e)return i}return null}(e,t.queue)))return;n=t.queue[i]}t.queue.splice(i,1),n.action(e,t),n.doneFn?t.queuePending[e]=n:Xc(e,t)}}else t.updating()||"closed"===t.mediaSource.readyState||(t.queue.shift(),n.action(t),n.doneFn&&n.doneFn(),Xc("audio",t),Xc("video",t))}}function Kc(e,t){var i=t[e+"Buffer"],n=zc(e);i&&(i.removeEventListener("updateend",t["on"+n+"UpdateEnd_"]),i.removeEventListener("error",t["on"+n+"Error_"]),t.codecs[e]=null,t[e+"Buffer"]=null)}function Yc(e,t){return e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t)}function $c(e){var t=e.type,i=e.sourceUpdater,n=e.action,r=e.doneFn,a=e.name;i.queue.push({type:t,action:n,doneFn:r,name:a}),Xc(t,i)}function Qc(i,n){return function(e){if(n.queuePending[i]){var t=n.queuePending[i].doneFn;n.queuePending[i]=null,t&&t(n[i+"Error_"])}Xc(i,n)}}function Jc(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}function Zc(e,t){for(var i=e.cues,n=0;n<i.length;n++){var r=i[n];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null}function ed(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)}function td(e,t){(t.activePlaylistLoader=e).load()}function id(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){wd[e](e,t)});var i=t.mediaTypes,e=t.masterPlaylistLoader,n=t.tech,r=t.vhs;["AUDIO","SUBTITLES"].forEach(function(e){i[e].activeGroup=function(a,s){return function(t){var e=s.masterPlaylistLoader,i=s.mediaTypes[a].groups,n=e.media();if(!n)return null;var r=null;return n.attributes[a]&&(r=i[n.attributes[a]]),r=r||i.main,"undefined"==typeof t?r:null===t?null:r.filter(function(e){return e.id===t.id})[0]||null}}(e,t),i[e].activeTrack=Id[e](e,t),i[e].onGroupChanged=function(o,u){return function(){var e=u.segmentLoaders,t=e[o],i=e.main,n=u.mediaTypes[o],r=n.activeTrack(),a=n.activeGroup(r),s=n.activePlaylistLoader;ed(t,n),a&&(a.playlistLoader?(t.resyncLoader(),td(a.playlistLoader,n)):s&&i.resetEverything())}}(e,t),i[e].onGroupChanging=function(t,i){return function(){var e=i.segmentLoaders[t];e.abort(),e.pause()}}(e,t),i[e].onTrackChanged=function(o,u){return function(){var e=u.segmentLoaders,t=e[o],i=e.main,n=u.mediaTypes[o],r=n.activeTrack(),a=n.activeGroup(r),s=n.activePlaylistLoader;if(ed(t,n),a){if("AUDIO"===o){if(!a.playlistLoader)return i.setAudio(!0),void i.resetEverything();t.setAudio(!0),i.setAudio(!1)}s!==a.playlistLoader&&(t.track&&t.track(r),t.resetEverything()),td(a.playlistLoader,n)}}}(e,t)});var a=i.AUDIO.activeGroup();if(a){var s=(a.filter(function(e){return e.default})[0]||a[0]).id;i.AUDIO.tracks[s].enabled=!0,i.AUDIO.onTrackChanged()}function o(){i.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"vhs-audio-change"}),n.trigger({type:"usage",name:"hls-audio-change"})}for(var u in e.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return i[e].onGroupChanged()})}),e.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(e){return i[e].onGroupChanging()})}),n.audioTracks().addEventListener("change",o),n.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged),r.on("dispose",function(){n.audioTracks().removeEventListener("change",o),n.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)}),n.clearTracks("audio"),i.AUDIO.tracks)n.audioTracks().addTrack(i.AUDIO.tracks[u])}function nd(e,t,i){var n=e.masterPlaylistController_,r=n[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(n);if(t.attributes.RESOLUTION){var a=t.attributes.RESOLUTION;this.width=a.width,this.height=a.height}this.bandwidth=t.attributes.BANDWIDTH,this.codecs=xc(n.master(),t),this.playlist=t,this.id=i,this.enabled=function(r,a,s){return function(e){var t=r.master.playlists[a],i=sl(t),n=ol(t);return"undefined"==typeof e?n:(e?delete t.disabled:t.disabled=!0,e===n||i||(s(),e?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),e)}}(e.playlists,t.id,r)}function rd(e){!function t(i,e){var n=0,r=0,a=da.mergeOptions(Od,e);i.ready(function(){i.trigger({type:"usage",name:"vhs-error-reload-initialized"}),i.trigger({type:"usage",name:"hls-error-reload-initialized"})});function s(){r&&i.currentTime(r)}function o(e){null!=e&&(r=i.duration()!==1/0&&i.currentTime()||0,i.one("loadedmetadata",s),i.src(e),i.trigger({type:"usage",name:"vhs-error-reload"}),i.trigger({type:"usage",name:"hls-error-reload"}),i.play())}function u(){return Date.now()-n<1e3*a.errorInterval?(i.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void i.trigger({type:"usage",name:"hls-error-reload-canceled"})):a.getSource&&"function"==typeof a.getSource?(n=Date.now(),a.getSource.call(i,o)):void da.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}function l(){i.off("loadedmetadata",s),i.off("error",u),i.off("dispose",l)}i.on("error",u),i.on("dispose",l),i.reloadSourceOnError=function(e){l(),t(i,e)}}(this,e)}var ad,sd=["video","audio"],od=function(n,r){return function(e,t){var i=t[e+"Buffer"];Yc(t.mediaSource,i)&&(t.logger_("Appending segment "+r.mediaIndex+"\'s "+n.length+" bytes to "+e+"Buffer"),i.appendBuffer(n))}},ud=function(n,r){return function(e,t){var i=t[e+"Buffer"];Yc(t.mediaSource,i)&&(t.logger_("Removing "+n+" to "+r+" from "+e+"Buffer"),i.remove(n,r))}},ld=function(n){return function(e,t){var i=t[e+"Buffer"];Yc(t.mediaSource,i)&&(t.logger_("Setting "+e+"timestampOffset to "+n),i.timestampOffset=n)}},cd=function(i){return function(e,t){i()}},dd=function(t){return function(e){if("open"===e.mediaSource.readyState){e.logger_("Calling mediaSource endOfStream("+(t||"")+")");try{e.mediaSource.endOfStream(t)}catch(e){da.log.warn("Failed to call media source endOfStream",e)}}}},hd=function(t){return function(e){e.logger_("Setting mediaSource duration to "+t);try{e.mediaSource.duration=t}catch(e){da.log.warn("Failed to set media source duration",e)}}},pd=function(){return function(t,e){if("open"===e.mediaSource.readyState){var i=e[t+"Buffer"];if(Yc(e.mediaSource,i)){e.logger_("calling abort on "+t+"Buffer");try{i.abort()}catch(e){da.log.warn("Failed to abort on "+t+"Buffer",e)}}}}},fd=function(r,a){return function(e){var t=zc(r),i=Wl(a);e.logger_("Adding "+r+"Buffer with codec "+a+" to mediaSource");var n=e.mediaSource.addSourceBuffer(i);n.addEventListener("updateend",e["on"+t+"UpdateEnd_"]),n.addEventListener("error",e["on"+t+"Error_"]),e.codecs[r]=a,e[r+"Buffer"]=n}},md=function(i){return function(e){var t=e[i+"Buffer"];if(Kc(i,e),Yc(e.mediaSource,t)){e.logger_("Removing "+i+"Buffer with codec "+e.codecs[i]+" from mediaSource");try{e.mediaSource.removeSourceBuffer(t)}catch(e){da.log.warn("Failed to removeSourceBuffer "+i+"Buffer",e)}}}},gd=function(r){return function(e,t){var i=t[e+"Buffer"],n=Wl(r);Yc(t.mediaSource,i)&&t.codecs[e]!==r&&(t.logger_("changing "+e+"Buffer codec from "+t.codecs[e]+" to "+r),i.changeType(n),t.codecs[e]=r)}},vd=function(i){function e(e){var t;return(t=i.call(this)||this).mediaSource=e,t.sourceopenListener_=function(){return Xc("mediaSource",Ve(t))},t.mediaSource.addEventListener("sourceopen",t.sourceopenListener_),t.logger_=Pc("SourceUpdater"),t.audioTimestampOffset_=0,t.videoTimestampOffset_=0,t.queue=[],t.queuePending={audio:null,video:null},t.delayedAudioAppendQueue_=[],t.videoAppendQueued_=!1,t.codecs={},t.onVideoUpdateEnd_=Qc("video",Ve(t)),t.onAudioUpdateEnd_=Qc("audio",Ve(t)),t.onVideoError_=function(e){t.videoError_=e},t.onAudioError_=function(e){t.audioError_=e},t.started_=!1,t}Ge(e,i);var t=e.prototype;return t.ready=function(){return this.started_},t.createSourceBuffers=function(e){this.ready()||(this.addOrChangeSourceBuffers(e),this.started_=!0,this.trigger("ready"))},t.addSourceBuffer=function(e,t){$c({type:"mediaSource",sourceUpdater:this,action:fd(e,t),name:"addSourceBuffer"})},t.abort=function(e){$c({type:e,sourceUpdater:this,action:pd(e),name:"abort"})},t.removeSourceBuffer=function(e){this.canRemoveSourceBuffer()?$c({type:"mediaSource",sourceUpdater:this,action:md(e),name:"removeSourceBuffer"}):da.log.error("removeSourceBuffer is not supported!")},t.canRemoveSourceBuffer=function(){return!da.browser.IE_VERSION&&T.MediaSource&&T.MediaSource.prototype&&"function"==typeof T.MediaSource.prototype.removeSourceBuffer},e.canChangeType=function(){return T.SourceBuffer&&T.SourceBuffer.prototype&&"function"==typeof T.SourceBuffer.prototype.changeType},t.canChangeType=function(){return this.constructor.canChangeType()},t.changeType=function(e,t){this.canChangeType()?$c({type:e,sourceUpdater:this,action:gd(t),name:"changeType"}):da.log.error("changeType is not supported!")},t.addOrChangeSourceBuffers=function(i){var n=this;if(!i||"object"!=typeof i||0===Object.keys(i).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(i).forEach(function(e){var t=i[e];if(!n.ready())return n.addSourceBuffer(e,t);n.canChangeType()&&n.changeType(e,t)})},t.appendBuffer=function(e,t){var i=this,n=e.segmentInfo,r=e.type,a=e.bytes;if(this.processedAppend_=!0,"audio"===r&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([e,t]),void this.logger_("delayed audio append of "+a.length+" until video append");if($c({type:r,sourceUpdater:this,action:od(a,n||{mediaIndex:-1}),doneFn:t,name:"appendBuffer"}),"video"===r){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var s=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+s.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,s.forEach(function(e){i.appendBuffer.apply(i,e)})}},t.audioBuffered=function(){return Yc(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:da.createTimeRange()},t.videoBuffered=function(){return Yc(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:da.createTimeRange()},t.buffered=function(){var e=Yc(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=Yc(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():function(e,t){var i=null,n=null,r=0,a=[],s=[];if(!(e&&e.length&&t&&t.length))return da.createTimeRange();for(var o=e.length;o--;)a.push({time:e.start(o),type:"start"}),a.push({time:e.end(o),type:"end"});for(o=t.length;o--;)a.push({time:t.start(o),type:"start"}),a.push({time:t.end(o),type:"end"});for(a.sort(function(e,t){return e.time-t.time}),o=0;o<a.length;o++)"start"===a[o].type?2===++r&&(i=a[o].time):"end"===a[o].type&&1===--r&&(n=a[o].time),null!==i&&null!==n&&(s.push([i,n]),n=i=null);return da.createTimeRanges(s)}(this.audioBuffered(),this.videoBuffered())},t.setDuration=function(e,t){void 0===t&&(t=Wc),$c({type:"mediaSource",sourceUpdater:this,action:hd(e),name:"duration",doneFn:t})},t.endOfStream=function(e,t){void 0===e&&(e=null),void 0===t&&(t=Wc),"string"!=typeof e&&(e=void 0),$c({type:"mediaSource",sourceUpdater:this,action:dd(e),name:"endOfStream",doneFn:t})},t.removeAudio=function(e,t,i){void 0===i&&(i=Wc),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?$c({type:"audio",sourceUpdater:this,action:ud(e,t),doneFn:i,name:"remove"}):i()},t.removeVideo=function(e,t,i){void 0===i&&(i=Wc),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?$c({type:"video",sourceUpdater:this,action:ud(e,t),doneFn:i,name:"remove"}):i()},t.updating=function(){return!(!Gc("audio",this)&&!Gc("video",this))},t.audioTimestampOffset=function(e){return"undefined"!=typeof e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&($c({type:"audio",sourceUpdater:this,action:ld(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_},t.videoTimestampOffset=function(e){return"undefined"!=typeof e&&this.videoBuffer&&this.videoTimestampOffset!==e&&($c({type:"video",sourceUpdater:this,action:ld(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_},t.audioQueueCallback=function(e){this.audioBuffer&&$c({type:"audio",sourceUpdater:this,action:cd(e),name:"callback"})},t.videoQueueCallback=function(e){this.videoBuffer&&$c({type:"video",sourceUpdater:this,action:cd(e),name:"callback"})},t.dispose=function(){var t=this;this.trigger("dispose"),sd.forEach(function(e){t.abort(e),t.canRemoveSourceBuffer()?t.removeSourceBuffer(e):t[e+"QueueCallback"](function(){return Kc(e,t)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},e}(da.EventTarget),yd=new Uint8Array("\\n\\n".split("").map(function(e){return e.charCodeAt(0)})),_d=function(n){function e(e,t){var i;return void 0===t&&(t={}),(i=n.call(this,e,t)||this).handlePartialData_=!1,i.mediaSource_=null,i.subtitlesTrack_=null,i.loaderType_="subtitle",i.featuresNativeTextTracks_=e.featuresNativeTextTracks,i.shouldSaveSegmentTimingInfo_=!1,i}Ge(e,n);var t=e.prototype;return t.createTransmuxer_=function(){return null},t.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return da.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,i=e[e.length-1].startTime;return da.createTimeRanges([[t,i]])},t.initSegmentForMap=function(e,t){if(void 0===t&&(t=!1),!e)return null;var i=gl(e),n=this.initSegments_[i];if(t&&!n&&e.bytes){var r=yd.byteLength+e.bytes.byteLength,a=new Uint8Array(r);a.set(e.bytes),a.set(yd,e.bytes.byteLength),this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return n||e},t.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},t.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},t.track=function(e){return"undefined"==typeof e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_},t.remove=function(e,t){Nc(e,t,this.subtitlesTrack_)},t.fillBuffer_=function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}},t.skipEmptySegments_=function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e},t.stopForError=function(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")},t.segmentRequestFinished_=function(e,t,i){var n=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(t.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(e)return e.code===mc&&this.handleTimeout_(),e.code===gc?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(e);this.saveBandwidthRelatedStats_(t.stats),this.state="APPENDING",this.trigger("appending");var r=this.pendingSegment_,a=r.segment;if(a.map&&(a.map.bytes=t.map.bytes),r.bytes=t.bytes,"function"!=typeof T.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var s,o=function(){n.subtitlesTrack_.tech_.off("vttjsloaded",s),n.stopForError({message:"Error loading vtt.js"})};return s=function(){n.subtitlesTrack_.tech_.off("vttjserror",o),n.segmentRequestFinished_(e,t,i)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",s),void this.subtitlesTrack_.tech_.one("vttjserror",o)}a.requested=!0;try{this.parseVTTCues_(r)}catch(e){return void this.stopForError({message:e.message})}if(this.updateTimeMapping_(r,this.syncController_.timelines[r.timeline],this.playlist_),r.cues.length?r.timingInfo={start:r.cues[0].startTime,end:r.cues[r.cues.length-1].endTime}:r.timingInfo={start:r.startOfSegment,end:r.startOfSegment+r.duration},r.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");r.byteLength=r.bytes.byteLength,this.mediaSecondsLoaded+=a.duration,r.cues.forEach(function(e){n.remove(e.startTime,e.endTime),n.subtitlesTrack_.addCue(n.featuresNativeTextTracks_?new T.VTTCue(e.startTime,e.endTime,e.text):e)}),this.handleAppendsDone_()}else this.state="READY"},t.handleData_=function(){},t.updateTimingInfoEnd_=function(){},t.parseVTTCues_=function(t){var e,i=!1;"function"==typeof T.TextDecoder?e=new T.TextDecoder("utf8"):(e=T.WebVTT.StringDecoder(),i=!0);var n=new T.WebVTT.Parser(T,T.vttjs,e);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},n.oncue=t.cues.push.bind(t.cues),n.ontimestampmap=function(e){t.timestampmap=e},n.onparsingerror=function(e){da.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var r=t.segment.map.bytes;i&&(r=Jc(r)),n.parse(r)}var a=t.bytes;i&&(a=Jc(a)),n.parse(a),n.flush()},t.updateTimeMapping_=function(e,t,i){var n=e.segment;if(t)if(e.cues.length){var r=e.timestampmap,a=r.MPEGTS/fu-r.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!i.syncInfo){var s=e.cues[0].startTime,o=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(s,o-n.duration)}}}else n.empty=!0},e}(Hc),bd=[{name:"VOD",run:function(e,t,i,n,r){if(i===1/0)return null;return{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,i,n,r){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],s=null,o=null;r=r||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.dateTimeObject){var c=l.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(r-c);if(null!==o&&(0===d||o<d))break;o=d,s={time:c,segmentIndex:u}}}return s}},{name:"Segment",run:function(e,t,i,n,r){var a=t.segments||[],s=null,o=null;r=r||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.timeline===n&&"undefined"!=typeof l.start){var c=Math.abs(r-l.start);if(null!==o&&o<c)break;(!s||null===o||c<=o)&&(o=c,s={time:l.start,segmentIndex:u})}}return s}},{name:"Discontinuity",run:function(e,t,i,n,r){var a=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var s=null,o=0;o<t.discontinuityStarts.length;o++){var u=t.discontinuityStarts[o],l=t.discontinuitySequence+o+1,c=e.discontinuities[l];if(c){var d=Math.abs(r-c.time);if(null!==s&&s<d)break;(!a||null===s||d<=s)&&(s=d,a={time:c.time,segmentIndex:u})}}return a}},{name:"Playlist",run:function(e,t,i,n,r){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],Td=function(i){function e(e){var t;return(t=i.call(this)||this).timelines=[],t.discontinuities=[],t.datetimeToDisplayTime=null,t.logger_=Pc("SyncController"),t}Ge(e,i);var t=e.prototype;return t.getSyncPoint=function(e,t,i,n){var r=this.runStrategies_(e,t,i,n);return r.length?this.selectSyncPoint_(r,{key:"time",value:n}):null},t.getExpiredTime=function(e,t){if(!e||!e.segments)return null;var i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;var n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return 0<n.segmentIndex&&(n.time*=-1),Math.abs(n.time+il(e,n.segmentIndex,0))},t.runStrategies_=function(e,t,i,n){for(var r=[],a=0;a<bd.length;a++){var s=bd[a],o=s.run(this,e,t,i,n);o&&(o.strategy=s.name,r.push({strategy:s.name,syncPoint:o}))}return r},t.selectSyncPoint_=function(e,t){for(var i=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,a=1;a<e.length;a++){var s=Math.abs(e[a].syncPoint[t.key]-t.value);s<n&&(n=s,i=e[a].syncPoint,r=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+r+"]: [time:"+i.time+", segmentIndex:"+i.segmentIndex+"]"),i},t.saveExpiredSegmentInfo=function(e,t){for(var i=t.mediaSequence-e.mediaSequence-1;0<=i;i--){var n=e.segments[i];if(n&&"undefined"!=typeof n.start){t.syncInfo={mediaSequence:e.mediaSequence+i,time:n.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},t.setDateTimeMapping=function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}},t.saveSegmentTimingInfo=function(e){var t=e.segmentInfo,i=e.shouldSaveTimelineMapping;this.calculateSegmentTimeMapping_(t,t.timingInfo,i)&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:t.segment.start}))},t.timestampOffsetForTimeline=function(e){return"undefined"==typeof this.timelines[e]?null:this.timelines[e].time},t.mappingForTimeline=function(e){return"undefined"==typeof this.timelines[e]?null:this.timelines[e].mapping},t.calculateSegmentTimeMapping_=function(e,t,i){var n=e.segment,r=this.timelines[e.timeline];if(null!==e.timestampOffset)r={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=r,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+r.time+"] [mapping: "+r.mapping+"]")),n.start=e.startOfSegment,n.end=t.end+r.mapping;else{if(!r)return!1;n.start=t.start+r.mapping,n.end=t.end+r.mapping}return!0},t.saveDiscontinuitySyncInfo_=function(e){var t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var n=0;n<t.discontinuityStarts.length;n++){var r=t.discontinuityStarts[n],a=t.discontinuitySequence+n+1,s=r-e.mediaIndex,o=Math.abs(s);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>o){var u=void 0;u=s<0?i.start-il(t,e.mediaIndex,r):i.end+il(t,e.mediaIndex+1,r),this.discontinuities[a]={time:u,accuracy:o}}}},t.dispose=function(){this.trigger("dispose"),this.off()},e}(da.EventTarget),Sd=function(t){function e(){var e;return(e=t.call(this)||this).pendingTimelineChanges_={},e.lastTimelineChanges_={},e}Ge(e,t);var i=e.prototype;return i.clearPendingTimelineChange=function(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")},i.pendingTimelineChange=function(e){var t=e.type,i=e.from,n=e.to;return"number"==typeof i&&"number"==typeof n&&(this.pendingTimelineChanges_[t]={type:t,from:i,to:n},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]},i.lastTimelineChange=function(e){var t=e.type,i=e.from,n=e.to;return"number"==typeof i&&"number"==typeof n&&(this.lastTimelineChanges_[t]={type:t,from:i,to:n},delete this.pendingTimelineChanges_[t],this.trigger("timelinechange")),this.lastTimelineChanges_[t]},i.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},e}(da.EventTarget),kd=new kc("./decrypter-worker.worker.js",function(e,t){var i,n,r,c,g,l,s,a=this;\n/*! @name @videojs/http-streaming @version 2.2.4 @license Apache-2.0 */i=function(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e},n=function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t},r=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),-1<i},t.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,r=0;r<n;++r)i[r].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(t){this.on("data",function(e){t.push(e)})},e}(),c=null,g=function(){function e(e){var t,i,n;c=c||function(){var e,t,i,n,r,a,s,o,u=[[[],[],[],[],[]],[[],[],[],[],[]]],l=u[0],c=u[1],d=l[4],h=c[4],p=[],f=[];for(e=0;e<256;e++)f[(p[e]=e<<1^283*(e>>7))^e]=e;for(t=i=0;!d[t];t^=n||1,i=f[i]||1)for(a=(a=i^i<<1^i<<2^i<<3^i<<4)>>8^255&a^99,o=16843009*p[r=p[n=p[h[d[t]=a]=t]]]^65537*r^257*n^16843008*t,s=257*p[a]^16843008*a,e=0;e<4;e++)l[e][t]=s=s<<24^s>>>8,c[e][a]=o=o<<24^o>>>8;for(e=0;e<5;e++)l[e]=l[e].slice(0),c[e]=c[e].slice(0);return u}(),this._tables=[[c[0][0].slice(),c[0][1].slice(),c[0][2].slice(),c[0][3].slice(),c[0][4].slice()],[c[1][0].slice(),c[1][1].slice(),c[1][2].slice(),c[1][3].slice(),c[1][4].slice()]];var r=this._tables[0][4],a=this._tables[1],s=e.length,o=1;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size");var u=e.slice(0),l=[];for(this._key=[u,l],t=s;t<4*s+28;t++)n=u[t-1],(t%s==0||8===s&&t%s==4)&&(n=r[n>>>24]<<24^r[n>>16&255]<<16^r[n>>8&255]<<8^r[255&n],t%s==0&&(n=n<<8^n>>>24^o<<24,o=o<<1^283*(o>>7))),u[t]=u[t-s]^n;for(i=0;t;i++,t--)n=u[3&i?t:t-4],l[i]=t<=4||i<4?n:a[0][r[n>>>24]]^a[1][r[n>>16&255]]^a[2][r[n>>8&255]]^a[3][r[255&n]]}return e.prototype.decrypt=function(e,t,i,n,r,a){var s,o,u,l,c=this._key[1],d=e^c[0],h=n^c[1],p=i^c[2],f=t^c[3],m=c.length/4-2,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],T=v[3],S=v[4];for(l=0;l<m;l++)s=y[d>>>24]^_[h>>16&255]^b[p>>8&255]^T[255&f]^c[g],o=y[h>>>24]^_[p>>16&255]^b[f>>8&255]^T[255&d]^c[g+1],u=y[p>>>24]^_[f>>16&255]^b[d>>8&255]^T[255&h]^c[g+2],f=y[f>>>24]^_[d>>16&255]^b[h>>8&255]^T[255&p]^c[g+3],g+=4,d=s,h=o,p=u;for(l=0;l<4;l++)r[(3&-l)+a]=S[d>>>24]<<24^S[h>>16&255]<<16^S[p>>8&255]<<8^S[255&f]^c[g++],s=d,d=h,h=p,p=f,f=s},e}(),l=function(t){function e(){var e;return(e=t.call(this,r)||this).jobs=[],e.delay=1,e.timeout_=null,e}n(e,t);var i=e.prototype;return i.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},i.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},e}(r),s=function(){function u(e,t,i,n){var r=u.STEP,a=new Int32Array(e.buffer),s=new Uint8Array(e.byteLength),o=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+r),t,i,s)),o=r;o<a.length;o+=r)i=new Uint32Array([v(a[o-4]),v(a[o-3]),v(a[o-2]),v(a[o-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+r),t,i,s));this.asyncStream_.push(function(){n(null,\n/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */\nfunction(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}\n/*! @name aes-decrypter @version 3.1.0 @license Apache-2.0 */(s))})}return u.prototype.decryptChunk_=function(t,i,n,r){return function(){var e=function(e,t,i){var n,r,a,s,o,u,l,c,d,h=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),p=new g(Array.prototype.slice.call(t)),f=new Uint8Array(e.byteLength),m=new Int32Array(f.buffer);for(n=i[0],r=i[1],a=i[2],s=i[3],d=0;d<h.length;d+=4)o=v(h[d]),u=v(h[d+1]),l=v(h[d+2]),c=v(h[d+3]),p.decrypt(o,u,l,c,m,d),m[d]=v(m[d]^n),m[d+1]=v(m[d+1]^r),m[d+2]=v(m[d+2]^a),m[d+3]=v(m[d+3]^s),n=o,r=u,a=l,s=c;return f}(t,i,n);r.set(e,t.byteOffset)}},i(u,null,[{key:"STEP",get:function(){return 32e3}}]),u}(),new function(a){a.onmessage=function(e){var i=e.data,t=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),n=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),r=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new s(t,n,r,function(e,t){a.postMessage(function(i){var n={};return Object.keys(i).forEach(function(e){var t=i[e];ArrayBuffer.isView(t)?n[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:n[e]=t}),n}({source:i.source,decrypted:t}),[t.buffer])})}}(a);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}}),Cd={AUDIO:function(u,l){return function(){var e=l.segmentLoaders[u],t=l.mediaTypes[u],i=l.blacklistCurrentPlaylist;ed(e,t);var n=t.activeTrack(),r=t.activeGroup(),a=(r.filter(function(e){return e.default})[0]||r[0]).id,s=t.tracks[a];if(n!==s){for(var o in da.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),t.tracks)t.tracks[o].enabled=t.tracks[o]===s;t.onTrackChanged()}else i({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(n,r){return function(){var e=r.segmentLoaders[n],t=r.mediaTypes[n];da.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),ed(e,t);var i=t.activeTrack();i&&(i.mode="disabled"),t.onTrackChanged()}}},Ed={AUDIO:function(e,t,i){if(t){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),(!n.paused()||e.endList&&"none"!==n.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),n.paused()||a.load()}),t.on("error",Cd[e](e,i))}},SUBTITLES:function(e,t,i){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[e],s=i.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),a.track(s.activeTrack()),(!n.paused()||e.endList&&"none"!==n.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),n.paused()||a.load()}),t.on("error",Cd[e](e,i))}},wd={AUDIO:function(s,o){var u=o.vhs,l=o.sourceType,e=o.segmentLoaders[s],c=o.requestOptions,t=o.master,d=t.mediaGroups,i=t.playlists,n=o.mediaTypes[s],h=n.groups,p=n.tracks,f=o.masterPlaylistLoader;d[s]&&0!==Object.keys(d[s]).length||(d[s]={main:{default:{default:!0}}});function r(r){function e(e){var t=d[s][r][e];a.filter(function(e){return e.resolvedUri===t.resolvedUri}).length&&delete t.resolvedUri;var i=void 0;if(i="vhs-json"===l&&t.playlists?new Zl(t.playlists[0],u,c):t.resolvedUri?new Zl(t.resolvedUri,u,c):t.playlists&&"dash"===l?new oc(t.playlists[0],u,c,f):null,t=da.mergeOptions({id:e,playlistLoader:i},t),Ed[s](s,t.playlistLoader,o),h[r].push(t),"undefined"==typeof p[e]){var n=new da.AudioTrack({id:e,kind:function(e){var t=e.default?"main":"alternative";return e.characteristics&&0<=e.characteristics.indexOf("public.accessibility.describes-video")&&(t="main-desc"),t}(t),enabled:!1,language:t.language,default:t.default,label:e});p[e]=n}}h[r]||(h[r]=[]);var a=i.filter(function(e){return e.attributes[s]===r});for(var t in d[s][r])e(t)}for(var a in d[s])r(a);e.on("error",Cd[s](s,o))},SUBTITLES:function(e,t){var i=t.tech,n=t.vhs,r=t.sourceType,a=t.segmentLoaders[e],s=t.requestOptions,o=t.master.mediaGroups,u=t.mediaTypes[e],l=u.groups,c=u.tracks,d=t.masterPlaylistLoader;for(var h in o[e])for(var p in l[h]||(l[h]=[]),o[e][h])if(!o[e][h][p].forced){var f=o[e][h][p],m=void 0;if("hls"===r?m=new Zl(f.resolvedUri,n,s):"dash"===r?m=new oc(f.playlists[0],n,s,d):"vhs-json"===r&&(m=new Zl(f.playlists?f.playlists[0]:f.resolvedUri,n,s)),f=da.mergeOptions({id:p,playlistLoader:m},f),Ed[e](e,f.playlistLoader,t),l[h].push(f),"undefined"==typeof c[p]){var g=i.addRemoteTextTrack({id:p,kind:"subtitles",default:f.default&&f.autoselect,language:f.language,label:p},!1).track;c[p]=g}}a.on("error",Cd[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i=t.tech,n=t.master.mediaGroups,r=t.mediaTypes[e],a=r.groups,s=r.tracks;for(var o in n[e])for(var u in a[o]||(a[o]=[]),n[e][o]){var l=n[e][o][u];if(l.instreamId.match(/CC\\d/)&&(a[o].push(da.mergeOptions({id:u},l)),"undefined"==typeof s[u])){var c=i.addRemoteTextTrack({id:l.instreamId,kind:"captions",default:l.default&&l.autoselect,language:l.language,label:u},!1).track;s[u]=c}}}},Id={AUDIO:function(i,n){return function(){var e=n.mediaTypes[i].tracks;for(var t in e)if(e[t].enabled)return e[t];return null}},SUBTITLES:function(i,n){return function(){var e=n.mediaTypes[i].tracks;for(var t in e)if("showing"===e[t].mode||"hidden"===e[t].mode)return e[t];return null}}},Ad=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],xd=function(m){function e(e){var t;t=m.call(this)||this;var i=e.src,n=e.handleManifestRedirects,r=e.withCredentials,a=e.tech,s=e.bandwidth,o=e.externVhs,u=e.useCueTags,l=e.blacklistDuration,c=e.enableLowInitialPlaylist,d=e.sourceType,h=e.cacheEncryptionKeys,p=e.handlePartialData;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");ad=o,t.withCredentials=r,t.tech_=a,t.vhs_=a.vhs,t.sourceType_=d,t.useCueTags_=u,t.blacklistDuration=l,t.enableLowInitialPlaylist=c,t.useCueTags_&&(t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues"),t.cueTagsTrack_.inBandMetadataTrackDispatchType=""),t.requestOptions_={withCredentials:r,handleManifestRedirects:n,timeout:null},t.on("error",t.pauseLoading),t.mediaTypes_=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Wc,activeTrack:Wc,onGroupChanged:Wc,onTrackChanged:Wc}}),t}(),t.mediaSource=new T.MediaSource,t.handleDurationChange_=t.handleDurationChange_.bind(Ve(t)),t.handleSourceOpen_=t.handleSourceOpen_.bind(Ve(t)),t.handleSourceEnded_=t.handleSourceEnded_.bind(Ve(t)),t.mediaSource.addEventListener("durationchange",t.handleDurationChange_),t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_),t.mediaSource.addEventListener("sourceended",t.handleSourceEnded_),t.seekable_=da.createTimeRanges(),t.hasPlayed_=!1,t.syncController_=new Td(e),t.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,t.decrypter_=new kd,t.sourceUpdater_=new vd(t.mediaSource),t.inbandTextTracks_={},t.timelineChangeController_=new Sd;var f={vhs:t.vhs_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.duration()},hasPlayed:function(){return t.hasPlayed_},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:s,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_,cacheEncryptionKeys:h,handlePartialData:p,sourceUpdater:t.sourceUpdater_,timelineChangeController:t.timelineChangeController_};return t.masterPlaylistLoader_="dash"===t.sourceType_?new oc(i,t.vhs_,t.requestOptions_):new Zl(i,t.vhs_,t.requestOptions_),t.setupMasterPlaylistLoaderListeners_(),t.mainSegmentLoader_=new Hc(da.mergeOptions(f,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e),t.audioSegmentLoader_=new Hc(da.mergeOptions(f,{loaderType:"audio"}),e),t.subtitleSegmentLoader_=new _d(da.mergeOptions(f,{loaderType:"vtt",featuresNativeTextTracks:t.tech_.featuresNativeTextTracks}),e),t.setupSegmentLoaderListeners_(),Ad.forEach(function(e){t[e+"_"]=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}.bind(Ve(t),e)}),t.logger_=Pc("MPC"),t.triggeredFmp4Usage=!1,t.masterPlaylistLoader_.load(),t}Ge(e,m);var t=e.prototype;return t.setupMasterPlaylistLoaderListeners_=function(){var i=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=i.masterPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;ll(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?i.requestOptions_.timeout=0:i.requestOptions_.timeout=t,e.endList&&"none"!==i.tech_.preload()&&(i.mainSegmentLoader_.playlist(e,i.requestOptions_),i.mainSegmentLoader_.load()),id({sourceType:i.sourceType_,segmentLoaders:{AUDIO:i.audioSegmentLoader_,SUBTITLES:i.subtitleSegmentLoader_,main:i.mainSegmentLoader_},tech:i.tech_,requestOptions:i.requestOptions_,masterPlaylistLoader:i.masterPlaylistLoader_,vhs:i.vhs_,master:i.master(),mediaTypes:i.mediaTypes_,blacklistCurrentPlaylist:i.blacklistCurrentPlaylist.bind(i)}),i.triggerPresenceUsage_(i.master(),e),i.setupFirstPlay(),!i.mediaTypes_.AUDIO.activePlaylistLoader||i.mediaTypes_.AUDIO.activePlaylistLoader.media()?i.trigger("selectedinitialmedia"):i.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){i.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=i.masterPlaylistLoader_.media();if(!e){var t;if(i.excludeUnsupportedVariants_(),i.enableLowInitialPlaylist&&(t=i.selectInitialPlaylist()),t=t||i.selectPlaylist(),i.initialMedia_=t,i.masterPlaylistLoader_.media(i.initialMedia_),!("vhs-json"===i.sourceType_&&i.initialMedia_.segments))return;e=i.initialMedia_}i.handleUpdatedMediaPlaylist(e)}),this.masterPlaylistLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){i.mainSegmentLoader_.abort(),i.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=i.masterPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;ll(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?i.requestOptions_.timeout=0:i.requestOptions_.timeout=t,i.mainSegmentLoader_.playlist(e,i.requestOptions_),i.mainSegmentLoader_.load(),i.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=i.masterPlaylistLoader_.media();i.stuckAtPlaylistEnd_(e)&&(i.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),i.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){i.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),i.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){i.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),i.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},t.handleUpdatedMediaPlaylist=function(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},t.triggerPresenceUsage_=function(e,t){var i=e.mediaGroups||{},n=!0,r=Object.keys(i.AUDIO);for(var a in i.AUDIO)for(var s in i.AUDIO[a]){i.AUDIO[a][s].uri||(n=!1)}n&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(i.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),ad.Playlist.isAes(t)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),r.length&&1<Object.keys(i.AUDIO[r[0]]).length&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},t.setupSegmentLoaderListeners_=function(){var n=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=n.selectPlaylist(),t=n.masterPlaylistLoader_.media(),i=n.tech_.buffered();!function(e){var t=e.currentPlaylist,i=e.nextPlaylist,n=e.forwardBuffer,r=e.bufferLowWaterLine,a=e.duration;e.log;return i?!t.endList||(a<uc.MAX_BUFFER_LOW_WATER_LINE||(i.attributes.BANDWIDTH<t.attributes.BANDWIDTH||r<=n)):(da.log.warn("We received no playlist to switch to. Please check your stream."),!1)}({currentPlaylist:t,nextPlaylist:e,forwardBuffer:i.length?i.end(i.length-1)-n.tech_.currentTime():0,bufferLowWaterLine:n.bufferLowWaterLine(),duration:n.duration(),log:n.logger_})||n.masterPlaylistLoader_.media(e),n.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){n.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){n.error=n.mainSegmentLoader_.error_,n.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){n.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),n.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){n.error=n.audioSegmentLoader_.error_,n.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){n.logger_("main segment loader ended"),n.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){n.blacklistCurrentPlaylist({message:"Aborted early because there isn\'t enough bandwidth to complete the request without rebuffering."},120)});function e(){if(!n.sourceUpdater_.ready())return n.tryToCreateSourceBuffers_();var e=n.getCodecsOrExclude_();e&&n.sourceUpdater_.addOrChangeSourceBuffers(e)}this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){n.logger_("audioSegmentLoader ended"),n.onEndOfStream()})},t.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},t.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},t.smoothQualityChange_=function(e){void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())},t.fastQualityChange_=function(e){var t=this;void 0===e&&(e=this.selectPlaylist()),e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetEverything(function(){da.browser.IE_VERSION||da.browser.IS_EDGE?t.tech_.setCurrentTime(t.tech_.currentTime()+.04):t.tech_.setCurrentTime(t.tech_.currentTime())}))},t.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}},t.setupFirstPlay=function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var i=this.seekable();if(!i.length)return!1;if(da.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.tech_.setCurrentTime(i.end(0)),e.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(i.end(0))}return this.hasPlayed_=!0,this.load(),!0},t.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var e=this.tech_.play();"undefined"!=typeof e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")},t.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var e=this.inbandTextTracks_.metadataTrack_.cues;if(e&&e.length){var t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}}},t.handleDurationChange_=function(){this.tech_.trigger("durationchange")},t.onEndOfStream=function(){var e=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.currentMediaInfo_||this.mainSegmentLoader_.currentMediaInfo_.hasVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e&&this.sourceUpdater_.endOfStream()},t.stuckAtPlaylistEnd_=function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.duration());if(null===t)return!1;var i=ad.Playlist.playlistEnd(e,t),n=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return i-n<=.1;var a=r.end(r.length-1);return a-n<=.1&&i-a<=.1},t.blacklistCurrentPlaylist=function(e,t){void 0===e&&(e={});var i=e.playlist||this.masterPlaylistLoader_.media();if(t=t||e.blacklistDuration||this.blacklistDuration,!i)return this.error=e,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));var n=this.masterPlaylistLoader_.master.playlists,r=n.filter(ol),a=1===r.length&&r[0]===i;if(1===n.length&&t!==1/0)return da.log.warn("Problem encountered with playlist "+i.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(a);if(a){var s=!1;n.forEach(function(e){if(e!==i){var t=e.excludeUntil;"undefined"!=typeof t&&t!==1/0&&(s=!0,delete e.excludeUntil)}}),s&&(da.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}i.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var o=this.selectPlaylist();if(!o)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");var u=e.internal?this.logger_:da.log.warn,l=e.message?" "+e.message:"";return u((e.internal?"Internal problem":"Problem")+" encountered with playlist "+i.id+"."+l+" Switching to playlist "+o.id+"."),o.attributes.AUDIO!==i.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),o.attributes.SUBTITLES!==i.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),this.masterPlaylistLoader_.media(o,a)},t.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"])},t.delegateLoaders_=function(i,e){var n=this,r=[],t="all"===i;!t&&"main"!==i||r.push(this.masterPlaylistLoader_);var a=[];!t&&"audio"!==i||a.push("AUDIO"),!t&&"subtitle"!==i||(a.push("CLOSED-CAPTIONS"),a.push("SUBTITLES")),a.forEach(function(e){var t=n.mediaTypes_[e]&&n.mediaTypes_[e].activePlaylistLoader;t&&r.push(t)}),["main","audio","subtitle"].forEach(function(e){var t=n[e+"SegmentLoader_"];!t||i!==e&&"all"!==i||r.push(t)}),r.forEach(function(t){return e.forEach(function(e){"function"==typeof t[e]&&t[e]()})})},t.setCurrentTime=function(e){var t=$u(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},t.duration=function(){if(!this.masterPlaylistLoader_)return 0;var e=this.masterPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:ad.Playlist.duration(e):1/0:0},t.seekable=function(){return this.seekable_},t.onSyncInfoUpdate_=function(){var e;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var i=this.syncController_.getExpiredTime(t,this.duration());if(null!==i){var n=this.masterPlaylistLoader_.master.suggestedPresentationDelay,r=ad.Playlist.seekable(t,i,n);if(0!==r.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(i=this.syncController_.getExpiredTime(t,this.duration())))return;if(0===(e=ad.Playlist.seekable(t,i,n)).length)return}var a,s;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),s=this.seekable_.start(0)),e?e.start(0)>r.end(0)||r.start(0)>e.end(0)?this.seekable_=r:this.seekable_=da.createTimeRanges([[e.start(0)>r.start(0)?e.start(0):r.start(0),e.end(0)<r.end(0)?e.end(0):r.end(0)]]):this.seekable_=r,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===s||(this.logger_("seekable updated ["+Ju(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},t.updateDuration=function(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,e),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(e){var t=this.seekable();if(!t.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1))}else{var i=this.tech_.buffered(),n=ad.Playlist.duration(this.masterPlaylistLoader_.media());0<i.length&&(n=Math.max(n,i.end(i.length-1))),this.mediaSource.duration!==n&&this.sourceUpdater_.setDuration(n)}},t.dispose=function(){var n=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var t=n.mediaTypes_[e].groups;for(var i in t)t[i].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},t.master=function(){return this.masterPlaylistLoader_.master},t.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},t.areMediaTypesKnown_=function(){var e=!!this.mediaTypes_.AUDIO.activePlaylistLoader;return!(!this.mainSegmentLoader_.currentMediaInfo_||e&&!this.audioSegmentLoader_.currentMediaInfo_)},t.getCodecsOrExclude_=function(){var n=this,i={main:this.mainSegmentLoader_.currentMediaInfo_||{},audio:this.audioSegmentLoader_.currentMediaInfo_||{}};i.video=i.main;var e=xc(this.master(),this.media()),r={},t=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(i.main.hasVideo&&(r.video=e.video||i.main.videoCodec||Vl),i.main.isMuxed&&(r.video+=","+(e.audio||i.main.audioCodec||jl)),(i.main.hasAudio&&!i.main.isMuxed||i.audio.hasAudio||t)&&(r.audio=e.audio||i.main.audioCodec||i.audio.audioCodec||jl,i.audio.isFmp4=i.main.hasAudio&&!i.main.isMuxed?i.main.isFmp4:i.audio.isFmp4),r.audio||r.video){var a,s={};if(["video","audio"].forEach(function(e){if(r.hasOwnProperty(e)&&!function(e,t){return e?ql(t):Xl(t)}(i[e].isFmp4,r[e])){var t=i[e].isFmp4?"browser":"muxer";s[t]=s[t]||[],s[t].push(r[e]),"audio"===e&&(a=t)}}),t&&a&&this.media().attributes.AUDIO){var o=this.media().attributes.AUDIO;this.master().playlists.forEach(function(e){(e.attributes&&e.attributes.AUDIO)===o&&e!==n.media()&&(e.excludeUntil=1/0)}),this.logger_("excluding audio group "+o+" as "+a+\' does not support codec(s): "\'+r.audio+\'"\')}if(!Object.keys(s).length){if(this.sourceUpdater_.ready()&&!this.sourceUpdater_.canChangeType()){var u=[];if(["video","audio"].forEach(function(e){var t=(Kl(n.sourceUpdater_.codecs[e]||"")[e]||{}).type,i=(Kl(r[e]||"")[e]||{}).type;t&&i&&t.toLowerCase()!==i.toLowerCase()&&u.push(\'"\'+n.sourceUpdater_.codecs[e]+\'" -> "\'+r[e]+\'"\')}),u.length)return void this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+u.join(", ")+".",blacklistDuration:1/0,internal:!0})}return r}var l=Object.keys(s).reduce(function(e,t){return e&&(e+=", "),e+=t+\' does not support codec(s): "\'+s[t].join(",")+\'"\'},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:l,blacklistDuration:1/0})}else this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0})},t.tryToCreateSourceBuffers_=function(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.ready()&&this.areMediaTypesKnown_()){var e=this.getCodecsOrExclude_();if(e){this.sourceUpdater_.createSourceBuffers(e);var t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}}},t.excludeUnsupportedVariants_=function(){var i=this;this.master().playlists.forEach(function(e){var t=xc(i.master,e);!t.audio||Xl(t.audio)||ql(t.audio)||(e.excludeUntil=1/0),!t.video||Xl(t.video)||ql(t.video)||(e.excludeUntil=1/0)})},t.excludeIncompatibleVariants_=function(e){var s=this,o=Kl(e),u=Object.keys(o).length;this.master().playlists.forEach(function(e){if(e.excludeUntil!==1/0){var t={},i=2,n=[],r=xc(s.masterPlaylistLoader_.master,e);if(r.audio||r.video){var a=[r.video,r.audio].filter(Boolean).join(",");t=Kl(a),i=Object.keys(t).length}i!==u&&(n.push(\'codec count "\'+i+\'" !== "\'+u+\'"\'),e.excludeUntil=1/0),s.sourceUpdater_.canChangeType()||(t.video&&o.video&&t.video.type.toLowerCase()!==o.video.type.toLowerCase()&&(n.push(\'video codec "\'+t.video.type+\'" !== "\'+o.video.type+\'"\'),e.excludeUntil=1/0),t.audio&&o.audio&&t.audio.type.toLowerCase()!==o.audio.type.toLowerCase()&&(e.excludeUntil=1/0,n.push(\'audio codec "\'+t.audio.type+\'" !== "\'+o.audio.type+\'"\'))),n.length&&s.logger_("blacklisting "+e.id+": "+n.join(" && "))}})},t.updateAdCues_=function(e){var t=0,i=this.seekable();i.length&&(t=i.start(0)),function(e,t,i){if(void 0===i&&(i=0),e.segments)for(var n,r=i,a=0;a<e.segments.length;a++){var s=e.segments[a];if(n=n||Zc(t,r+s.duration/2)){if("cueIn"in s){n.endTime=r,n.adEndTime=r,r+=s.duration,n=null;continue}if(r<n.endTime){r+=s.duration;continue}n.endTime+=s.duration}else if("cueOut"in s&&((n=new T.VTTCue(r,r+s.duration,s.cueOut)).adStartTime=r,n.adEndTime=r+parseFloat(s.cueOut),t.addCue(n)),"cueOutCont"in s){var o=s.cueOutCont.split("/").map(parseFloat),u=o[0],l=o[1];(n=new T.VTTCue(r,r+s.duration,"")).adStartTime=r-u,n.adEndTime=n.adStartTime+l,t.addCue(n)}r+=s.duration}}(e,this.cueTagsTrack_,t)},t.goalBufferLength=function(){var e=this.tech_.currentTime(),t=uc.GOAL_BUFFER_LENGTH,i=uc.GOAL_BUFFER_LENGTH_RATE,n=Math.max(t,uc.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,n)},t.bufferLowWaterLine=function(){var e=this.tech_.currentTime(),t=uc.BUFFER_LOW_WATER_LINE,i=uc.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(t,uc.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,n)},e}(da.EventTarget),Pd=["seeking","seeked","pause","playing","error"],Ld=function(){function e(e){var t=this;this.masterPlaylistController_=e.masterPlaylistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Pc("PlaybackWatcher"),this.logger_("initialize");function i(){return t.monitorCurrentTime_()}function n(){return t.techWaiting_()}function r(){return t.cancelTimer_()}function a(){return t.fixesBadSeeks_()}var s=this.masterPlaylistController_,o=["main","subtitle","audio"],u={};o.forEach(function(e){u[e]={reset:function(){return t.resetSegmentDownloads_(e)},updateend:function(){return t.checkSegmentDownloads_(e)}},s[e+"SegmentLoader_"].on("appendsdone",u[e].updateend),s[e+"SegmentLoader_"].on("playlistupdate",u[e].reset),t.tech_.on(["seeked","seeking"],u[e].reset)}),this.tech_.on("seekablechanged",a),this.tech_.on("waiting",n),this.tech_.on(Pd,r),this.tech_.on("canplay",i),this.dispose=function(){t.logger_("dispose"),t.tech_.off("seekablechanged",a),t.tech_.off("waiting",n),t.tech_.off(Pd,r),t.tech_.off("canplay",i),o.forEach(function(e){s[e+"SegmentLoader_"].off("appendsdone",u[e].updateend),s[e+"SegmentLoader_"].off("playlistupdate",u[e].reset),t.tech_.off(["seeked","seeking"],u[e].reset)}),t.checkCurrentTimeTimeout_&&T.clearTimeout(t.checkCurrentTimeTimeout_),t.cancelTimer_()}}var t=e.prototype;return t.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&T.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=T.setTimeout(this.monitorCurrentTime_.bind(this),250)},t.resetSegmentDownloads_=function(e){var t=this.masterPlaylistController_[e+"SegmentLoader_"];0<this[e+"StalledDownloads_"]&&this.logger_("resetting possible stalled download count for "+e+" loader"),this[e+"StalledDownloads_"]=0,this[e+"Buffered_"]=t.buffered_()},t.checkSegmentDownloads_=function(e){var t=this.masterPlaylistController_,i=t[e+"SegmentLoader_"],n=i.buffered_(),r=function(e,t){if(e===t)return!1;if(!e&&t||!t&&e)return!0;if(e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e.start(i)!==t.start(i)||e.end(i)!==t.end(i))return!0;return!1}(this[e+"Buffered_"],n);this[e+"Buffered_"]=n,r?this.resetSegmentDownloads_(e):(this[e+"StalledDownloads_"]++,this.logger_("found #"+this[e+"StalledDownloads_"]+" "+e+" appends that did not increase buffer (possible stalled download)",{playlistId:i.playlist_&&i.playlist_.id,buffered:Zu(n)}),this[e+"StalledDownloads_"]<10||(this.logger_(e+" loader stalled download exclusion"),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:"vhs-"+e+"-download-exclusion"}),"subtitle"!==e&&t.blacklistCurrentPlaylist({message:"Excessive "+e+" segment downloading detected."},1/0)))},t.checkCurrentTime_=function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}},t.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},t.fixesBadSeeks_=function(){if(!this.tech_.seeking())return!1;var e,t=this.seekable(),i=this.tech_.currentTime();this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(e=t.end(t.length-1));if(this.beforeSeekableWindow_(t,i)){var n=t.start(0);e=n+(n===t.end(0)?0:.1)}if("undefined"!=typeof e)return this.logger_("Trying to seek outside of seekable at time "+i+" with seekable range "+Ju(t)+". Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0;var r=this.tech_.buffered();return!!function(e){var t=e.buffered,i=e.targetDuration,n=e.currentTime;return!!t.length&&(!(t.end(0)-t.start(0)<2*i)&&(!(n>t.start(0))&&t.start(0)-n<i))}({buffered:r,targetDuration:this.media().targetDuration,currentTime:i})&&(e=r.start(0)+.1,this.logger_("Buffered region starts ("+r.start(0)+")  just beyond seek point ("+i+"). Seeking to "+e+"."),this.tech_.setCurrentTime(e),!0)},t.waiting_=function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),i=$u(t,e);return i.length&&e+3<=i.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+i.start(0)+" -> "+i.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}},t.techWaiting_=function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var i=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var n=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,r=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:n.audioBuffered(),videoBuffered:n.videoBuffered(),currentTime:t}))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var a=Qu(r,t);if(0<a.length){var s=a.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+s+", seeking to "+a.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*s,t),!0}return!1},t.afterSeekableWindow_=function(e,t,i,n){if(void 0===n&&(n=!1),!e.length)return!1;var r=e.end(e.length-1)+.1;return!i.endList&&n&&(r=e.end(e.length-1)+3*i.targetDuration),r<t},t.beforeSeekableWindow_=function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-.1)},t.videoUnderflow_=function(e){var t=e.videoBuffered,i=e.audioBuffered,n=e.currentTime;if(t){var r;if(t.length&&i.length){var a=$u(t,n-3),s=$u(t,n),o=$u(i,n);o.length&&!s.length&&a.length&&(r={start:a.end(0),end:o.end(0)})}else{Qu(t,n).length||(r=this.gapFromVideoUnderflow_(t,n))}return!!r&&(this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". Seeking to current time "+n),!0)}},t.skipTheGap_=function(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),n=Qu(t,i);this.cancelTimer_(),0!==n.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",n.start(0)),this.tech_.setCurrentTime(n.start(0)+ec),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},t.gapFromVideoUnderflow_=function(e,t){for(var i=function(e){if(e.length<2)return da.createTimeRanges();for(var t=[],i=1;i<e.length;i++){var n=e.end(i-1),r=e.start(i);t.push([n,r])}return da.createTimeRanges(t)}(e),n=0;n<i.length;n++){var r=i.start(n),a=i.end(n);if(t-r<4&&2<t-r)return{start:r,end:a}}return null},e}(),Od={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},Dd={PlaylistLoader:Zl,Playlist:ic,utils:ac,STANDARD_PLAYLIST_SELECTOR:function(){var e=this.useDevicePixelRatio&&T.devicePixelRatio||1;return function(e,t,i,n,r){var a={bandwidth:t,width:i,height:n,limitRenditionByPlayerDimensions:r},s=e.playlists.map(function(e){var t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height;return{bandwidth:e.attributes.BANDWIDTH||T.Number.MAX_VALUE,width:t,height:i,playlist:e}});Dc(s,function(e,t){return e.bandwidth-t.bandwidth});var o=(s=s.filter(function(e){return!ic.isIncompatible(e.playlist)})).filter(function(e){return ic.isEnabled(e.playlist)});o.length||(o=s.filter(function(e){return!ic.isDisabled(e.playlist)}));var u=o.filter(function(e){return e.bandwidth*uc.BANDWIDTH_VARIANCE<t}),l=u[u.length-1],c=u.filter(function(e){return e.bandwidth===l.bandwidth})[0];if(!1===r){var d=c||o[0]||s[0];if(d&&d.playlist){var h="sortedPlaylistReps";return c&&(h="bandwidthBestRep"),o[0]&&(h="enabledPlaylistReps"),qc("choosing "+Lc(d)+" using "+h+" with options",a),d.playlist}return qc("could not choose a playlist with options",a),null}var p=u.filter(function(e){return e.width&&e.height});Dc(p,function(e,t){return e.width-t.width});var f=p.filter(function(e){return e.width===i&&e.height===n});l=f[f.length-1];var m,g,v,y=f.filter(function(e){return e.bandwidth===l.bandwidth})[0];y||(g=(m=p.filter(function(e){return e.width>i||e.height>n})).filter(function(e){return e.width===m[0].width&&e.height===m[0].height}),l=g[g.length-1],v=g.filter(function(e){return e.bandwidth===l.bandwidth})[0]);var _=v||y||c||o[0]||s[0];if(_&&_.playlist){var b="sortedPlaylistReps";return v?b="resolutionPlusOneRep":y?b="resolutionBestRep":c?b="bandwidthBestRep":o[0]&&(b="enabledPlaylistReps"),qc("choosing "+Lc(_)+" using "+b+" with options",a),_.playlist}return qc("could not choose a playlist with options",a),null}(this.playlists.master,this.systemBandwidth,parseInt(Oc(this.tech_.el(),"width"),10)*e,parseInt(Oc(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var t=this,e=this.playlists.master.playlists.filter(ic.isEnabled);return Dc(e,function(e,t){return Mc(e,t)}),e.filter(function(e){return!!xc(t.playlists.master,e).video})[0]||null},comparePlaylistBandwidth:Mc,comparePlaylistResolution:function(e,t){var i,n;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||T.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(n=t.attributes.RESOLUTION.width),i===(n=n||T.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-n},xhr:dl()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","BACK_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(Dd,t,{get:function(){return da.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),uc[t]},set:function(e){da.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<0?da.log.warn("value of Vhs."+t+" must be greater than or equal to 0"):uc[t]=e}})});function Md(e,t){for(var i=t.media(),n=-1,r=0;r<e.length;r++)if(e[r].id===i.id){n=r;break}e.selectedIndex_=n,e.trigger({selectedIndex:n,type:"change"})}var Rd="videojs-vhs";Dd.canPlaySource=function(){return da.log.warn("HLS is no longer a tech. Please remove it from your player\'s techOrder.")};function Nd(e){var t=e.player,i=e.sourceKeySystems,n=e.media,r=e.audioMedia,a=e.mainPlaylists,s=function(e,t,i){if(!e)return e;var n={video:t&&t.attributes&&t.attributes.CODECS,audio:i&&i.attributes&&i.attributes.CODECS};!n.audio&&n.video&&1<n.video.split(",").length&&n.video.split(",").forEach(function(e){e=e.trim(),zl(e)?n.audio=e:Gl(e)&&(n.video=e)});var r=n.video?\'video/mp4;codecs="\'+n.video+\'"\':null,a=n.audio?\'audio/mp4;codecs="\'+n.audio+\'"\':null,s={};for(var o in e)s[o]={audioContentType:a,videoContentType:r},t.contentProtection&&t.contentProtection[o]&&t.contentProtection[o].pssh&&(s[o].pssh=t.contentProtection[o].pssh),"string"==typeof e[o]&&(s[o].url=e[o]);return da.mergeOptions(e,s)}(i,n,r);s&&(!(t.currentSource().keySystems=s)||t.eme?11!==da.browser.IE_VERSION&&t.eme.initializeMediaKeys&&function(e,i){return e.reduce(function(e,n){if(!n.contentProtection)return e;var t=i.reduce(function(e,t){var i=n.contentProtection[t];return i&&i.pssh&&(e[t]={pssh:i.pssh}),e},{});return Object.keys(t).length&&e.push(t),e},[])}(r?a.concat([r]):a,Object.keys(i)).forEach(function(e){t.eme.initializeMediaKeys({keySystems:e})}):da.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"))}function Ud(){if(!T.localStorage)return null;var e=T.localStorage.getItem(Rd);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}Dd.supportsNativeHls=function(){if(!d||!d.createElement)return!1;var t=d.createElement("video");if(!da.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),Dd.supportsNativeDash=!!(d&&d.createElement&&da.getTech("Html5").isSupported())&&/maybe|probably/i.test(d.createElement("video").canPlayType("application/dash+xml")),Dd.supportsTypeNatively=function(e){return"hls"===e?Dd.supportsNativeHls:"dash"===e&&Dd.supportsNativeDash},Dd.isSupported=function(){return da.log.warn("HLS is no longer a tech. Please remove it from your player\'s techOrder.")};var Fd=function(a){function e(e,t,i){var n;if(n=a.call(this,t,da.mergeOptions(i.hls,i.vhs))||this,i.hls&&Object.keys(i.hls).length&&da.log.warn("Using hls options is deprecated. Use vhs instead."),t.options_&&t.options_.playerId){var r=da(t.options_.playerId);r.hasOwnProperty("hls")||Object.defineProperty(r,"hls",{get:function(){return da.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),t.trigger({type:"usage",name:"hls-player-access"}),Ve(n)},configurable:!0}),r.hasOwnProperty("vhs")||Object.defineProperty(r,"vhs",{get:function(){return da.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),t.trigger({type:"usage",name:"vhs-player-access"}),Ve(n)},configurable:!0}),r.hasOwnProperty("dash")||Object.defineProperty(r,"dash",{get:function(){return da.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),Ve(n)},configurable:!0}),n.player_=r}if(n.tech_=t,n.source_=e,n.stats={},n.ignoreNextSeekingEvent_=!1,n.setOptions_(),n.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(n.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return n.on(d,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=d.fullscreenElement||d.webkitFullscreenElement||d.mozFullScreenElement||d.msFullscreenElement;t&&t.contains(n.tech_.el())&&n.masterPlaylistController_.smoothQualityChange_()}),n.on(n.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),n.on(n.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),n.on(n.tech_,"play",n.play),n}Ge(e,a);var t=e.prototype;return t.setOptions_=function(){var t=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage="undefined"!=typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.handlePartialData=this.options_.handlePartialData||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var e=Ud();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=uc.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===uc.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","handlePartialData"].forEach(function(e){"undefined"!=typeof t.source_[e]&&(t.options_[e]=t.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},t.src=function(e,t){var i=this;e&&(this.setOptions_(),this.options_.src=function(e){return 0===e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(e.substring(e.indexOf(",")+1)):e}(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Dd,this.options_.sourceType=Ia(t),this.options_.seekTo=function(e){i.tech_.setCurrentTime(e)},this.masterPlaylistController_=new xd(this.options_),this.playbackWatcher_=new Ld(da.mergeOptions(this.options_,{seekable:function(){return i.seekable()},media:function(){return i.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_})),this.masterPlaylistController_.on("error",function(){var e=da.players[i.tech_.options_.playerId],t=i.masterPlaylistController_.error;"object"!=typeof t||t.code?"string"==typeof t&&(t={message:t,code:3}):t.code=3,e.error(t)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Dd.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Dd.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e,t=1/(this.bandwidth||1);return e=0<this.throughput?1/this.throughput:0,Math.floor(1/(t+e))},set:function(){da.log.error(\'The "systemBandwidth" property is read-only\')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Zu(i.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return i.tech_.name_},enumerable:!0},duration:{get:function(){return i.tech_.duration()},enumerable:!0},master:{get:function(){return i.playlists.master},enumerable:!0},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Zu(i.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){i.options_.useBandwidthFromLocalStorage&&function(e){if(!T.localStorage)return;var t=Ud();t=t?da.mergeOptions(t,e):e;try{T.localStorage.setItem(Rd,JSON.stringify(t))}catch(e){return}}({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(i){var e=i.playlists;i.representations=function(){return e&&e.master&&e.master.playlists?e.master.playlists.filter(function(e){return!sl(e)}).map(function(e,t){return new nd(i,e,e.id)}):[]}}(i)}),this.masterPlaylistController_.sourceUpdater_.on("ready",function(){var e=i.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;Nd({player:i.player_,sourceKeySystems:i.source_.keySystems,media:i.playlists.media(),audioMedia:e&&e.media(),mainPlaylists:i.playlists.master.playlists})}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=T.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_)))},t.setupQualityLevels_=function(){var e=this,t=da.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(t,e){e.representations().forEach(function(e){t.addQualityLevel(e)}),Md(t,e.playlists)}(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){Md(e.qualityLevels_,e.playlists)}))},e.version=function(){return{"@videojs/http-streaming":"2.2.4","mux.js":"5.6.7","mpd-parser":"0.14.0","m3u8-parser":"4.5.0","aes-decrypter":"3.1.0"}},t.version=function(){return this.constructor.version()},t.canChangeType=function(){return vd.canChangeType()},t.play=function(){this.masterPlaylistController_.play()},t.setCurrentTime=function(e){this.masterPlaylistController_.setCurrentTime(e)},t.duration=function(){return this.masterPlaylistController_.duration()},t.seekable=function(){return this.masterPlaylistController_.seekable()},t.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&T.URL.revokeObjectURL&&(T.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),a.prototype.dispose.call(this)},t.convertToProgramTime=function(e,t){return _l({playlist:this.masterPlaylistController_.media(),time:e,callback:t})},t.seekToProgramTime=function(e,t,i,n){return void 0===i&&(i=!0),void 0===n&&(n=2),bl({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})},e}(da.getComponent("Component")),Bd={name:"videojs-http-streaming",VERSION:"2.2.4",canHandleSource:function(e,t){void 0===t&&(t={});var i=da.mergeOptions(da.options,t);return Bd.canPlayType(e.type,i)},handleSource:function(e,t,i){void 0===i&&(i={});var n=da.mergeOptions(da.options,i);return t.vhs=new Fd(e,t,n),da.hasOwnProperty("hls")||Object.defineProperty(t,"hls",{get:function(){return da.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),t.vhs},configurable:!0}),t.vhs.xhr=dl(),t.vhs.src(e.src,e.type),t.vhs},canPlayType:function(e,t){void 0===t&&(t={});var i=da.mergeOptions(da.options,t).vhs.overrideNative,n=void 0===i?!da.browser.IS_ANY_SAFARI:i,r=Ia(e);return r&&(!Dd.supportsTypeNatively(r)||n)?"maybe":""}};return ql("avc1.4d400d,mp4a.40.2")&&da.getTech("Html5").registerSourceHandler(Bd,0),da.VhsHandler=Fd,Object.defineProperty(da,"HlsHandler",{get:function(){return da.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),Fd},configurable:!0}),da.VhsSourceHandler=Bd,Object.defineProperty(da,"HlsSourceHandler",{get:function(){return da.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),Bd},configurable:!0}),da.Vhs=Dd,Object.defineProperty(da,"Hls",{get:function(){return da.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),Dd},configurable:!0}),da.use||(da.registerComponent("Hls",Dd),da.registerComponent("Vhs",Dd)),da.options.vhs=da.options.vhs||{},da.options.hls=da.options.hls||{},da.registerPlugin?da.registerPlugin("reloadSourceOnError",rd):da.plugin("reloadSourceOnError",rd),da});'},function(t,e,n){n(0)(n(31))},function(t,e,n){t.exports="// extracted by mini-css-extract-plugin"},function(t,e,n){n(0)(n(33))},function(t,e){t.exports="\n/*!\n * move\n * Copyright(c) 2011 TJ Holowaychuk <tj@vision-media.ca>\n * MIT Licensed\n */\n\n;(function(exports){\n\n  /**\n   * Computed style.\n   */\n\n  var current = window.getComputedStyle || window.currentStyle;\n\n  /**\n   * Map of prop -> type for numeric values.\n   */\n\n  var map = {\n      'top': 'px'\n    , 'bottom': 'px'\n    , 'left': 'px'\n    , 'right': 'px'\n    , 'width': 'px'\n    , 'height': 'px'\n    , 'font-size': 'px'\n    , 'margin': 'px'\n    , 'margin-top': 'px'\n    , 'margin-bottom': 'px'\n    , 'margin-left': 'px'\n    , 'margin-right': 'px'\n    , 'padding': 'px'\n    , 'padding-top': 'px'\n    , 'padding-bottom': 'px'\n    , 'padding-left': 'px'\n    , 'padding-right': 'px'\n  };\n\n  /**\n   * Initialize a `Move` instance with the given `selector`.\n   *\n   * @param {String} selector\n   * @return {Move}\n   * @api public\n   */\n\n  exports.move = function(selector) {\n    return new Move(move.select(selector));\n  };\n\n  /**\n   * Library version.\n   */\n\n  exports.move.version = '0.0.3';\n\n  /**\n   * Defaults.\n   * \n   *   `duration` - default duration of 500ms\n   * \n   */\n\n  move.defaults = {\n    duration: 500\n  };\n\n  /**\n   * Easing functions.\n   */\n\n  move.ease = {\n      'in':                'ease-in'\n    , 'out':               'ease-out'\n    , 'in-out':            'ease-in-out'\n    , 'snap':              'cubic-bezier(0,1,.5,1)'\n    , 'linear':            'cubic-bezier(0.250, 0.250, 0.750, 0.750)'\n    , 'ease-in-quad':      'cubic-bezier(0.550, 0.085, 0.680, 0.530)'\n    , 'ease-in-cubic':     'cubic-bezier(0.550, 0.055, 0.675, 0.190)'\n    , 'ease-in-quart':     'cubic-bezier(0.895, 0.030, 0.685, 0.220)'\n    , 'ease-in-quint':     'cubic-bezier(0.755, 0.050, 0.855, 0.060)'\n    , 'ease-in-sine':      'cubic-bezier(0.470, 0.000, 0.745, 0.715)'\n    , 'ease-in-expo':      'cubic-bezier(0.950, 0.050, 0.795, 0.035)'\n    , 'ease-in-circ':      'cubic-bezier(0.600, 0.040, 0.980, 0.335)'\n    , 'ease-in-back':      'cubic-bezier(0.600, -0.280, 0.735, 0.045)'\n    , 'ease-out-quad':     'cubic-bezier(0.250, 0.460, 0.450, 0.940)'\n    , 'ease-out-cubic':    'cubic-bezier(0.215, 0.610, 0.355, 1.000)'\n    , 'ease-out-quart':    'cubic-bezier(0.165, 0.840, 0.440, 1.000)'\n    , 'ease-out-quint':    'cubic-bezier(0.230, 1.000, 0.320, 1.000)'\n    , 'ease-out-sine':     'cubic-bezier(0.390, 0.575, 0.565, 1.000)'\n    , 'ease-out-expo':     'cubic-bezier(0.190, 1.000, 0.220, 1.000)'\n    , 'ease-out-circ':     'cubic-bezier(0.075, 0.820, 0.165, 1.000)'\n    , 'ease-out-back':     'cubic-bezier(0.175, 0.885, 0.320, 1.275)'\n    , 'ease-out-quad':     'cubic-bezier(0.455, 0.030, 0.515, 0.955)'\n    , 'ease-out-cubic':    'cubic-bezier(0.645, 0.045, 0.355, 1.000)'\n    , 'ease-in-out-quart': 'cubic-bezier(0.770, 0.000, 0.175, 1.000)'\n    , 'ease-in-out-quint': 'cubic-bezier(0.860, 0.000, 0.070, 1.000)'\n    , 'ease-in-out-sine':  'cubic-bezier(0.445, 0.050, 0.550, 0.950)'\n    , 'ease-in-out-expo':  'cubic-bezier(1.000, 0.000, 0.000, 1.000)'\n    , 'ease-in-out-circ':  'cubic-bezier(0.785, 0.135, 0.150, 0.860)'\n    , 'ease-in-out-back':  'cubic-bezier(0.680, -0.550, 0.265, 1.550)'\n  };\n\n  /**\n   * Default element selection utilized by `move(selector)`.\n   *\n   * Override to implement your own selection, for example\n   * with jQuery one might write:\n   *\n   *     move.select = function(selector) {\n   *       return jQuery(selector).get(0);\n   *     };\n   *\n   * @param {Object|String} selector\n   * @return {Element}\n   * @api public\n   */\n\n  move.select = function(selector){\n    if ('string' != typeof selector) return selector;\n    return document.getElementById(selector)\n      || document.querySelectorAll(selector)[0];\n  };\n\n  /**\n   * EventEmitter.\n   */\n\n  function EventEmitter() {\n    this.callbacks = {};\n  }\n\n  /**\n   * Listen on the given `event` with `fn`.\n   *\n   * @param {String} event\n   * @param {Function} fn\n   */\n\n  EventEmitter.prototype.on = function(event, fn){\n    (this.callbacks[event] = this.callbacks[event] || [])\n      .push(fn);\n    return this;\n  };\n\n  /**\n   * Emit `event` with the given args.\n   *\n   * @param {String} event\n   * @param {Mixed} ...\n   */\n\n  EventEmitter.prototype.emit = function(event){\n    var args = Array.prototype.slice.call(arguments, 1)\n      , callbacks = this.callbacks[event]\n      , len;\n\n    if (callbacks) {\n      len = callbacks.length;\n      for (var i = 0; i < len; ++i) {\n        callbacks[i].apply(this, args)\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Initialize a new `Move` with the given `el`.\n   *\n   * @param {Element} el\n   * @api public\n   */\n\n  exports.Move = function Move(el) {\n    if (!(this instanceof Move)) return new Move(el);\n    EventEmitter.call(this);\n    this.el = el;\n    this._props = {};\n    this._rotate = 0;\n    this._transitionProps = [];\n    this._transforms = [];\n    this.duration(move.defaults.duration)\n  };\n\n  /**\n   * Inherit from `EventEmitter.prototype`.\n   */\n\n  Move.prototype = new EventEmitter;\n  Move.prototype.constructor = Move;\n\n  /**\n   * Buffer `transform`.\n   *\n   * @param {String} transform\n   * @return {Move} for chaining\n   * @api private\n   */\n\n  Move.prototype.transform = function(transform){\n    this._transforms.push(transform);\n    return this;\n  };\n\n  /**\n   * Skew `x` and `y`.\n   *\n   * @param {Number} x\n   * @param {Number} y\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.skew = function(x, y){\n    y = y || 0;\n    return this.transform('skew('\n      + x + 'deg, '\n      + y + 'deg)');\n  };\n\n  /**\n   * Skew x by `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.skewX = function(n){\n    return this.transform('skewX(' + n + 'deg)');\n  };\n\n  /**\n   * Skew y by `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.skewY = function(n){\n    return this.transform('skewY(' + n + 'deg)');\n  };\n\n  /**\n   * Translate `x` and `y` axis.\n   *\n   * @param {Number} x\n   * @param {Number} y\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.translate = \n  Move.prototype.to = function(x, y){\n    y = y || 0;\n    return this.transform('translate('\n      + x + 'px, '\n      + y + 'px)');\n  };\n\n  /**\n   * Translate on the x axis to `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.translateX =\n  Move.prototype.x = function(n){\n    return this.transform('translate3d(' + n + 'px, 0px, 0px)');\n  };\n\n  /**\n   * Translate on the y axis to `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.translateY =\n  Move.prototype.y = function(n){\n    return this.transform('translate3d(0px, ' + n + 'px, 0px)');\n  };\n\n  /**\n   * Scale the x and y axis by `x`, or \n   * individually scale `x` and `y`.\n   *\n   * @param {Number} x\n   * @param {Number} y\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.scale = function(x, y){\n    y = null == y ? x : y;\n    return this.transform('scale('\n      + x + ', '\n      + y + ')');\n  };\n\n  /**\n   * Scale x axis by `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.scaleX = function(n){\n    return this.transform('scaleX(' + n + ')')\n  };\n\n  /**\n   * Scale y axis by `n`.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.scaleY = function(n){\n    return this.transform('scaleY(' + n + ')')\n  };\n\n  /**\n   * Rotate `n` degrees.\n   *\n   * @param {Number} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.rotate = function(n){\n    return this.transform('rotate(' + n + 'deg)');\n  };\n\n  /**\n   * Set transition easing function to to `fn` string.\n   *\n   * When:\n   *\n   *   - null \"ease\" is used\n   *   - \"in\" \"ease-in\" is used\n   *   - \"out\" \"ease-out\" is used\n   *   - \"in-out\" \"ease-in-out\" is used\n   *\n   * @param {String} fn\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.ease = function(fn){\n    fn = move.ease[fn] || fn || 'ease';\n    return this.setVendorProperty('transition-timing-function', fn);\n  };\n\n  /**\n   * Set animation properties\n   *\n   * @param {String} name\n   * @param {Object} props\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.animate = function(name, props){\n    for (var i in props){\n      if (props.hasOwnProperty(i)){\n        this.setVendorProperty('animation-' + i, props[i])\n      }\n    }\n    return this.setVendorProperty('animation-name', name);\n  }\n\n  /**\n   * Set duration to `n`.\n   *\n   * @param {Number|String} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.duration = function(n){\n    n = this._duration = 'string' == typeof n\n      ? parseFloat(n) * 1000\n      : n;\n    return this.setVendorProperty('transition-duration', n + 'ms');\n  };\n\n  /**\n   * Delay the animation by `n`.\n   *\n   * @param {Number|String} n\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.delay = function(n){\n    n = 'string' == typeof n\n      ? parseFloat(n) * 1000\n      : n;\n    return this.setVendorProperty('transition-delay', n + 'ms');\n  };\n\n  /**\n   * Set `prop` to `val`, deferred until `.end()` is invoked.\n   *\n   * @param {String} prop\n   * @param {String} val\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.setProperty = function(prop, val){\n    this._props[prop] = val;\n    return this;\n  };\n\n  /**\n   * Set a vendor prefixed `prop` with the given `val`.\n   *\n   * @param {String} prop\n   * @param {String} val\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.setVendorProperty = function(prop, val){\n    this.setProperty('-webkit-' + prop, val);\n    this.setProperty('-moz-' + prop, val);\n    this.setProperty('-ms-' + prop, val);\n    this.setProperty('-o-' + prop, val);\n    return this;\n  };\n\n  /**\n   * Set `prop` to `value`, deferred until `.end()` is invoked\n   * and adds the property to the list of transition props.\n   *\n   * @param {String} prop\n   * @param {String} val\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.set = function(prop, val){\n    this.transition(prop);\n    if ('number' == typeof val && map[prop]) val += map[prop]; \n    this._props[prop] = val;\n    return this;\n  };\n\n  /**\n   * Increment `prop` by `val`, deferred until `.end()` is invoked\n   * and adds the property to the list of transition props.\n   *\n   * @param {String} prop\n   * @param {Number} val\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.add = function(prop, val){\n    if (!current) return;\n    var self = this;\n    return this.on('start', function(){\n      var curr = parseInt(self.current(prop), 10);\n      self.set(prop, curr + val + 'px');\n    });\n  };\n\n  /**\n   * Decrement `prop` by `val`, deferred until `.end()` is invoked\n   * and adds the property to the list of transition props.\n   *\n   * @param {String} prop\n   * @param {Number} val\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.sub = function(prop, val){\n    if (!current) return;\n    var self = this;\n    return this.on('start', function(){\n      var curr = parseInt(self.current(prop), 10);\n      self.set(prop, curr - val + 'px');\n    });\n  };\n\n  /**\n   * Get computed or \"current\" value of `prop`.\n   *\n   * @param {String} prop\n   * @return {String}\n   * @api public\n   */\n\n  Move.prototype.current = function(prop){\n    return current(this.el).getPropertyValue(prop);\n  };\n\n  /**\n   * Add `prop` to the list of internal transition properties.\n   *\n   * @param {String} prop\n   * @return {Move} for chaining\n   * @api private\n   */\n\n  Move.prototype.transition = function(prop){\n    if (!this._transitionProps.indexOf(prop)) return this;\n    this._transitionProps.push(prop);\n    return this;\n  };\n\n  /**\n   * Commit style properties, aka apply them to `el.style`.\n   *\n   * @return {Move} for chaining\n   * @see Move#end()\n   * @api private\n   */\n\n  Move.prototype.applyProperties = function(){\n    var props = this._props\n      , el = this.el;\n\n    for (var prop in props) {\n      if (props.hasOwnProperty(prop)) {\n        el.style.setProperty(prop, props[prop], '');\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Re-select element via `selector`, replacing\n   * the current element.\n   *\n   * @param {String} selector\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.move =\n  Move.prototype.select = function(selector){\n    this.el = move.select(selector);\n    return this;\n  };\n\n  /**\n   * Defer the given `fn` until the animation\n   * is complete. `fn` may be one of the following:\n   *\n   *   - a function to invoke\n   *   - an instanceof `Move` to call `.end()`\n   *   - nothing, to return a clone of this `Move` instance for chaining\n   *\n   * @param {Function|Move} fn\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.then = function(fn){\n    // invoke .end()\n    if (fn instanceof Move) {\n      this.on('end', function(){\n        fn.end();\n      });\n    // callback\n    } else if ('function' == typeof fn) {\n      this.on('end', fn);\n    // chain\n    } else {\n      var clone = new Move(this.el);\n      clone._transforms = this._transforms.slice(0);\n      this.then(clone);\n      clone.parent = this;\n      return clone;\n    }\n\n    return this;\n  };\n\n  /**\n   * Pop the move context.\n   *\n   * @return {Move} parent Move\n   * @api public\n   */\n\n  Move.prototype.pop = function(){\n    return this.parent;\n  };\n\n  /**\n   * Start animation, optionally calling `fn` when complete.\n   *\n   * @param {Function} fn\n   * @return {Move} for chaining\n   * @api public\n   */\n\n  Move.prototype.end = function(fn){\n    var self = this;\n\n    // emit \"start\" event\n    this.emit('start');\n\n    // transforms\n    if (this._transforms.length) {\n      this.setVendorProperty('transform', this._transforms.join(' '));\n    }\n\n    // transition properties\n    this.setVendorProperty('transition-properties', this._transitionProps.join(', '));\n    this.applyProperties();\n\n    // callback given\n    if (fn) this.then(fn);\n\n    // emit \"end\" when complete\n    setTimeout(function(){\n      self.emit('end');\n    }, this._duration);\n\n    return this;\n  };\n\n})(this);"},function(t,e,n){n(0)(n(35))},function(t,e){t.exports="/*\n\tAnimator.js 1.1.11\n\n\tThis library is released under the BSD license:\n\n\tCopyright (c) 2006, Bernard Sumption. All rights reserved.\n\n\tRedistribution and use in source and binary forms, with or without\n\tmodification, are permitted provided that the following conditions are met:\n\n\tRedistributions of source code must retain the above copyright notice, this\n\tlist of conditions and the following disclaimer. Redistributions in binary\n\tform must reproduce the above copyright notice, this list of conditions and\n\tthe following disclaimer in the documentation and/or other materials\n\tprovided with the distribution. Neither the name BernieCode nor\n\tthe names of its contributors may be used to endorse or promote products\n\tderived from this software without specific prior written permission.\n\n\tTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n\tAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n\tIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n\tARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE FOR\n\tANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n\tDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n\tSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n\tCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n\tLIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\n\tOUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\n\tDAMAGE.\n\n*/\n\n\n// Applies a sequence of numbers between 0 and 1 to a number of subjects\n// construct - see setOptions for parameters\nfunction Animator(options) {\n\tthis.setOptions(options);\n\tvar _this = this;\n\tthis.timerDelegate = function(){_this.onTimerEvent()};\n\tthis.subjects = [];\n\tthis.target = 0;\n\tthis.state = 0;\n\tthis.lastTime = null;\n};\nAnimator.prototype = {\n\t// apply defaults\n\tsetOptions: function(options) {\n\t\tthis.options = Animator.applyDefaults({\n\t\t\tinterval: 20,  // time between animation frames\n\t\t\tduration: 400, // length of animation\n\t\t\tonComplete: function(){},\n\t\t\tonStep: function(){},\n\t\t\ttransition: Animator.tx.easeInOut\n\t\t}, options);\n\t},\n\t// animate from the current state to provided value\n\tseekTo: function(to) {\n\t\tthis.seekFromTo(this.state, to);\n\t},\n\t// animate from the current state to provided value\n\tseekFromTo: function(from, to) {\n\t\tthis.target = Math.max(0, Math.min(1, to));\n\t\tthis.state = Math.max(0, Math.min(1, from));\n\t\tthis.lastTime = new Date().getTime();\n\t\tif (!this.intervalId) {\n\t\t\tthis.intervalId = window.setInterval(this.timerDelegate, this.options.interval);\n\t\t}\n\t},\n\t// animate from the current state to provided value\n\tjumpTo: function(to) {\n\t\tthis.target = this.state = Math.max(0, Math.min(1, to));\n\t\tthis.propagate();\n\t},\n\t// seek to the opposite of the current target\n\ttoggle: function() {\n\t\tthis.seekTo(1 - this.target);\n\t},\n\t// add a function or an object with a method setState(state) that will be called with a number\n\t// between 0 and 1 on each frame of the animation\n\taddSubject: function(subject) {\n\t\tthis.subjects[this.subjects.length] = subject;\n\t\treturn this;\n\t},\n\t// remove all subjects\n\tclearSubjects: function() {\n\t\tthis.subjects = [];\n\t},\n\t// forward the current state to the animation subjects\n\tpropagate: function() {\n\t\tvar value = this.options.transition(this.state);\n\t\tfor (var i=0; i<this.subjects.length; i++) {\n\t\t\tif (this.subjects[i].setState) {\n\t\t\t\tthis.subjects[i].setState(value);\n\t\t\t} else {\n\t\t\t\tthis.subjects[i](value);\n\t\t\t}\n\t\t}\n\t},\n\t// called once per frame to update the current state\n\tonTimerEvent: function() {\n\t\tvar now = new Date().getTime();\n\t\tvar timePassed = now - this.lastTime;\n\t\tthis.lastTime = now;\n\t\tvar movement = (timePassed / this.options.duration) * (this.state < this.target ? 1 : -1);\n\t\tif (Math.abs(movement) >= Math.abs(this.state - this.target)) {\n\t\t\tthis.state = this.target;\n\t\t} else {\n\t\t\tthis.state += movement;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tthis.propagate();\n\t\t}\n\t\tcatch (_objError)\n\t\t{\n\t\t\t// Empty catch to stop IE7 and lower failing.\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tthis.options.onStep.call(this);\n\t\t\tif (this.target == this.state) {\n\t\t\t\tthis.stop();\n\t\t\t}\n\t\t}\n\t},\n\tstop: function() {\n\t\tif (this.intervalId) {\n\t\t\twindow.clearInterval(this.intervalId);\n\t\t\tthis.intervalId = null;\n\t\t\tthis.options.onComplete.call(this);\n\t\t}\n\t},\n\t// shortcuts\n\tplay: function() {this.seekFromTo(0, 1)},\n\treverse: function() {this.seekFromTo(1, 0)},\n\t// return a string describing this Animator, for debugging\n\tinspect: function() {\n\t\tvar str = \"#<Animator:\\n\";\n\t\tfor (var i=0; i<this.subjects.length; i++) {\n\t\t\tstr += this.subjects[i].inspect();\n\t\t}\n\t\tstr += \">\";\n\t\treturn str;\n\t}\n}\n// merge the properties of two objects\nAnimator.applyDefaults = function(defaults, prefs) {\n\tprefs = prefs || {};\n\tvar prop, result = {};\n\tfor (prop in defaults) result[prop] = prefs[prop] !== undefined ? prefs[prop] : defaults[prop];\n\treturn result;\n}\n// make an array from any object\nAnimator.makeArrayOfElements = function(o) {\n\tif (o == null) return [];\n\tif (\"string\" == typeof o) {\n\t\treturn [document.getElementById(o)];\n\t}\n\tif (!o.length) return [o];\n\tvar result = [];\n\tfor (var i=0; i<o.length; i++) {\n\t\tif (\"string\" == typeof o[i]) {\n\t\t\tresult[i] = document.getElementById(o[i]);\n\t\t} else {\n\t\t\tresult[i] = o[i];\n\t\t}\n\t}\n\treturn result;\n}\n// convert a dash-delimited-property to a camelCaseProperty (c/o Prototype, thanks Sam!)\nAnimator.camelize = function(string) {\n\tvar oStringList = string.split('-');\n\tif (oStringList.length == 1) return oStringList[0];\n\n\tvar camelizedString = string.indexOf('-') == 0\n\t\t? oStringList[0].charAt(0).toUpperCase() + oStringList[0].substring(1)\n\t\t: oStringList[0];\n\n\tfor (var i = 1, len = oStringList.length; i < len; i++) {\n\t\tvar s = oStringList[i];\n\t\tcamelizedString += s.charAt(0).toUpperCase() + s.substring(1);\n\t}\n\treturn camelizedString;\n}\n// syntactic sugar for creating CSSStyleSubjects\nAnimator.apply = function(el, style, options) {\n\tif (style instanceof Array) {\n\t\treturn new Animator(options).addSubject(new CSSStyleSubject(el, style[0], style[1]));\n\t}\n\treturn new Animator(options).addSubject(new CSSStyleSubject(el, style));\n}\n// make a transition function that gradually accelerates. pass a=1 for smooth\n// gravitational acceleration, higher values for an exaggerated effect\nAnimator.makeEaseIn = function(a) {\n\treturn function(state) {\n\t\treturn Math.pow(state, a*2);\n\t}\n}\n// as makeEaseIn but for deceleration\nAnimator.makeEaseOut = function(a) {\n\treturn function(state) {\n\t\treturn 1 - Math.pow(1 - state, a*2);\n\t}\n}\n// make a transition function that, like an object with momentum being attracted to a point,\n// goes past the target then returns\nAnimator.makeElastic = function(bounces) {\n\treturn function(state) {\n\t\tstate = Animator.tx.easeInOut(state);\n\t\treturn ((1-Math.cos(state * Math.PI * bounces)) * (1 - state)) + state;\n\t}\n}\n// make an Attack Decay Sustain Release envelope that starts and finishes on the same level\n//\nAnimator.makeADSR = function(attackEnd, decayEnd, sustainEnd, sustainLevel) {\n\tif (sustainLevel == null) sustainLevel = 0.5;\n\treturn function(state) {\n\t\tif (state < attackEnd) {\n\t\t\treturn state / attackEnd;\n\t\t}\n\t\tif (state < decayEnd) {\n\t\t\treturn 1 - ((state - attackEnd) / (decayEnd - attackEnd) * (1 - sustainLevel));\n\t\t}\n\t\tif (state < sustainEnd) {\n\t\t\treturn sustainLevel;\n\t\t}\n\t\treturn sustainLevel * (1 - ((state - sustainEnd) / (1 - sustainEnd)));\n\t}\n}\n// make a transition function that, like a ball falling to floor, reaches the target and/\n// bounces back again\nAnimator.makeBounce = function(bounces) {\n\tvar fn = Animator.makeElastic(bounces);\n\treturn function(state) {\n\t\tstate = fn(state);\n\t\treturn state <= 1 ? state : 2-state;\n\t}\n}\n\n// pre-made transition functions to use with the 'transition' option\nAnimator.tx = {\n\teaseInOut: function(pos){\n\t\treturn ((-Math.cos(pos*Math.PI)/2) + 0.5);\n\t},\n\tlinear: function(x) {\n\t\treturn x;\n\t},\n\teaseIn: Animator.makeEaseIn(1.5),\n\teaseOut: Animator.makeEaseOut(1.5),\n\tstrongEaseIn: Animator.makeEaseIn(2.5),\n\tstrongEaseOut: Animator.makeEaseOut(2.5),\n\telastic: Animator.makeElastic(1),\n\tveryElastic: Animator.makeElastic(3),\n\tbouncy: Animator.makeBounce(1),\n\tveryBouncy: Animator.makeBounce(3)\n}\n\n// animates a pixel-based style property between two integer values\nfunction NumericalStyleSubject(els, property, from, to, units) {\n\tthis.els = Animator.makeArrayOfElements(els);\n\tif (property == 'opacity' && window.ActiveXObject) {\n\t\tthis.property = 'filter';\n\t} else {\n\t\tthis.property = Animator.camelize(property);\n\t}\n\tthis.from = parseFloat(from);\n\tthis.to = parseFloat(to);\n\tthis.units = units != null ? units : 'px';\n}\nNumericalStyleSubject.prototype = {\n\tsetState: function(state) {\n\t\tvar style = this.getStyle(state);\n\t\tvar visibility = (this.property == 'opacity' && state == 0) ? 'hidden' : '';\n\t\tvar j=0;\n\t\tfor (var i=0; i<this.els.length; i++) {\n\t\t\ttry {\n\t\t\t\tthis.els[i].style[this.property] = style;\n\t\t\t} catch (e) {\n\t\t\t\t// ignore fontWeight - intermediate numerical values cause exeptions in firefox\n\t\t\t\tif (this.property != 'fontWeight') throw e;\n\t\t\t}\n\t\t\tif (j++ > 20) return;\n\t\t}\n\t},\n\tgetStyle: function(state) {\n\t\tstate = this.from + ((this.to - this.from) * state);\n\t\tif (this.property == 'filter') return \"alpha(opacity=\" + Math.round(state*100) + \")\";\n\t\tif (this.property == 'opacity') return state;\n\t\treturn Math.round(state) + this.units;\n\t},\n\tinspect: function() {\n\t\treturn \"\\t\" + this.property + \"(\" + this.from + this.units + \" to \" + this.to + this.units + \")\\n\";\n\t}\n}\n\n// animates a colour based style property between two hex values\nfunction ColorStyleSubject(els, property, from, to) {\n\tthis.els = Animator.makeArrayOfElements(els);\n\tthis.property = Animator.camelize(property);\n\tthis.to = this.expandColor(to);\n\tthis.from = this.expandColor(from);\n\tthis.origFrom = from;\n\tthis.origTo = to;\n}\n\nColorStyleSubject.prototype = {\n\t// parse \"#FFFF00\" to [256, 256, 0]\n\texpandColor: function(color) {\n\t\tvar hexColor, red, green, blue;\n\t\thexColor = ColorStyleSubject.parseColor(color);\n\t\tif (hexColor) {\n\t\t\tred = parseInt(hexColor.slice(1, 3), 16);\n\t\t\tgreen = parseInt(hexColor.slice(3, 5), 16);\n\t\t\tblue = parseInt(hexColor.slice(5, 7), 16);\n\t\t\treturn [red,green,blue]\n\t\t}\n\t\tif (window.ANIMATOR_DEBUG) {\n\t\t\talert(\"Invalid colour: '\" + color + \"'\");\n\t\t}\n\t},\n\tgetValueForState: function(color, state) {\n\t\treturn Math.round(this.from[color] + ((this.to[color] - this.from[color]) * state));\n\t},\n\tsetState: function(state) {\n\t\tvar color = '#'\n\t\t\t\t+ ColorStyleSubject.toColorPart(this.getValueForState(0, state))\n\t\t\t\t+ ColorStyleSubject.toColorPart(this.getValueForState(1, state))\n\t\t\t\t+ ColorStyleSubject.toColorPart(this.getValueForState(2, state));\n\t\tfor (var i=0; i<this.els.length; i++) {\n\t\t\tthis.els[i].style[this.property] = color;\n\t\t}\n\t},\n\tinspect: function() {\n\t\treturn \"\\t\" + this.property + \"(\" + this.origFrom + \" to \" + this.origTo + \")\\n\";\n\t}\n}\n\n// return a properly formatted 6-digit hex colour spec, or false\nColorStyleSubject.parseColor = function(string) {\n\tvar color = '#', match;\n\tif(match = ColorStyleSubject.parseColor.rgbRe.exec(string)) {\n\t\tvar part;\n\t\tfor (var i=1; i<=3; i++) {\n\t\t\tpart = Math.max(0, Math.min(255, parseInt(match[i])));\n\t\t\tcolor += ColorStyleSubject.toColorPart(part);\n\t\t}\n\t\treturn color;\n\t}\n\tif (match = ColorStyleSubject.parseColor.hexRe.exec(string)) {\n\t\tif(match[1].length == 3) {\n\t\t\tfor (var i=0; i<3; i++) {\n\t\t\t\tcolor += match[1].charAt(i) + match[1].charAt(i);\n\t\t\t}\n\t\t\treturn color;\n\t\t}\n\t\treturn '#' + match[1];\n\t}\n\treturn false;\n}\n// convert a number to a 2 digit hex string\nColorStyleSubject.toColorPart = function(number) {\n\tif (number > 255) number = 255;\n\tvar digits = number.toString(16);\n\tif (number < 16) return '0' + digits;\n\treturn digits;\n}\nColorStyleSubject.parseColor.rgbRe = /^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/i;\nColorStyleSubject.parseColor.hexRe = /^\\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;\n\n// Animates discrete styles, i.e. ones that do not scale but have discrete values\n// that can't be interpolated\nfunction DiscreteStyleSubject(els, property, from, to, threshold) {\n\tthis.els = Animator.makeArrayOfElements(els);\n\tthis.property = Animator.camelize(property);\n\tthis.from = from;\n\tthis.to = to;\n\tthis.threshold = threshold || 0.5;\n}\n\nDiscreteStyleSubject.prototype = {\n\tsetState: function(state) {\n\t\tvar j=0;\n\t\tfor (var i=0; i<this.els.length; i++) {\n\t\t\tthis.els[i].style[this.property] = state <= this.threshold ? this.from : this.to;\n\t\t}\n\t},\n\tinspect: function() {\n\t\treturn \"\\t\" + this.property + \"(\" + this.from + \" to \" + this.to + \" @ \" + this.threshold + \")\\n\";\n\t}\n}\n\n// animates between two styles defined using CSS.\n// if style1 and style2 are present, animate between them, if only style1\n// is present, animate between the element's current style and style1\nfunction CSSStyleSubject(els, style1, style2) {\n\tels = Animator.makeArrayOfElements(els);\n\tthis.subjects = [];\n\tif (els.length == 0) return;\n\tvar prop, toStyle, fromStyle;\n\tif (style2) {\n\t\tfromStyle = this.parseStyle(style1, els[0]);\n\t\ttoStyle = this.parseStyle(style2, els[0]);\n\t} else {\n\t\ttoStyle = this.parseStyle(style1, els[0]);\n\t\tfromStyle = {};\n\t\tfor (prop in toStyle) {\n\t\t\tfromStyle[prop] = CSSStyleSubject.getStyle(els[0], prop);\n\t\t}\n\t}\n\t// remove unchanging properties\n\tvar prop;\n\tfor (prop in fromStyle) {\n\t\tif (fromStyle[prop] == toStyle[prop]) {\n\t\t\tdelete fromStyle[prop];\n\t\t\tdelete toStyle[prop];\n\t\t}\n\t}\n\t// discover the type (numerical or colour) of each style\n\tvar prop, units, match, type, from, to;\n\tfor (prop in fromStyle) {\n\t\tvar fromProp = String(fromStyle[prop]);\n\t\tvar toProp = String(toStyle[prop]);\n\t\tif (toStyle[prop] == null) {\n\t\t\tif (window.ANIMATOR_DEBUG) alert(\"No to style provided for '\" + prop + '\"');\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (from = ColorStyleSubject.parseColor(fromProp)) {\n\t\t\tto = ColorStyleSubject.parseColor(toProp);\n\t\t\ttype = ColorStyleSubject;\n\t\t} else if (fromProp.match(CSSStyleSubject.numericalRe)\n\t\t\t\t&& toProp.match(CSSStyleSubject.numericalRe)) {\n\t\t\tfrom = parseFloat(fromProp);\n\t\t\tto = parseFloat(toProp);\n\t\t\ttype = NumericalStyleSubject;\n\t\t\tmatch = CSSStyleSubject.numericalRe.exec(fromProp);\n\t\t\tvar reResult = CSSStyleSubject.numericalRe.exec(toProp);\n\t\t\tif (match[1] != null) {\n\t\t\t\tunits = match[1];\n\t\t\t} else if (reResult[1] != null) {\n\t\t\t\tunits = reResult[1];\n\t\t\t} else {\n\t\t\t\tunits = reResult;\n\t\t\t}\n\t\t} else if (fromProp.match(CSSStyleSubject.discreteRe)\n\t\t\t\t&& toProp.match(CSSStyleSubject.discreteRe)) {\n\t\t\tfrom = fromProp;\n\t\t\tto = toProp;\n\t\t\ttype = DiscreteStyleSubject;\n\t\t\tunits = 0;   // hack - how to get an animator option down to here\n\t\t} else {\n\t\t\tif (window.ANIMATOR_DEBUG) {\n\t\t\t\talert(\"Unrecognised format for value of \"\n\t\t\t\t\t+ prop + \": '\" + fromStyle[prop] + \"'\");\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tthis.subjects[this.subjects.length] = new type(els, prop, from, to, units);\n\t}\n}\n\nCSSStyleSubject.prototype = {\n\t// parses \"width: 400px; color: #FFBB2E\" to {width: \"400px\", color: \"#FFBB2E\"}\n\tparseStyle: function(style, el) {\n\t\tvar rtn = {};\n\t\t// if style is a rule set\n\t\tif (style.indexOf(\":\") != -1) {\n\t\t\tvar styles = style.split(\";\");\n\t\t\tfor (var i=0; i<styles.length; i++) {\n\t\t\t\tvar parts = CSSStyleSubject.ruleRe.exec(styles[i]);\n\t\t\t\tif (parts) {\n\t\t\t\t\trtn[parts[1]] = parts[2];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// else assume style is a class name\n\t\telse {\n\t\t\tvar prop, value, oldClass;\n\t\t\toldClass = el.className;\n\t\t\tel.className = style;\n\t\t\tfor (var i=0; i<CSSStyleSubject.cssProperties.length; i++) {\n\t\t\t\tprop = CSSStyleSubject.cssProperties[i];\n\t\t\t\tvalue = CSSStyleSubject.getStyle(el, prop);\n\t\t\t\tif (value != null) {\n\t\t\t\t\trtn[prop] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tel.className = oldClass;\n\t\t}\n\t\treturn rtn;\n\n\t},\n\tsetState: function(state) {\n\t\tfor (var i=0; i<this.subjects.length; i++) {\n\t\t\tthis.subjects[i].setState(state);\n\t\t}\n\t},\n\tinspect: function() {\n\t\tvar str = \"\";\n\t\tfor (var i=0; i<this.subjects.length; i++) {\n\t\t\tstr += this.subjects[i].inspect();\n\t\t}\n\t\treturn str;\n\t}\n}\n// get the current value of a css property,\nCSSStyleSubject.getStyle = function(el, property){\n\tvar style;\n\tif(document.defaultView && document.defaultView.getComputedStyle){\n\t\tstyle = document.defaultView.getComputedStyle(el, \"\").getPropertyValue(property);\n\t\tif (style) {\n\t\t\treturn style;\n\t\t}\n\t}\n\tproperty = Animator.camelize(property);\n\tif(el.currentStyle){\n\t\tstyle = el.currentStyle[property];\n\t}\n\treturn style || el.style[property]\n}\n\n\nCSSStyleSubject.ruleRe = /^\\s*([a-zA-Z\\-]+)\\s*:\\s*(\\S(.+\\S)?)\\s*$/;\nCSSStyleSubject.numericalRe = /^-?\\d+(?:\\.\\d+)?(%|[a-zA-Z]{2})?$/;\nCSSStyleSubject.discreteRe = /^\\w+$/;\n\n// required because the style object of elements isn't enumerable in Safari\n/*\nCSSStyleSubject.cssProperties = ['background-color','border','border-color','border-spacing',\n'border-style','border-top','border-right','border-bottom','border-left','border-top-color',\n'border-right-color','border-bottom-color','border-left-color','border-top-width','border-right-width',\n'border-bottom-width','border-left-width','border-width','bottom','color','font-size','font-size-adjust',\n'font-stretch','font-style','height','left','letter-spacing','line-height','margin','margin-top',\n'margin-right','margin-bottom','margin-left','marker-offset','max-height','max-width','min-height',\n'min-width','orphans','outline','outline-color','outline-style','outline-width','overflow','padding',\n'padding-top','padding-right','padding-bottom','padding-left','quotes','right','size','text-indent',\n'top','width','word-spacing','z-index','opacity','outline-offset'];*/\n\n\nCSSStyleSubject.cssProperties = ['azimuth','background','background-attachment','background-color','background-image','background-position','background-repeat','border-collapse','border-color','border-spacing','border-style','border-top','border-top-color','border-right-color','border-bottom-color','border-left-color','border-top-style','border-right-style','border-bottom-style','border-left-style','border-top-width','border-right-width','border-bottom-width','border-left-width','border-width','bottom','clear','clip','color','content','cursor','direction','display','elevation','empty-cells','css-float','font','font-family','font-size','font-size-adjust','font-stretch','font-style','font-variant','font-weight','height','left','letter-spacing','line-height','list-style','list-style-image','list-style-position','list-style-type','margin','margin-top','margin-right','margin-bottom','margin-left','max-height','max-width','min-height','min-width','orphans','outline','outline-color','outline-style','outline-width','overflow','padding','padding-top','padding-right','padding-bottom','padding-left','pause','position','right','size','table-layout','text-align','text-decoration','text-indent','text-shadow','text-transform','top','vertical-align','visibility','white-space','width','word-spacing','z-index','opacity','outline-offset','overflow-x','overflow-y'];\n\n\n// chains several Animator objects together\nfunction AnimatorChain(animators, options) {\n\tthis.animators = animators;\n\tthis.setOptions(options);\n\tfor (var i=0; i<this.animators.length; i++) {\n\t\tthis.listenTo(this.animators[i]);\n\t}\n\tthis.forwards = false;\n\tthis.current = 0;\n}\n\nAnimatorChain.prototype = {\n\t// apply defaults\n\tsetOptions: function(options) {\n\t\tthis.options = Animator.applyDefaults({\n\t\t\t// by default, each call to AnimatorChain.play() calls jumpTo(0) of each animator\n\t\t\t// before playing, which can cause flickering if you have multiple animators all\n\t\t\t// targeting the same element. Set this to false to avoid this.\n\t\t\tresetOnPlay: true\n\t\t}, options);\n\t},\n\t// play each animator in turn\n\tplay: function() {\n\t\tthis.forwards = true;\n\t\tthis.current = -1;\n\t\tif (this.options.resetOnPlay) {\n\t\t\tfor (var i=0; i<this.animators.length; i++) {\n\t\t\t\tthis.animators[i].jumpTo(0);\n\t\t\t}\n\t\t}\n\t\tthis.advance();\n\t},\n\t// play all animators backwards\n\treverse: function() {\n\t\tthis.forwards = false;\n\t\tthis.current = this.animators.length;\n\t\tif (this.options.resetOnPlay) {\n\t\t\tfor (var i=0; i<this.animators.length; i++) {\n\t\t\t\tthis.animators[i].jumpTo(1);\n\t\t\t}\n\t\t}\n\t\tthis.advance();\n\t},\n\t// if we have just play()'d, then call reverse(), and vice versa\n\ttoggle: function() {\n\t\tif (this.forwards) {\n\t\t\tthis.seekTo(0);\n\t\t} else {\n\t\t\tthis.seekTo(1);\n\t\t}\n\t},\n\t// internal: install an event listener on an animator's onComplete option\n\t// to trigger the next animator\n\tlistenTo: function(animator) {\n\t\tvar oldOnComplete = animator.options.onComplete;\n\t\tvar _this = this;\n\t\tanimator.options.onComplete = function() {\n\t\t\tif (oldOnComplete) oldOnComplete.call(animator);\n\t\t\t_this.advance();\n\t\t}\n\t},\n\t// play the next animator\n\tadvance: function() {\n\t\tif (this.forwards) {\n\t\t\tif (this.animators[this.current + 1] == null) return;\n\t\t\tthis.current++;\n\t\t\tthis.animators[this.current].play();\n\t\t} else {\n\t\t\tif (this.animators[this.current - 1] == null) return;\n\t\t\tthis.current--;\n\t\t\tthis.animators[this.current].reverse();\n\t\t}\n\t},\n\t// this function is provided for drop-in compatibility with Animator objects,\n\t// but only accepts 0 and 1 as target values\n\tseekTo: function(target) {\n\t\tif (target <= 0) {\n\t\t\tthis.forwards = false;\n\t\t\tthis.animators[this.current].seekTo(0);\n\t\t} else {\n\t\t\tthis.forwards = true;\n\t\t\tthis.animators[this.current].seekTo(1);\n\t\t}\n\t}\n}"},function(t,e,n){n(0)(n(37))},function(t,e){t.exports="/*! https://mths.be/he v1.2.0 by @mathias | MIT license */\n;(function(root) {\n\n\t// Detect free variables `exports`.\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`.\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code,\n\t// and use it as `root`.\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t// All astral symbols.\n\tvar regexAstralSymbols = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n\t// All ASCII symbols (not just printable ASCII) except those listed in the\n\t// first column of the overrides table.\n\t// https://html.spec.whatwg.org/multipage/syntax.html#table-charref-overrides\n\tvar regexAsciiWhitelist = /[\\x01-\\x7F]/g;\n\t// All BMP symbols that are not ASCII newlines, printable ASCII symbols, or\n\t// code points listed in the first column of the overrides table on\n\t// https://html.spec.whatwg.org/multipage/syntax.html#table-charref-overrides.\n\tvar regexBmpWhitelist = /[\\x01-\\t\\x0B\\f\\x0E-\\x1F\\x7F\\x81\\x8D\\x8F\\x90\\x9D\\xA0-\\uFFFF]/g;\n\n\tvar regexEncodeNonAscii = /<\\u20D2|=\\u20E5|>\\u20D2|\\u205F\\u200A|\\u219D\\u0338|\\u2202\\u0338|\\u2220\\u20D2|\\u2229\\uFE00|\\u222A\\uFE00|\\u223C\\u20D2|\\u223D\\u0331|\\u223E\\u0333|\\u2242\\u0338|\\u224B\\u0338|\\u224D\\u20D2|\\u224E\\u0338|\\u224F\\u0338|\\u2250\\u0338|\\u2261\\u20E5|\\u2264\\u20D2|\\u2265\\u20D2|\\u2266\\u0338|\\u2267\\u0338|\\u2268\\uFE00|\\u2269\\uFE00|\\u226A\\u0338|\\u226A\\u20D2|\\u226B\\u0338|\\u226B\\u20D2|\\u227F\\u0338|\\u2282\\u20D2|\\u2283\\u20D2|\\u228A\\uFE00|\\u228B\\uFE00|\\u228F\\u0338|\\u2290\\u0338|\\u2293\\uFE00|\\u2294\\uFE00|\\u22B4\\u20D2|\\u22B5\\u20D2|\\u22D8\\u0338|\\u22D9\\u0338|\\u22DA\\uFE00|\\u22DB\\uFE00|\\u22F5\\u0338|\\u22F9\\u0338|\\u2933\\u0338|\\u29CF\\u0338|\\u29D0\\u0338|\\u2A6D\\u0338|\\u2A70\\u0338|\\u2A7D\\u0338|\\u2A7E\\u0338|\\u2AA1\\u0338|\\u2AA2\\u0338|\\u2AAC\\uFE00|\\u2AAD\\uFE00|\\u2AAF\\u0338|\\u2AB0\\u0338|\\u2AC5\\u0338|\\u2AC6\\u0338|\\u2ACB\\uFE00|\\u2ACC\\uFE00|\\u2AFD\\u20E5|[\\xA0-\\u0113\\u0116-\\u0122\\u0124-\\u012B\\u012E-\\u014D\\u0150-\\u017E\\u0192\\u01B5\\u01F5\\u0237\\u02C6\\u02C7\\u02D8-\\u02DD\\u0311\\u0391-\\u03A1\\u03A3-\\u03A9\\u03B1-\\u03C9\\u03D1\\u03D2\\u03D5\\u03D6\\u03DC\\u03DD\\u03F0\\u03F1\\u03F5\\u03F6\\u0401-\\u040C\\u040E-\\u044F\\u0451-\\u045C\\u045E\\u045F\\u2002-\\u2005\\u2007-\\u2010\\u2013-\\u2016\\u2018-\\u201A\\u201C-\\u201E\\u2020-\\u2022\\u2025\\u2026\\u2030-\\u2035\\u2039\\u203A\\u203E\\u2041\\u2043\\u2044\\u204F\\u2057\\u205F-\\u2063\\u20AC\\u20DB\\u20DC\\u2102\\u2105\\u210A-\\u2113\\u2115-\\u211E\\u2122\\u2124\\u2127-\\u2129\\u212C\\u212D\\u212F-\\u2131\\u2133-\\u2138\\u2145-\\u2148\\u2153-\\u215E\\u2190-\\u219B\\u219D-\\u21A7\\u21A9-\\u21AE\\u21B0-\\u21B3\\u21B5-\\u21B7\\u21BA-\\u21DB\\u21DD\\u21E4\\u21E5\\u21F5\\u21FD-\\u2205\\u2207-\\u2209\\u220B\\u220C\\u220F-\\u2214\\u2216-\\u2218\\u221A\\u221D-\\u2238\\u223A-\\u2257\\u2259\\u225A\\u225C\\u225F-\\u2262\\u2264-\\u228B\\u228D-\\u229B\\u229D-\\u22A5\\u22A7-\\u22B0\\u22B2-\\u22BB\\u22BD-\\u22DB\\u22DE-\\u22E3\\u22E6-\\u22F7\\u22F9-\\u22FE\\u2305\\u2306\\u2308-\\u2310\\u2312\\u2313\\u2315\\u2316\\u231C-\\u231F\\u2322\\u2323\\u232D\\u232E\\u2336\\u233D\\u233F\\u237C\\u23B0\\u23B1\\u23B4-\\u23B6\\u23DC-\\u23DF\\u23E2\\u23E7\\u2423\\u24C8\\u2500\\u2502\\u250C\\u2510\\u2514\\u2518\\u251C\\u2524\\u252C\\u2534\\u253C\\u2550-\\u256C\\u2580\\u2584\\u2588\\u2591-\\u2593\\u25A1\\u25AA\\u25AB\\u25AD\\u25AE\\u25B1\\u25B3-\\u25B5\\u25B8\\u25B9\\u25BD-\\u25BF\\u25C2\\u25C3\\u25CA\\u25CB\\u25EC\\u25EF\\u25F8-\\u25FC\\u2605\\u2606\\u260E\\u2640\\u2642\\u2660\\u2663\\u2665\\u2666\\u266A\\u266D-\\u266F\\u2713\\u2717\\u2720\\u2736\\u2758\\u2772\\u2773\\u27C8\\u27C9\\u27E6-\\u27ED\\u27F5-\\u27FA\\u27FC\\u27FF\\u2902-\\u2905\\u290C-\\u2913\\u2916\\u2919-\\u2920\\u2923-\\u292A\\u2933\\u2935-\\u2939\\u293C\\u293D\\u2945\\u2948-\\u294B\\u294E-\\u2976\\u2978\\u2979\\u297B-\\u297F\\u2985\\u2986\\u298B-\\u2996\\u299A\\u299C\\u299D\\u29A4-\\u29B7\\u29B9\\u29BB\\u29BC\\u29BE-\\u29C5\\u29C9\\u29CD-\\u29D0\\u29DC-\\u29DE\\u29E3-\\u29E5\\u29EB\\u29F4\\u29F6\\u2A00-\\u2A02\\u2A04\\u2A06\\u2A0C\\u2A0D\\u2A10-\\u2A17\\u2A22-\\u2A27\\u2A29\\u2A2A\\u2A2D-\\u2A31\\u2A33-\\u2A3C\\u2A3F\\u2A40\\u2A42-\\u2A4D\\u2A50\\u2A53-\\u2A58\\u2A5A-\\u2A5D\\u2A5F\\u2A66\\u2A6A\\u2A6D-\\u2A75\\u2A77-\\u2A9A\\u2A9D-\\u2AA2\\u2AA4-\\u2AB0\\u2AB3-\\u2AC8\\u2ACB\\u2ACC\\u2ACF-\\u2ADB\\u2AE4\\u2AE6-\\u2AE9\\u2AEB-\\u2AF3\\u2AFD\\uFB00-\\uFB04]|\\uD835[\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDCCF\\uDD04\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDD6B]/g;\n\tvar encodeMap = {'\\xAD':'shy','\\u200C':'zwnj','\\u200D':'zwj','\\u200E':'lrm','\\u2063':'ic','\\u2062':'it','\\u2061':'af','\\u200F':'rlm','\\u200B':'ZeroWidthSpace','\\u2060':'NoBreak','\\u0311':'DownBreve','\\u20DB':'tdot','\\u20DC':'DotDot','\\t':'Tab','\\n':'NewLine','\\u2008':'puncsp','\\u205F':'MediumSpace','\\u2009':'thinsp','\\u200A':'hairsp','\\u2004':'emsp13','\\u2002':'ensp','\\u2005':'emsp14','\\u2003':'emsp','\\u2007':'numsp','\\xA0':'nbsp','\\u205F\\u200A':'ThickSpace','\\u203E':'oline','_':'lowbar','\\u2010':'dash','\\u2013':'ndash','\\u2014':'mdash','\\u2015':'horbar',',':'comma',';':'semi','\\u204F':'bsemi',':':'colon','\\u2A74':'Colone','!':'excl','\\xA1':'iexcl','?':'quest','\\xBF':'iquest','.':'period','\\u2025':'nldr','\\u2026':'mldr','\\xB7':'middot','\\'':'apos','\\u2018':'lsquo','\\u2019':'rsquo','\\u201A':'sbquo','\\u2039':'lsaquo','\\u203A':'rsaquo','\"':'quot','\\u201C':'ldquo','\\u201D':'rdquo','\\u201E':'bdquo','\\xAB':'laquo','\\xBB':'raquo','(':'lpar',')':'rpar','[':'lsqb',']':'rsqb','{':'lcub','}':'rcub','\\u2308':'lceil','\\u2309':'rceil','\\u230A':'lfloor','\\u230B':'rfloor','\\u2985':'lopar','\\u2986':'ropar','\\u298B':'lbrke','\\u298C':'rbrke','\\u298D':'lbrkslu','\\u298E':'rbrksld','\\u298F':'lbrksld','\\u2990':'rbrkslu','\\u2991':'langd','\\u2992':'rangd','\\u2993':'lparlt','\\u2994':'rpargt','\\u2995':'gtlPar','\\u2996':'ltrPar','\\u27E6':'lobrk','\\u27E7':'robrk','\\u27E8':'lang','\\u27E9':'rang','\\u27EA':'Lang','\\u27EB':'Rang','\\u27EC':'loang','\\u27ED':'roang','\\u2772':'lbbrk','\\u2773':'rbbrk','\\u2016':'Vert','\\xA7':'sect','\\xB6':'para','@':'commat','*':'ast','/':'sol','undefined':null,'&':'amp','#':'num','%':'percnt','\\u2030':'permil','\\u2031':'pertenk','\\u2020':'dagger','\\u2021':'Dagger','\\u2022':'bull','\\u2043':'hybull','\\u2032':'prime','\\u2033':'Prime','\\u2034':'tprime','\\u2057':'qprime','\\u2035':'bprime','\\u2041':'caret','`':'grave','\\xB4':'acute','\\u02DC':'tilde','^':'Hat','\\xAF':'macr','\\u02D8':'breve','\\u02D9':'dot','\\xA8':'die','\\u02DA':'ring','\\u02DD':'dblac','\\xB8':'cedil','\\u02DB':'ogon','\\u02C6':'circ','\\u02C7':'caron','\\xB0':'deg','\\xA9':'copy','\\xAE':'reg','\\u2117':'copysr','\\u2118':'wp','\\u211E':'rx','\\u2127':'mho','\\u2129':'iiota','\\u2190':'larr','\\u219A':'nlarr','\\u2192':'rarr','\\u219B':'nrarr','\\u2191':'uarr','\\u2193':'darr','\\u2194':'harr','\\u21AE':'nharr','\\u2195':'varr','\\u2196':'nwarr','\\u2197':'nearr','\\u2198':'searr','\\u2199':'swarr','\\u219D':'rarrw','\\u219D\\u0338':'nrarrw','\\u219E':'Larr','\\u219F':'Uarr','\\u21A0':'Rarr','\\u21A1':'Darr','\\u21A2':'larrtl','\\u21A3':'rarrtl','\\u21A4':'mapstoleft','\\u21A5':'mapstoup','\\u21A6':'map','\\u21A7':'mapstodown','\\u21A9':'larrhk','\\u21AA':'rarrhk','\\u21AB':'larrlp','\\u21AC':'rarrlp','\\u21AD':'harrw','\\u21B0':'lsh','\\u21B1':'rsh','\\u21B2':'ldsh','\\u21B3':'rdsh','\\u21B5':'crarr','\\u21B6':'cularr','\\u21B7':'curarr','\\u21BA':'olarr','\\u21BB':'orarr','\\u21BC':'lharu','\\u21BD':'lhard','\\u21BE':'uharr','\\u21BF':'uharl','\\u21C0':'rharu','\\u21C1':'rhard','\\u21C2':'dharr','\\u21C3':'dharl','\\u21C4':'rlarr','\\u21C5':'udarr','\\u21C6':'lrarr','\\u21C7':'llarr','\\u21C8':'uuarr','\\u21C9':'rrarr','\\u21CA':'ddarr','\\u21CB':'lrhar','\\u21CC':'rlhar','\\u21D0':'lArr','\\u21CD':'nlArr','\\u21D1':'uArr','\\u21D2':'rArr','\\u21CF':'nrArr','\\u21D3':'dArr','\\u21D4':'iff','\\u21CE':'nhArr','\\u21D5':'vArr','\\u21D6':'nwArr','\\u21D7':'neArr','\\u21D8':'seArr','\\u21D9':'swArr','\\u21DA':'lAarr','\\u21DB':'rAarr','\\u21DD':'zigrarr','\\u21E4':'larrb','\\u21E5':'rarrb','\\u21F5':'duarr','\\u21FD':'loarr','\\u21FE':'roarr','\\u21FF':'hoarr','\\u2200':'forall','\\u2201':'comp','\\u2202':'part','\\u2202\\u0338':'npart','\\u2203':'exist','\\u2204':'nexist','\\u2205':'empty','\\u2207':'Del','\\u2208':'in','\\u2209':'notin','\\u220B':'ni','\\u220C':'notni','\\u03F6':'bepsi','\\u220F':'prod','\\u2210':'coprod','\\u2211':'sum','+':'plus','\\xB1':'pm','\\xF7':'div','\\xD7':'times','<':'lt','\\u226E':'nlt','<\\u20D2':'nvlt','=':'equals','\\u2260':'ne','=\\u20E5':'bne','\\u2A75':'Equal','>':'gt','\\u226F':'ngt','>\\u20D2':'nvgt','\\xAC':'not','|':'vert','\\xA6':'brvbar','\\u2212':'minus','\\u2213':'mp','\\u2214':'plusdo','\\u2044':'frasl','\\u2216':'setmn','\\u2217':'lowast','\\u2218':'compfn','\\u221A':'Sqrt','\\u221D':'prop','\\u221E':'infin','\\u221F':'angrt','\\u2220':'ang','\\u2220\\u20D2':'nang','\\u2221':'angmsd','\\u2222':'angsph','\\u2223':'mid','\\u2224':'nmid','\\u2225':'par','\\u2226':'npar','\\u2227':'and','\\u2228':'or','\\u2229':'cap','\\u2229\\uFE00':'caps','\\u222A':'cup','\\u222A\\uFE00':'cups','\\u222B':'int','\\u222C':'Int','\\u222D':'tint','\\u2A0C':'qint','\\u222E':'oint','\\u222F':'Conint','\\u2230':'Cconint','\\u2231':'cwint','\\u2232':'cwconint','\\u2233':'awconint','\\u2234':'there4','\\u2235':'becaus','\\u2236':'ratio','\\u2237':'Colon','\\u2238':'minusd','\\u223A':'mDDot','\\u223B':'homtht','\\u223C':'sim','\\u2241':'nsim','\\u223C\\u20D2':'nvsim','\\u223D':'bsim','\\u223D\\u0331':'race','\\u223E':'ac','\\u223E\\u0333':'acE','\\u223F':'acd','\\u2240':'wr','\\u2242':'esim','\\u2242\\u0338':'nesim','\\u2243':'sime','\\u2244':'nsime','\\u2245':'cong','\\u2247':'ncong','\\u2246':'simne','\\u2248':'ap','\\u2249':'nap','\\u224A':'ape','\\u224B':'apid','\\u224B\\u0338':'napid','\\u224C':'bcong','\\u224D':'CupCap','\\u226D':'NotCupCap','\\u224D\\u20D2':'nvap','\\u224E':'bump','\\u224E\\u0338':'nbump','\\u224F':'bumpe','\\u224F\\u0338':'nbumpe','\\u2250':'doteq','\\u2250\\u0338':'nedot','\\u2251':'eDot','\\u2252':'efDot','\\u2253':'erDot','\\u2254':'colone','\\u2255':'ecolon','\\u2256':'ecir','\\u2257':'cire','\\u2259':'wedgeq','\\u225A':'veeeq','\\u225C':'trie','\\u225F':'equest','\\u2261':'equiv','\\u2262':'nequiv','\\u2261\\u20E5':'bnequiv','\\u2264':'le','\\u2270':'nle','\\u2264\\u20D2':'nvle','\\u2265':'ge','\\u2271':'nge','\\u2265\\u20D2':'nvge','\\u2266':'lE','\\u2266\\u0338':'nlE','\\u2267':'gE','\\u2267\\u0338':'ngE','\\u2268\\uFE00':'lvnE','\\u2268':'lnE','\\u2269':'gnE','\\u2269\\uFE00':'gvnE','\\u226A':'ll','\\u226A\\u0338':'nLtv','\\u226A\\u20D2':'nLt','\\u226B':'gg','\\u226B\\u0338':'nGtv','\\u226B\\u20D2':'nGt','\\u226C':'twixt','\\u2272':'lsim','\\u2274':'nlsim','\\u2273':'gsim','\\u2275':'ngsim','\\u2276':'lg','\\u2278':'ntlg','\\u2277':'gl','\\u2279':'ntgl','\\u227A':'pr','\\u2280':'npr','\\u227B':'sc','\\u2281':'nsc','\\u227C':'prcue','\\u22E0':'nprcue','\\u227D':'sccue','\\u22E1':'nsccue','\\u227E':'prsim','\\u227F':'scsim','\\u227F\\u0338':'NotSucceedsTilde','\\u2282':'sub','\\u2284':'nsub','\\u2282\\u20D2':'vnsub','\\u2283':'sup','\\u2285':'nsup','\\u2283\\u20D2':'vnsup','\\u2286':'sube','\\u2288':'nsube','\\u2287':'supe','\\u2289':'nsupe','\\u228A\\uFE00':'vsubne','\\u228A':'subne','\\u228B\\uFE00':'vsupne','\\u228B':'supne','\\u228D':'cupdot','\\u228E':'uplus','\\u228F':'sqsub','\\u228F\\u0338':'NotSquareSubset','\\u2290':'sqsup','\\u2290\\u0338':'NotSquareSuperset','\\u2291':'sqsube','\\u22E2':'nsqsube','\\u2292':'sqsupe','\\u22E3':'nsqsupe','\\u2293':'sqcap','\\u2293\\uFE00':'sqcaps','\\u2294':'sqcup','\\u2294\\uFE00':'sqcups','\\u2295':'oplus','\\u2296':'ominus','\\u2297':'otimes','\\u2298':'osol','\\u2299':'odot','\\u229A':'ocir','\\u229B':'oast','\\u229D':'odash','\\u229E':'plusb','\\u229F':'minusb','\\u22A0':'timesb','\\u22A1':'sdotb','\\u22A2':'vdash','\\u22AC':'nvdash','\\u22A3':'dashv','\\u22A4':'top','\\u22A5':'bot','\\u22A7':'models','\\u22A8':'vDash','\\u22AD':'nvDash','\\u22A9':'Vdash','\\u22AE':'nVdash','\\u22AA':'Vvdash','\\u22AB':'VDash','\\u22AF':'nVDash','\\u22B0':'prurel','\\u22B2':'vltri','\\u22EA':'nltri','\\u22B3':'vrtri','\\u22EB':'nrtri','\\u22B4':'ltrie','\\u22EC':'nltrie','\\u22B4\\u20D2':'nvltrie','\\u22B5':'rtrie','\\u22ED':'nrtrie','\\u22B5\\u20D2':'nvrtrie','\\u22B6':'origof','\\u22B7':'imof','\\u22B8':'mumap','\\u22B9':'hercon','\\u22BA':'intcal','\\u22BB':'veebar','\\u22BD':'barvee','\\u22BE':'angrtvb','\\u22BF':'lrtri','\\u22C0':'Wedge','\\u22C1':'Vee','\\u22C2':'xcap','\\u22C3':'xcup','\\u22C4':'diam','\\u22C5':'sdot','\\u22C6':'Star','\\u22C7':'divonx','\\u22C8':'bowtie','\\u22C9':'ltimes','\\u22CA':'rtimes','\\u22CB':'lthree','\\u22CC':'rthree','\\u22CD':'bsime','\\u22CE':'cuvee','\\u22CF':'cuwed','\\u22D0':'Sub','\\u22D1':'Sup','\\u22D2':'Cap','\\u22D3':'Cup','\\u22D4':'fork','\\u22D5':'epar','\\u22D6':'ltdot','\\u22D7':'gtdot','\\u22D8':'Ll','\\u22D8\\u0338':'nLl','\\u22D9':'Gg','\\u22D9\\u0338':'nGg','\\u22DA\\uFE00':'lesg','\\u22DA':'leg','\\u22DB':'gel','\\u22DB\\uFE00':'gesl','\\u22DE':'cuepr','\\u22DF':'cuesc','\\u22E6':'lnsim','\\u22E7':'gnsim','\\u22E8':'prnsim','\\u22E9':'scnsim','\\u22EE':'vellip','\\u22EF':'ctdot','\\u22F0':'utdot','\\u22F1':'dtdot','\\u22F2':'disin','\\u22F3':'isinsv','\\u22F4':'isins','\\u22F5':'isindot','\\u22F5\\u0338':'notindot','\\u22F6':'notinvc','\\u22F7':'notinvb','\\u22F9':'isinE','\\u22F9\\u0338':'notinE','\\u22FA':'nisd','\\u22FB':'xnis','\\u22FC':'nis','\\u22FD':'notnivc','\\u22FE':'notnivb','\\u2305':'barwed','\\u2306':'Barwed','\\u230C':'drcrop','\\u230D':'dlcrop','\\u230E':'urcrop','\\u230F':'ulcrop','\\u2310':'bnot','\\u2312':'profline','\\u2313':'profsurf','\\u2315':'telrec','\\u2316':'target','\\u231C':'ulcorn','\\u231D':'urcorn','\\u231E':'dlcorn','\\u231F':'drcorn','\\u2322':'frown','\\u2323':'smile','\\u232D':'cylcty','\\u232E':'profalar','\\u2336':'topbot','\\u233D':'ovbar','\\u233F':'solbar','\\u237C':'angzarr','\\u23B0':'lmoust','\\u23B1':'rmoust','\\u23B4':'tbrk','\\u23B5':'bbrk','\\u23B6':'bbrktbrk','\\u23DC':'OverParenthesis','\\u23DD':'UnderParenthesis','\\u23DE':'OverBrace','\\u23DF':'UnderBrace','\\u23E2':'trpezium','\\u23E7':'elinters','\\u2423':'blank','\\u2500':'boxh','\\u2502':'boxv','\\u250C':'boxdr','\\u2510':'boxdl','\\u2514':'boxur','\\u2518':'boxul','\\u251C':'boxvr','\\u2524':'boxvl','\\u252C':'boxhd','\\u2534':'boxhu','\\u253C':'boxvh','\\u2550':'boxH','\\u2551':'boxV','\\u2552':'boxdR','\\u2553':'boxDr','\\u2554':'boxDR','\\u2555':'boxdL','\\u2556':'boxDl','\\u2557':'boxDL','\\u2558':'boxuR','\\u2559':'boxUr','\\u255A':'boxUR','\\u255B':'boxuL','\\u255C':'boxUl','\\u255D':'boxUL','\\u255E':'boxvR','\\u255F':'boxVr','\\u2560':'boxVR','\\u2561':'boxvL','\\u2562':'boxVl','\\u2563':'boxVL','\\u2564':'boxHd','\\u2565':'boxhD','\\u2566':'boxHD','\\u2567':'boxHu','\\u2568':'boxhU','\\u2569':'boxHU','\\u256A':'boxvH','\\u256B':'boxVh','\\u256C':'boxVH','\\u2580':'uhblk','\\u2584':'lhblk','\\u2588':'block','\\u2591':'blk14','\\u2592':'blk12','\\u2593':'blk34','\\u25A1':'squ','\\u25AA':'squf','\\u25AB':'EmptyVerySmallSquare','\\u25AD':'rect','\\u25AE':'marker','\\u25B1':'fltns','\\u25B3':'xutri','\\u25B4':'utrif','\\u25B5':'utri','\\u25B8':'rtrif','\\u25B9':'rtri','\\u25BD':'xdtri','\\u25BE':'dtrif','\\u25BF':'dtri','\\u25C2':'ltrif','\\u25C3':'ltri','\\u25CA':'loz','\\u25CB':'cir','\\u25EC':'tridot','\\u25EF':'xcirc','\\u25F8':'ultri','\\u25F9':'urtri','\\u25FA':'lltri','\\u25FB':'EmptySmallSquare','\\u25FC':'FilledSmallSquare','\\u2605':'starf','\\u2606':'star','\\u260E':'phone','\\u2640':'female','\\u2642':'male','\\u2660':'spades','\\u2663':'clubs','\\u2665':'hearts','\\u2666':'diams','\\u266A':'sung','\\u2713':'check','\\u2717':'cross','\\u2720':'malt','\\u2736':'sext','\\u2758':'VerticalSeparator','\\u27C8':'bsolhsub','\\u27C9':'suphsol','\\u27F5':'xlarr','\\u27F6':'xrarr','\\u27F7':'xharr','\\u27F8':'xlArr','\\u27F9':'xrArr','\\u27FA':'xhArr','\\u27FC':'xmap','\\u27FF':'dzigrarr','\\u2902':'nvlArr','\\u2903':'nvrArr','\\u2904':'nvHarr','\\u2905':'Map','\\u290C':'lbarr','\\u290D':'rbarr','\\u290E':'lBarr','\\u290F':'rBarr','\\u2910':'RBarr','\\u2911':'DDotrahd','\\u2912':'UpArrowBar','\\u2913':'DownArrowBar','\\u2916':'Rarrtl','\\u2919':'latail','\\u291A':'ratail','\\u291B':'lAtail','\\u291C':'rAtail','\\u291D':'larrfs','\\u291E':'rarrfs','\\u291F':'larrbfs','\\u2920':'rarrbfs','\\u2923':'nwarhk','\\u2924':'nearhk','\\u2925':'searhk','\\u2926':'swarhk','\\u2927':'nwnear','\\u2928':'toea','\\u2929':'tosa','\\u292A':'swnwar','\\u2933':'rarrc','\\u2933\\u0338':'nrarrc','\\u2935':'cudarrr','\\u2936':'ldca','\\u2937':'rdca','\\u2938':'cudarrl','\\u2939':'larrpl','\\u293C':'curarrm','\\u293D':'cularrp','\\u2945':'rarrpl','\\u2948':'harrcir','\\u2949':'Uarrocir','\\u294A':'lurdshar','\\u294B':'ldrushar','\\u294E':'LeftRightVector','\\u294F':'RightUpDownVector','\\u2950':'DownLeftRightVector','\\u2951':'LeftUpDownVector','\\u2952':'LeftVectorBar','\\u2953':'RightVectorBar','\\u2954':'RightUpVectorBar','\\u2955':'RightDownVectorBar','\\u2956':'DownLeftVectorBar','\\u2957':'DownRightVectorBar','\\u2958':'LeftUpVectorBar','\\u2959':'LeftDownVectorBar','\\u295A':'LeftTeeVector','\\u295B':'RightTeeVector','\\u295C':'RightUpTeeVector','\\u295D':'RightDownTeeVector','\\u295E':'DownLeftTeeVector','\\u295F':'DownRightTeeVector','\\u2960':'LeftUpTeeVector','\\u2961':'LeftDownTeeVector','\\u2962':'lHar','\\u2963':'uHar','\\u2964':'rHar','\\u2965':'dHar','\\u2966':'luruhar','\\u2967':'ldrdhar','\\u2968':'ruluhar','\\u2969':'rdldhar','\\u296A':'lharul','\\u296B':'llhard','\\u296C':'rharul','\\u296D':'lrhard','\\u296E':'udhar','\\u296F':'duhar','\\u2970':'RoundImplies','\\u2971':'erarr','\\u2972':'simrarr','\\u2973':'larrsim','\\u2974':'rarrsim','\\u2975':'rarrap','\\u2976':'ltlarr','\\u2978':'gtrarr','\\u2979':'subrarr','\\u297B':'suplarr','\\u297C':'lfisht','\\u297D':'rfisht','\\u297E':'ufisht','\\u297F':'dfisht','\\u299A':'vzigzag','\\u299C':'vangrt','\\u299D':'angrtvbd','\\u29A4':'ange','\\u29A5':'range','\\u29A6':'dwangle','\\u29A7':'uwangle','\\u29A8':'angmsdaa','\\u29A9':'angmsdab','\\u29AA':'angmsdac','\\u29AB':'angmsdad','\\u29AC':'angmsdae','\\u29AD':'angmsdaf','\\u29AE':'angmsdag','\\u29AF':'angmsdah','\\u29B0':'bemptyv','\\u29B1':'demptyv','\\u29B2':'cemptyv','\\u29B3':'raemptyv','\\u29B4':'laemptyv','\\u29B5':'ohbar','\\u29B6':'omid','\\u29B7':'opar','\\u29B9':'operp','\\u29BB':'olcross','\\u29BC':'odsold','\\u29BE':'olcir','\\u29BF':'ofcir','\\u29C0':'olt','\\u29C1':'ogt','\\u29C2':'cirscir','\\u29C3':'cirE','\\u29C4':'solb','\\u29C5':'bsolb','\\u29C9':'boxbox','\\u29CD':'trisb','\\u29CE':'rtriltri','\\u29CF':'LeftTriangleBar','\\u29CF\\u0338':'NotLeftTriangleBar','\\u29D0':'RightTriangleBar','\\u29D0\\u0338':'NotRightTriangleBar','\\u29DC':'iinfin','\\u29DD':'infintie','\\u29DE':'nvinfin','\\u29E3':'eparsl','\\u29E4':'smeparsl','\\u29E5':'eqvparsl','\\u29EB':'lozf','\\u29F4':'RuleDelayed','\\u29F6':'dsol','\\u2A00':'xodot','\\u2A01':'xoplus','\\u2A02':'xotime','\\u2A04':'xuplus','\\u2A06':'xsqcup','\\u2A0D':'fpartint','\\u2A10':'cirfnint','\\u2A11':'awint','\\u2A12':'rppolint','\\u2A13':'scpolint','\\u2A14':'npolint','\\u2A15':'pointint','\\u2A16':'quatint','\\u2A17':'intlarhk','\\u2A22':'pluscir','\\u2A23':'plusacir','\\u2A24':'simplus','\\u2A25':'plusdu','\\u2A26':'plussim','\\u2A27':'plustwo','\\u2A29':'mcomma','\\u2A2A':'minusdu','\\u2A2D':'loplus','\\u2A2E':'roplus','\\u2A2F':'Cross','\\u2A30':'timesd','\\u2A31':'timesbar','\\u2A33':'smashp','\\u2A34':'lotimes','\\u2A35':'rotimes','\\u2A36':'otimesas','\\u2A37':'Otimes','\\u2A38':'odiv','\\u2A39':'triplus','\\u2A3A':'triminus','\\u2A3B':'tritime','\\u2A3C':'iprod','\\u2A3F':'amalg','\\u2A40':'capdot','\\u2A42':'ncup','\\u2A43':'ncap','\\u2A44':'capand','\\u2A45':'cupor','\\u2A46':'cupcap','\\u2A47':'capcup','\\u2A48':'cupbrcap','\\u2A49':'capbrcup','\\u2A4A':'cupcup','\\u2A4B':'capcap','\\u2A4C':'ccups','\\u2A4D':'ccaps','\\u2A50':'ccupssm','\\u2A53':'And','\\u2A54':'Or','\\u2A55':'andand','\\u2A56':'oror','\\u2A57':'orslope','\\u2A58':'andslope','\\u2A5A':'andv','\\u2A5B':'orv','\\u2A5C':'andd','\\u2A5D':'ord','\\u2A5F':'wedbar','\\u2A66':'sdote','\\u2A6A':'simdot','\\u2A6D':'congdot','\\u2A6D\\u0338':'ncongdot','\\u2A6E':'easter','\\u2A6F':'apacir','\\u2A70':'apE','\\u2A70\\u0338':'napE','\\u2A71':'eplus','\\u2A72':'pluse','\\u2A73':'Esim','\\u2A77':'eDDot','\\u2A78':'equivDD','\\u2A79':'ltcir','\\u2A7A':'gtcir','\\u2A7B':'ltquest','\\u2A7C':'gtquest','\\u2A7D':'les','\\u2A7D\\u0338':'nles','\\u2A7E':'ges','\\u2A7E\\u0338':'nges','\\u2A7F':'lesdot','\\u2A80':'gesdot','\\u2A81':'lesdoto','\\u2A82':'gesdoto','\\u2A83':'lesdotor','\\u2A84':'gesdotol','\\u2A85':'lap','\\u2A86':'gap','\\u2A87':'lne','\\u2A88':'gne','\\u2A89':'lnap','\\u2A8A':'gnap','\\u2A8B':'lEg','\\u2A8C':'gEl','\\u2A8D':'lsime','\\u2A8E':'gsime','\\u2A8F':'lsimg','\\u2A90':'gsiml','\\u2A91':'lgE','\\u2A92':'glE','\\u2A93':'lesges','\\u2A94':'gesles','\\u2A95':'els','\\u2A96':'egs','\\u2A97':'elsdot','\\u2A98':'egsdot','\\u2A99':'el','\\u2A9A':'eg','\\u2A9D':'siml','\\u2A9E':'simg','\\u2A9F':'simlE','\\u2AA0':'simgE','\\u2AA1':'LessLess','\\u2AA1\\u0338':'NotNestedLessLess','\\u2AA2':'GreaterGreater','\\u2AA2\\u0338':'NotNestedGreaterGreater','\\u2AA4':'glj','\\u2AA5':'gla','\\u2AA6':'ltcc','\\u2AA7':'gtcc','\\u2AA8':'lescc','\\u2AA9':'gescc','\\u2AAA':'smt','\\u2AAB':'lat','\\u2AAC':'smte','\\u2AAC\\uFE00':'smtes','\\u2AAD':'late','\\u2AAD\\uFE00':'lates','\\u2AAE':'bumpE','\\u2AAF':'pre','\\u2AAF\\u0338':'npre','\\u2AB0':'sce','\\u2AB0\\u0338':'nsce','\\u2AB3':'prE','\\u2AB4':'scE','\\u2AB5':'prnE','\\u2AB6':'scnE','\\u2AB7':'prap','\\u2AB8':'scap','\\u2AB9':'prnap','\\u2ABA':'scnap','\\u2ABB':'Pr','\\u2ABC':'Sc','\\u2ABD':'subdot','\\u2ABE':'supdot','\\u2ABF':'subplus','\\u2AC0':'supplus','\\u2AC1':'submult','\\u2AC2':'supmult','\\u2AC3':'subedot','\\u2AC4':'supedot','\\u2AC5':'subE','\\u2AC5\\u0338':'nsubE','\\u2AC6':'supE','\\u2AC6\\u0338':'nsupE','\\u2AC7':'subsim','\\u2AC8':'supsim','\\u2ACB\\uFE00':'vsubnE','\\u2ACB':'subnE','\\u2ACC\\uFE00':'vsupnE','\\u2ACC':'supnE','\\u2ACF':'csub','\\u2AD0':'csup','\\u2AD1':'csube','\\u2AD2':'csupe','\\u2AD3':'subsup','\\u2AD4':'supsub','\\u2AD5':'subsub','\\u2AD6':'supsup','\\u2AD7':'suphsub','\\u2AD8':'supdsub','\\u2AD9':'forkv','\\u2ADA':'topfork','\\u2ADB':'mlcp','\\u2AE4':'Dashv','\\u2AE6':'Vdashl','\\u2AE7':'Barv','\\u2AE8':'vBar','\\u2AE9':'vBarv','\\u2AEB':'Vbar','\\u2AEC':'Not','\\u2AED':'bNot','\\u2AEE':'rnmid','\\u2AEF':'cirmid','\\u2AF0':'midcir','\\u2AF1':'topcir','\\u2AF2':'nhpar','\\u2AF3':'parsim','\\u2AFD':'parsl','\\u2AFD\\u20E5':'nparsl','\\u266D':'flat','\\u266E':'natur','\\u266F':'sharp','\\xA4':'curren','\\xA2':'cent','$':'dollar','\\xA3':'pound','\\xA5':'yen','\\u20AC':'euro','\\xB9':'sup1','\\xBD':'half','\\u2153':'frac13','\\xBC':'frac14','\\u2155':'frac15','\\u2159':'frac16','\\u215B':'frac18','\\xB2':'sup2','\\u2154':'frac23','\\u2156':'frac25','\\xB3':'sup3','\\xBE':'frac34','\\u2157':'frac35','\\u215C':'frac38','\\u2158':'frac45','\\u215A':'frac56','\\u215D':'frac58','\\u215E':'frac78','\\uD835\\uDCB6':'ascr','\\uD835\\uDD52':'aopf','\\uD835\\uDD1E':'afr','\\uD835\\uDD38':'Aopf','\\uD835\\uDD04':'Afr','\\uD835\\uDC9C':'Ascr','\\xAA':'ordf','\\xE1':'aacute','\\xC1':'Aacute','\\xE0':'agrave','\\xC0':'Agrave','\\u0103':'abreve','\\u0102':'Abreve','\\xE2':'acirc','\\xC2':'Acirc','\\xE5':'aring','\\xC5':'angst','\\xE4':'auml','\\xC4':'Auml','\\xE3':'atilde','\\xC3':'Atilde','\\u0105':'aogon','\\u0104':'Aogon','\\u0101':'amacr','\\u0100':'Amacr','\\xE6':'aelig','\\xC6':'AElig','\\uD835\\uDCB7':'bscr','\\uD835\\uDD53':'bopf','\\uD835\\uDD1F':'bfr','\\uD835\\uDD39':'Bopf','\\u212C':'Bscr','\\uD835\\uDD05':'Bfr','\\uD835\\uDD20':'cfr','\\uD835\\uDCB8':'cscr','\\uD835\\uDD54':'copf','\\u212D':'Cfr','\\uD835\\uDC9E':'Cscr','\\u2102':'Copf','\\u0107':'cacute','\\u0106':'Cacute','\\u0109':'ccirc','\\u0108':'Ccirc','\\u010D':'ccaron','\\u010C':'Ccaron','\\u010B':'cdot','\\u010A':'Cdot','\\xE7':'ccedil','\\xC7':'Ccedil','\\u2105':'incare','\\uD835\\uDD21':'dfr','\\u2146':'dd','\\uD835\\uDD55':'dopf','\\uD835\\uDCB9':'dscr','\\uD835\\uDC9F':'Dscr','\\uD835\\uDD07':'Dfr','\\u2145':'DD','\\uD835\\uDD3B':'Dopf','\\u010F':'dcaron','\\u010E':'Dcaron','\\u0111':'dstrok','\\u0110':'Dstrok','\\xF0':'eth','\\xD0':'ETH','\\u2147':'ee','\\u212F':'escr','\\uD835\\uDD22':'efr','\\uD835\\uDD56':'eopf','\\u2130':'Escr','\\uD835\\uDD08':'Efr','\\uD835\\uDD3C':'Eopf','\\xE9':'eacute','\\xC9':'Eacute','\\xE8':'egrave','\\xC8':'Egrave','\\xEA':'ecirc','\\xCA':'Ecirc','\\u011B':'ecaron','\\u011A':'Ecaron','\\xEB':'euml','\\xCB':'Euml','\\u0117':'edot','\\u0116':'Edot','\\u0119':'eogon','\\u0118':'Eogon','\\u0113':'emacr','\\u0112':'Emacr','\\uD835\\uDD23':'ffr','\\uD835\\uDD57':'fopf','\\uD835\\uDCBB':'fscr','\\uD835\\uDD09':'Ffr','\\uD835\\uDD3D':'Fopf','\\u2131':'Fscr','\\uFB00':'fflig','\\uFB03':'ffilig','\\uFB04':'ffllig','\\uFB01':'filig','fj':'fjlig','\\uFB02':'fllig','\\u0192':'fnof','\\u210A':'gscr','\\uD835\\uDD58':'gopf','\\uD835\\uDD24':'gfr','\\uD835\\uDCA2':'Gscr','\\uD835\\uDD3E':'Gopf','\\uD835\\uDD0A':'Gfr','\\u01F5':'gacute','\\u011F':'gbreve','\\u011E':'Gbreve','\\u011D':'gcirc','\\u011C':'Gcirc','\\u0121':'gdot','\\u0120':'Gdot','\\u0122':'Gcedil','\\uD835\\uDD25':'hfr','\\u210E':'planckh','\\uD835\\uDCBD':'hscr','\\uD835\\uDD59':'hopf','\\u210B':'Hscr','\\u210C':'Hfr','\\u210D':'Hopf','\\u0125':'hcirc','\\u0124':'Hcirc','\\u210F':'hbar','\\u0127':'hstrok','\\u0126':'Hstrok','\\uD835\\uDD5A':'iopf','\\uD835\\uDD26':'ifr','\\uD835\\uDCBE':'iscr','\\u2148':'ii','\\uD835\\uDD40':'Iopf','\\u2110':'Iscr','\\u2111':'Im','\\xED':'iacute','\\xCD':'Iacute','\\xEC':'igrave','\\xCC':'Igrave','\\xEE':'icirc','\\xCE':'Icirc','\\xEF':'iuml','\\xCF':'Iuml','\\u0129':'itilde','\\u0128':'Itilde','\\u0130':'Idot','\\u012F':'iogon','\\u012E':'Iogon','\\u012B':'imacr','\\u012A':'Imacr','\\u0133':'ijlig','\\u0132':'IJlig','\\u0131':'imath','\\uD835\\uDCBF':'jscr','\\uD835\\uDD5B':'jopf','\\uD835\\uDD27':'jfr','\\uD835\\uDCA5':'Jscr','\\uD835\\uDD0D':'Jfr','\\uD835\\uDD41':'Jopf','\\u0135':'jcirc','\\u0134':'Jcirc','\\u0237':'jmath','\\uD835\\uDD5C':'kopf','\\uD835\\uDCC0':'kscr','\\uD835\\uDD28':'kfr','\\uD835\\uDCA6':'Kscr','\\uD835\\uDD42':'Kopf','\\uD835\\uDD0E':'Kfr','\\u0137':'kcedil','\\u0136':'Kcedil','\\uD835\\uDD29':'lfr','\\uD835\\uDCC1':'lscr','\\u2113':'ell','\\uD835\\uDD5D':'lopf','\\u2112':'Lscr','\\uD835\\uDD0F':'Lfr','\\uD835\\uDD43':'Lopf','\\u013A':'lacute','\\u0139':'Lacute','\\u013E':'lcaron','\\u013D':'Lcaron','\\u013C':'lcedil','\\u013B':'Lcedil','\\u0142':'lstrok','\\u0141':'Lstrok','\\u0140':'lmidot','\\u013F':'Lmidot','\\uD835\\uDD2A':'mfr','\\uD835\\uDD5E':'mopf','\\uD835\\uDCC2':'mscr','\\uD835\\uDD10':'Mfr','\\uD835\\uDD44':'Mopf','\\u2133':'Mscr','\\uD835\\uDD2B':'nfr','\\uD835\\uDD5F':'nopf','\\uD835\\uDCC3':'nscr','\\u2115':'Nopf','\\uD835\\uDCA9':'Nscr','\\uD835\\uDD11':'Nfr','\\u0144':'nacute','\\u0143':'Nacute','\\u0148':'ncaron','\\u0147':'Ncaron','\\xF1':'ntilde','\\xD1':'Ntilde','\\u0146':'ncedil','\\u0145':'Ncedil','\\u2116':'numero','\\u014B':'eng','\\u014A':'ENG','\\uD835\\uDD60':'oopf','\\uD835\\uDD2C':'ofr','\\u2134':'oscr','\\uD835\\uDCAA':'Oscr','\\uD835\\uDD12':'Ofr','\\uD835\\uDD46':'Oopf','\\xBA':'ordm','\\xF3':'oacute','\\xD3':'Oacute','\\xF2':'ograve','\\xD2':'Ograve','\\xF4':'ocirc','\\xD4':'Ocirc','\\xF6':'ouml','\\xD6':'Ouml','\\u0151':'odblac','\\u0150':'Odblac','\\xF5':'otilde','\\xD5':'Otilde','\\xF8':'oslash','\\xD8':'Oslash','\\u014D':'omacr','\\u014C':'Omacr','\\u0153':'oelig','\\u0152':'OElig','\\uD835\\uDD2D':'pfr','\\uD835\\uDCC5':'pscr','\\uD835\\uDD61':'popf','\\u2119':'Popf','\\uD835\\uDD13':'Pfr','\\uD835\\uDCAB':'Pscr','\\uD835\\uDD62':'qopf','\\uD835\\uDD2E':'qfr','\\uD835\\uDCC6':'qscr','\\uD835\\uDCAC':'Qscr','\\uD835\\uDD14':'Qfr','\\u211A':'Qopf','\\u0138':'kgreen','\\uD835\\uDD2F':'rfr','\\uD835\\uDD63':'ropf','\\uD835\\uDCC7':'rscr','\\u211B':'Rscr','\\u211C':'Re','\\u211D':'Ropf','\\u0155':'racute','\\u0154':'Racute','\\u0159':'rcaron','\\u0158':'Rcaron','\\u0157':'rcedil','\\u0156':'Rcedil','\\uD835\\uDD64':'sopf','\\uD835\\uDCC8':'sscr','\\uD835\\uDD30':'sfr','\\uD835\\uDD4A':'Sopf','\\uD835\\uDD16':'Sfr','\\uD835\\uDCAE':'Sscr','\\u24C8':'oS','\\u015B':'sacute','\\u015A':'Sacute','\\u015D':'scirc','\\u015C':'Scirc','\\u0161':'scaron','\\u0160':'Scaron','\\u015F':'scedil','\\u015E':'Scedil','\\xDF':'szlig','\\uD835\\uDD31':'tfr','\\uD835\\uDCC9':'tscr','\\uD835\\uDD65':'topf','\\uD835\\uDCAF':'Tscr','\\uD835\\uDD17':'Tfr','\\uD835\\uDD4B':'Topf','\\u0165':'tcaron','\\u0164':'Tcaron','\\u0163':'tcedil','\\u0162':'Tcedil','\\u2122':'trade','\\u0167':'tstrok','\\u0166':'Tstrok','\\uD835\\uDCCA':'uscr','\\uD835\\uDD66':'uopf','\\uD835\\uDD32':'ufr','\\uD835\\uDD4C':'Uopf','\\uD835\\uDD18':'Ufr','\\uD835\\uDCB0':'Uscr','\\xFA':'uacute','\\xDA':'Uacute','\\xF9':'ugrave','\\xD9':'Ugrave','\\u016D':'ubreve','\\u016C':'Ubreve','\\xFB':'ucirc','\\xDB':'Ucirc','\\u016F':'uring','\\u016E':'Uring','\\xFC':'uuml','\\xDC':'Uuml','\\u0171':'udblac','\\u0170':'Udblac','\\u0169':'utilde','\\u0168':'Utilde','\\u0173':'uogon','\\u0172':'Uogon','\\u016B':'umacr','\\u016A':'Umacr','\\uD835\\uDD33':'vfr','\\uD835\\uDD67':'vopf','\\uD835\\uDCCB':'vscr','\\uD835\\uDD19':'Vfr','\\uD835\\uDD4D':'Vopf','\\uD835\\uDCB1':'Vscr','\\uD835\\uDD68':'wopf','\\uD835\\uDCCC':'wscr','\\uD835\\uDD34':'wfr','\\uD835\\uDCB2':'Wscr','\\uD835\\uDD4E':'Wopf','\\uD835\\uDD1A':'Wfr','\\u0175':'wcirc','\\u0174':'Wcirc','\\uD835\\uDD35':'xfr','\\uD835\\uDCCD':'xscr','\\uD835\\uDD69':'xopf','\\uD835\\uDD4F':'Xopf','\\uD835\\uDD1B':'Xfr','\\uD835\\uDCB3':'Xscr','\\uD835\\uDD36':'yfr','\\uD835\\uDCCE':'yscr','\\uD835\\uDD6A':'yopf','\\uD835\\uDCB4':'Yscr','\\uD835\\uDD1C':'Yfr','\\uD835\\uDD50':'Yopf','\\xFD':'yacute','\\xDD':'Yacute','\\u0177':'ycirc','\\u0176':'Ycirc','\\xFF':'yuml','\\u0178':'Yuml','\\uD835\\uDCCF':'zscr','\\uD835\\uDD37':'zfr','\\uD835\\uDD6B':'zopf','\\u2128':'Zfr','\\u2124':'Zopf','\\uD835\\uDCB5':'Zscr','\\u017A':'zacute','\\u0179':'Zacute','\\u017E':'zcaron','\\u017D':'Zcaron','\\u017C':'zdot','\\u017B':'Zdot','\\u01B5':'imped','\\xFE':'thorn','\\xDE':'THORN','\\u0149':'napos','\\u03B1':'alpha','\\u0391':'Alpha','\\u03B2':'beta','\\u0392':'Beta','\\u03B3':'gamma','\\u0393':'Gamma','\\u03B4':'delta','\\u0394':'Delta','\\u03B5':'epsi','\\u03F5':'epsiv','\\u0395':'Epsilon','\\u03DD':'gammad','\\u03DC':'Gammad','\\u03B6':'zeta','\\u0396':'Zeta','\\u03B7':'eta','\\u0397':'Eta','\\u03B8':'theta','\\u03D1':'thetav','\\u0398':'Theta','\\u03B9':'iota','\\u0399':'Iota','\\u03BA':'kappa','\\u03F0':'kappav','\\u039A':'Kappa','\\u03BB':'lambda','\\u039B':'Lambda','\\u03BC':'mu','\\xB5':'micro','\\u039C':'Mu','\\u03BD':'nu','\\u039D':'Nu','\\u03BE':'xi','\\u039E':'Xi','\\u03BF':'omicron','\\u039F':'Omicron','\\u03C0':'pi','\\u03D6':'piv','\\u03A0':'Pi','\\u03C1':'rho','\\u03F1':'rhov','\\u03A1':'Rho','\\u03C3':'sigma','\\u03A3':'Sigma','\\u03C2':'sigmaf','\\u03C4':'tau','\\u03A4':'Tau','\\u03C5':'upsi','\\u03A5':'Upsilon','\\u03D2':'Upsi','\\u03C6':'phi','\\u03D5':'phiv','\\u03A6':'Phi','\\u03C7':'chi','\\u03A7':'Chi','\\u03C8':'psi','\\u03A8':'Psi','\\u03C9':'omega','\\u03A9':'ohm','\\u0430':'acy','\\u0410':'Acy','\\u0431':'bcy','\\u0411':'Bcy','\\u0432':'vcy','\\u0412':'Vcy','\\u0433':'gcy','\\u0413':'Gcy','\\u0453':'gjcy','\\u0403':'GJcy','\\u0434':'dcy','\\u0414':'Dcy','\\u0452':'djcy','\\u0402':'DJcy','\\u0435':'iecy','\\u0415':'IEcy','\\u0451':'iocy','\\u0401':'IOcy','\\u0454':'jukcy','\\u0404':'Jukcy','\\u0436':'zhcy','\\u0416':'ZHcy','\\u0437':'zcy','\\u0417':'Zcy','\\u0455':'dscy','\\u0405':'DScy','\\u0438':'icy','\\u0418':'Icy','\\u0456':'iukcy','\\u0406':'Iukcy','\\u0457':'yicy','\\u0407':'YIcy','\\u0439':'jcy','\\u0419':'Jcy','\\u0458':'jsercy','\\u0408':'Jsercy','\\u043A':'kcy','\\u041A':'Kcy','\\u045C':'kjcy','\\u040C':'KJcy','\\u043B':'lcy','\\u041B':'Lcy','\\u0459':'ljcy','\\u0409':'LJcy','\\u043C':'mcy','\\u041C':'Mcy','\\u043D':'ncy','\\u041D':'Ncy','\\u045A':'njcy','\\u040A':'NJcy','\\u043E':'ocy','\\u041E':'Ocy','\\u043F':'pcy','\\u041F':'Pcy','\\u0440':'rcy','\\u0420':'Rcy','\\u0441':'scy','\\u0421':'Scy','\\u0442':'tcy','\\u0422':'Tcy','\\u045B':'tshcy','\\u040B':'TSHcy','\\u0443':'ucy','\\u0423':'Ucy','\\u045E':'ubrcy','\\u040E':'Ubrcy','\\u0444':'fcy','\\u0424':'Fcy','\\u0445':'khcy','\\u0425':'KHcy','\\u0446':'tscy','\\u0426':'TScy','\\u0447':'chcy','\\u0427':'CHcy','\\u045F':'dzcy','\\u040F':'DZcy','\\u0448':'shcy','\\u0428':'SHcy','\\u0449':'shchcy','\\u0429':'SHCHcy','\\u044A':'hardcy','\\u042A':'HARDcy','\\u044B':'ycy','\\u042B':'Ycy','\\u044C':'softcy','\\u042C':'SOFTcy','\\u044D':'ecy','\\u042D':'Ecy','\\u044E':'yucy','\\u042E':'YUcy','\\u044F':'yacy','\\u042F':'YAcy','\\u2135':'aleph','\\u2136':'beth','\\u2137':'gimel','\\u2138':'daleth'};\n\n\tvar regexEscape = /[\"&'<>`]/g;\n\tvar escapeMap = {\n\t\t'\"': '&quot;',\n\t\t'&': '&amp;',\n\t\t'\\'': '&#x27;',\n\t\t'<': '&lt;',\n\t\t// See https://mathiasbynens.be/notes/ambiguous-ampersands: in HTML, the\n\t\t// following is not strictly necessary unless its part of a tag or an\n\t\t// unquoted attribute value. Were only escaping it to support those\n\t\t// situations, and for XML support.\n\t\t'>': '&gt;',\n\t\t// In Internet Explorer  8, the backtick character can be used\n\t\t// to break out of (un)quoted attribute values or HTML comments.\n\t\t// See http://html5sec.org/#102, http://html5sec.org/#108, and\n\t\t// http://html5sec.org/#133.\n\t\t'`': '&#x60;'\n\t};\n\n\tvar regexInvalidEntity = /&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/;\n\tvar regexInvalidRawCodePoint = /[\\0-\\x08\\x0B\\x0E-\\x1F\\x7F-\\x9F\\uFDD0-\\uFDEF\\uFFFE\\uFFFF]|[\\uD83F\\uD87F\\uD8BF\\uD8FF\\uD93F\\uD97F\\uD9BF\\uD9FF\\uDA3F\\uDA7F\\uDABF\\uDAFF\\uDB3F\\uDB7F\\uDBBF\\uDBFF][\\uDFFE\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\n\tvar regexDecode = /&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g;\n\tvar decodeMap = {'aacute':'\\xE1','Aacute':'\\xC1','abreve':'\\u0103','Abreve':'\\u0102','ac':'\\u223E','acd':'\\u223F','acE':'\\u223E\\u0333','acirc':'\\xE2','Acirc':'\\xC2','acute':'\\xB4','acy':'\\u0430','Acy':'\\u0410','aelig':'\\xE6','AElig':'\\xC6','af':'\\u2061','afr':'\\uD835\\uDD1E','Afr':'\\uD835\\uDD04','agrave':'\\xE0','Agrave':'\\xC0','alefsym':'\\u2135','aleph':'\\u2135','alpha':'\\u03B1','Alpha':'\\u0391','amacr':'\\u0101','Amacr':'\\u0100','amalg':'\\u2A3F','amp':'&','AMP':'&','and':'\\u2227','And':'\\u2A53','andand':'\\u2A55','andd':'\\u2A5C','andslope':'\\u2A58','andv':'\\u2A5A','ang':'\\u2220','ange':'\\u29A4','angle':'\\u2220','angmsd':'\\u2221','angmsdaa':'\\u29A8','angmsdab':'\\u29A9','angmsdac':'\\u29AA','angmsdad':'\\u29AB','angmsdae':'\\u29AC','angmsdaf':'\\u29AD','angmsdag':'\\u29AE','angmsdah':'\\u29AF','angrt':'\\u221F','angrtvb':'\\u22BE','angrtvbd':'\\u299D','angsph':'\\u2222','angst':'\\xC5','angzarr':'\\u237C','aogon':'\\u0105','Aogon':'\\u0104','aopf':'\\uD835\\uDD52','Aopf':'\\uD835\\uDD38','ap':'\\u2248','apacir':'\\u2A6F','ape':'\\u224A','apE':'\\u2A70','apid':'\\u224B','apos':'\\'','ApplyFunction':'\\u2061','approx':'\\u2248','approxeq':'\\u224A','aring':'\\xE5','Aring':'\\xC5','ascr':'\\uD835\\uDCB6','Ascr':'\\uD835\\uDC9C','Assign':'\\u2254','ast':'*','asymp':'\\u2248','asympeq':'\\u224D','atilde':'\\xE3','Atilde':'\\xC3','auml':'\\xE4','Auml':'\\xC4','awconint':'\\u2233','awint':'\\u2A11','backcong':'\\u224C','backepsilon':'\\u03F6','backprime':'\\u2035','backsim':'\\u223D','backsimeq':'\\u22CD','Backslash':'\\u2216','Barv':'\\u2AE7','barvee':'\\u22BD','barwed':'\\u2305','Barwed':'\\u2306','barwedge':'\\u2305','bbrk':'\\u23B5','bbrktbrk':'\\u23B6','bcong':'\\u224C','bcy':'\\u0431','Bcy':'\\u0411','bdquo':'\\u201E','becaus':'\\u2235','because':'\\u2235','Because':'\\u2235','bemptyv':'\\u29B0','bepsi':'\\u03F6','bernou':'\\u212C','Bernoullis':'\\u212C','beta':'\\u03B2','Beta':'\\u0392','beth':'\\u2136','between':'\\u226C','bfr':'\\uD835\\uDD1F','Bfr':'\\uD835\\uDD05','bigcap':'\\u22C2','bigcirc':'\\u25EF','bigcup':'\\u22C3','bigodot':'\\u2A00','bigoplus':'\\u2A01','bigotimes':'\\u2A02','bigsqcup':'\\u2A06','bigstar':'\\u2605','bigtriangledown':'\\u25BD','bigtriangleup':'\\u25B3','biguplus':'\\u2A04','bigvee':'\\u22C1','bigwedge':'\\u22C0','bkarow':'\\u290D','blacklozenge':'\\u29EB','blacksquare':'\\u25AA','blacktriangle':'\\u25B4','blacktriangledown':'\\u25BE','blacktriangleleft':'\\u25C2','blacktriangleright':'\\u25B8','blank':'\\u2423','blk12':'\\u2592','blk14':'\\u2591','blk34':'\\u2593','block':'\\u2588','bne':'=\\u20E5','bnequiv':'\\u2261\\u20E5','bnot':'\\u2310','bNot':'\\u2AED','bopf':'\\uD835\\uDD53','Bopf':'\\uD835\\uDD39','bot':'\\u22A5','bottom':'\\u22A5','bowtie':'\\u22C8','boxbox':'\\u29C9','boxdl':'\\u2510','boxdL':'\\u2555','boxDl':'\\u2556','boxDL':'\\u2557','boxdr':'\\u250C','boxdR':'\\u2552','boxDr':'\\u2553','boxDR':'\\u2554','boxh':'\\u2500','boxH':'\\u2550','boxhd':'\\u252C','boxhD':'\\u2565','boxHd':'\\u2564','boxHD':'\\u2566','boxhu':'\\u2534','boxhU':'\\u2568','boxHu':'\\u2567','boxHU':'\\u2569','boxminus':'\\u229F','boxplus':'\\u229E','boxtimes':'\\u22A0','boxul':'\\u2518','boxuL':'\\u255B','boxUl':'\\u255C','boxUL':'\\u255D','boxur':'\\u2514','boxuR':'\\u2558','boxUr':'\\u2559','boxUR':'\\u255A','boxv':'\\u2502','boxV':'\\u2551','boxvh':'\\u253C','boxvH':'\\u256A','boxVh':'\\u256B','boxVH':'\\u256C','boxvl':'\\u2524','boxvL':'\\u2561','boxVl':'\\u2562','boxVL':'\\u2563','boxvr':'\\u251C','boxvR':'\\u255E','boxVr':'\\u255F','boxVR':'\\u2560','bprime':'\\u2035','breve':'\\u02D8','Breve':'\\u02D8','brvbar':'\\xA6','bscr':'\\uD835\\uDCB7','Bscr':'\\u212C','bsemi':'\\u204F','bsim':'\\u223D','bsime':'\\u22CD','bsol':'\\\\','bsolb':'\\u29C5','bsolhsub':'\\u27C8','bull':'\\u2022','bullet':'\\u2022','bump':'\\u224E','bumpe':'\\u224F','bumpE':'\\u2AAE','bumpeq':'\\u224F','Bumpeq':'\\u224E','cacute':'\\u0107','Cacute':'\\u0106','cap':'\\u2229','Cap':'\\u22D2','capand':'\\u2A44','capbrcup':'\\u2A49','capcap':'\\u2A4B','capcup':'\\u2A47','capdot':'\\u2A40','CapitalDifferentialD':'\\u2145','caps':'\\u2229\\uFE00','caret':'\\u2041','caron':'\\u02C7','Cayleys':'\\u212D','ccaps':'\\u2A4D','ccaron':'\\u010D','Ccaron':'\\u010C','ccedil':'\\xE7','Ccedil':'\\xC7','ccirc':'\\u0109','Ccirc':'\\u0108','Cconint':'\\u2230','ccups':'\\u2A4C','ccupssm':'\\u2A50','cdot':'\\u010B','Cdot':'\\u010A','cedil':'\\xB8','Cedilla':'\\xB8','cemptyv':'\\u29B2','cent':'\\xA2','centerdot':'\\xB7','CenterDot':'\\xB7','cfr':'\\uD835\\uDD20','Cfr':'\\u212D','chcy':'\\u0447','CHcy':'\\u0427','check':'\\u2713','checkmark':'\\u2713','chi':'\\u03C7','Chi':'\\u03A7','cir':'\\u25CB','circ':'\\u02C6','circeq':'\\u2257','circlearrowleft':'\\u21BA','circlearrowright':'\\u21BB','circledast':'\\u229B','circledcirc':'\\u229A','circleddash':'\\u229D','CircleDot':'\\u2299','circledR':'\\xAE','circledS':'\\u24C8','CircleMinus':'\\u2296','CirclePlus':'\\u2295','CircleTimes':'\\u2297','cire':'\\u2257','cirE':'\\u29C3','cirfnint':'\\u2A10','cirmid':'\\u2AEF','cirscir':'\\u29C2','ClockwiseContourIntegral':'\\u2232','CloseCurlyDoubleQuote':'\\u201D','CloseCurlyQuote':'\\u2019','clubs':'\\u2663','clubsuit':'\\u2663','colon':':','Colon':'\\u2237','colone':'\\u2254','Colone':'\\u2A74','coloneq':'\\u2254','comma':',','commat':'@','comp':'\\u2201','compfn':'\\u2218','complement':'\\u2201','complexes':'\\u2102','cong':'\\u2245','congdot':'\\u2A6D','Congruent':'\\u2261','conint':'\\u222E','Conint':'\\u222F','ContourIntegral':'\\u222E','copf':'\\uD835\\uDD54','Copf':'\\u2102','coprod':'\\u2210','Coproduct':'\\u2210','copy':'\\xA9','COPY':'\\xA9','copysr':'\\u2117','CounterClockwiseContourIntegral':'\\u2233','crarr':'\\u21B5','cross':'\\u2717','Cross':'\\u2A2F','cscr':'\\uD835\\uDCB8','Cscr':'\\uD835\\uDC9E','csub':'\\u2ACF','csube':'\\u2AD1','csup':'\\u2AD0','csupe':'\\u2AD2','ctdot':'\\u22EF','cudarrl':'\\u2938','cudarrr':'\\u2935','cuepr':'\\u22DE','cuesc':'\\u22DF','cularr':'\\u21B6','cularrp':'\\u293D','cup':'\\u222A','Cup':'\\u22D3','cupbrcap':'\\u2A48','cupcap':'\\u2A46','CupCap':'\\u224D','cupcup':'\\u2A4A','cupdot':'\\u228D','cupor':'\\u2A45','cups':'\\u222A\\uFE00','curarr':'\\u21B7','curarrm':'\\u293C','curlyeqprec':'\\u22DE','curlyeqsucc':'\\u22DF','curlyvee':'\\u22CE','curlywedge':'\\u22CF','curren':'\\xA4','curvearrowleft':'\\u21B6','curvearrowright':'\\u21B7','cuvee':'\\u22CE','cuwed':'\\u22CF','cwconint':'\\u2232','cwint':'\\u2231','cylcty':'\\u232D','dagger':'\\u2020','Dagger':'\\u2021','daleth':'\\u2138','darr':'\\u2193','dArr':'\\u21D3','Darr':'\\u21A1','dash':'\\u2010','dashv':'\\u22A3','Dashv':'\\u2AE4','dbkarow':'\\u290F','dblac':'\\u02DD','dcaron':'\\u010F','Dcaron':'\\u010E','dcy':'\\u0434','Dcy':'\\u0414','dd':'\\u2146','DD':'\\u2145','ddagger':'\\u2021','ddarr':'\\u21CA','DDotrahd':'\\u2911','ddotseq':'\\u2A77','deg':'\\xB0','Del':'\\u2207','delta':'\\u03B4','Delta':'\\u0394','demptyv':'\\u29B1','dfisht':'\\u297F','dfr':'\\uD835\\uDD21','Dfr':'\\uD835\\uDD07','dHar':'\\u2965','dharl':'\\u21C3','dharr':'\\u21C2','DiacriticalAcute':'\\xB4','DiacriticalDot':'\\u02D9','DiacriticalDoubleAcute':'\\u02DD','DiacriticalGrave':'`','DiacriticalTilde':'\\u02DC','diam':'\\u22C4','diamond':'\\u22C4','Diamond':'\\u22C4','diamondsuit':'\\u2666','diams':'\\u2666','die':'\\xA8','DifferentialD':'\\u2146','digamma':'\\u03DD','disin':'\\u22F2','div':'\\xF7','divide':'\\xF7','divideontimes':'\\u22C7','divonx':'\\u22C7','djcy':'\\u0452','DJcy':'\\u0402','dlcorn':'\\u231E','dlcrop':'\\u230D','dollar':'$','dopf':'\\uD835\\uDD55','Dopf':'\\uD835\\uDD3B','dot':'\\u02D9','Dot':'\\xA8','DotDot':'\\u20DC','doteq':'\\u2250','doteqdot':'\\u2251','DotEqual':'\\u2250','dotminus':'\\u2238','dotplus':'\\u2214','dotsquare':'\\u22A1','doublebarwedge':'\\u2306','DoubleContourIntegral':'\\u222F','DoubleDot':'\\xA8','DoubleDownArrow':'\\u21D3','DoubleLeftArrow':'\\u21D0','DoubleLeftRightArrow':'\\u21D4','DoubleLeftTee':'\\u2AE4','DoubleLongLeftArrow':'\\u27F8','DoubleLongLeftRightArrow':'\\u27FA','DoubleLongRightArrow':'\\u27F9','DoubleRightArrow':'\\u21D2','DoubleRightTee':'\\u22A8','DoubleUpArrow':'\\u21D1','DoubleUpDownArrow':'\\u21D5','DoubleVerticalBar':'\\u2225','downarrow':'\\u2193','Downarrow':'\\u21D3','DownArrow':'\\u2193','DownArrowBar':'\\u2913','DownArrowUpArrow':'\\u21F5','DownBreve':'\\u0311','downdownarrows':'\\u21CA','downharpoonleft':'\\u21C3','downharpoonright':'\\u21C2','DownLeftRightVector':'\\u2950','DownLeftTeeVector':'\\u295E','DownLeftVector':'\\u21BD','DownLeftVectorBar':'\\u2956','DownRightTeeVector':'\\u295F','DownRightVector':'\\u21C1','DownRightVectorBar':'\\u2957','DownTee':'\\u22A4','DownTeeArrow':'\\u21A7','drbkarow':'\\u2910','drcorn':'\\u231F','drcrop':'\\u230C','dscr':'\\uD835\\uDCB9','Dscr':'\\uD835\\uDC9F','dscy':'\\u0455','DScy':'\\u0405','dsol':'\\u29F6','dstrok':'\\u0111','Dstrok':'\\u0110','dtdot':'\\u22F1','dtri':'\\u25BF','dtrif':'\\u25BE','duarr':'\\u21F5','duhar':'\\u296F','dwangle':'\\u29A6','dzcy':'\\u045F','DZcy':'\\u040F','dzigrarr':'\\u27FF','eacute':'\\xE9','Eacute':'\\xC9','easter':'\\u2A6E','ecaron':'\\u011B','Ecaron':'\\u011A','ecir':'\\u2256','ecirc':'\\xEA','Ecirc':'\\xCA','ecolon':'\\u2255','ecy':'\\u044D','Ecy':'\\u042D','eDDot':'\\u2A77','edot':'\\u0117','eDot':'\\u2251','Edot':'\\u0116','ee':'\\u2147','efDot':'\\u2252','efr':'\\uD835\\uDD22','Efr':'\\uD835\\uDD08','eg':'\\u2A9A','egrave':'\\xE8','Egrave':'\\xC8','egs':'\\u2A96','egsdot':'\\u2A98','el':'\\u2A99','Element':'\\u2208','elinters':'\\u23E7','ell':'\\u2113','els':'\\u2A95','elsdot':'\\u2A97','emacr':'\\u0113','Emacr':'\\u0112','empty':'\\u2205','emptyset':'\\u2205','EmptySmallSquare':'\\u25FB','emptyv':'\\u2205','EmptyVerySmallSquare':'\\u25AB','emsp':'\\u2003','emsp13':'\\u2004','emsp14':'\\u2005','eng':'\\u014B','ENG':'\\u014A','ensp':'\\u2002','eogon':'\\u0119','Eogon':'\\u0118','eopf':'\\uD835\\uDD56','Eopf':'\\uD835\\uDD3C','epar':'\\u22D5','eparsl':'\\u29E3','eplus':'\\u2A71','epsi':'\\u03B5','epsilon':'\\u03B5','Epsilon':'\\u0395','epsiv':'\\u03F5','eqcirc':'\\u2256','eqcolon':'\\u2255','eqsim':'\\u2242','eqslantgtr':'\\u2A96','eqslantless':'\\u2A95','Equal':'\\u2A75','equals':'=','EqualTilde':'\\u2242','equest':'\\u225F','Equilibrium':'\\u21CC','equiv':'\\u2261','equivDD':'\\u2A78','eqvparsl':'\\u29E5','erarr':'\\u2971','erDot':'\\u2253','escr':'\\u212F','Escr':'\\u2130','esdot':'\\u2250','esim':'\\u2242','Esim':'\\u2A73','eta':'\\u03B7','Eta':'\\u0397','eth':'\\xF0','ETH':'\\xD0','euml':'\\xEB','Euml':'\\xCB','euro':'\\u20AC','excl':'!','exist':'\\u2203','Exists':'\\u2203','expectation':'\\u2130','exponentiale':'\\u2147','ExponentialE':'\\u2147','fallingdotseq':'\\u2252','fcy':'\\u0444','Fcy':'\\u0424','female':'\\u2640','ffilig':'\\uFB03','fflig':'\\uFB00','ffllig':'\\uFB04','ffr':'\\uD835\\uDD23','Ffr':'\\uD835\\uDD09','filig':'\\uFB01','FilledSmallSquare':'\\u25FC','FilledVerySmallSquare':'\\u25AA','fjlig':'fj','flat':'\\u266D','fllig':'\\uFB02','fltns':'\\u25B1','fnof':'\\u0192','fopf':'\\uD835\\uDD57','Fopf':'\\uD835\\uDD3D','forall':'\\u2200','ForAll':'\\u2200','fork':'\\u22D4','forkv':'\\u2AD9','Fouriertrf':'\\u2131','fpartint':'\\u2A0D','frac12':'\\xBD','frac13':'\\u2153','frac14':'\\xBC','frac15':'\\u2155','frac16':'\\u2159','frac18':'\\u215B','frac23':'\\u2154','frac25':'\\u2156','frac34':'\\xBE','frac35':'\\u2157','frac38':'\\u215C','frac45':'\\u2158','frac56':'\\u215A','frac58':'\\u215D','frac78':'\\u215E','frasl':'\\u2044','frown':'\\u2322','fscr':'\\uD835\\uDCBB','Fscr':'\\u2131','gacute':'\\u01F5','gamma':'\\u03B3','Gamma':'\\u0393','gammad':'\\u03DD','Gammad':'\\u03DC','gap':'\\u2A86','gbreve':'\\u011F','Gbreve':'\\u011E','Gcedil':'\\u0122','gcirc':'\\u011D','Gcirc':'\\u011C','gcy':'\\u0433','Gcy':'\\u0413','gdot':'\\u0121','Gdot':'\\u0120','ge':'\\u2265','gE':'\\u2267','gel':'\\u22DB','gEl':'\\u2A8C','geq':'\\u2265','geqq':'\\u2267','geqslant':'\\u2A7E','ges':'\\u2A7E','gescc':'\\u2AA9','gesdot':'\\u2A80','gesdoto':'\\u2A82','gesdotol':'\\u2A84','gesl':'\\u22DB\\uFE00','gesles':'\\u2A94','gfr':'\\uD835\\uDD24','Gfr':'\\uD835\\uDD0A','gg':'\\u226B','Gg':'\\u22D9','ggg':'\\u22D9','gimel':'\\u2137','gjcy':'\\u0453','GJcy':'\\u0403','gl':'\\u2277','gla':'\\u2AA5','glE':'\\u2A92','glj':'\\u2AA4','gnap':'\\u2A8A','gnapprox':'\\u2A8A','gne':'\\u2A88','gnE':'\\u2269','gneq':'\\u2A88','gneqq':'\\u2269','gnsim':'\\u22E7','gopf':'\\uD835\\uDD58','Gopf':'\\uD835\\uDD3E','grave':'`','GreaterEqual':'\\u2265','GreaterEqualLess':'\\u22DB','GreaterFullEqual':'\\u2267','GreaterGreater':'\\u2AA2','GreaterLess':'\\u2277','GreaterSlantEqual':'\\u2A7E','GreaterTilde':'\\u2273','gscr':'\\u210A','Gscr':'\\uD835\\uDCA2','gsim':'\\u2273','gsime':'\\u2A8E','gsiml':'\\u2A90','gt':'>','Gt':'\\u226B','GT':'>','gtcc':'\\u2AA7','gtcir':'\\u2A7A','gtdot':'\\u22D7','gtlPar':'\\u2995','gtquest':'\\u2A7C','gtrapprox':'\\u2A86','gtrarr':'\\u2978','gtrdot':'\\u22D7','gtreqless':'\\u22DB','gtreqqless':'\\u2A8C','gtrless':'\\u2277','gtrsim':'\\u2273','gvertneqq':'\\u2269\\uFE00','gvnE':'\\u2269\\uFE00','Hacek':'\\u02C7','hairsp':'\\u200A','half':'\\xBD','hamilt':'\\u210B','hardcy':'\\u044A','HARDcy':'\\u042A','harr':'\\u2194','hArr':'\\u21D4','harrcir':'\\u2948','harrw':'\\u21AD','Hat':'^','hbar':'\\u210F','hcirc':'\\u0125','Hcirc':'\\u0124','hearts':'\\u2665','heartsuit':'\\u2665','hellip':'\\u2026','hercon':'\\u22B9','hfr':'\\uD835\\uDD25','Hfr':'\\u210C','HilbertSpace':'\\u210B','hksearow':'\\u2925','hkswarow':'\\u2926','hoarr':'\\u21FF','homtht':'\\u223B','hookleftarrow':'\\u21A9','hookrightarrow':'\\u21AA','hopf':'\\uD835\\uDD59','Hopf':'\\u210D','horbar':'\\u2015','HorizontalLine':'\\u2500','hscr':'\\uD835\\uDCBD','Hscr':'\\u210B','hslash':'\\u210F','hstrok':'\\u0127','Hstrok':'\\u0126','HumpDownHump':'\\u224E','HumpEqual':'\\u224F','hybull':'\\u2043','hyphen':'\\u2010','iacute':'\\xED','Iacute':'\\xCD','ic':'\\u2063','icirc':'\\xEE','Icirc':'\\xCE','icy':'\\u0438','Icy':'\\u0418','Idot':'\\u0130','iecy':'\\u0435','IEcy':'\\u0415','iexcl':'\\xA1','iff':'\\u21D4','ifr':'\\uD835\\uDD26','Ifr':'\\u2111','igrave':'\\xEC','Igrave':'\\xCC','ii':'\\u2148','iiiint':'\\u2A0C','iiint':'\\u222D','iinfin':'\\u29DC','iiota':'\\u2129','ijlig':'\\u0133','IJlig':'\\u0132','Im':'\\u2111','imacr':'\\u012B','Imacr':'\\u012A','image':'\\u2111','ImaginaryI':'\\u2148','imagline':'\\u2110','imagpart':'\\u2111','imath':'\\u0131','imof':'\\u22B7','imped':'\\u01B5','Implies':'\\u21D2','in':'\\u2208','incare':'\\u2105','infin':'\\u221E','infintie':'\\u29DD','inodot':'\\u0131','int':'\\u222B','Int':'\\u222C','intcal':'\\u22BA','integers':'\\u2124','Integral':'\\u222B','intercal':'\\u22BA','Intersection':'\\u22C2','intlarhk':'\\u2A17','intprod':'\\u2A3C','InvisibleComma':'\\u2063','InvisibleTimes':'\\u2062','iocy':'\\u0451','IOcy':'\\u0401','iogon':'\\u012F','Iogon':'\\u012E','iopf':'\\uD835\\uDD5A','Iopf':'\\uD835\\uDD40','iota':'\\u03B9','Iota':'\\u0399','iprod':'\\u2A3C','iquest':'\\xBF','iscr':'\\uD835\\uDCBE','Iscr':'\\u2110','isin':'\\u2208','isindot':'\\u22F5','isinE':'\\u22F9','isins':'\\u22F4','isinsv':'\\u22F3','isinv':'\\u2208','it':'\\u2062','itilde':'\\u0129','Itilde':'\\u0128','iukcy':'\\u0456','Iukcy':'\\u0406','iuml':'\\xEF','Iuml':'\\xCF','jcirc':'\\u0135','Jcirc':'\\u0134','jcy':'\\u0439','Jcy':'\\u0419','jfr':'\\uD835\\uDD27','Jfr':'\\uD835\\uDD0D','jmath':'\\u0237','jopf':'\\uD835\\uDD5B','Jopf':'\\uD835\\uDD41','jscr':'\\uD835\\uDCBF','Jscr':'\\uD835\\uDCA5','jsercy':'\\u0458','Jsercy':'\\u0408','jukcy':'\\u0454','Jukcy':'\\u0404','kappa':'\\u03BA','Kappa':'\\u039A','kappav':'\\u03F0','kcedil':'\\u0137','Kcedil':'\\u0136','kcy':'\\u043A','Kcy':'\\u041A','kfr':'\\uD835\\uDD28','Kfr':'\\uD835\\uDD0E','kgreen':'\\u0138','khcy':'\\u0445','KHcy':'\\u0425','kjcy':'\\u045C','KJcy':'\\u040C','kopf':'\\uD835\\uDD5C','Kopf':'\\uD835\\uDD42','kscr':'\\uD835\\uDCC0','Kscr':'\\uD835\\uDCA6','lAarr':'\\u21DA','lacute':'\\u013A','Lacute':'\\u0139','laemptyv':'\\u29B4','lagran':'\\u2112','lambda':'\\u03BB','Lambda':'\\u039B','lang':'\\u27E8','Lang':'\\u27EA','langd':'\\u2991','langle':'\\u27E8','lap':'\\u2A85','Laplacetrf':'\\u2112','laquo':'\\xAB','larr':'\\u2190','lArr':'\\u21D0','Larr':'\\u219E','larrb':'\\u21E4','larrbfs':'\\u291F','larrfs':'\\u291D','larrhk':'\\u21A9','larrlp':'\\u21AB','larrpl':'\\u2939','larrsim':'\\u2973','larrtl':'\\u21A2','lat':'\\u2AAB','latail':'\\u2919','lAtail':'\\u291B','late':'\\u2AAD','lates':'\\u2AAD\\uFE00','lbarr':'\\u290C','lBarr':'\\u290E','lbbrk':'\\u2772','lbrace':'{','lbrack':'[','lbrke':'\\u298B','lbrksld':'\\u298F','lbrkslu':'\\u298D','lcaron':'\\u013E','Lcaron':'\\u013D','lcedil':'\\u013C','Lcedil':'\\u013B','lceil':'\\u2308','lcub':'{','lcy':'\\u043B','Lcy':'\\u041B','ldca':'\\u2936','ldquo':'\\u201C','ldquor':'\\u201E','ldrdhar':'\\u2967','ldrushar':'\\u294B','ldsh':'\\u21B2','le':'\\u2264','lE':'\\u2266','LeftAngleBracket':'\\u27E8','leftarrow':'\\u2190','Leftarrow':'\\u21D0','LeftArrow':'\\u2190','LeftArrowBar':'\\u21E4','LeftArrowRightArrow':'\\u21C6','leftarrowtail':'\\u21A2','LeftCeiling':'\\u2308','LeftDoubleBracket':'\\u27E6','LeftDownTeeVector':'\\u2961','LeftDownVector':'\\u21C3','LeftDownVectorBar':'\\u2959','LeftFloor':'\\u230A','leftharpoondown':'\\u21BD','leftharpoonup':'\\u21BC','leftleftarrows':'\\u21C7','leftrightarrow':'\\u2194','Leftrightarrow':'\\u21D4','LeftRightArrow':'\\u2194','leftrightarrows':'\\u21C6','leftrightharpoons':'\\u21CB','leftrightsquigarrow':'\\u21AD','LeftRightVector':'\\u294E','LeftTee':'\\u22A3','LeftTeeArrow':'\\u21A4','LeftTeeVector':'\\u295A','leftthreetimes':'\\u22CB','LeftTriangle':'\\u22B2','LeftTriangleBar':'\\u29CF','LeftTriangleEqual':'\\u22B4','LeftUpDownVector':'\\u2951','LeftUpTeeVector':'\\u2960','LeftUpVector':'\\u21BF','LeftUpVectorBar':'\\u2958','LeftVector':'\\u21BC','LeftVectorBar':'\\u2952','leg':'\\u22DA','lEg':'\\u2A8B','leq':'\\u2264','leqq':'\\u2266','leqslant':'\\u2A7D','les':'\\u2A7D','lescc':'\\u2AA8','lesdot':'\\u2A7F','lesdoto':'\\u2A81','lesdotor':'\\u2A83','lesg':'\\u22DA\\uFE00','lesges':'\\u2A93','lessapprox':'\\u2A85','lessdot':'\\u22D6','lesseqgtr':'\\u22DA','lesseqqgtr':'\\u2A8B','LessEqualGreater':'\\u22DA','LessFullEqual':'\\u2266','LessGreater':'\\u2276','lessgtr':'\\u2276','LessLess':'\\u2AA1','lesssim':'\\u2272','LessSlantEqual':'\\u2A7D','LessTilde':'\\u2272','lfisht':'\\u297C','lfloor':'\\u230A','lfr':'\\uD835\\uDD29','Lfr':'\\uD835\\uDD0F','lg':'\\u2276','lgE':'\\u2A91','lHar':'\\u2962','lhard':'\\u21BD','lharu':'\\u21BC','lharul':'\\u296A','lhblk':'\\u2584','ljcy':'\\u0459','LJcy':'\\u0409','ll':'\\u226A','Ll':'\\u22D8','llarr':'\\u21C7','llcorner':'\\u231E','Lleftarrow':'\\u21DA','llhard':'\\u296B','lltri':'\\u25FA','lmidot':'\\u0140','Lmidot':'\\u013F','lmoust':'\\u23B0','lmoustache':'\\u23B0','lnap':'\\u2A89','lnapprox':'\\u2A89','lne':'\\u2A87','lnE':'\\u2268','lneq':'\\u2A87','lneqq':'\\u2268','lnsim':'\\u22E6','loang':'\\u27EC','loarr':'\\u21FD','lobrk':'\\u27E6','longleftarrow':'\\u27F5','Longleftarrow':'\\u27F8','LongLeftArrow':'\\u27F5','longleftrightarrow':'\\u27F7','Longleftrightarrow':'\\u27FA','LongLeftRightArrow':'\\u27F7','longmapsto':'\\u27FC','longrightarrow':'\\u27F6','Longrightarrow':'\\u27F9','LongRightArrow':'\\u27F6','looparrowleft':'\\u21AB','looparrowright':'\\u21AC','lopar':'\\u2985','lopf':'\\uD835\\uDD5D','Lopf':'\\uD835\\uDD43','loplus':'\\u2A2D','lotimes':'\\u2A34','lowast':'\\u2217','lowbar':'_','LowerLeftArrow':'\\u2199','LowerRightArrow':'\\u2198','loz':'\\u25CA','lozenge':'\\u25CA','lozf':'\\u29EB','lpar':'(','lparlt':'\\u2993','lrarr':'\\u21C6','lrcorner':'\\u231F','lrhar':'\\u21CB','lrhard':'\\u296D','lrm':'\\u200E','lrtri':'\\u22BF','lsaquo':'\\u2039','lscr':'\\uD835\\uDCC1','Lscr':'\\u2112','lsh':'\\u21B0','Lsh':'\\u21B0','lsim':'\\u2272','lsime':'\\u2A8D','lsimg':'\\u2A8F','lsqb':'[','lsquo':'\\u2018','lsquor':'\\u201A','lstrok':'\\u0142','Lstrok':'\\u0141','lt':'<','Lt':'\\u226A','LT':'<','ltcc':'\\u2AA6','ltcir':'\\u2A79','ltdot':'\\u22D6','lthree':'\\u22CB','ltimes':'\\u22C9','ltlarr':'\\u2976','ltquest':'\\u2A7B','ltri':'\\u25C3','ltrie':'\\u22B4','ltrif':'\\u25C2','ltrPar':'\\u2996','lurdshar':'\\u294A','luruhar':'\\u2966','lvertneqq':'\\u2268\\uFE00','lvnE':'\\u2268\\uFE00','macr':'\\xAF','male':'\\u2642','malt':'\\u2720','maltese':'\\u2720','map':'\\u21A6','Map':'\\u2905','mapsto':'\\u21A6','mapstodown':'\\u21A7','mapstoleft':'\\u21A4','mapstoup':'\\u21A5','marker':'\\u25AE','mcomma':'\\u2A29','mcy':'\\u043C','Mcy':'\\u041C','mdash':'\\u2014','mDDot':'\\u223A','measuredangle':'\\u2221','MediumSpace':'\\u205F','Mellintrf':'\\u2133','mfr':'\\uD835\\uDD2A','Mfr':'\\uD835\\uDD10','mho':'\\u2127','micro':'\\xB5','mid':'\\u2223','midast':'*','midcir':'\\u2AF0','middot':'\\xB7','minus':'\\u2212','minusb':'\\u229F','minusd':'\\u2238','minusdu':'\\u2A2A','MinusPlus':'\\u2213','mlcp':'\\u2ADB','mldr':'\\u2026','mnplus':'\\u2213','models':'\\u22A7','mopf':'\\uD835\\uDD5E','Mopf':'\\uD835\\uDD44','mp':'\\u2213','mscr':'\\uD835\\uDCC2','Mscr':'\\u2133','mstpos':'\\u223E','mu':'\\u03BC','Mu':'\\u039C','multimap':'\\u22B8','mumap':'\\u22B8','nabla':'\\u2207','nacute':'\\u0144','Nacute':'\\u0143','nang':'\\u2220\\u20D2','nap':'\\u2249','napE':'\\u2A70\\u0338','napid':'\\u224B\\u0338','napos':'\\u0149','napprox':'\\u2249','natur':'\\u266E','natural':'\\u266E','naturals':'\\u2115','nbsp':'\\xA0','nbump':'\\u224E\\u0338','nbumpe':'\\u224F\\u0338','ncap':'\\u2A43','ncaron':'\\u0148','Ncaron':'\\u0147','ncedil':'\\u0146','Ncedil':'\\u0145','ncong':'\\u2247','ncongdot':'\\u2A6D\\u0338','ncup':'\\u2A42','ncy':'\\u043D','Ncy':'\\u041D','ndash':'\\u2013','ne':'\\u2260','nearhk':'\\u2924','nearr':'\\u2197','neArr':'\\u21D7','nearrow':'\\u2197','nedot':'\\u2250\\u0338','NegativeMediumSpace':'\\u200B','NegativeThickSpace':'\\u200B','NegativeThinSpace':'\\u200B','NegativeVeryThinSpace':'\\u200B','nequiv':'\\u2262','nesear':'\\u2928','nesim':'\\u2242\\u0338','NestedGreaterGreater':'\\u226B','NestedLessLess':'\\u226A','NewLine':'\\n','nexist':'\\u2204','nexists':'\\u2204','nfr':'\\uD835\\uDD2B','Nfr':'\\uD835\\uDD11','nge':'\\u2271','ngE':'\\u2267\\u0338','ngeq':'\\u2271','ngeqq':'\\u2267\\u0338','ngeqslant':'\\u2A7E\\u0338','nges':'\\u2A7E\\u0338','nGg':'\\u22D9\\u0338','ngsim':'\\u2275','ngt':'\\u226F','nGt':'\\u226B\\u20D2','ngtr':'\\u226F','nGtv':'\\u226B\\u0338','nharr':'\\u21AE','nhArr':'\\u21CE','nhpar':'\\u2AF2','ni':'\\u220B','nis':'\\u22FC','nisd':'\\u22FA','niv':'\\u220B','njcy':'\\u045A','NJcy':'\\u040A','nlarr':'\\u219A','nlArr':'\\u21CD','nldr':'\\u2025','nle':'\\u2270','nlE':'\\u2266\\u0338','nleftarrow':'\\u219A','nLeftarrow':'\\u21CD','nleftrightarrow':'\\u21AE','nLeftrightarrow':'\\u21CE','nleq':'\\u2270','nleqq':'\\u2266\\u0338','nleqslant':'\\u2A7D\\u0338','nles':'\\u2A7D\\u0338','nless':'\\u226E','nLl':'\\u22D8\\u0338','nlsim':'\\u2274','nlt':'\\u226E','nLt':'\\u226A\\u20D2','nltri':'\\u22EA','nltrie':'\\u22EC','nLtv':'\\u226A\\u0338','nmid':'\\u2224','NoBreak':'\\u2060','NonBreakingSpace':'\\xA0','nopf':'\\uD835\\uDD5F','Nopf':'\\u2115','not':'\\xAC','Not':'\\u2AEC','NotCongruent':'\\u2262','NotCupCap':'\\u226D','NotDoubleVerticalBar':'\\u2226','NotElement':'\\u2209','NotEqual':'\\u2260','NotEqualTilde':'\\u2242\\u0338','NotExists':'\\u2204','NotGreater':'\\u226F','NotGreaterEqual':'\\u2271','NotGreaterFullEqual':'\\u2267\\u0338','NotGreaterGreater':'\\u226B\\u0338','NotGreaterLess':'\\u2279','NotGreaterSlantEqual':'\\u2A7E\\u0338','NotGreaterTilde':'\\u2275','NotHumpDownHump':'\\u224E\\u0338','NotHumpEqual':'\\u224F\\u0338','notin':'\\u2209','notindot':'\\u22F5\\u0338','notinE':'\\u22F9\\u0338','notinva':'\\u2209','notinvb':'\\u22F7','notinvc':'\\u22F6','NotLeftTriangle':'\\u22EA','NotLeftTriangleBar':'\\u29CF\\u0338','NotLeftTriangleEqual':'\\u22EC','NotLess':'\\u226E','NotLessEqual':'\\u2270','NotLessGreater':'\\u2278','NotLessLess':'\\u226A\\u0338','NotLessSlantEqual':'\\u2A7D\\u0338','NotLessTilde':'\\u2274','NotNestedGreaterGreater':'\\u2AA2\\u0338','NotNestedLessLess':'\\u2AA1\\u0338','notni':'\\u220C','notniva':'\\u220C','notnivb':'\\u22FE','notnivc':'\\u22FD','NotPrecedes':'\\u2280','NotPrecedesEqual':'\\u2AAF\\u0338','NotPrecedesSlantEqual':'\\u22E0','NotReverseElement':'\\u220C','NotRightTriangle':'\\u22EB','NotRightTriangleBar':'\\u29D0\\u0338','NotRightTriangleEqual':'\\u22ED','NotSquareSubset':'\\u228F\\u0338','NotSquareSubsetEqual':'\\u22E2','NotSquareSuperset':'\\u2290\\u0338','NotSquareSupersetEqual':'\\u22E3','NotSubset':'\\u2282\\u20D2','NotSubsetEqual':'\\u2288','NotSucceeds':'\\u2281','NotSucceedsEqual':'\\u2AB0\\u0338','NotSucceedsSlantEqual':'\\u22E1','NotSucceedsTilde':'\\u227F\\u0338','NotSuperset':'\\u2283\\u20D2','NotSupersetEqual':'\\u2289','NotTilde':'\\u2241','NotTildeEqual':'\\u2244','NotTildeFullEqual':'\\u2247','NotTildeTilde':'\\u2249','NotVerticalBar':'\\u2224','npar':'\\u2226','nparallel':'\\u2226','nparsl':'\\u2AFD\\u20E5','npart':'\\u2202\\u0338','npolint':'\\u2A14','npr':'\\u2280','nprcue':'\\u22E0','npre':'\\u2AAF\\u0338','nprec':'\\u2280','npreceq':'\\u2AAF\\u0338','nrarr':'\\u219B','nrArr':'\\u21CF','nrarrc':'\\u2933\\u0338','nrarrw':'\\u219D\\u0338','nrightarrow':'\\u219B','nRightarrow':'\\u21CF','nrtri':'\\u22EB','nrtrie':'\\u22ED','nsc':'\\u2281','nsccue':'\\u22E1','nsce':'\\u2AB0\\u0338','nscr':'\\uD835\\uDCC3','Nscr':'\\uD835\\uDCA9','nshortmid':'\\u2224','nshortparallel':'\\u2226','nsim':'\\u2241','nsime':'\\u2244','nsimeq':'\\u2244','nsmid':'\\u2224','nspar':'\\u2226','nsqsube':'\\u22E2','nsqsupe':'\\u22E3','nsub':'\\u2284','nsube':'\\u2288','nsubE':'\\u2AC5\\u0338','nsubset':'\\u2282\\u20D2','nsubseteq':'\\u2288','nsubseteqq':'\\u2AC5\\u0338','nsucc':'\\u2281','nsucceq':'\\u2AB0\\u0338','nsup':'\\u2285','nsupe':'\\u2289','nsupE':'\\u2AC6\\u0338','nsupset':'\\u2283\\u20D2','nsupseteq':'\\u2289','nsupseteqq':'\\u2AC6\\u0338','ntgl':'\\u2279','ntilde':'\\xF1','Ntilde':'\\xD1','ntlg':'\\u2278','ntriangleleft':'\\u22EA','ntrianglelefteq':'\\u22EC','ntriangleright':'\\u22EB','ntrianglerighteq':'\\u22ED','nu':'\\u03BD','Nu':'\\u039D','num':'#','numero':'\\u2116','numsp':'\\u2007','nvap':'\\u224D\\u20D2','nvdash':'\\u22AC','nvDash':'\\u22AD','nVdash':'\\u22AE','nVDash':'\\u22AF','nvge':'\\u2265\\u20D2','nvgt':'>\\u20D2','nvHarr':'\\u2904','nvinfin':'\\u29DE','nvlArr':'\\u2902','nvle':'\\u2264\\u20D2','nvlt':'<\\u20D2','nvltrie':'\\u22B4\\u20D2','nvrArr':'\\u2903','nvrtrie':'\\u22B5\\u20D2','nvsim':'\\u223C\\u20D2','nwarhk':'\\u2923','nwarr':'\\u2196','nwArr':'\\u21D6','nwarrow':'\\u2196','nwnear':'\\u2927','oacute':'\\xF3','Oacute':'\\xD3','oast':'\\u229B','ocir':'\\u229A','ocirc':'\\xF4','Ocirc':'\\xD4','ocy':'\\u043E','Ocy':'\\u041E','odash':'\\u229D','odblac':'\\u0151','Odblac':'\\u0150','odiv':'\\u2A38','odot':'\\u2299','odsold':'\\u29BC','oelig':'\\u0153','OElig':'\\u0152','ofcir':'\\u29BF','ofr':'\\uD835\\uDD2C','Ofr':'\\uD835\\uDD12','ogon':'\\u02DB','ograve':'\\xF2','Ograve':'\\xD2','ogt':'\\u29C1','ohbar':'\\u29B5','ohm':'\\u03A9','oint':'\\u222E','olarr':'\\u21BA','olcir':'\\u29BE','olcross':'\\u29BB','oline':'\\u203E','olt':'\\u29C0','omacr':'\\u014D','Omacr':'\\u014C','omega':'\\u03C9','Omega':'\\u03A9','omicron':'\\u03BF','Omicron':'\\u039F','omid':'\\u29B6','ominus':'\\u2296','oopf':'\\uD835\\uDD60','Oopf':'\\uD835\\uDD46','opar':'\\u29B7','OpenCurlyDoubleQuote':'\\u201C','OpenCurlyQuote':'\\u2018','operp':'\\u29B9','oplus':'\\u2295','or':'\\u2228','Or':'\\u2A54','orarr':'\\u21BB','ord':'\\u2A5D','order':'\\u2134','orderof':'\\u2134','ordf':'\\xAA','ordm':'\\xBA','origof':'\\u22B6','oror':'\\u2A56','orslope':'\\u2A57','orv':'\\u2A5B','oS':'\\u24C8','oscr':'\\u2134','Oscr':'\\uD835\\uDCAA','oslash':'\\xF8','Oslash':'\\xD8','osol':'\\u2298','otilde':'\\xF5','Otilde':'\\xD5','otimes':'\\u2297','Otimes':'\\u2A37','otimesas':'\\u2A36','ouml':'\\xF6','Ouml':'\\xD6','ovbar':'\\u233D','OverBar':'\\u203E','OverBrace':'\\u23DE','OverBracket':'\\u23B4','OverParenthesis':'\\u23DC','par':'\\u2225','para':'\\xB6','parallel':'\\u2225','parsim':'\\u2AF3','parsl':'\\u2AFD','part':'\\u2202','PartialD':'\\u2202','pcy':'\\u043F','Pcy':'\\u041F','percnt':'%','period':'.','permil':'\\u2030','perp':'\\u22A5','pertenk':'\\u2031','pfr':'\\uD835\\uDD2D','Pfr':'\\uD835\\uDD13','phi':'\\u03C6','Phi':'\\u03A6','phiv':'\\u03D5','phmmat':'\\u2133','phone':'\\u260E','pi':'\\u03C0','Pi':'\\u03A0','pitchfork':'\\u22D4','piv':'\\u03D6','planck':'\\u210F','planckh':'\\u210E','plankv':'\\u210F','plus':'+','plusacir':'\\u2A23','plusb':'\\u229E','pluscir':'\\u2A22','plusdo':'\\u2214','plusdu':'\\u2A25','pluse':'\\u2A72','PlusMinus':'\\xB1','plusmn':'\\xB1','plussim':'\\u2A26','plustwo':'\\u2A27','pm':'\\xB1','Poincareplane':'\\u210C','pointint':'\\u2A15','popf':'\\uD835\\uDD61','Popf':'\\u2119','pound':'\\xA3','pr':'\\u227A','Pr':'\\u2ABB','prap':'\\u2AB7','prcue':'\\u227C','pre':'\\u2AAF','prE':'\\u2AB3','prec':'\\u227A','precapprox':'\\u2AB7','preccurlyeq':'\\u227C','Precedes':'\\u227A','PrecedesEqual':'\\u2AAF','PrecedesSlantEqual':'\\u227C','PrecedesTilde':'\\u227E','preceq':'\\u2AAF','precnapprox':'\\u2AB9','precneqq':'\\u2AB5','precnsim':'\\u22E8','precsim':'\\u227E','prime':'\\u2032','Prime':'\\u2033','primes':'\\u2119','prnap':'\\u2AB9','prnE':'\\u2AB5','prnsim':'\\u22E8','prod':'\\u220F','Product':'\\u220F','profalar':'\\u232E','profline':'\\u2312','profsurf':'\\u2313','prop':'\\u221D','Proportion':'\\u2237','Proportional':'\\u221D','propto':'\\u221D','prsim':'\\u227E','prurel':'\\u22B0','pscr':'\\uD835\\uDCC5','Pscr':'\\uD835\\uDCAB','psi':'\\u03C8','Psi':'\\u03A8','puncsp':'\\u2008','qfr':'\\uD835\\uDD2E','Qfr':'\\uD835\\uDD14','qint':'\\u2A0C','qopf':'\\uD835\\uDD62','Qopf':'\\u211A','qprime':'\\u2057','qscr':'\\uD835\\uDCC6','Qscr':'\\uD835\\uDCAC','quaternions':'\\u210D','quatint':'\\u2A16','quest':'?','questeq':'\\u225F','quot':'\"','QUOT':'\"','rAarr':'\\u21DB','race':'\\u223D\\u0331','racute':'\\u0155','Racute':'\\u0154','radic':'\\u221A','raemptyv':'\\u29B3','rang':'\\u27E9','Rang':'\\u27EB','rangd':'\\u2992','range':'\\u29A5','rangle':'\\u27E9','raquo':'\\xBB','rarr':'\\u2192','rArr':'\\u21D2','Rarr':'\\u21A0','rarrap':'\\u2975','rarrb':'\\u21E5','rarrbfs':'\\u2920','rarrc':'\\u2933','rarrfs':'\\u291E','rarrhk':'\\u21AA','rarrlp':'\\u21AC','rarrpl':'\\u2945','rarrsim':'\\u2974','rarrtl':'\\u21A3','Rarrtl':'\\u2916','rarrw':'\\u219D','ratail':'\\u291A','rAtail':'\\u291C','ratio':'\\u2236','rationals':'\\u211A','rbarr':'\\u290D','rBarr':'\\u290F','RBarr':'\\u2910','rbbrk':'\\u2773','rbrace':'}','rbrack':']','rbrke':'\\u298C','rbrksld':'\\u298E','rbrkslu':'\\u2990','rcaron':'\\u0159','Rcaron':'\\u0158','rcedil':'\\u0157','Rcedil':'\\u0156','rceil':'\\u2309','rcub':'}','rcy':'\\u0440','Rcy':'\\u0420','rdca':'\\u2937','rdldhar':'\\u2969','rdquo':'\\u201D','rdquor':'\\u201D','rdsh':'\\u21B3','Re':'\\u211C','real':'\\u211C','realine':'\\u211B','realpart':'\\u211C','reals':'\\u211D','rect':'\\u25AD','reg':'\\xAE','REG':'\\xAE','ReverseElement':'\\u220B','ReverseEquilibrium':'\\u21CB','ReverseUpEquilibrium':'\\u296F','rfisht':'\\u297D','rfloor':'\\u230B','rfr':'\\uD835\\uDD2F','Rfr':'\\u211C','rHar':'\\u2964','rhard':'\\u21C1','rharu':'\\u21C0','rharul':'\\u296C','rho':'\\u03C1','Rho':'\\u03A1','rhov':'\\u03F1','RightAngleBracket':'\\u27E9','rightarrow':'\\u2192','Rightarrow':'\\u21D2','RightArrow':'\\u2192','RightArrowBar':'\\u21E5','RightArrowLeftArrow':'\\u21C4','rightarrowtail':'\\u21A3','RightCeiling':'\\u2309','RightDoubleBracket':'\\u27E7','RightDownTeeVector':'\\u295D','RightDownVector':'\\u21C2','RightDownVectorBar':'\\u2955','RightFloor':'\\u230B','rightharpoondown':'\\u21C1','rightharpoonup':'\\u21C0','rightleftarrows':'\\u21C4','rightleftharpoons':'\\u21CC','rightrightarrows':'\\u21C9','rightsquigarrow':'\\u219D','RightTee':'\\u22A2','RightTeeArrow':'\\u21A6','RightTeeVector':'\\u295B','rightthreetimes':'\\u22CC','RightTriangle':'\\u22B3','RightTriangleBar':'\\u29D0','RightTriangleEqual':'\\u22B5','RightUpDownVector':'\\u294F','RightUpTeeVector':'\\u295C','RightUpVector':'\\u21BE','RightUpVectorBar':'\\u2954','RightVector':'\\u21C0','RightVectorBar':'\\u2953','ring':'\\u02DA','risingdotseq':'\\u2253','rlarr':'\\u21C4','rlhar':'\\u21CC','rlm':'\\u200F','rmoust':'\\u23B1','rmoustache':'\\u23B1','rnmid':'\\u2AEE','roang':'\\u27ED','roarr':'\\u21FE','robrk':'\\u27E7','ropar':'\\u2986','ropf':'\\uD835\\uDD63','Ropf':'\\u211D','roplus':'\\u2A2E','rotimes':'\\u2A35','RoundImplies':'\\u2970','rpar':')','rpargt':'\\u2994','rppolint':'\\u2A12','rrarr':'\\u21C9','Rrightarrow':'\\u21DB','rsaquo':'\\u203A','rscr':'\\uD835\\uDCC7','Rscr':'\\u211B','rsh':'\\u21B1','Rsh':'\\u21B1','rsqb':']','rsquo':'\\u2019','rsquor':'\\u2019','rthree':'\\u22CC','rtimes':'\\u22CA','rtri':'\\u25B9','rtrie':'\\u22B5','rtrif':'\\u25B8','rtriltri':'\\u29CE','RuleDelayed':'\\u29F4','ruluhar':'\\u2968','rx':'\\u211E','sacute':'\\u015B','Sacute':'\\u015A','sbquo':'\\u201A','sc':'\\u227B','Sc':'\\u2ABC','scap':'\\u2AB8','scaron':'\\u0161','Scaron':'\\u0160','sccue':'\\u227D','sce':'\\u2AB0','scE':'\\u2AB4','scedil':'\\u015F','Scedil':'\\u015E','scirc':'\\u015D','Scirc':'\\u015C','scnap':'\\u2ABA','scnE':'\\u2AB6','scnsim':'\\u22E9','scpolint':'\\u2A13','scsim':'\\u227F','scy':'\\u0441','Scy':'\\u0421','sdot':'\\u22C5','sdotb':'\\u22A1','sdote':'\\u2A66','searhk':'\\u2925','searr':'\\u2198','seArr':'\\u21D8','searrow':'\\u2198','sect':'\\xA7','semi':';','seswar':'\\u2929','setminus':'\\u2216','setmn':'\\u2216','sext':'\\u2736','sfr':'\\uD835\\uDD30','Sfr':'\\uD835\\uDD16','sfrown':'\\u2322','sharp':'\\u266F','shchcy':'\\u0449','SHCHcy':'\\u0429','shcy':'\\u0448','SHcy':'\\u0428','ShortDownArrow':'\\u2193','ShortLeftArrow':'\\u2190','shortmid':'\\u2223','shortparallel':'\\u2225','ShortRightArrow':'\\u2192','ShortUpArrow':'\\u2191','shy':'\\xAD','sigma':'\\u03C3','Sigma':'\\u03A3','sigmaf':'\\u03C2','sigmav':'\\u03C2','sim':'\\u223C','simdot':'\\u2A6A','sime':'\\u2243','simeq':'\\u2243','simg':'\\u2A9E','simgE':'\\u2AA0','siml':'\\u2A9D','simlE':'\\u2A9F','simne':'\\u2246','simplus':'\\u2A24','simrarr':'\\u2972','slarr':'\\u2190','SmallCircle':'\\u2218','smallsetminus':'\\u2216','smashp':'\\u2A33','smeparsl':'\\u29E4','smid':'\\u2223','smile':'\\u2323','smt':'\\u2AAA','smte':'\\u2AAC','smtes':'\\u2AAC\\uFE00','softcy':'\\u044C','SOFTcy':'\\u042C','sol':'/','solb':'\\u29C4','solbar':'\\u233F','sopf':'\\uD835\\uDD64','Sopf':'\\uD835\\uDD4A','spades':'\\u2660','spadesuit':'\\u2660','spar':'\\u2225','sqcap':'\\u2293','sqcaps':'\\u2293\\uFE00','sqcup':'\\u2294','sqcups':'\\u2294\\uFE00','Sqrt':'\\u221A','sqsub':'\\u228F','sqsube':'\\u2291','sqsubset':'\\u228F','sqsubseteq':'\\u2291','sqsup':'\\u2290','sqsupe':'\\u2292','sqsupset':'\\u2290','sqsupseteq':'\\u2292','squ':'\\u25A1','square':'\\u25A1','Square':'\\u25A1','SquareIntersection':'\\u2293','SquareSubset':'\\u228F','SquareSubsetEqual':'\\u2291','SquareSuperset':'\\u2290','SquareSupersetEqual':'\\u2292','SquareUnion':'\\u2294','squarf':'\\u25AA','squf':'\\u25AA','srarr':'\\u2192','sscr':'\\uD835\\uDCC8','Sscr':'\\uD835\\uDCAE','ssetmn':'\\u2216','ssmile':'\\u2323','sstarf':'\\u22C6','star':'\\u2606','Star':'\\u22C6','starf':'\\u2605','straightepsilon':'\\u03F5','straightphi':'\\u03D5','strns':'\\xAF','sub':'\\u2282','Sub':'\\u22D0','subdot':'\\u2ABD','sube':'\\u2286','subE':'\\u2AC5','subedot':'\\u2AC3','submult':'\\u2AC1','subne':'\\u228A','subnE':'\\u2ACB','subplus':'\\u2ABF','subrarr':'\\u2979','subset':'\\u2282','Subset':'\\u22D0','subseteq':'\\u2286','subseteqq':'\\u2AC5','SubsetEqual':'\\u2286','subsetneq':'\\u228A','subsetneqq':'\\u2ACB','subsim':'\\u2AC7','subsub':'\\u2AD5','subsup':'\\u2AD3','succ':'\\u227B','succapprox':'\\u2AB8','succcurlyeq':'\\u227D','Succeeds':'\\u227B','SucceedsEqual':'\\u2AB0','SucceedsSlantEqual':'\\u227D','SucceedsTilde':'\\u227F','succeq':'\\u2AB0','succnapprox':'\\u2ABA','succneqq':'\\u2AB6','succnsim':'\\u22E9','succsim':'\\u227F','SuchThat':'\\u220B','sum':'\\u2211','Sum':'\\u2211','sung':'\\u266A','sup':'\\u2283','Sup':'\\u22D1','sup1':'\\xB9','sup2':'\\xB2','sup3':'\\xB3','supdot':'\\u2ABE','supdsub':'\\u2AD8','supe':'\\u2287','supE':'\\u2AC6','supedot':'\\u2AC4','Superset':'\\u2283','SupersetEqual':'\\u2287','suphsol':'\\u27C9','suphsub':'\\u2AD7','suplarr':'\\u297B','supmult':'\\u2AC2','supne':'\\u228B','supnE':'\\u2ACC','supplus':'\\u2AC0','supset':'\\u2283','Supset':'\\u22D1','supseteq':'\\u2287','supseteqq':'\\u2AC6','supsetneq':'\\u228B','supsetneqq':'\\u2ACC','supsim':'\\u2AC8','supsub':'\\u2AD4','supsup':'\\u2AD6','swarhk':'\\u2926','swarr':'\\u2199','swArr':'\\u21D9','swarrow':'\\u2199','swnwar':'\\u292A','szlig':'\\xDF','Tab':'\\t','target':'\\u2316','tau':'\\u03C4','Tau':'\\u03A4','tbrk':'\\u23B4','tcaron':'\\u0165','Tcaron':'\\u0164','tcedil':'\\u0163','Tcedil':'\\u0162','tcy':'\\u0442','Tcy':'\\u0422','tdot':'\\u20DB','telrec':'\\u2315','tfr':'\\uD835\\uDD31','Tfr':'\\uD835\\uDD17','there4':'\\u2234','therefore':'\\u2234','Therefore':'\\u2234','theta':'\\u03B8','Theta':'\\u0398','thetasym':'\\u03D1','thetav':'\\u03D1','thickapprox':'\\u2248','thicksim':'\\u223C','ThickSpace':'\\u205F\\u200A','thinsp':'\\u2009','ThinSpace':'\\u2009','thkap':'\\u2248','thksim':'\\u223C','thorn':'\\xFE','THORN':'\\xDE','tilde':'\\u02DC','Tilde':'\\u223C','TildeEqual':'\\u2243','TildeFullEqual':'\\u2245','TildeTilde':'\\u2248','times':'\\xD7','timesb':'\\u22A0','timesbar':'\\u2A31','timesd':'\\u2A30','tint':'\\u222D','toea':'\\u2928','top':'\\u22A4','topbot':'\\u2336','topcir':'\\u2AF1','topf':'\\uD835\\uDD65','Topf':'\\uD835\\uDD4B','topfork':'\\u2ADA','tosa':'\\u2929','tprime':'\\u2034','trade':'\\u2122','TRADE':'\\u2122','triangle':'\\u25B5','triangledown':'\\u25BF','triangleleft':'\\u25C3','trianglelefteq':'\\u22B4','triangleq':'\\u225C','triangleright':'\\u25B9','trianglerighteq':'\\u22B5','tridot':'\\u25EC','trie':'\\u225C','triminus':'\\u2A3A','TripleDot':'\\u20DB','triplus':'\\u2A39','trisb':'\\u29CD','tritime':'\\u2A3B','trpezium':'\\u23E2','tscr':'\\uD835\\uDCC9','Tscr':'\\uD835\\uDCAF','tscy':'\\u0446','TScy':'\\u0426','tshcy':'\\u045B','TSHcy':'\\u040B','tstrok':'\\u0167','Tstrok':'\\u0166','twixt':'\\u226C','twoheadleftarrow':'\\u219E','twoheadrightarrow':'\\u21A0','uacute':'\\xFA','Uacute':'\\xDA','uarr':'\\u2191','uArr':'\\u21D1','Uarr':'\\u219F','Uarrocir':'\\u2949','ubrcy':'\\u045E','Ubrcy':'\\u040E','ubreve':'\\u016D','Ubreve':'\\u016C','ucirc':'\\xFB','Ucirc':'\\xDB','ucy':'\\u0443','Ucy':'\\u0423','udarr':'\\u21C5','udblac':'\\u0171','Udblac':'\\u0170','udhar':'\\u296E','ufisht':'\\u297E','ufr':'\\uD835\\uDD32','Ufr':'\\uD835\\uDD18','ugrave':'\\xF9','Ugrave':'\\xD9','uHar':'\\u2963','uharl':'\\u21BF','uharr':'\\u21BE','uhblk':'\\u2580','ulcorn':'\\u231C','ulcorner':'\\u231C','ulcrop':'\\u230F','ultri':'\\u25F8','umacr':'\\u016B','Umacr':'\\u016A','uml':'\\xA8','UnderBar':'_','UnderBrace':'\\u23DF','UnderBracket':'\\u23B5','UnderParenthesis':'\\u23DD','Union':'\\u22C3','UnionPlus':'\\u228E','uogon':'\\u0173','Uogon':'\\u0172','uopf':'\\uD835\\uDD66','Uopf':'\\uD835\\uDD4C','uparrow':'\\u2191','Uparrow':'\\u21D1','UpArrow':'\\u2191','UpArrowBar':'\\u2912','UpArrowDownArrow':'\\u21C5','updownarrow':'\\u2195','Updownarrow':'\\u21D5','UpDownArrow':'\\u2195','UpEquilibrium':'\\u296E','upharpoonleft':'\\u21BF','upharpoonright':'\\u21BE','uplus':'\\u228E','UpperLeftArrow':'\\u2196','UpperRightArrow':'\\u2197','upsi':'\\u03C5','Upsi':'\\u03D2','upsih':'\\u03D2','upsilon':'\\u03C5','Upsilon':'\\u03A5','UpTee':'\\u22A5','UpTeeArrow':'\\u21A5','upuparrows':'\\u21C8','urcorn':'\\u231D','urcorner':'\\u231D','urcrop':'\\u230E','uring':'\\u016F','Uring':'\\u016E','urtri':'\\u25F9','uscr':'\\uD835\\uDCCA','Uscr':'\\uD835\\uDCB0','utdot':'\\u22F0','utilde':'\\u0169','Utilde':'\\u0168','utri':'\\u25B5','utrif':'\\u25B4','uuarr':'\\u21C8','uuml':'\\xFC','Uuml':'\\xDC','uwangle':'\\u29A7','vangrt':'\\u299C','varepsilon':'\\u03F5','varkappa':'\\u03F0','varnothing':'\\u2205','varphi':'\\u03D5','varpi':'\\u03D6','varpropto':'\\u221D','varr':'\\u2195','vArr':'\\u21D5','varrho':'\\u03F1','varsigma':'\\u03C2','varsubsetneq':'\\u228A\\uFE00','varsubsetneqq':'\\u2ACB\\uFE00','varsupsetneq':'\\u228B\\uFE00','varsupsetneqq':'\\u2ACC\\uFE00','vartheta':'\\u03D1','vartriangleleft':'\\u22B2','vartriangleright':'\\u22B3','vBar':'\\u2AE8','Vbar':'\\u2AEB','vBarv':'\\u2AE9','vcy':'\\u0432','Vcy':'\\u0412','vdash':'\\u22A2','vDash':'\\u22A8','Vdash':'\\u22A9','VDash':'\\u22AB','Vdashl':'\\u2AE6','vee':'\\u2228','Vee':'\\u22C1','veebar':'\\u22BB','veeeq':'\\u225A','vellip':'\\u22EE','verbar':'|','Verbar':'\\u2016','vert':'|','Vert':'\\u2016','VerticalBar':'\\u2223','VerticalLine':'|','VerticalSeparator':'\\u2758','VerticalTilde':'\\u2240','VeryThinSpace':'\\u200A','vfr':'\\uD835\\uDD33','Vfr':'\\uD835\\uDD19','vltri':'\\u22B2','vnsub':'\\u2282\\u20D2','vnsup':'\\u2283\\u20D2','vopf':'\\uD835\\uDD67','Vopf':'\\uD835\\uDD4D','vprop':'\\u221D','vrtri':'\\u22B3','vscr':'\\uD835\\uDCCB','Vscr':'\\uD835\\uDCB1','vsubne':'\\u228A\\uFE00','vsubnE':'\\u2ACB\\uFE00','vsupne':'\\u228B\\uFE00','vsupnE':'\\u2ACC\\uFE00','Vvdash':'\\u22AA','vzigzag':'\\u299A','wcirc':'\\u0175','Wcirc':'\\u0174','wedbar':'\\u2A5F','wedge':'\\u2227','Wedge':'\\u22C0','wedgeq':'\\u2259','weierp':'\\u2118','wfr':'\\uD835\\uDD34','Wfr':'\\uD835\\uDD1A','wopf':'\\uD835\\uDD68','Wopf':'\\uD835\\uDD4E','wp':'\\u2118','wr':'\\u2240','wreath':'\\u2240','wscr':'\\uD835\\uDCCC','Wscr':'\\uD835\\uDCB2','xcap':'\\u22C2','xcirc':'\\u25EF','xcup':'\\u22C3','xdtri':'\\u25BD','xfr':'\\uD835\\uDD35','Xfr':'\\uD835\\uDD1B','xharr':'\\u27F7','xhArr':'\\u27FA','xi':'\\u03BE','Xi':'\\u039E','xlarr':'\\u27F5','xlArr':'\\u27F8','xmap':'\\u27FC','xnis':'\\u22FB','xodot':'\\u2A00','xopf':'\\uD835\\uDD69','Xopf':'\\uD835\\uDD4F','xoplus':'\\u2A01','xotime':'\\u2A02','xrarr':'\\u27F6','xrArr':'\\u27F9','xscr':'\\uD835\\uDCCD','Xscr':'\\uD835\\uDCB3','xsqcup':'\\u2A06','xuplus':'\\u2A04','xutri':'\\u25B3','xvee':'\\u22C1','xwedge':'\\u22C0','yacute':'\\xFD','Yacute':'\\xDD','yacy':'\\u044F','YAcy':'\\u042F','ycirc':'\\u0177','Ycirc':'\\u0176','ycy':'\\u044B','Ycy':'\\u042B','yen':'\\xA5','yfr':'\\uD835\\uDD36','Yfr':'\\uD835\\uDD1C','yicy':'\\u0457','YIcy':'\\u0407','yopf':'\\uD835\\uDD6A','Yopf':'\\uD835\\uDD50','yscr':'\\uD835\\uDCCE','Yscr':'\\uD835\\uDCB4','yucy':'\\u044E','YUcy':'\\u042E','yuml':'\\xFF','Yuml':'\\u0178','zacute':'\\u017A','Zacute':'\\u0179','zcaron':'\\u017E','Zcaron':'\\u017D','zcy':'\\u0437','Zcy':'\\u0417','zdot':'\\u017C','Zdot':'\\u017B','zeetrf':'\\u2128','ZeroWidthSpace':'\\u200B','zeta':'\\u03B6','Zeta':'\\u0396','zfr':'\\uD835\\uDD37','Zfr':'\\u2128','zhcy':'\\u0436','ZHcy':'\\u0416','zigrarr':'\\u21DD','zopf':'\\uD835\\uDD6B','Zopf':'\\u2124','zscr':'\\uD835\\uDCCF','Zscr':'\\uD835\\uDCB5','zwj':'\\u200D','zwnj':'\\u200C'};\n\tvar decodeMapLegacy = {'aacute':'\\xE1','Aacute':'\\xC1','acirc':'\\xE2','Acirc':'\\xC2','acute':'\\xB4','aelig':'\\xE6','AElig':'\\xC6','agrave':'\\xE0','Agrave':'\\xC0','amp':'&','AMP':'&','aring':'\\xE5','Aring':'\\xC5','atilde':'\\xE3','Atilde':'\\xC3','auml':'\\xE4','Auml':'\\xC4','brvbar':'\\xA6','ccedil':'\\xE7','Ccedil':'\\xC7','cedil':'\\xB8','cent':'\\xA2','copy':'\\xA9','COPY':'\\xA9','curren':'\\xA4','deg':'\\xB0','divide':'\\xF7','eacute':'\\xE9','Eacute':'\\xC9','ecirc':'\\xEA','Ecirc':'\\xCA','egrave':'\\xE8','Egrave':'\\xC8','eth':'\\xF0','ETH':'\\xD0','euml':'\\xEB','Euml':'\\xCB','frac12':'\\xBD','frac14':'\\xBC','frac34':'\\xBE','gt':'>','GT':'>','iacute':'\\xED','Iacute':'\\xCD','icirc':'\\xEE','Icirc':'\\xCE','iexcl':'\\xA1','igrave':'\\xEC','Igrave':'\\xCC','iquest':'\\xBF','iuml':'\\xEF','Iuml':'\\xCF','laquo':'\\xAB','lt':'<','LT':'<','macr':'\\xAF','micro':'\\xB5','middot':'\\xB7','nbsp':'\\xA0','not':'\\xAC','ntilde':'\\xF1','Ntilde':'\\xD1','oacute':'\\xF3','Oacute':'\\xD3','ocirc':'\\xF4','Ocirc':'\\xD4','ograve':'\\xF2','Ograve':'\\xD2','ordf':'\\xAA','ordm':'\\xBA','oslash':'\\xF8','Oslash':'\\xD8','otilde':'\\xF5','Otilde':'\\xD5','ouml':'\\xF6','Ouml':'\\xD6','para':'\\xB6','plusmn':'\\xB1','pound':'\\xA3','quot':'\"','QUOT':'\"','raquo':'\\xBB','reg':'\\xAE','REG':'\\xAE','sect':'\\xA7','shy':'\\xAD','sup1':'\\xB9','sup2':'\\xB2','sup3':'\\xB3','szlig':'\\xDF','thorn':'\\xFE','THORN':'\\xDE','times':'\\xD7','uacute':'\\xFA','Uacute':'\\xDA','ucirc':'\\xFB','Ucirc':'\\xDB','ugrave':'\\xF9','Ugrave':'\\xD9','uml':'\\xA8','uuml':'\\xFC','Uuml':'\\xDC','yacute':'\\xFD','Yacute':'\\xDD','yen':'\\xA5','yuml':'\\xFF'};\n\tvar decodeMapNumeric = {'0':'\\uFFFD','128':'\\u20AC','130':'\\u201A','131':'\\u0192','132':'\\u201E','133':'\\u2026','134':'\\u2020','135':'\\u2021','136':'\\u02C6','137':'\\u2030','138':'\\u0160','139':'\\u2039','140':'\\u0152','142':'\\u017D','145':'\\u2018','146':'\\u2019','147':'\\u201C','148':'\\u201D','149':'\\u2022','150':'\\u2013','151':'\\u2014','152':'\\u02DC','153':'\\u2122','154':'\\u0161','155':'\\u203A','156':'\\u0153','158':'\\u017E','159':'\\u0178'};\n\tvar invalidReferenceCodePoints = [1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65000,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111];\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar stringFromCharCode = String.fromCharCode;\n\n\tvar object = {};\n\tvar hasOwnProperty = object.hasOwnProperty;\n\tvar has = function(object, propertyName) {\n\t\treturn hasOwnProperty.call(object, propertyName);\n\t};\n\n\tvar contains = function(array, value) {\n\t\tvar index = -1;\n\t\tvar length = array.length;\n\t\twhile (++index < length) {\n\t\t\tif (array[index] == value) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar merge = function(options, defaults) {\n\t\tif (!options) {\n\t\t\treturn defaults;\n\t\t}\n\t\tvar result = {};\n\t\tvar key;\n\t\tfor (key in defaults) {\n\t\t\t// A `hasOwnProperty` check is not needed here, since only recognized\n\t\t\t// option names are used anyway. Any others are ignored.\n\t\t\tresult[key] = has(options, key) ? options[key] : defaults[key];\n\t\t}\n\t\treturn result;\n\t};\n\n\t// Modified version of `ucs2encode`; see https://mths.be/punycode.\n\tvar codePointToSymbol = function(codePoint, strict) {\n\t\tvar output = '';\n\t\tif ((codePoint >= 0xD800 && codePoint <= 0xDFFF) || codePoint > 0x10FFFF) {\n\t\t\t// See issue #4:\n\t\t\t// Otherwise, if the number is in the range 0xD800 to 0xDFFF or is\n\t\t\t// greater than 0x10FFFF, then this is a parse error. Return a U+FFFD\n\t\t\t// REPLACEMENT CHARACTER.\n\t\t\tif (strict) {\n\t\t\t\tparseError('character reference outside the permissible Unicode range');\n\t\t\t}\n\t\t\treturn '\\uFFFD';\n\t\t}\n\t\tif (has(decodeMapNumeric, codePoint)) {\n\t\t\tif (strict) {\n\t\t\t\tparseError('disallowed character reference');\n\t\t\t}\n\t\t\treturn decodeMapNumeric[codePoint];\n\t\t}\n\t\tif (strict && contains(invalidReferenceCodePoints, codePoint)) {\n\t\t\tparseError('disallowed character reference');\n\t\t}\n\t\tif (codePoint > 0xFFFF) {\n\t\t\tcodePoint -= 0x10000;\n\t\t\toutput += stringFromCharCode(codePoint >>> 10 & 0x3FF | 0xD800);\n\t\t\tcodePoint = 0xDC00 | codePoint & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(codePoint);\n\t\treturn output;\n\t};\n\n\tvar hexEscape = function(codePoint) {\n\t\treturn '&#x' + codePoint.toString(16).toUpperCase() + ';';\n\t};\n\n\tvar decEscape = function(codePoint) {\n\t\treturn '&#' + codePoint + ';';\n\t};\n\n\tvar parseError = function(message) {\n\t\tthrow Error('Parse error: ' + message);\n\t};\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar encode = function(string, options) {\n\t\toptions = merge(options, encode.options);\n\t\tvar strict = options.strict;\n\t\tif (strict && regexInvalidRawCodePoint.test(string)) {\n\t\t\tparseError('forbidden code point');\n\t\t}\n\t\tvar encodeEverything = options.encodeEverything;\n\t\tvar useNamedReferences = options.useNamedReferences;\n\t\tvar allowUnsafeSymbols = options.allowUnsafeSymbols;\n\t\tvar escapeCodePoint = options.decimal ? decEscape : hexEscape;\n\n\t\tvar escapeBmpSymbol = function(symbol) {\n\t\t\treturn escapeCodePoint(symbol.charCodeAt(0));\n\t\t};\n\n\t\tif (encodeEverything) {\n\t\t\t// Encode ASCII symbols.\n\t\t\tstring = string.replace(regexAsciiWhitelist, function(symbol) {\n\t\t\t\t// Use named references if requested & possible.\n\t\t\t\tif (useNamedReferences && has(encodeMap, symbol)) {\n\t\t\t\t\treturn '&' + encodeMap[symbol] + ';';\n\t\t\t\t}\n\t\t\t\treturn escapeBmpSymbol(symbol);\n\t\t\t});\n\t\t\t// Shorten a few escapes that represent two symbols, of which at least one\n\t\t\t// is within the ASCII range.\n\t\t\tif (useNamedReferences) {\n\t\t\t\tstring = string\n\t\t\t\t\t.replace(/&gt;\\u20D2/g, '&nvgt;')\n\t\t\t\t\t.replace(/&lt;\\u20D2/g, '&nvlt;')\n\t\t\t\t\t.replace(/&#x66;&#x6A;/g, '&fjlig;');\n\t\t\t}\n\t\t\t// Encode non-ASCII symbols.\n\t\t\tif (useNamedReferences) {\n\t\t\t\t// Encode non-ASCII symbols that can be replaced with a named reference.\n\t\t\t\tstring = string.replace(regexEncodeNonAscii, function(string) {\n\t\t\t\t\t// Note: there is no need to check `has(encodeMap, string)` here.\n\t\t\t\t\treturn '&' + encodeMap[string] + ';';\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Note: any remaining non-ASCII symbols are handled outside of the `if`.\n\t\t} else if (useNamedReferences) {\n\t\t\t// Apply named character references.\n\t\t\t// Encode `<>\"'&` using named character references.\n\t\t\tif (!allowUnsafeSymbols) {\n\t\t\t\tstring = string.replace(regexEscape, function(string) {\n\t\t\t\t\treturn '&' + encodeMap[string] + ';'; // no need to check `has()` here\n\t\t\t\t});\n\t\t\t}\n\t\t\t// Shorten escapes that represent two symbols, of which at least one is\n\t\t\t// `<>\"'&`.\n\t\t\tstring = string\n\t\t\t\t.replace(/&gt;\\u20D2/g, '&nvgt;')\n\t\t\t\t.replace(/&lt;\\u20D2/g, '&nvlt;');\n\t\t\t// Encode non-ASCII symbols that can be replaced with a named reference.\n\t\t\tstring = string.replace(regexEncodeNonAscii, function(string) {\n\t\t\t\t// Note: there is no need to check `has(encodeMap, string)` here.\n\t\t\t\treturn '&' + encodeMap[string] + ';';\n\t\t\t});\n\t\t} else if (!allowUnsafeSymbols) {\n\t\t\t// Encode `<>\"'&` using hexadecimal escapes, now that theyre not handled\n\t\t\t// using named character references.\n\t\t\tstring = string.replace(regexEscape, escapeBmpSymbol);\n\t\t}\n\t\treturn string\n\t\t\t// Encode astral symbols.\n\t\t\t.replace(regexAstralSymbols, function($0) {\n\t\t\t\t// https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n\t\t\t\tvar high = $0.charCodeAt(0);\n\t\t\t\tvar low = $0.charCodeAt(1);\n\t\t\t\tvar codePoint = (high - 0xD800) * 0x400 + low - 0xDC00 + 0x10000;\n\t\t\t\treturn escapeCodePoint(codePoint);\n\t\t\t})\n\t\t\t// Encode any remaining BMP symbols that are not printable ASCII symbols\n\t\t\t// using a hexadecimal escape.\n\t\t\t.replace(regexBmpWhitelist, escapeBmpSymbol);\n\t};\n\t// Expose default options (so they can be overridden globally).\n\tencode.options = {\n\t\t'allowUnsafeSymbols': false,\n\t\t'encodeEverything': false,\n\t\t'strict': false,\n\t\t'useNamedReferences': false,\n\t\t'decimal' : false\n\t};\n\n\tvar decode = function(html, options) {\n\t\toptions = merge(options, decode.options);\n\t\tvar strict = options.strict;\n\t\tif (strict && regexInvalidEntity.test(html)) {\n\t\t\tparseError('malformed character reference');\n\t\t}\n\t\treturn html.replace(regexDecode, function($0, $1, $2, $3, $4, $5, $6, $7, $8) {\n\t\t\tvar codePoint;\n\t\t\tvar semicolon;\n\t\t\tvar decDigits;\n\t\t\tvar hexDigits;\n\t\t\tvar reference;\n\t\t\tvar next;\n\n\t\t\tif ($1) {\n\t\t\t\treference = $1;\n\t\t\t\t// Note: there is no need to check `has(decodeMap, reference)`.\n\t\t\t\treturn decodeMap[reference];\n\t\t\t}\n\n\t\t\tif ($2) {\n\t\t\t\t// Decode named character references without trailing `;`, e.g. `&amp`.\n\t\t\t\t// This is only a parse error if it gets converted to `&`, or if it is\n\t\t\t\t// followed by `=` in an attribute context.\n\t\t\t\treference = $2;\n\t\t\t\tnext = $3;\n\t\t\t\tif (next && options.isAttributeValue) {\n\t\t\t\t\tif (strict && next == '=') {\n\t\t\t\t\t\tparseError('`&` did not start a character reference');\n\t\t\t\t\t}\n\t\t\t\t\treturn $0;\n\t\t\t\t} else {\n\t\t\t\t\tif (strict) {\n\t\t\t\t\t\tparseError(\n\t\t\t\t\t\t\t'named character reference was not terminated by a semicolon'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t// Note: there is no need to check `has(decodeMapLegacy, reference)`.\n\t\t\t\t\treturn decodeMapLegacy[reference] + (next || '');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ($4) {\n\t\t\t\t// Decode decimal escapes, e.g. `&#119558;`.\n\t\t\t\tdecDigits = $4;\n\t\t\t\tsemicolon = $5;\n\t\t\t\tif (strict && !semicolon) {\n\t\t\t\t\tparseError('character reference was not terminated by a semicolon');\n\t\t\t\t}\n\t\t\t\tcodePoint = parseInt(decDigits, 10);\n\t\t\t\treturn codePointToSymbol(codePoint, strict);\n\t\t\t}\n\n\t\t\tif ($6) {\n\t\t\t\t// Decode hexadecimal escapes, e.g. `&#x1D306;`.\n\t\t\t\thexDigits = $6;\n\t\t\t\tsemicolon = $7;\n\t\t\t\tif (strict && !semicolon) {\n\t\t\t\t\tparseError('character reference was not terminated by a semicolon');\n\t\t\t\t}\n\t\t\t\tcodePoint = parseInt(hexDigits, 16);\n\t\t\t\treturn codePointToSymbol(codePoint, strict);\n\t\t\t}\n\n\t\t\t// If were still here, `if ($7)` is implied; its an ambiguous\n\t\t\t// ampersand for sure. https://mths.be/notes/ambiguous-ampersands\n\t\t\tif (strict) {\n\t\t\t\tparseError(\n\t\t\t\t\t'named character reference was not terminated by a semicolon'\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn $0;\n\t\t});\n\t};\n\t// Expose default options (so they can be overridden globally).\n\tdecode.options = {\n\t\t'isAttributeValue': false,\n\t\t'strict': false\n\t};\n\n\tvar escape = function(string) {\n\t\treturn string.replace(regexEscape, function($0) {\n\t\t\t// Note: there is no need to check `has(escapeMap, $0)` here.\n\t\t\treturn escapeMap[$0];\n\t\t});\n\t};\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar he = {\n\t\t'version': '1.2.0',\n\t\t'encode': encode,\n\t\t'decode': decode,\n\t\t'escape': escape,\n\t\t'unescape': decode\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn he;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = he;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in he) {\n\t\t\t\thas(he, key) && (freeExports[key] = he[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.he = he;\n\t}\n\n}(this));\n"},function(t,e,n){n(0)(n(39))},function(t,e){t.exports="/* global $, ISCROLL_INTERFACE, CONTENT_TRACKING, _, LOCALISER */\n\n(function() {\n  // Create new Accordion\n  var Accordion = gomo.Asset.extend({\n    accordionStatementData: {},\n    notVisitedClassName: 'notVisitedC',\n    visitedClassName: 'visitedC',\n    openedClassName: 'openedC',\n\n    processData: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      me.openAccordionCells = {},\n      rawData.trackingCompletionDelayed = true;\n      _.each(rawData.arrStepData, function(step) {\n        step.formattedTitle = me.formatHTML(step.strTitle);\n        step.formattedContent = me.formatHTML(step.strContent);\n        step.visited = false;\n        step.formattedLabel =\n          gomo.utility.removeMarkup(step.strTitle +\n          ' ' +\n          LOCALISER.get('ACCORDION_UNVISITED_OPTION'));\n      });\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n      if (found) {\n        while (count < rawData.arrStepData.length) {\n          if (found.arrStepData[count]) {\n            found.arrStepData[count].formattedTitle =\n              me.formatHTML(rawData.arrStepData[count].strTitle);\n            found.arrStepData[count].formattedContent =\n              me.formatHTML(rawData.arrStepData[count].strContent);\n            found.arrStepData[count].formattedLabel =\n              rawData.arrStepData[count].visited ?\n                gomo.utility.removeMarkup(found.arrStepData[count].formattedTitle +\n                ' ' +\n                LOCALISER.get('ACCORDION_VISITED_OPTION')) :\n                gomo.utility.removeMarkup(found.arrStepData[count].formattedTitle\n                + ' ' +\n                LOCALISER.get('ACCORDION_UNVISITED_OPTION'));\n          }\n          count++;\n        }\n      }\n    },\n\n    /**\n     * Setup the accordion and tracking before it is shown.\n     */\n    beforeShown: function() {\n      var me = this;\n      var data = me.data;\n\n      // Setup tracking data.\n      me.accordionStatementData[data.strObjID] = {\n        assetType: data.strAssetType,\n        hasOpenTab: false,\n        tabAvailable: new Date(),\n        tabIndex: null\n      };\n\n      // Setup accordion.\n      me.initAccordion();\n    },\n\n    /**\n     * Send tracking data after accordion is hidden.\n     */\n    afterRenderHidden: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = me.data.objRawData;\n      if (\n        typeof(me.accordionStatementData[data.strObjID]) !== 'undefined' &&\n        me.accordionStatementData[data.strObjID].hasOpenTab\n      ) {\n        var currentIndex = me.accordionStatementData[data.strObjID].tabIndex;\n        me.sendAccordionTrackingDataOut(rawData.arrStepData[currentIndex], data.strObjID);\n      }\n    },\n\n    /**\n     * Set up the accordion steps.\n     */\n    initAccordion: function() {\n      var me = this;\n      var data = this.data;\n      var rawData = data.objRawData;\n      me.$el\n        .find('.accordionStepContentWrapperC')\n        .off('hidden.bs.collapse')\n        .on('hidden.bs.collapse', function(e) {\n          me.resetAccordionIscroll();\n          var currentIndex = me.accordionStatementData[data.strObjID].tabIndex;\n          if (currentIndex !== null) {\n            me.sendAccordionTrackingDataOut(rawData.arrStepData[currentIndex], rawData.strID);\n          }\n          $(this)\n            .closest('.accordionAssetWrapperC')\n            .removeClass('accordionAssetOpenC')\n            .addClass('accordionAssetClosedC');\n          // Remove opened class\n          if ($(this).is(e.target)) {\n            $(this)\n              .siblings()\n              .find('.accordionStepTitleC')\n              .removeClass(me.openedClassName)\n              .attr('aria-expanded', false);\n\n            delete me.openAccordionCells[this['id']];\n          }\n        });\n      me.$el\n        .find('.accordionStepContentWrapperC')\n        .off('shown.bs.collapse')\n        .on('shown.bs.collapse', function(e) {\n          me.resetAccordionIscroll();\n          $(this)\n            .closest('.accordionAssetWrapperC')\n            .removeClass('accordionAssetClosedC')\n            .addClass('accordionAssetOpenC');\n          if ($(this).is(e.target)) {\n            // Get the title so we can use it for an aria-label.\n            var stepTitle = $.trim($(this).siblings().find('.accordionStepTitleC').text());\n            $(this)\n              .siblings()\n              .find('.accordionStepTitleC')\n              .removeClass(me.notVisitedClassName)\n              .addClass(me.visitedClassName + ' ' + me.openedClassName)\n              .attr('aria-expanded', true)\n              .attr(\n                'aria-label',\n                gomo.utility.removeMarkup(stepTitle +\n                ' ' +\n                LOCALISER.get('ACCORDION_VISITED_OPTION'))\n              );\n            me.openAccordionCells[this['id']] = this;\n          }\n          me.accordionStatementData[data.strObjID].tabIndex = $(this).parent().index();\n          me.accordionStatementData[data.strObjID].tabAvailable = new Date();\n          me.accordionStatementData[data.strObjID].hasOpenTab = true;\n          var currentIndex = me.accordionStatementData[data.strObjID].tabIndex;\n          if (currentIndex !== null) {\n            me.sendAccordionTrackingDataIn(rawData.arrStepData[currentIndex], rawData.strID);\n            // Update visited state so aria attributes are correct.\n            rawData.arrStepData[currentIndex].visited = true;\n          }\n          gomo.eventManager.legacy('screenAssetInteracting', data);\n        });\n    },\n\n    /**\n     * Reset the accordion iscroll.\n     */\n    resetAccordionIscroll: function() {\n      if (ISCROLL_INTERFACE) {\n        ISCROLL_INTERFACE.refreshIScrolls();\n      }\n    },\n\n    /**\n     * Reset the accordion.\n     */\n    reset: function() {\n      var me = this;\n      var stepData = me.data.objRawData.arrStepData;\n      for (var strDomId in me.openAccordionCells) {\n        if (Object.prototype.hasOwnProperty.call(me.openAccordionCells, strDomId)) {\n          $(me.openAccordionCells[strDomId])\n            .collapse('hide')\n            .parent()\n            .find('.accordionStepTitleC')\n            .addClass('collapsed');\n        }\n      }\n      while (typeof me.$el.find('.' + me.visitedClassName)[0] != 'undefined') {\n        var domCurrentVisited = me.$el.find('.' + me.visitedClassName)[0];\n        var stepTitle = $.trim($(domCurrentVisited).text());\n        $(domCurrentVisited)\n          .addClass(me.notVisitedClassName)\n          .removeClass(me.visitedClassName)\n          .attr(\n            'aria-label',\n            gomo.utility.removeMarkup(stepTitle +\n            ' ' +\n            LOCALISER.get('ACCORDION_UNVISITED_OPTION'))\n          );\n      }\n      // Reset visited state data for each step.\n      if (stepData.length) {\n        var stepCount = 0;\n        while (stepCount < stepData.length) {\n          stepData[stepCount].visited = false;\n          stepCount++;\n        }\n      }\n    },\n\n    /**\n     * Is the accordion a completable asset.\n     * @return {boolean}\n     */\n    isCompletable: function() {\n      return true;\n    },\n\n    /**\n     * Is the accordion asset complete.\n     * @return {boolean}\n     */\n    isComplete: function() {\n      var me = this;\n      var completed = true;\n      if (me.$el.find('.' + me.notVisitedClassName)[0]) {\n        completed = false;\n      }\n      return completed;\n    },\n\n    /**\n     * Returns all accesible parts of the accordion asset for the tab manager to apply tab indexes.\n     * @return {boolean}\n     */\n    getAccessibleElements: function() {\n      var accessibleElements = ['.accordionStepTitleC'];\n      return accessibleElements;\n    },\n\n    /**\n     * Send tracking data when an accordion subscreen is opened.\n     * @param {object} data\n     * @param {string} assetId\n     */\n    sendAccordionTrackingDataIn: function(data, assetId) {\n      var me = this;\n      CONTENT_TRACKING.interaction({\n        type: 'experienced',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: me.accordionStatementData[assetId].assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n      me.accordionStatementData[assetId].hasOpenTab = true;\n    },\n\n    /**\n     * Send tracking data when an accordion subscreen is closed.\n     * @param {object} data\n     * @param {string} assetId\n     */\n    sendAccordionTrackingDataOut: function(data, assetId) {\n      var me = this;\n      var tabAvailable = me.accordionStatementData[assetId].tabAvailable;\n      CONTENT_TRACKING.interaction({\n        type: 'left',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        response: {\n          timeAvailable: tabAvailable,\n          timeResponse: new Date()\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: me.accordionStatementData[assetId].assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n      me.accordionStatementData[assetId].hasOpenTab = false;\n    }\n  });\n\n  // Register the asset.\n  gomo.assetManager.register('accordion', Accordion);\n})();\n"},function(t,e,n){n(0)(n(41))},function(t,e){t.exports="/* globals $ */\n(function() {\n  // Create new Button\n  var Button = gomo.Asset.extend({\n\n    /**\n     * Perform any data processing prior to button rendering.\n     */\n    processData: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      // Decode icon image source.\n      if (rawData.objIconImageFilename.strSrc) {\n        rawData.objIconImageFilename.decodedSrc = decodeURIComponent(\n          rawData.objIconImageFilename.strSrc\n        );\n\n        rawData.objIconImageFilename.decodedSrc =\n          gomo.utility.getSrcPath(rawData.objIconImageFilename.decodedSrc) +\n          rawData.objIconImageFilename.decodedSrc;\n      }\n      // Set the correct button classname. These are hard coded in the manifest unfortunately so\n      // need to remain or old courses with buttons have no type and incorrect styling.\n      rawData.buttonStyle = '';\n      switch (rawData.strButtonType) {\n        case 'dropdownValue2':\n        case 'btn-warning':\n          rawData.buttonStyle = 'btn-warning';\n          break;\n        case 'dropdownValue3':\n        case 'btn-danger':\n          rawData.buttonStyle = 'btn-danger';\n          break;\n        case 'dropdownValue4':\n        case 'btn-large':\n          rawData.buttonStyle = 'btn-large';\n          break;\n      }\n      // Format the label.\n      rawData.formattedLabel = me.formatHTML(rawData.strLabel);\n      // Set button enabled classname.\n      rawData.enabledClassname = '';\n      if (rawData.arrActions && rawData.arrActions.length) {\n        rawData.enabledClassname = me.checkEnabledState(rawData) ? '' : 'disableInteractions';\n      }\n    },\n\n    /**\n     * Perform any actions needed before the button is shown.\n     */\n    beforeShown: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      // Add aria attribute for accessibility.\n      if (gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n        me.$el\n          .find('.buttonC')\n          .attr('aria-haspopup', 'dialog');\n      }\n    },\n\n    /**\n     * Triggered when the asset is hidden\n     */\n    translationProcessOnHidden: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      /*\n      * We need to run translation preprocess here as we may have\n      * switched language while the asset was hidden by display conditions.\n      */\n      rawData.formattedLabel = me.formatHTML(rawData.strLabel);\n    },\n\n    /**\n     * Update the button on translation.\n     */\n    translationPreprocess: function() {\n      var me = this;\n      var data = me.data;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n\n      if (found) {\n        me.updateButtonAlignment(found);\n        var formatLabel = me.formatHTML(found.strLabel);\n        found.formattedLabel = formatLabel;\n        me.data.objRawData.formattedLabel = formatLabel;\n        gomo.translationManager.setImage(data.strObjID, 'objIconImageFilename');\n      }\n    },\n\n    /**\n     * Update the button alignment class.\n     * @param {Object} updateData\n     */\n    updateButtonAlignment: function(updateData) {\n      var me = this;\n      if (updateData.strAlignment) {\n        me.$el\n          .find('.buttonAssetWrapperC')\n          .removeClass('left-alignC right-alignC centre-alignC image-fit-to-widthC fit-to-widthC')\n          .addClass(updateData.strAlignment + 'C');\n      }\n    },\n\n    /**\n     * Register the button click event.\n     */\n    registerEvents: function() {\n      var me = this;\n      me.events = {\n        'click .buttonC': 'buttonAction'\n      };\n    },\n\n    /**\n     * Is the button a completable asset.\n     * @return {boolean}\n     */\n    isCompletable: function() {\n      return true;\n    },\n\n    /**\n     * Is the button asset complete.\n     * @return {boolean}\n     */\n    isComplete: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var completed = false;\n      if (rawData.booClicked) {\n        completed = true;\n      }\n      return completed;\n    },\n\n    /**\n     * Apply focus to the button.\n     */\n    returnFocusToSelf: function() {\n      var me = this;\n      me.$el.focus();\n    },\n\n    /**\n     * Returns all accesible parts of the button asset for the tab manager to apply tab indexes.\n     * @return {boolean}\n     */\n    getAccessibleElements: function() {\n      var accessibleElements = ['.buttonC'];\n      return accessibleElements;\n    },\n\n    /**\n     * When the button is clicked trigger its action(s).\n     */\n    buttonAction: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = me.data.objRawData;\n      var actionOptions = {\n        objActions: rawData.arrActions,\n        objOptionalExtraData: data\n      };\n      actionOptions.objOptionalExtraData.strAssetID = data.strObjID,\n      actionOptions.objOptionalExtraData.domLink = me.$el.find('.buttonC');\n\n      rawData.booClicked = true;\n\n      gomo.eventManager.legacy('screenAssetInteracting', data);\n      gomo.eventManager.legacy('processActions', actionOptions);\n    },\n\n    /**\n     * Switch enabled state of the button.\n     * @param {Object} assetData\n     * @param {Boolean} enabled\n     */\n    switchState: function(assetData, enabled) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      rawData.enabledClassname = enabled ? '' : 'disableInteractions';\n      $('#buttonAsset_YY' + assetData.strID + 'YY_WrapperL')\n        .find('.buttonC')\n        .toggleClass('disableInteractions', !enabled);\n    }\n  });\n\n  // Register the asset.\n  gomo.assetManager.register('button', Button);\n})();\n"},function(t,e,n){n(0)(n(43))},function(t,e){t.exports="/* globals _, SWIPE_CONTROL, ISCROLL_INTERFACE, CONTENT_TRACKING, SCREEN_INTERACTIONS */\n(function() {\n  // Create new Carousel\n  var Carousel = gomo.Asset.extend({\n    carousels: {},\n    carouselOptions: {\n      navigation: true,\n      navigationText: [\n        gomo.localiser.get('CAROUSEL_PREVIOUS_BUTTON'),\n        gomo.localiser.get('CAROUSEL_NEXT_BUTTON')\n      ],\n      slideSpeed: 300,\n      paginationSpeed: 400,\n      singleItem: true,\n      addClassActive: true\n    },\n    carouselStatementData: {},\n\n    /**\n     * Perform any data processing prior to button rendering.\n     */\n    processData: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      rawData.trackingCompletionDelayed = true;\n      // Set visibility classes for each step.\n      _.each(rawData.arrStepData, function(step) {\n        step.titleVisibilityClass = '';\n        step.contentVisibilityClass = '';\n        if (!step.strTitle.length) {\n          step.titleVisibilityClass = 'hiddenElementC';\n        }\n        if (!step.strContent.length) {\n          step.contentVisibilityClass = 'hiddenElementC';\n        }\n        // Sanitise the data\n        step.objStepSrc.formattedStrAltText = me.convertStringQuote(step.objStepSrc.strAltText);\n        step.formattedStrTitle = me.formatHTML(step.strTitle);\n        step.formattedStrContent = me.formatHTML(step.strContent);\n      });\n    },\n\n    /**\n     * Perform any actions prior to topic load.\n     */\n    preloadTopic: function() {\n      var me = this;\n\n      me.hardResetCarouselAsset();\n    },\n\n    /**\n     * Update the carousel before translation.\n     */\n    translationPreprocess: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var pathToArray = 'arrStepData';\n      var pathToImage = 'objStepSrc';\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n\n      if (found && found.arrStepData.length) {\n        _.each(found.arrStepData, function(step, i) {\n          step.formattedStrTitle = me.formatHTML(rawData.arrStepData[i].strTitle);\n          step.formattedStrContent = me.formatHTML(rawData.arrStepData[i].strContent);\n        });\n      }\n      gomo.translationManager.setArrayOfImages(me.id, pathToArray, pathToImage);\n\n      me.carouselOptions.navigationText = [\n        gomo.localiser.get('CAROUSEL_PREVIOUS_BUTTON'),\n        gomo.localiser.get('CAROUSEL_NEXT_BUTTON')\n      ];\n    },\n\n    /**\n     * Update the carousel after translation.\n     */\n    translationPostprocess: function() {\n      var me = this;\n      if (me.$el) {\n        me.$el.find('.owl-prev').html(gomo.localiser.get('CAROUSEL_PREVIOUS_BUTTON'));\n        me.$el.find('.owl-next').html(gomo.localiser.get('CAROUSEL_NEXT_BUTTON'));\n      }\n    },\n\n    /**\n     * Setup the carousel and tracking before it is shown.\n     */\n    beforeShown: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var stepsData = rawData.arrStepData;\n      var domCarousel = me.$el.find('.carouselAssetWrapperC');\n\n      me.carouselOptions.navigationText = [\n        gomo.localiser.get('CAROUSEL_PREVIOUS_BUTTON'),\n        gomo.localiser.get('CAROUSEL_NEXT_BUTTON')\n      ];\n\n      me.carouselOptions.afterMove = function() {\n        me.carouselMoved();\n      };\n\n      domCarousel.owlCarousel(me.carouselOptions);\n      me.carousels[rawData.strID] = domCarousel.data('owlCarousel');\n\n      if (typeof SWIPE_CONTROL != 'undefined') {\n        SWIPE_CONTROL.disableSwipingOnElementClassname('carouselStepImageAssetC');\n      }\n      me.carouselStatementData[data.strObjID] = {\n        slideAvailable: new Date(),\n        slideIndex: 0\n      };\n\n      me.sendCarouselSlideTrackingDataIn(stepsData[0], rawData.strID, rawData.strType);\n    },\n\n    /**\n     * Perform any actions after carousel render.\n     */\n    afterRenderShown: function() {\n      ISCROLL_INTERFACE.refreshIScrolls();\n    },\n\n    /**\n     * Perform any actions after carousel is hidden.\n     */\n    afterRenderHidden: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var stepsData = rawData.arrStepData;\n      var currentIndex = me.carouselStatementData[data.strObjID].slideIndex;\n\n      me.sendCarouselSlideTrackingDataOut(\n        stepsData[currentIndex],\n        rawData.strID,\n        rawData.strType\n      );\n    },\n\n    /**\n     * Perform actions when carousel step is changed.\n     */\n    carouselMoved: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var stepsData = rawData.arrStepData;\n      var domCarousel = me.$el.find('.owl-item');\n      var lastArrayPosition = domCarousel.length - 1;\n      var currentIndex = me.carouselStatementData[data.strObjID].slideIndex;\n      var newIndex = me.carouselStatementData[data.strObjID].slideIndex;\n\n      if (domCarousel[lastArrayPosition].className.indexOf('active') >= 0) {\n        me.carousels[data.strObjID].booComplete = true;\n      }\n\n      var domCurrScreenLayer = SCREEN_INTERACTIONS.getShownScreenElement();\n      if (domCurrScreenLayer) {\n        gomo.eventManager.legacy('screenAssetInteracting', data);\n      }\n      me.sendCarouselSlideTrackingDataOut(stepsData[currentIndex], rawData.strID, rawData.strType);\n      me.carouselStatementData[data.strObjID].slideIndex = me.$el.find('.owl-item.active').index();\n      me.carouselStatementData[data.strObjID].slideAvailable = new Date();\n      me.sendCarouselSlideTrackingDataIn(stepsData[newIndex], rawData.strID, rawData.strType);\n    },\n\n    /**\n     * Reset carousel asset.\n     */\n    reset: function() {\n      var me = this;\n      var data = me.data;\n\n      if (me.carousels[data.strObjID]) {\n        me.carousels[data.strObjID].booComplete = false;\n        var domCarousel = me.$el.find('.carouselAssetWrapperC');\n        domCarousel.trigger('owl.jumpTo', 0);\n      }\n    },\n\n    /**\n     * Hard reset carsouel asset.\n     */\n    hardResetCarouselAsset: function() {\n      var me = this;\n\n      me.carousels = {};\n    },\n\n    /**\n     * Is the carousel a completable asset.\n     * @return {boolean}\n     */\n    isCompletable: function() {\n      return true;\n    },\n\n    /**\n     * Is the carousel asset complete.\n     * @return {boolean}\n     */\n    isComplete: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var completed = false;\n\n      if (me.carousels && me.carousels[rawData.strID]) {\n        completed = me.carousels[rawData.strID].booComplete ? true : false;\n      }\n      return completed;\n    },\n\n    /**\n     * Returns all accesible parts of the accordion asset for the tab manager to apply tab indexes.\n     * @return {array}\n     */\n    getAccessibleElements: function() {\n      // Not tabbable without major modification.\n      var accessibleElements = [];\n      return accessibleElements;\n    },\n\n    /**\n     * Send tracking data when a carousel step is opened.\n     * @param {object} data\n     * @param {string} assetId\n     * @param {string} assetType\n     */\n    sendCarouselSlideTrackingDataIn: function(data, assetId, assetType) {\n      CONTENT_TRACKING.interaction({\n        type: 'experienced',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n    },\n\n    /**\n     * Send tracking data when a carousel step is closed.\n     * @param {object} data\n     * @param {string} assetId\n     * @param {string} assetType\n     */\n    sendCarouselSlideTrackingDataOut: function(data, assetId, assetType) {\n      var me = this;\n      var slideAvailable = me.carouselStatementData[assetId].slideAvailable;\n\n      CONTENT_TRACKING.interaction({\n        type: 'left',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        response: {\n          timeAvailable: slideAvailable,\n          timeResponse: new Date()\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n    }\n  });\n\n  // Register the asset.\n  gomo.assetManager.register('carousel', Carousel);\n})();\n"},function(t,e,n){n(0)(n(45))},function(t,e){t.exports="/* globals ASSET_RENDERER, MANIFEST_MANAGER, TEMPLATE_MANANGER, OUTPUT_MODE_CHECKER, Animator,\n ASSET_INTERACTIONS, MASTER_RENDERER, OBJ_REF, SUB_SCREEN_RENDERER, O_EXTENDER, CORE, EM,\n CSSStyleSubject, TOPIC_STRUCTURE_PARSER, $, _, SCREEN_INTERACTIONS, ISCROLL_INTERFACE,\n SUB_SCREEN_INTERACTIONS, CONTENT_TRACKING */\n\n/**\n * @title Comicstrip asset extension collection\n * @description Provides 'comicstrip' functionality, which displays a series of\n * cropped images, expanding out to full size on click, and displaying subscreen\n *\n * @author Paul Stanyer\n * @version 2.0 11/07/12\n * @ Refactor note: This file still makes extensive use of non-coding standard variable names,\n * despite being converted away from the old style @variablename data shape. It would be ideal to\n * re-write/refactor to be inline with standards.\n */\n\nASSET_RENDERER.addAssetSupportData('comicstrip', {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n});\n\nvar COMICSTRIP_ASSET_RENDERER = {\n  strObjID: 'The comicstrip asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['comicstrip', 'comicstripAssetTemplateWrapperC']],\n  // _arrSubAssetHTMLTemplateIDs : [[\"comicstripCell\",\"comicstripCellWrapperC\"]],\n\n  _objSubscreens: {},\n  _objComicStripRowClassNames: {\n    '1': 'comicStripOnlyRowC',\n    '2': 'comicStripTopRowC',\n    '3': 'comicStripBottomRowC',\n    '4': 'comicStripMiddleRowC'\n  },\n  _objComicStripCellClassNames: {\n    '1': 'comicStripOnlyCellC',\n    '2': 'comicStripFirstCellC',\n    '3': 'comicStripLastCellC',\n    '4': 'comicStripMiddleCellC'\n  },\n\n  _objDomWrappers: {},\n  _objAssetManifest: MANIFEST_MANAGER.getAssetManifest('asset-comic-strip'),\n\n  arrTempComicStripAssetData: [],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_comicstrip_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n    _objWhatAssetCourseObject.trackingCompletionDelayed = true;\n\n    if (_objWhatAssetCourseObject.objRawData.booFullscreen == false) {\n      var _objAssetContent = {};\n      _objAssetContent.htmAssetContent = this._renderComicstripContainer(\n        _objWhatAssetCourseObject,\n        _booPreviewMode\n      );\n      _objAssetContent.htmAssetContent = _objAssetContent.htmAssetContent.replace(\n        /XX_FLOW_CLASS_XX/,\n        'comicstripAssetWrapperC'\n      );\n      return _objAssetContent;\n    }\n    return '';\n  },\n\n  _renderComicstripContainer: function(\n    _objWhatAssetCourseObject,\n    _booPreviewMode\n  ) {\n    // get a ref to the incoming raw data\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    // create a hash of subscreens\n    this._createSubscreenObj(_objWhatAssetCourseObject);\n\n    // Get template HTML segment\n    var _htmReturnData = TEMPLATE_MANANGER.getTemplate(\n      'comicstripAssetTemplateWrapperC',\n      _objWhatAssetCourseObject.strComicStripOutputMode\n    ).htmData;\n    this._objDomWrappers[_objWhatRawAssetData.strID] = this._replaceAssetID(\n      false,\n      'XX_ASSET_ID_XX',\n      _objWhatRawAssetData.strID\n    );\n\n    // Set the strBoundaryId\n    var _strAssetDOMID = this.getAssetDOMId(_objWhatRawAssetData);\n    OUTPUT_MODE_CHECKER.setNewScreenSizeBoundary({\n      objRawAssetData: _objWhatAssetCourseObject.objRawData,\n      strDomId: _strAssetDOMID\n    });\n\n    _objWhatAssetCourseObject.strComicStripLayoutMode =\n      OUTPUT_MODE_CHECKER.objScreenSizeBoundaries[\n        _objWhatRawAssetData.strBoundaryId\n      ].strCurrentLayoutSize;\n\n    // Smartphone HTML, JS and CSS doesn't support large mode\n    if (OUTPUT_MODE_CHECKER.isSmartPhone()) {\n      _objWhatAssetCourseObject.strComicStripLayoutMode = OUTPUT_MODE_CHECKER.strScreenSizeSmall;\n    }\n\n    // Render cells\n    _htmReturnData = _htmReturnData.replace(\n      /XX_COMICSTRIP_CELLS_XX/,\n      this._renderComicstripCells(\n        _objWhatRawAssetData['rows'],\n        _objWhatAssetCourseObject\n      )\n    );\n\n    // Replace Asset ID\n    _htmReturnData = this._replaceAssetID(\n      _booPreviewMode,\n      _htmReturnData,\n      _objWhatRawAssetData['strID']\n    );\n\n    // Return our built HTML\n    return _htmReturnData;\n  },\n\n  resetComicstripRender: function() {\n    this._objDomWrappers = {};\n    this.arrTempComicStripAssetData = [];\n  },\n\n  _rerenderSetup_comicstrip_Asset: function(_objWhatAssetData) {\n    var _objWhatRawAssetData = _objWhatAssetData.objRawData;\n\n    var _strReturnOutputMode = 'large';\n    var _intLargestImage = 0;\n    // Additional width is a bit of an arbitrary number which allows room for asset padding etc...\n    var _intAdditionalScreenWidth = this._objAssetManifest.objPlayerDeclarations\n      .objCustomThemeElements.intAdditionalScreenWidth;\n\n    for (var i = 0; i < _objWhatRawAssetData.arrCells.length; i++) {\n      if (\n        _objWhatRawAssetData.arrCells[i]['strExpandedWidth'] >\n        window.innerWidth - _intAdditionalScreenWidth\n      ) {\n        _strReturnOutputMode = 'small';\n      }\n      if (\n        _intLargestImage == 0 ||\n        _intLargestImage <\n          _objWhatRawAssetData.arrCells[i]['strExpandedWidth'] +\n            _intAdditionalScreenWidth\n      ) {\n        _intLargestImage =\n          _objWhatRawAssetData.arrCells[i]['strExpandedWidth'] +\n          _intAdditionalScreenWidth;\n      }\n    }\n\n    var _funCallBack = function() {\n      ASSET_RENDERER.rerenderComicstrips(_objWhatAssetData);\n    };\n    if (_objWhatRawAssetData.booComicStripOutputModeSet == true) {\n      // Mode has already been setup\n    } else {\n      _objWhatRawAssetData.booComicStripOutputModeSet = true;\n      var _strAssetDOMID = this.getAssetDOMId(_objWhatRawAssetData);\n      OUTPUT_MODE_CHECKER.setNewScreenSizeBoundary({\n        objRawAssetData: _objWhatRawAssetData,\n        strDomId: _strAssetDOMID,\n        intLargeScreenMin: _intLargestImage,\n        intSmallScreenMax: _intLargestImage - 1,\n        funCallBack: _funCallBack\n      });\n    }\n\n    _objWhatAssetData.strOutputMode = _strReturnOutputMode;\n  },\n\n  rerenderComicstrips: function(_objWhatAssetData, booForceRerender) {\n    this._rerenderComicstrip(_objWhatAssetData, booForceRerender);\n  },\n\n  _rerenderComicstrip: function(_objAssetData, booForceRerender) {\n    if (\n      typeof _objAssetData.booComicstripRendering == 'undefined' ||\n      _objAssetData.booComicstripRendering == false ||\n      booForceRerender == true\n    ) {\n      _objAssetData.booComicstripRendering = true;\n      var booForceReset = true;\n      ASSET_INTERACTIONS.resetComicstrip(_objAssetData, booForceReset);\n\n      var _objWhatRawAssetData = _objAssetData.objRawData;\n      if (\n        this._objDomWrappers[_objWhatRawAssetData.strID] &&\n        _objAssetData.booIsDisplayed\n      ) {\n        var _domCurrentAsset = this.getAssetDOMElement(_objWhatRawAssetData);\n\n        if (_domCurrentAsset) {\n          // Render cells\n          var _objRenderData = {};\n          _objRenderData.objWhatAssetCourseObject = _objAssetData;\n          _objRenderData.booPreviewMode = false;\n\n          var _objAssetContent = this._render_comicstrip_Asset(_objRenderData);\n          _domCurrentAsset.outerHTML = _objAssetContent.htmAssetContent;\n          this.arrTempComicStripAssetData.push(_objAssetData);\n          // Don't PostRender on a Forced Rerender. This will cause an infinit loop. This needs\n          // reworking but this deprecated asset will be replaced soon.\n          if (!booForceRerender) {\n            ASSET_RENDERER.comicStripPostRender();\n          }\n\n          // Set the asset and default boundaries before using them\n          OUTPUT_MODE_CHECKER.manualScreenSizeCheck();\n          var forcedModeSize = OUTPUT_MODE_CHECKER.objScreenSizeBoundaries[\n            _objWhatRawAssetData.strBoundaryId\n          ].strCurrentLayoutSize;\n\n          // Smartphone HTML, JS and CSS doesn't support large mode\n          if (OUTPUT_MODE_CHECKER.isSmartPhone()) {\n            forcedModeSize = OUTPUT_MODE_CHECKER.strScreenSizeSmall;\n          }\n          this.resetAssetWrapperForcedMode(_objAssetData.objRawData, forcedModeSize);\n\n          // Reregister the new asset with the\n          gomo.translationManager.rebindDataToElement(\n            _objWhatRawAssetData.strID,\n            _objWhatRawAssetData.strID,\n            _domCurrentAsset.id\n          );\n        }\n      }\n    }\n  },\n\n  comicStripPostRender: function() {\n    var count = 0;\n    while (count < this.arrTempComicStripAssetData.length) {\n      var _objAssetData = ASSET_RENDERER.arrTempComicStripAssetData[count];\n\n      ASSET_INTERACTIONS.showPostRenderAsset(_objAssetData);\n      _objAssetData.booComicstripRendering = false;\n\n      count++;\n    }\n  },\n\n  _replaceAssetID: function(_booPreviewMode, _htmReturnData, _strId) {\n    if (_booPreviewMode) {\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _strId + 'YYPreview'\n      );\n    } else {\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _strId + 'YY'\n      );\n    }\n    return _htmReturnData;\n  },\n\n  _renderComicstripCells: function(_arrRows, _objAssetData) {\n    var _htmAllCells = '';\n    var _intCell = 0;\n    var _strCellClass;\n    var _strCellPlacementClass;\n\n    for (var _intRow = 0; _intRow < _arrRows.length; _intRow++) {\n      var _strRowClass = this._objComicStripRowClassNames[\n        this._comicstrip_calculateClassIndex(_intRow, _arrRows.length)\n      ];\n      var _arrRowCells = _arrRows[_intRow];\n      for (var _intCol = 0; _intCol < _arrRowCells.length; _intCol++) {\n        _intCell++;\n        _strCellClass = '';\n        _strCellPlacementClass =\n          _strRowClass +\n          ' ' +\n          this._objComicStripCellClassNames[\n            this._comicstrip_calculateClassIndex(_intCol, _arrRowCells.length)\n          ];\n        _strCellClass += 'comicstripCellC comicStripCell_' + _intCell + '_C';\n        var _objCell = _arrRowCells[_intCol];\n        _htmAllCells += this._renderSingleCell(\n          _objCell,\n          _strCellClass,\n          _strCellPlacementClass,\n          _objAssetData\n        );\n      }\n    }\n    return _htmAllCells;\n  },\n\n  _renderSingleCell: function(\n    _objCell,\n    _strClass,\n    _strPlacementClass,\n    _objAssetData\n  ) {\n    var _htmCell = TEMPLATE_MANANGER.getTemplate(\n      'comicstripCellWrapperC',\n      _objAssetData.strComicStripLayoutMode\n    ).htmData;\n\n    _htmCell = _htmCell.replace(\n      /XX_ASSET_ID_XX/g,\n      _objAssetData.objRawData.strID\n    );\n    _htmCell = _htmCell.replace(/XX_CELL_ID_XX/g, _objCell['strID']);\n    _htmCell = _htmCell.replace(/XX_COMICSTRIP_CELL_CLASS_XX/, _strClass);\n    _htmCell = _htmCell.replace(/XX_CELL_PLACEMENT_XX/g, _strPlacementClass);\n    _htmCell = _htmCell.replace(\n      /resources\\/trans.gif\\?/,\n      gomo.utility.getSrcPath(_objCell.objImageSrc.strSrc)\n    );\n    _htmCell = _htmCell.replace(\n      /XX_CELL_SRC_XX/,\n      decodeURIComponent(_objCell.objImageSrc.strSrc)\n    );\n    _htmCell = _htmCell.replace(\n      /XX_ALTTEXT_XX/,\n      decodeURIComponent(_objCell.objImageSrc.strAltText)\n    );\n    _htmCell = _htmCell.replace(/XX_CS_COL_XX/g, _objCell['intColumnIndex']);\n    _htmCell = _htmCell.replace(/XX_CS_ROW_XX/g, _objCell.strRow);\n\n    if (\n      _objCell.arrActions[0] &&\n      _objCell.arrActions[0].objParameters &&\n      _objCell.arrActions[0].objParameters.strSubScreenID\n    ) {\n      _htmCell = _htmCell.replace(\n        /XX_SUBSCREEN_XX/,\n        this._renderComicstripSubscreen(\n          _objCell.arrActions[0].objParameters.strSubScreenID\n        )\n      );\n    } else {\n      _htmCell = _htmCell.replace(/XX_SUBSCREEN_XX/, '');\n    }\n\n    _htmCell = _htmCell.replace(/XX_ARR_NUM_XX/g, _objCell['intCellNum'] - 1);\n    _htmCell = _htmCell.replace(/XX_CELL_NUM_XX/g, _objCell['intCellNum']);\n    return _htmCell;\n  },\n\n  _comicstrip_calculateClassIndex: function(_intCurrent, _intLength) {\n    if (_intCurrent == _intLength - 1 && _intCurrent == 0) {\n      return '1';\n    } else if (_intCurrent == 0) {\n      return '2';\n    } else if (_intCurrent == _intLength - 1) {\n      return '3';\n    }\n    return '4';\n  },\n\n  _createSubscreenObj: function(_objWhatAssetCourseObject) {\n    for (\n      var _i = 0;\n      _i < _objWhatAssetCourseObject.objRawData.arrCells.length;\n      _i++\n    ) {\n      var _objCurrCell = _objWhatAssetCourseObject.objRawData.arrCells[_i];\n      if (\n        _objCurrCell.arrActions.length > 0 &&\n        _objCurrCell.arrActions[0].objParameters &&\n        _objCurrCell.arrActions[0].objParameters.strSubScreenID\n      ) {\n        var _strSubScreenID =\n          _objCurrCell.arrActions[0].objParameters.strSubScreenID;\n        this._objSubscreens[_strSubScreenID] = OBJ_REF.get(_strSubScreenID);\n      }\n    }\n  },\n\n  _renderComicstripSubscreen: function(_strSubscreenId) {\n    if (this._objSubscreens[_strSubscreenId]) {\n      return SUB_SCREEN_RENDERER.renderSubScreen(\n        this._objSubscreens[_strSubscreenId],\n        'comicstrip'\n      );\n    }\n    return '';\n  },\n\n  _comicstrip_checkSubScreenForRender: function() {\n    return false;\n  },\n\n  _comicstrip_renderNonColumnAsset: function(\n    _objWhatAssetCourseObject,\n    _booPreviewMode\n  ) {\n    if (_objWhatAssetCourseObject.objRawData.booFullscreen == true) {\n      var _htmContent = this._renderComicstripContainer(\n        _objWhatAssetCourseObject,\n        _booPreviewMode\n      );\n      return _htmContent.replace(\n        /XX_FLOW_CLASS_XX/,\n        'comicstripNonColumnAssetWrapperC'\n      );\n    }\n    return '';\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, COMICSTRIP_ASSET_RENDERER);\n\n/**\n * Simple class to manage cell animations per comic strip\n *\n * This class then gets extended by a specific animator to handle the\n * different types (currently: popup crop, deform crop, scale)\n * @param {object} _objAsset - The asset object.\n * @param {boolean} _booImageOffset - The image offset.\n */\nfunction ComicstripAnimator(_objAsset, _booImageOffset) {\n  // store animation state\n  this._booAnimating = false;\n\n  // stores cells (see _initialiseData)\n  this._arrCells = {};\n\n  // Container DOM element\n  this._domElement = null;\n\n  // Container dimensions\n  this._intContainerWidth = 0;\n  this._intContainerHeight = 0;\n  // Mode\n  this._booImageOffset = _booImageOffset;\n\n  // store the currently active cell, null for all closed\n  this._strCurrentCell = null;\n\n  // cell animations stored by id\n  this._objCellAnimations = {};\n\n  // overlay animation\n  this._objOverlayAnimation = {};\n\n  // subscreen animations stored by cell id\n  this._objSubscreenAnimations = {};\n\n  // Store Asset Data\n  this._initialiseData(_objAsset);\n}\n\nComicstripAnimator.prototype = {\n  _intBorderWidth: 3,\n  _strCssComicstripOverlayHidden: 'opacity: 0.1; z-index: -1;',\n  _strCssComicstripOverlayShown: 'opacity: 0.8; z-index: 2;',\n\n  // return the animating state\n  isAnimating: function() {\n    return this._booAnimating;\n  },\n\n  // check if we currently have an open cell\n  hasCurrentOpenCell: function() {\n    return null !== this._strCurrentCell;\n  },\n\n  getCurrentOpenCell: function() {\n    return this._strCurrentCell;\n  },\n\n  // call the open cell animation\n  openCell: function(_strCellToOpen) {\n    // Switch animation state\n    this._booAnimating = true;\n\n    // move to front\n    this.setCellClass(_strCellToOpen, 'comicstripCellOpenC');\n    this.setVisitedClass(_strCellToOpen);\n    var _domSubscreen = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripCell_' + _strCellToOpen\n    );\n    _domSubscreen = CORE.getElementsByClassName(\n      _domSubscreen,\n      'comicstripSubScreenWrapperC'\n    )[0];\n    if (_domSubscreen == undefined) {\n      alert('There is no associated subscreen for this comicstrip cell');\n      return;\n    }\n\n    var _objMeRef = this;\n    var _objAnimator = this._objCellAnimations[_strCellToOpen];\n    _objAnimator.setOptions({\n      onComplete: function() {\n        _domSubscreen.className = _domSubscreen.className.replace(\n          'comicstripSubscreenHiddenC',\n          'comicstripSubscreenVisibleC'\n        );\n        if (_objMeRef._objSubscreenAnimations[_strCellToOpen]) {\n          _objMeRef._objSubscreenAnimations[_strCellToOpen].play();\n        }\n        // set state\n        _objMeRef._strCurrentCell = _strCellToOpen;\n        _objMeRef._booAnimating = false;\n        gomo.scrollManager.refreshScrollers();\n        // Disable the page scroller so the subscreen scrolls\n        var currScreenId = SCREEN_INTERACTIONS.getCurrentScreenData().strObjID;\n        var scrollerId = $(\n          '#screenWrapper_' + currScreenId + 'L .scrollMaskingWrapperC'\n        ).attr('id');\n        if (scrollerId) {\n          ISCROLL_INTERFACE._disableScroller(scrollerId);\n        }\n      }\n    });\n    // make overlay visible\n    _objMeRef._domOverlayElement.style.zIndex = 2;\n    _objMeRef._objOverlayAnimation.play();\n    _objAnimator.play();\n  },\n  // close the open cell\n  // NOTE: will trigger open if cell clicked on is not the same cell to close\n  closeCurrentCell: function(_strCellClickedOn, _objWhatCellData) {\n    // Switch animation state\n    this._booAnimating = true;\n\n    // Did we click the open cell?\n    var _booSameCell = this._strCurrentCell == _strCellClickedOn;\n\n    var _domSubscreen = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripCell_' + _strCellClickedOn\n    );\n    _domSubscreen = CORE.getElementsByClassName(\n      _domSubscreen,\n      'comicstripSubScreenWrapperC'\n    )[0];\n    _domSubscreen.className = _domSubscreen.className.replace(\n      'comicstripSubscreenVisibleC',\n      'comicstripSubscreenHiddenC'\n    );\n\n    // close subscreen\n    if (this._objSubscreenAnimations[this._strCurrentCell]) {\n      this._objSubscreenAnimations[this._strCurrentCell].reverse();\n    }\n    // hide overlay\n    this._objOverlayAnimation.reverse();\n\n    var _objAnimator = this._objCellAnimations[this._strCurrentCell];\n    var _objMeRef = this;\n    _objAnimator.setOptions({\n      onComplete: function() {\n        // move to back\n        _objMeRef.setCellClass(\n          _objMeRef._strCurrentCell,\n          'comicstripCellClosedC'\n        );\n\n        // move overlay out of the way\n        _objMeRef._domOverlayElement.style.zIndex = -1;\n\n        // reset the current animation\n        _objMeRef._strCurrentCell = null;\n        _objMeRef._booAnimating = false;\n\n        // If we clicked a different cell...\n        if (!_booSameCell) {\n          // ...re-trigger click now that we've closed this one\n          EM.trigger('comicstripCellClicked', _objWhatCellData);\n        }\n\n        // Enable page scrolling\n        var currScreenId = SCREEN_INTERACTIONS.getCurrentScreenData().strObjID;\n        var scrollerId = $(\n          '#screenWrapper_' + currScreenId + 'L .scrollMaskingWrapperC'\n        ).attr('id');\n        if (scrollerId) {\n          ISCROLL_INTERFACE._enableScroller(scrollerId);\n        }\n      }\n    });\n    _objAnimator.reverse();\n  },\n\n  // build animations\n  generateCellAnimations: function() {\n    // alert('T'is functionality should be provided by a child class');\n    alert(\n      'ERROR: Animation type isn\\'t set or wasn\\'t understood. ComicstripAnimator(),' +\n        'extension_comicstrip_asset.js'\n    );\n  },\n\n  _initialiseData: function(_objAsset) {\n    var booForceRerender = true;\n    ASSET_RENDERER.rerenderComicstrips(_objAsset, booForceRerender);\n\n    // get the DOM Element\n    this._domElement = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripAsset_YY' + _objAsset['strObjID'] + 'YY_ContainerL'\n    );\n    // grab the width and height\n    this._intContainerWidth = this._domElement.offsetWidth;\n    this._intContainerHeight =\n      this._domElement.parentNode.offsetHeight - this._intBorderWidth * 2;\n\n    // add each row\n    var _intCumulativeOffsetY = 0;\n\n    var _arrRows = _objAsset.objRawData['rows'];\n    for (var _intRow = 0; _intRow < _arrRows.length; _intRow++) {\n      // initialise row in object\n      var _arrRowCells = _arrRows[_intRow];\n      var _intCumulativeOffsetX = 0;\n      var _intCumulativeWidth = 0;\n\n      // extra loop to calculate the total width the cells will take up.\n      // this is then checked against the container width to see if there will be any pixels\n      // remaining. The remainder is then added to the cells within the next loop to make sure\n      // both widths are the same at the end.\n\n      var _objCell;\n      var _intCellWidth;\n      var _intCellHeight;\n\n      for (var i = 0; i < _arrRowCells.length; i++) {\n        _objCell = _arrRowCells[i];\n        _intCellWidth = Math.round(\n          this._intContainerWidth * (_objCell['strWidthRatio'] / 100)\n        );\n        _intCumulativeWidth += _intCellWidth;\n      }\n\n      var _intWidthRemainder = this._intContainerWidth % _intCumulativeWidth;\n\n      for (var j = 0; j < _arrRowCells.length; j++) {\n        _objCell = _arrRowCells[j];\n        _intCellWidth = Math.round(\n          this._intContainerWidth * (_objCell['strWidthRatio'] / 100)\n        );\n        _intCellHeight = Math.round(\n          this._intContainerHeight * (_objCell['strHeightRatio'] / 100)\n        );\n\n        if (_intWidthRemainder > 0) {\n          _intCellWidth++;\n          _intWidthRemainder--;\n        }\n\n        // difference in expanded\n        var _intDeltaWidth = _objCell['strExpandedWidth'] - _intCellWidth;\n        var _intDeltaHeight = _objCell['strExpandedHeight'] - _intCellHeight;\n        // where to expand to\n        var _intMaxX = Math.round(_intCumulativeOffsetX - _intDeltaWidth / 2);\n        var _intMaxY = Math.round(_intCumulativeOffsetY - _intDeltaHeight / 2);\n        // check we haven't expanded over a boundary\n        if (_intMaxX < 0) {\n          _intMaxX = 0;\n        }\n        if (_intMaxY < 0) {\n          _intMaxY = 0;\n        }\n        if (_intMaxX + _objCell['strExpandedWidth'] > this._intContainerWidth) {\n          _intMaxX = this._intContainerWidth - _objCell['strExpandedWidth'];\n        }\n        if (\n          _intMaxY + _objCell['strExpandedHeight'] >\n          this._intContainerHeight\n        ) {\n          _intMaxY = this._intContainerHeight - _objCell['strExpandedHeight'];\n        }\n        // calculate and store data we need to make animations\n        var _objCellData = {\n          // collapsed\n          _intMinX: _intCumulativeOffsetX,\n          _intMinY: _intCumulativeOffsetY,\n          _intMinWidth: _intCellWidth,\n          _intMinHeight: _intCellHeight,\n          // expanded\n          _intMaxX: _intMaxX,\n          _intMaxY: _intMaxY,\n          _intMaxWidth: _objCell['strExpandedWidth'],\n          _intMaxHeight: _objCell['strExpandedHeight'],\n          // position in strip data\n          _intRow: _intRow + 1,\n          _intNumRows: _arrRows.length,\n          _intCol: j + 1,\n          _intCellsInRow: _arrRowCells.length\n        };\n        this._arrCells[_objCell['strID']] = _objCellData;\n        // set the initial styles\n        this.setInitialCellStyle(_objCell['strID'], _objCellData);\n        // add to cumulative x\n        _intCumulativeOffsetX += _intCellWidth;\n        // generate a subscreen animation if required\n        if (\n          _objCell.arrActions.length > 0 &&\n          _objCell.arrActions[0].objParameters &&\n          _objCell.arrActions[0].objParameters.strSubScreenID\n        ) {\n          var _strSubscreenId =\n            'subScreenWrapper_' +\n            _objCell.arrActions[0].objParameters.strSubScreenID +\n            'L';\n\n          var _objAnimtor;\n          if (\n            OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie7C' ||\n            OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass ==\n              'ie8CompatibilityModeC'\n          ) {\n            _objAnimtor = new Animator({duration: 300});\n          } else {\n            _objAnimtor = new Animator({duration: 300}).addSubject(\n              new CSSStyleSubject(_strSubscreenId, 'opacity:0', 'opacity:0.8')\n            );\n          }\n          this._objSubscreenAnimations[_objCell['strID']] = _objAnimtor;\n        }\n      }\n      _intCumulativeOffsetY += _intCellHeight;\n    }\n    // show/hide overlay layer\n    var _strOverlayId =\n      'comicstripAsset_YY' + _objAsset['strObjID'] + 'YY_OverlayL';\n    this._domOverlayElement = ASSET_RENDERER._objCurrDOM.getElementById(\n      _strOverlayId\n    );\n    this._objOverlayAnimation = new Animator({\n      duration: 150,\n      transition: Animator.tx.linear\n    }).addSubject(\n      new CSSStyleSubject(\n        _strOverlayId,\n        this._strCssComicstripOverlayHidden,\n        this._strCssComicstripOverlayShown\n      )\n    );\n  },\n\n  setInitialCellStyle: function(_strId, _objCell) {\n    var _domCell = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripCell_' + _strId\n    );\n    _domCell.style.top = _objCell['_intMinY'] + 'px';\n    _domCell.style.left = _objCell['_intMinX'] + 'px';\n    _domCell.style.width = _objCell['_intMinWidth'] + 'px';\n    _domCell.style.height = _objCell['_intMinHeight'] + 'px';\n\n    if (this._booImageOffset) {\n      var _domCellImg = ASSET_RENDERER._objCurrDOM.getElementById(\n        'comicstripCellImg_' + _strId\n      );\n      _domCellImg.style.marginTop =\n        _objCell['_intMaxY'] - _objCell['_intMinY'] + 'px';\n      _domCellImg.style.marginLeft =\n        _objCell['_intMaxX'] - _objCell['_intMinX'] + 'px';\n    }\n  },\n\n  setCellClass: function(_strId, _strClassName) {\n    var _domCell = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripCell_' + _strId\n    );\n    /* If a screen is closed with an open comic strip there will be nothing to close\n     * and an error will occur - JH */\n    if (_domCell) {\n      _domCell.className = _domCell.className.replace(\n        /comicstripCell(Open|Closed)C/,\n        _strClassName\n      );\n    }\n  },\n\n  setVisitedClass: function(_strId) {\n    var _domCell = ASSET_RENDERER._objCurrDOM.getElementById(\n      'comicstripCell_' + _strId\n    );\n    _domCell.className = _domCell.className.replace(\n      /comicStripCellUnvisitedC/,\n      'comicStripCellVisitedC'\n    );\n  }\n};\n\n/**\n * Popup crop animation generator. This needs to be loaded into the base class\n * in order to do anything sensible.\n */\nvar ComicstripPopupCropAnimationGenerator = function() {\n  // create an animation for each cell in the strip\n  for (var _strCellId in this._arrCells) {\n    if (Object.prototype.hasOwnProperty.call(this._arrCells, _strCellId)) {\n      var _objCell = this._arrCells[_strCellId];\n      // we need to animate cell and image (to keep image aligned in cell)\n      var _objAnim = new Animator();\n      var _strTo = 'top: ' + _objCell._intMaxY + 'px; ';\n      _strTo += 'left: ' + _objCell._intMaxX + 'px; ';\n      _strTo += 'width: ' + _objCell._intMaxWidth + 'px; ';\n      _strTo += 'height: ' + _objCell._intMaxHeight + 'px; ';\n      _objAnim.addSubject(\n        new CSSStyleSubject('comicstripCell_' + _strCellId, _strTo)\n      );\n      // all non generated css can sit in these styles - also allows us to turn off numbers etc.\n      _objAnim.addSubject(\n        new CSSStyleSubject(\n          'comicstripCell_' + _strCellId,\n          'comicstripCellClosedC',\n          'comicstripCellOpenC'\n        )\n      );\n      _objAnim.addSubject(\n        new CSSStyleSubject(\n          'comicstripCellImg_' + _strCellId,\n          'margin-left: 0px; margin-top: 0px;'\n        )\n      );\n      // save to cell animations\n      this._objCellAnimations[_strCellId] = _objAnim;\n    }\n  }\n};\n\n/**\n * Returns the correct animator for the job\n */\nvar ComicstripAnimatorFactory = {\n  getAnimator: function(_objAsset) {\n    var _strAnimationType = _objAsset.objRawData.strTransitionType;\n    // create animator\n    var _objAnimator = new ComicstripAnimator(_objAsset, true);\n\n    // Attach the correct generator\n    switch (_strAnimationType) {\n      case 'crop':\n      case 'crop_popup':\n      case 'scale':\n        // crop is older style format\n        // Attach generator\n        _objAnimator.generateCellAnimations = ComicstripPopupCropAnimationGenerator;\n        break;\n\n      case 'zoom':\n        _objAnimator._booImageOffset = false;\n        break;\n\n      default:\n        alert(\n          'ERROR: Unknown animation type of \\'' +\n            _strAnimationType +\n            '\\' found in ComicstripAnimatorFactory(), extension_comicstrip_asset.js.'\n        );\n        break;\n    }\n    // Generate animations\n    _objAnimator.generateCellAnimations();\n\n    // return animation object\n    return _objAnimator;\n  }\n};\n\n/**\n *\n */\nvar COMICSTRIP_ASSET_INTERACTIONS = {\n  strObjID: 'The graphical mcq asset interactions extension object',\n\n  // Animators for each comic strip\n  _objComicstripAnimators: {},\n\n  comicstripStatementData: {},\n\n  is_comicstrip_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _performPreShowActions_comicstrip_Asset: function(assetData) {\n    this.comicstripStatementData[assetData.strObjID] = {\n      subscreenAvailable: null,\n      assetType: assetData.strAssetType\n    };\n    var listenForEscape = function(e) {\n      if (e.keyCode === 27 || e.key === 'Escape') {\n        gomo.eventManager.legacy('comicstripCellClicked', false);\n      }\n    };\n    window.addEventListener('keydown', listenForEscape);\n  },\n\n  _performLanguagePreprocess_comicstrip_Asset: function(\n    _objWhatAssetCourseObject\n  ) {\n    gomo.translationManager.setArrayOfImages(\n      _objWhatAssetCourseObject.objRawData.strID,\n      'arrCells',\n      'objImageSrc'\n    );\n  },\n\n  _doPostRenderShowActions_comicstrip_Asset: function(\n    _objWhatAssetCourseObject\n  ) {\n    if (!this._objComicstripAnimators[_objWhatAssetCourseObject['strObjID']]) {\n      if (\n        OUTPUT_MODE_CHECKER.objScreenSizeBoundaries[\n          _objWhatAssetCourseObject.objRawData.strBoundaryId\n        ].strCurrentLayoutSize != 'small' &&\n        this._strCurrOutputMode != 'accessibleC' &&\n        !OUTPUT_MODE_CHECKER.isSmartPhone()\n      ) {\n        this._objComicstripAnimators[\n          _objWhatAssetCourseObject['strObjID']\n        ] = ComicstripAnimatorFactory.getAnimator(_objWhatAssetCourseObject);\n      }\n    }\n\n    /* IE falls over if opacity:value; is set, so we need to logically set CSS. JH */\n    var _domPageWrapper = ASSET_RENDERER._objCurrDOM.getElementById(\n      'pageWrapperL'\n    );\n    var _domComicStrips = CORE.getElementsByClassName(\n      _domPageWrapper,\n      'comicstripSubScreenWrapperC'\n    );\n\n    var _intOpacityValue = 0;\n\n    if (\n      OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie7C' ||\n      OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie8CompatibilityModeC'\n    ) {\n      /* IE 7 and IE 8 in compatibility mode can't use alpha with overflowed elements.\n       * ms-filter would work but we can't set the in JH */\n      return;\n    } else if (\n      OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie6C' ||\n      OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie8C' ||\n      OUTPUT_MODE_CHECKER.strWhatBrowserTypeClass == 'ie9C'\n    ) {\n      var _intComicStrip;\n      for (_intComicStrip in _domComicStrips) {\n        if (\n          Object.prototype.hasOwnProperty.call(_domComicStrips, _intComicStrip)\n        ) {\n          _domComicStrips[_intComicStrip].style.filter =\n            'alpha(opacity=' + _intOpacityValue * 100 + ')';\n        }\n      }\n    } else if (\n      OUTPUT_MODE_CHECKER.objScreenSizeBoundaries[\n        _objWhatAssetCourseObject.objRawData.strBoundaryId\n      ].strCurrentLayoutSize == 'small' ||\n      this._strCurrOutputMode == 'accessibleC' ||\n      OUTPUT_MODE_CHECKER.isSmartPhone()\n    ) {\n      // no animation required for static modes (smartphone and accessible). JH\n      for (_intComicStrip in _domComicStrips) {\n        if (\n          Object.prototype.hasOwnProperty.call(_domComicStrips, _intComicStrip)\n        ) {\n          _domComicStrips[_intComicStrip].className = _domComicStrips[\n            _intComicStrip\n          ].className.replace(\n            'comicstripSubscreenHiddenC',\n            'comicstripSubscreenVisibleC'\n          );\n        }\n      }\n      return;\n    } else if (ASSET_INTERACTIONS.shouldAssetReset(_objWhatAssetCourseObject)) {\n      for (_intComicStrip in _domComicStrips) {\n        if (\n          Object.prototype.hasOwnProperty.call(_domComicStrips, _intComicStrip)\n        ) {\n          _domComicStrips[_intComicStrip].style.opacity = _intOpacityValue;\n        }\n      }\n    }\n\n    // Apply iscroll to comic strip subscreens\n    var me = this;\n    _.each(_objWhatAssetCourseObject.objRawData.arrCells, function(element) {\n      var subscreenId = element.arrActions[0].objParameters.strSubScreenID;\n      var comicstripSubscreenContent = me._objWhatDOM.getElementById(\n        'comicstripSubscreenContent_' + subscreenId + 'L'\n      );\n\n      if (typeof element.strExpandedWidth !== 'undefined') {\n        $(comicstripSubscreenContent).width(element.strExpandedWidth + 'px');\n\n        var subscreenHeight = $(comicstripSubscreenContent)\n          .find('.scrollWrapperC')\n          .height();\n        if (subscreenHeight > 235) {\n          var subscreenContentOuter = me._objWhatDOM.getElementById(\n            'subScreenContent_' + subscreenId + 'L'\n          );\n          gomo.scrollManager.parseChildElements(subscreenContentOuter, true);\n          var comicstripSubscreenWrapper = me._objWhatDOM.getElementById(\n            'subScreenWrapper_' + subscreenId + 'L'\n          );\n          $(comicstripSubscreenWrapper).addClass('comicstripSubscreenOverflow');\n        }\n\n        $(comicstripSubscreenContent).width('auto');\n      }\n    });\n  },\n\n  _doPostRenderHideActions_comicstrip_Asset: function(assetData) {\n    var data = this.comicstripStatementData[assetData.strObjID];\n    if (data.subscreenAvailable) {\n      this.sendComicstripSlideTrackingDataOut(assetData.strObjID);\n    }\n  },\n\n  handleEvent_comicstripCellClicked: function(_objWhatCellData) {\n    if (!_objWhatCellData || _.isUndefined(_objWhatCellData)) {\n      _objWhatCellData = this._objComicstripAnimators.openCells;\n    } else {\n      // Store open cell data so we know which one to close when escape key pressed.\n      this._objComicstripAnimators.openCells = _objWhatCellData;\n    }\n    // get the cell from info passed in to us\n    var _objCell = this._getCellData(_objWhatCellData);\n\n    // grab the animator for this comic strip\n    var _objAnimator = this._objComicstripAnimators[_objCell['strAssetID']];\n\n    // Ignore the event if mid-animation\n    if (_objAnimator.isAnimating()) {\n      return false;\n    }\n\n    // Do we have a cell open?\n    if (_objAnimator.hasCurrentOpenCell()) {\n      // close the current cell, (and potentially open a new one after)\n      _objAnimator.closeCurrentCell(_objCell['strID'], _objWhatCellData);\n      this.sendComicstripSlideTrackingDataOut(_objCell.strAssetID);\n      this.comicstripStatementData[_objCell.strAssetID].subscreenAvailable = null;\n    } else {\n      // open the cell we clicked on\n      _objAnimator.openCell(_objCell['strID']);\n      var subscreenId = _objCell.arrActions.length ?\n        _objCell.arrActions[0].objParameters.strSubScreenID : '';\n      this.comicstripStatementData[_objCell.strAssetID].subscreenAvailable = new Date();\n      this.comicstripStatementData[_objCell.strAssetID].subscreenId = subscreenId;\n      this.comicstripStatementData[_objCell.strAssetID].subscreenTitle =\n        SUB_SCREEN_INTERACTIONS._getSubScreenData(subscreenId).strTitle;\n      this.sendComicstripSlideTrackingDataIn(_objCell.strAssetID);\n      var subscreenDomElem = SUB_SCREEN_INTERACTIONS.getSubScreenDOMElement(subscreenId);\n      if (subscreenDomElem) {\n        gomo.tabManager.focusModalContent(subscreenDomElem, subscreenDomElem);\n      }\n    }\n\n    var _strAssetId = _objWhatCellData['strAssetID'];\n    var _objWhatAssetData = this.getAssetData(_strAssetId);\n    EM.trigger('screenAssetInteracting', _objWhatAssetData);\n    return false;\n  },\n\n  resetComicstrip: function(_objWhatAssetData, _booForceReset) {\n    this._reset_comicstrip_Asset(_objWhatAssetData, _booForceReset);\n    ASSET_RENDERER.arrTempComicStripAssetData = [];\n  },\n\n  _getCellData: function(_objWhatCellData) {\n    var _strAssetId = _objWhatCellData['strAssetID'];\n    var _objWhatAssetData = this.getAssetData(_strAssetId);\n    var _objRawData = _objWhatAssetData.objRawData;\n    // -1 from these as 0 indexed in array\n    var _row = _objWhatCellData['row'] - 1;\n    if (!_objRawData.rows[_row]) {\n      return false;\n    }\n    var _col = _objWhatCellData['col'] - 1;\n    if (!_objRawData.rows[_row][_col]) {\n      return false;\n    }\n    // add asset id\n    _objRawData.rows[_row][_col]['strAssetID'] = _objRawData['strID'];\n\n    // JC: Removed as it was a) redundant and b) caused errors due to cyclical references.\n    // pointer to all rows\n    // _objRawData.rows[_row][_col]['allrows'] = _objRawData.rows;\n\n    return _objRawData.rows[_row][_col];\n  },\n\n  _reset_comicstrip_Asset: function(_objWhatAssetData, _booForceReset) {\n    // Recycle the scroller on comicstrip reset as the subscreen doms have been destroyed\n    var me = this;\n    _.each(_objWhatAssetData.objRawData.arrCells, function(element) {\n      var subscreenId = element.arrActions[0].objParameters.strSubScreenID;\n      var subscreenContentOuter = me._objWhatDOM.getElementById(\n        'subScreenContent_' + subscreenId + 'L'\n      );\n\n      ISCROLL_INTERFACE.recycleScroller(subscreenContentOuter);\n    });\n\n    var _objAnimator = this._objComicstripAnimators[\n      _objWhatAssetData['strObjID']\n    ];\n    if (_objAnimator) {\n      if (_objAnimator.hasCurrentOpenCell()) {\n        _objAnimator.closeCurrentCell(_objAnimator.getCurrentOpenCell());\n      }\n    }\n\n    this._objComicstripAnimators[_objWhatAssetData['strObjID']] = null;\n\n    if (_booForceReset) {\n      _objWhatAssetData.objRawData.booComicStripOutputModeSet = false;\n    }\n\n    ASSET_RENDERER.resetComicstripRender;\n  },\n\n  _checkCompletion_comicstrip_Asset: function(_objWhatAssetDataWrapper) {\n    var _objWhatAssetData = this.getAssetData(\n      _objWhatAssetDataWrapper['strObjID']\n    );\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n      _objWhatAssetData['objRawData']\n    );\n    var _domUnvisitedCells = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      'comicStripCellUnvisitedC'\n    );\n    return _domUnvisitedCells.length == 0;\n  },\n\n  getAccessibleElements_comicstrip: function(_objAssetData) {\n    var comicstripCells = this.getAssetData(_objAssetData['strObjID'])\n      .objRawData.arrCells;\n    var count = 0;\n    var accessibleElements = [];\n\n    while (count < comicstripCells.length) {\n      accessibleElements.push(\n        '#comicstripCell_' + comicstripCells[count].strID\n      );\n      accessibleElements.push(\n        '#subScreenContent_' +\n          comicstripCells[count].arrActions[0].objParameters.strSubScreenID +\n          'L .fakeComicStripCellCloseC'\n      );\n      count++;\n    }\n\n    return accessibleElements;\n  },\n\n  sendComicstripSlideTrackingDataIn: function(assetId) {\n    var data = this.comicstripStatementData[assetId];\n    CONTENT_TRACKING.interaction({\n      type: 'experienced',\n      activity: {\n        id: data.subscreenId,\n        title: data.subscreenTitle,\n        type: 'subscreen'\n      },\n      referrer: {\n        id: assetId,\n        type: 'asset',\n        assetType: data.assetType\n      },\n      parent: 'asset/' + assetId,\n      topicGrouping: true\n    });\n  },\n\n  sendComicstripSlideTrackingDataOut: function(assetId) {\n    var data = this.comicstripStatementData[assetId];\n    CONTENT_TRACKING.interaction({\n      type: 'left',\n      activity: {\n        id: data.subscreenId,\n        title: data.subscreenTitle,\n        type: 'subscreen'\n      },\n      response: {\n        timeAvailable: data.subscreenAvailable,\n        timeResponse: new Date()\n      },\n      referrer: {\n        id: assetId,\n        type: 'asset',\n        assetType: data.assetType\n      },\n      parent: 'asset/' + assetId,\n      topicGrouping: true\n    });\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, COMICSTRIP_ASSET_INTERACTIONS);\n\n/**\n * Pre-processor extension to manage data from raw XML into something a little\n * easier to manipulate later on.\n */\nvar COMICSTRIP_ASSET_PREPROCESSOR = {\n  strObjID: 'The Comicstrip asset pre-extension object',\n\n  _preProcess_comicstrip_Asset: function(\n    _objWhatRawAssetData,\n    _objWhatParentScreenObject\n  ) {\n    var _rows = [];\n    var _rowWidths = [];\n    var _rowHeight = [];\n    for (var i = 0; i < _objWhatRawAssetData.arrCells.length; i++) {\n      var _cell = _objWhatRawAssetData.arrCells[i];\n      // grab the image data\n      var _objCellImageMetaData = MASTER_RENDERER.getImageProperties(\n        decodeURIComponent(_cell.objImageSrc.strSrc)\n      );\n      // figure out which row (index to 0)\n      var _row = _cell.strRow - 1;\n      // add some arrays if first time we have seen this row\n      if (!_rows[_row]) {\n        _rows[_row] = [];\n      }\n\n      if (!_rowWidths[_row]) {\n        _rowWidths[_row] = 0;\n      }\n\n      if (!_rowHeight[_row]) {\n        _rowHeight[_row] = 100000000;\n      }\n      // figure out the column\n      var _currentcount = _rows[_row].length;\n\n      // grab image width and height\n      var _width = 0;\n      var _height = 100000000;\n      if (_objCellImageMetaData) {\n        _width = parseInt(_objCellImageMetaData['strWidth']);\n        _height = parseInt(_objCellImageMetaData['strHeight']);\n      } else {\n        console.log(\n          'Data for the following image: ' +\n            decodeURIComponent(_cell.objImageSrc.strSrc) +\n            ' has not been found. Image src has probably been mistyped or image not uploaded.'\n        );\n      }\n\n      // add to the row totals for width/height\n      _rowWidths[_row] += _width;\n      if (_height < _rowHeight[_row]) {\n        _rowHeight[_row] = _height;\n      }\n      // add extra cell details\n      _cell['intCellNum'] = i + 1;\n      _cell['intColumnIndex'] = _currentcount + 1;\n      _cell['strWidthRatio'] = 0; // this gets set below (next loop)\n      _cell['strExpandedWidth'] = _width;\n      _cell['strHeightRatio'] = 0; // this gets set below\n      _cell['strExpandedHeight'] = 0; // this gets set below\n      // add cell to row\n      _rows[_row][_currentcount] = _cell;\n    }\n    var totalHeight = 0;\n    var smallestWidth = 10000;\n    var _col;\n    // get total height\n    for (_row = 0; _row < _rows.length; _row++) {\n      totalHeight += _rowHeight[_row];\n      if (smallestWidth > _rowWidths[_row]) {\n        smallestWidth = _rowWidths[_row];\n      }\n    }\n    // now figure out the ratios for each cell\n    for (_row = 0; _row < _rows.length; _row++) {\n      if (_rows[_row] == undefined) {\n        alert(\n          'Bad Data - Missing a comicstrip row for ' +\n            _objWhatRawAssetData['strID'] +\n            ' - please ensure comicstrip rows are contiguous'\n        );\n      }\n      for (_col = 0; _col < _rows[_row].length; _col++) {\n        _width = _rows[_row][_col]['strExpandedWidth'];\n        _rows[_row][_col]['strWidthRatio'] = (_width / _rowWidths[_row]) * 100;\n        _rows[_row][_col]['intMaxCols'] = _rows[_row].length;\n        _rows[_row][_col]['strHeightRatio'] =\n          (_rowHeight[_row] / totalHeight) * 100;\n        _rows[_row][_col]['intMaxRows'] = _rows.length;\n        _rows[_row][_col]['strExpandedHeight'] = _rowHeight[_row];\n      }\n    }\n\n    // add to raw data and return\n    _objWhatRawAssetData['rows'] = _rows;\n    _objWhatRawAssetData['intAssetWidth'] = smallestWidth;\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, COMICSTRIP_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(47))},function(t,e){t.exports="/* globals Modernizr, VARIABLES_HOLDER, $ */\n/**\n * Countdown timer asset which executes actions when complete.\n */\n(function() {\n  var Countdowntimer = gomo.Asset.extend({\n    delayTimer: '',\n    timer: '',\n    timerRunning: false,\n\n    processData: function(data) {\n      var rawData = data.objRawData;\n      var displayMode = rawData.displayMode;\n\n      rawData.barDisplayMode = false;\n      rawData.pieDisplayMode = false;\n      rawData.circleDisplayMode = false;\n      rawData.textDisplayMode = false;\n      rawData.showTextCountdown = false;\n      data.isComplete = false;\n      rawData.minutesLabel = gomo.utility.decodeHtml(rawData.minutesLabel);\n      rawData.secondsLabel = gomo.utility.decodeHtml(rawData.secondsLabel);\n\n      // Old browsers will default to text only mode\n      if (\n        Modernizr.csstransitions &&\n        VARIABLES_HOLDER.getVariableValue('gomo_accessibility_state') === 'false'\n      ) {\n        if (displayMode == 'bar' || displayMode == 'barText') {\n          rawData.barDisplayMode = true;\n          if (displayMode == 'barText') {\n            rawData.showTextCountdown = true;\n          }\n        }\n        if (displayMode == 'pie' || displayMode == 'pieText') {\n          rawData.pieDisplayMode = true;\n          if (displayMode == 'pieText') {\n            rawData.showTextCountdown = true;\n          }\n        }\n        if (displayMode == 'circle' || displayMode == 'circleText') {\n          rawData.circleDisplayMode = true;\n          if (displayMode == 'circleText') {\n            rawData.showTextCountdown = true;\n          }\n        }\n        if (displayMode == 'text') {\n          rawData.textDisplayMode = true;\n          rawData.showTextCountdown = true;\n        }\n        if (displayMode == 'hidden') {\n          rawData.hiddenDisplayMode = true;\n        }\n      } else {\n        if (displayMode == 'hidden') {\n          rawData.hiddenDisplayMode = true;\n        } else {\n          rawData.textDisplayMode = true;\n          rawData.showTextCountdown = true;\n        }\n      }\n    },\n\n    beforeShown: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      me.resetTimer();\n      //  Show timer and reset to 100%\n      if (rawData.pieDisplayMode || rawData.circleDisplayMode) {\n        me.drawCircleTimer(100);\n      } else {\n        me.drawBarTimer(100);\n      }\n      // Set countdown text\n      if (rawData.showTextCountdown) {\n        me.updateTextCountdown(parseInt(rawData.minutes) * 60 + parseInt(rawData.seconds));\n      }\n    },\n\n    afterRenderHidden: function() {\n      var me = this;\n      me.resetTimer();\n    },\n\n    afterRenderShown: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      // Launch delay timer if required\n      if (!me.timerRunning) {\n        if (rawData.delay > 0) {\n          me.runDelayTimer(rawData.delay);\n        } else {\n          me.runTimer(rawData.minutes, rawData.seconds);\n        }\n        me.timerRunning = true;\n      }\n    },\n\n    displayConditionsHide: function() {\n      var me = this;\n      me.resetTimer();\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n      if (found) {\n        me.updateAlignment(found);\n      }\n    },\n\n    updateAlignment: function(data) {\n      var me = this;\n      var timerElement = $(me.el).find('.timerWrapper');\n      if (timerElement.length && typeof data.alignment !== 'undefined') {\n        timerElement[0].className =\n          timerElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n        timerElement.addClass(data.alignment);\n      }\n    },\n\n    drawCircleTimer: function(percent) {\n      var me = this;\n      var deg = (360 / 100) * percent;\n\n      if (percent <= 50) {\n        me.$('.timer .slice').removeClass('gt50');\n      } else {\n        me.$('.timer .slice').addClass('gt50');\n      }\n\n      // Rotate the timer\n      me.$('.slice .pie').css({\n        '-moz-transform': 'rotate(' + deg + 'deg)',\n        '-webkit-transform': 'rotate(' + deg + 'deg)',\n        '-o-transform': 'rotate(' + deg + 'deg)',\n        'transform': 'rotate(' + deg + 'deg)'\n      });\n    },\n\n    drawBarTimer: function(percent) {\n      var me = this;\n      me.$('.bar-inner').css('width', percent + '%');\n    },\n\n    runDelayTimer: function(seconds) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var delayDuration = parseInt(seconds * 1000);\n      me.delayTimer = setTimeout(function() {\n        me.runTimer(rawData.minutes, rawData.seconds);\n      }, delayDuration);\n    },\n\n    runTimer: function(minutes, seconds) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      me.timerSeconds = parseInt(minutes * 60) + parseInt(seconds);\n      me.timerFinish = new Date().getTime() + me.timerSeconds * 1000;\n      me.timer = setInterval(function() {\n        var seconds = (me.timerFinish - new Date().getTime()) / 1000;\n        if (seconds <= 0) {\n          if (rawData.pieDisplayMode || rawData.circleDisplayMode) {\n            me.drawCircleTimer(0);\n          } else {\n            me.drawBarTimer(0);\n          }\n          clearInterval(me.timer);\n          me.timerComplete(me);\n        } else {\n          var percent = (seconds / me.timerSeconds) * 100;\n          if (rawData.pieDisplayMode || rawData.circleDisplayMode) {\n            me.drawCircleTimer(percent);\n          } else {\n            me.drawBarTimer(percent);\n          }\n          if (rawData.showTextCountdown) {\n            me.updateTextCountdown(seconds);\n          }\n        }\n      }, 50);\n    },\n\n    updateTextCountdown: function(time) {\n      var me = this;\n      var minutes = Math.floor(time / 60);\n      var seconds = Math.round(time - minutes * 60);\n      me.$('.minutes-countdown').html(minutes);\n      me.$('.seconds-countdown').html(seconds);\n    },\n\n    timerComplete: function(me) {\n      var data = me.data;\n      var rawData = data.objRawData;\n      var actionOptions = {};\n      actionOptions.objActions = rawData.arrActions;\n      actionOptions.objOptionalExtraData = data;\n      actionOptions.objOptionalExtraData.strAssetID = data.strObjID;\n      data.isComplete = true;\n      gomo.eventManager.legacy('screenAssetInteracting', data);\n      // Execute all actions\n      gomo.eventManager.legacy('processActions', actionOptions);\n    },\n\n    resetTimer: function() {\n      var me = this;\n      var data = me.data;\n      clearTimeout(me.delayTimer);\n      clearInterval(me.timer);\n      me.timerRunning = false;\n      data.isComplete = false;\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    isComplete: function() {\n      var me = this;\n      return me.data.isComplete;\n    }\n  });\n\n  gomo.assetManager.register('countdown-timer', Countdowntimer);\n})();\n"},function(t,e,n){n(0)(n(49))},function(t,e){t.exports="/* globals BOO_SHOW_FILMSTRIP_STEP_NUMBERS, BOO_INCLUDE_FILMSTRIP_STEP_HEADINGS, _ ,OBJ_REF,\nSUB_SCREEN_RENDERER, OUTPUT_MODE_CHECKER, Animator, CONTENT_TRACKING, ANIMATOR_INTERFACE,\nSUB_SCREEN_INTERACTIONS, BOO_SMART_FIT_FILMSTRIP, MASTER_RENDERER $,\nBOO_CENTER_FILMSTRIP_IMAGES_HORIZONTALLY, BOO_CENTER_FILMSTRIP_IMAGES_VERTICALLY,\nSCREEN_INTERACTIONS, ISCROLL_INTERFACE, ASSET_INTERACTIONS */\n(function() {\n  // Create new Filmstrip\n  var Filmstrip = gomo.Asset.extend({\n    filmstripAnimating: false,\n    visitedStepsHash: {},\n    currOutputMode: '',\n    filmstripHeight: 0,\n    defaultFilmstripHeightSingleColumn: 320,\n    defaultFilmstripHeightTwoColumn: 435,\n    filmStripMovementTime: 1000,\n    filmstripStatementData: {},\n    smallLayout: false,\n    processData: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      rawData.trackingCompletionDelayed = true;\n      // step numbers and headings\n      rawData.showStepNumbers = BOO_SHOW_FILMSTRIP_STEP_NUMBERS || false;\n      _.each(rawData.arrStepData, function(step, index) {\n        step.stepNumber = index + 1;\n        step.showStepTitles = false;\n        if (BOO_INCLUDE_FILMSTRIP_STEP_HEADINGS) {\n          step.showStepTitles = true;\n        }\n      });\n      // multi column\n      rawData.columnClass = '';\n      if (\n        data.objParent.intColumns > 1 &&\n        data.intColumnAffinity !== 0\n      ) {\n        rawData.columnClass = 'multiColumnFilmStripC';\n      }\n      // build subscreen for each step\n      _.each(rawData.arrStepData, function(step) {\n        if (\n          step.arrActions.length &&\n          step.arrActions[0].objParameters &&\n          step.arrActions[0].objParameters.strSubScreenID\n        ) {\n          var subscreen = OBJ_REF.get(\n            step.arrActions[0].objParameters.strSubScreenID\n          );\n          step.subscreenHtml = SUB_SCREEN_RENDERER.renderSubScreen(\n            subscreen, 'consumed'\n          ).replace(/hiddenSubScreenC/g, '');\n        }\n      });\n      rawData.localisedStepLabel = gomo.localiser.get('FILMSTRIP_SLIDE_DESCRIPTION');\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var data = me.data;\n      var pathToArray = 'arrStepData';\n      var pathToImage = 'objImageSrc';\n      gomo.translationManager.setArrayOfImages(data.strObjID, pathToArray, pathToImage);\n      data.objRawData.localisedStepLabel = gomo.localiser.get('FILMSTRIP_SLIDE_DESCRIPTION');\n      $('.filmstripStepWrapperC').attr('aria-roledescription', data.objRawData.localisedStepLabel);\n    },\n\n    beforeShown: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n\n      // reset step completion\n      me.visitedStepsHash[data.strObjID] = {};\n      me.filmstripStatementData[data.strObjID] = {\n        subscreens: [],\n        slideAvailable: new Date(),\n        slideIndex: 0\n      };\n\n      var steps = rawData['arrStepData'];\n      for (var i = 0; i < steps.length; i += 1) {\n        var actions = steps[i].arrActions;\n        var title = '';\n        if (actions && actions.length) {\n          var subscreenId = actions[0].objParameters.strSubScreenID;\n          title = SUB_SCREEN_INTERACTIONS._getSubScreenData(subscreenId).strTitle;\n        }\n        me.filmstripStatementData[data.strObjID].subscreens.push({\n          strTitle: title,\n          strID: subscreenId\n        });\n      }\n\n      me.sendFilmstripSlideTrackingDataIn(\n        rawData.strID,\n        rawData.strType\n      );\n\n      me.setLayoutClass();\n    },\n\n    afterRenderShown: function() {\n      var me = this;\n      me.initFilmStrip();\n    },\n\n    afterRenderHidden: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var stepData = rawData.arrStepData;\n      // This stops the currently playing audio in a filmstrip subscreen when you change screen.\n      if (stepData && stepData.length) {\n        var count = 0;\n        while (count < stepData.length) {\n          var subScreenId = stepData[count].arrActions[0].objParameters.strSubScreenID;\n          var subScreen = OBJ_REF.get(subScreenId);\n          var audioAssets = subScreen.getAssetsByType('audioplayer', false);\n          var audioCount = 0;\n          while (audioCount < audioAssets.length) {\n            // Will need updaing when audio is converted.\n            ASSET_INTERACTIONS._doPostRenderHideActions_audioplayer_Asset(audioAssets[audioCount]);\n            audioCount++;\n          }\n          count++;\n        }\n      }\n\n      this.sendFilmstripSlideTrackingDataOut(\n        rawData.strID,\n        rawData.strType\n      );\n    },\n\n    setLayoutClass: function() {\n      var me = this;\n      if (me.$el.width() < gomo.outputChecker.smallScreenMax) {\n        me.$el.addClass('forcesmallC');\n        me.$el.removeClass('forcemediumC');\n        me.smallLayout = true;\n      } else {\n        me.$el.removeClass('forcesmallC');\n        me.$el.addClass('forcemediumC');\n        me.smallLayout = false;\n      }\n    },\n\n    registerEvents: function() {\n      var me = this;\n      me.events = {\n        'click .filmstripUpArrowC, .filmstripDownArrowC, .filmstripNumStepButton': 'moveFilmstrip'\n      };\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    isComplete: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var returnValue = true;\n      var count = 0;\n\n      if (this.visitedStepsHash[data.strObjID] && !me.smallLayout) {\n        for (var stepId in this.visitedStepsHash[data.strObjID]) {\n          if (count < rawData.arrStepData.length) {\n            if (this.visitedStepsHash[data.strObjID][stepId] == false) {\n              returnValue = false;\n            }\n            count++;\n          }\n        }\n      }\n\n      return returnValue;\n    },\n\n    getAccessibleElements: function() {\n      var accessibleElements = ['.filmstripDownArrowC', '.filmstripUpArrowC'];\n      return accessibleElements;\n    },\n\n    initFilmStrip: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var callBack = function() {\n        me.resetFilmStrip();\n      };\n\n      OUTPUT_MODE_CHECKER.setNewScreenSizeBoundary({\n        objRawAssetData: rawData,\n        strDomId: data.strObjID,\n        funCallBack: callBack\n      });\n\n      if (BOO_SMART_FIT_FILMSTRIP) {\n        me.setContainerDimensions(data);\n      } else {\n        me.filmstripHeight = me.defaultFilmstripHeightSingleColumn;\n        if (\n          data.objParent.intColumns > 1 &&\n          data.intColumnAffinity !== 0\n        ) {\n          me.filmstripHeight = me.defaultFilmstripHeightTwoColumn;\n        }\n      }\n\n      if (me.currOutputMode != 'accessibleC' && !me.smallLayout) {\n        me.resetFilmStrip();\n      }\n\n      if (me.smallLayout) {\n        var numOfSteps = rawData.arrStepData.length;\n        var i = 0;\n\n        while (i < numOfSteps) {\n          me.loadStep(i, null);\n          i++;\n        }\n      } else {\n        me.loadStep(0, null);\n      }\n\n      me.updateNavigation(0);\n\n      for (var stepNumberNum in rawData['arrStepData']) {\n        if (Object.prototype.hasOwnProperty.call(\n          rawData['arrStepData'], stepNumberNum\n        )) {\n          var stepId = rawData['arrStepData'][stepNumberNum]['strID'];\n          me.addIScrollToStep(stepNumberNum, data);\n\n          if (stepNumberNum == 0) {\n            me.visitedStepsHash[data.strObjID][stepId] = true;\n          } else {\n            me.visitedStepsHash[data.strObjID][stepId] = false;\n          }\n        }\n      }\n    },\n\n    setContainerDimensions: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var stepsWrapperDomElement = me.$el.find('.filmstripStepsHolderC');\n      var stepDomImages = me.$el.find('.filmstriptStepImageAssetC');\n      var maxAssetWidth = stepsWrapperDomElement.offsetWidth;\n\n      if (me.currOutputMode != 'accessibleC' && me.smallLayout) {\n        maxAssetWidth = maxAssetWidth - 16;\n      }\n\n      var maxHeightFound = 0;\n      var count = 0;\n      var stepData = rawData.arrStepData;\n      var calculatedHeight;\n      var calculatedWidth;\n      while (count < stepData.length) {\n        var currStep = stepData[count];\n        var imageMetaData = MASTER_RENDERER.getImageProperties(\n          gomo.utility.getSrcPath(currStep.objStepData.strSrc)\n        );\n        if (imageMetaData) {\n          if (imageMetaData.strWidth > maxAssetWidth) {\n            var floScaleFactor = maxAssetWidth / imageMetaData.strWidth;\n            calculatedHeight = Math.round(\n              parseInt(imageMetaData.strHeight) * floScaleFactor\n            );\n            calculatedWidth = maxAssetWidth;\n          } else {\n            calculatedHeight = parseInt(imageMetaData.strHeight);\n            calculatedWidth = parseInt(imageMetaData.strWidth);\n          }\n\n          if (calculatedHeight > maxHeightFound) {\n            maxHeightFound = calculatedHeight;\n          }\n\n          var currImageDomElement = stepDomImages[count];\n          if (BOO_CENTER_FILMSTRIP_IMAGES_HORIZONTALLY) {\n            currImageDomElement.style.marginLeft = '-' + Math.round(calculatedWidth / 2) + 'px';\n            currImageDomElement.style.left = '50%';\n          }\n          if (BOO_CENTER_FILMSTRIP_IMAGES_VERTICALLY) {\n            currImageDomElement.style.top = '-' + Math.round(calculatedHeight / 2) + 'px';\n          }\n          currImageDomElement.style.width = calculatedWidth + 'px';\n          currImageDomElement.style.height = calculatedHeight + 'px';\n          currImageDomElement.style.display = 'block';\n        }\n        count++;\n      }\n\n      count = 0;\n      var stepDomWrappers = me.$el.find('.filmstripStepWrapperC');\n      var stepSubscreenDomWrappers = me.$el.find('.filmstripSubScreenWrapperC');\n\n      while (count < stepDomWrappers.length) {\n        var currStepWrapper = stepDomWrappers[count];\n        var currStepSubscreenWrapper = stepSubscreenDomWrappers[count];\n        currStepWrapper.style.width = maxAssetWidth + 'px';\n        if (me.currOutputMode != 'accessibleC' && me.smallLayout) {\n          // IE Workaround\n          currStepSubscreenWrapper.style.width = maxAssetWidth - 40 + 'px';\n          currStepWrapper.style.height = maxHeightFound + 'px';\n        }\n        count++;\n      }\n\n      if (me.currOutputMode != 'accessibleC' && me.smallLayout) {\n        me.$el.style.height = maxHeightFound + 'px';\n      }\n\n      maxAssetWidth = stepsWrapperDomElement.offsetWidth;\n      me.filmstripHeight = maxHeightFound;\n      SCREEN_INTERACTIONS.refreshCurrentIScrollComponent();\n    },\n\n    resetFilmStrip: function() {\n      var me = this;\n      var data = me.data;\n      var stepNumber = 0;\n      var filmstripEl = $('#filmstripStepsHolderC_YY' + data.strObjID + 'YY_WrapperL')[0];\n      var currentStepDomElement = $(filmstripEl).find('.filmstripStepCurrent');\n      var firstStepDomElement = $(filmstripEl).find('.filmstripStepWrapperC')[stepNumber];\n\n      // reset step completion\n      me.visitedStepsHash[data.strObjID] = {};\n      // change current class to first one\n      me.changeCurrentStepClass(currentStepDomElement, $(firstStepDomElement));\n      // move to top\n      data.intMovement = me.calculateMovement(stepNumber);\n      filmstripEl.style.top = data.intMovement + 'px';\n      // set move back to zero as step uses it for 'intCurrentPosition'\n      data.intMovement = 0;\n      // change arrows\n      me.updateNavigation(stepNumber);\n      // reset localisation for the wrapper.\n      data.objRawData.localisedStepLabel = gomo.localiser.get('FILMSTRIP_SLIDE_DESCRIPTION');\n      $('filmstripStepWrapperC').attr('aria-roledescription', data.objRawData.localisedStepLabel);\n    },\n\n    moveFilmstrip: function(e) {\n      e.preventDefault();\n      var me = this;\n      var data = me.data;\n      var rawData = me.data.objRawData;\n      var filmstripSteps = rawData.arrStepData;\n      var currentStepDomElement = me.$el.find('.filmstripStepCurrent');\n      var stepHolderDomElement = me.$el.find('.filmstripStepsHolderC');\n\n      // lock next animation if the current one is still in action\n      if (me.filmstripAnimating) {\n        return;\n      }\n      me.filmstripAnimating = true;\n\n      var isNumberStep = $(e.target).data('isnumberstep') ? true : false;\n      var currentStepNumber = parseInt(currentStepDomElement.data('stepNumber'));\n      var newStepNumber;\n      var moveDirection = parseInt($(e.currentTarget).data('direction'));\n      if (isNumberStep) {\n        newStepNumber = moveDirection;\n      } else {\n        newStepNumber = currentStepNumber + moveDirection;\n      }\n\n      // stop and unlock action if there's no new step\n      if (newStepNumber < 0 || newStepNumber >= filmstripSteps.length) {\n        me.filmstripAnimating = false;\n        return;\n      }\n\n      // get previous movement for 'current position'\n      var currentStepPosition;\n      if (data.intMovement != undefined) {\n        currentStepPosition = data.intMovement;\n      } else {\n        currentStepPosition = 0;\n      }\n\n      // calculate movement\n      data.intMovement = me.calculateMovement(\n        newStepNumber\n      );\n\n      // move it with animation\n      var _onComplete = function() {\n        me.filmstripAnimating = false;\n        me.updateNavigation(newStepNumber);\n        gomo.eventManager.legacy('screenAssetInteracting', data);\n\n        me.sendFilmstripSlideTrackingDataOut(\n          data.objRawData.strID,\n          data.objRawData.strType\n        );\n\n        me.filmstripStatementData[data.strObjID].slideIndex = newStepNumber;\n        me.filmstripStatementData[data.strObjID].slideAvailable = new Date();\n\n        me.sendFilmstripSlideTrackingDataIn(\n          data.objRawData.strID,\n          data.objRawData.strType\n        );\n      };\n\n      me.animationPlay(\n        stepHolderDomElement,\n        'top',\n        currentStepPosition,\n        'top',\n        data.intMovement,\n        {\n          transition: Animator.makeElastic(0.75),\n          duration: me.filmStripMovementTime,\n          onComplete: _onComplete\n        }\n      );\n\n      me.loadStep(newStepNumber, currentStepNumber);\n      var newStepDomElement = me.$el.find('[data-step-number=\"'+newStepNumber+'\"]');\n      me.visitedStepsHash[data.strObjID][filmstripSteps[newStepNumber]['strID']] = true;\n      me.changeCurrentStepClass(currentStepDomElement, newStepDomElement);\n    },\n\n    calculateMovement: function(newStepNumber) {\n      var me = this;\n      var filmstripStepsDomElements = me.$el.find('.filmstripStepWrapperC');\n      var moveValue = 0;\n\n      for (var i = 0; i < newStepNumber; i++) {\n        moveValue -= filmstripStepsDomElements[i].clientHeight;\n      }\n\n      return moveValue;\n    },\n\n    updateNavigation: function(stepNumber) {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var upArrowDomElement = me.$el.find('.filmstripUpArrowC');\n      var downArrowDomElement = me.$el.find('.filmstripDownArrowC');\n      var stepNumbersDomElements = me.$el.find('.filmstripNumStepC');\n\n      if (stepNumber === 0) {\n        upArrowDomElement.addClass('filmstripUpArrowDisabledC').attr('aria-hidden', true);\n        if (stepNumbersDomElements.length) {\n          $(stepNumbersDomElements[0])\n            .addClass('inactiveC visitedC')\n            .removeClass('activeC unvisitedC');\n        }\n      } else {\n        upArrowDomElement.removeClass('filmstripUpArrowDisabledC').attr('aria-hidden', false);\n        if (stepNumbersDomElements.length) {\n          $(stepNumbersDomElements[stepNumber])\n            .removeClass('unvisitedC inactiveC')\n            .addClass('visitedC activeC');\n        }\n      }\n\n      if (stepNumber === rawData.arrStepData.length-1) {\n        downArrowDomElement.addClass('filmstripDownArrowDisabledC').attr('aria-hidden', true);\n        if (stepNumbersDomElements.length) {\n          $(stepNumbersDomElements[0])\n            .addClass('inactiveC visitedC')\n            .removeClass('activeC unvisitedC');\n        }\n      } else {\n        downArrowDomElement.removeClass('filmstripDownArrowDisabledC').attr('aria-hidden', false);\n      }\n      // Set focus to current slide\n      me.$el\n        .find('[data-step-number=\"' + stepNumber + '\"]')\n        .attr('tabindex', -1)[0]\n        .focus();\n    },\n\n    animationPlay: function(\n      currentStepDomElement,\n      effectStartStyle,\n      effectStartValue,\n      effectEndStyle,\n      effectEndValue,\n      animationOptions\n    ) {\n      var arrAnimations = [\n        {style: effectStartStyle, value: effectStartValue},\n        {style: effectEndStyle, value: effectEndValue}\n      ];\n\n      var animationData = ANIMATOR_INTERFACE.objAnimate(\n        'seekTo(1)',\n        currentStepDomElement[0],\n        arrAnimations,\n        animationOptions.duration,\n        'elastic',\n        animationOptions.onComplete\n      );\n      ANIMATOR_INTERFACE.animate(animationData);\n    },\n\n    loadStep: function(newStepNumber, previousStepNumber) {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      if (rawData.arrStepData && rawData.arrStepData.length) {\n        var subScreenId =\n          rawData.arrStepData[newStepNumber].arrActions[0].objParameters.strSubScreenID;\n\n        // Unload the previous step...\n        if (previousStepNumber !== null) {\n          var previousSubScreenId =\n            rawData.arrStepData[previousStepNumber].arrActions[0].objParameters.strSubScreenID;\n          SUB_SCREEN_INTERACTIONS._resetSubscreenAssets(previousSubScreenId);\n          SUB_SCREEN_INTERACTIONS._hideSubScreensPostRenderAssets(previousSubScreenId);\n        }\n        // Load the new step...\n        SUB_SCREEN_INTERACTIONS._showSubScreensPostRenderAssets(subScreenId);\n      }\n    },\n\n    changeCurrentStepClass: function(currentStepDomElement, newStepDomElement) {\n      $(currentStepDomElement)\n        .removeClass('filmstripStepCurrent')\n        .attr('aria-hidden', true)\n        .attr('aria-current', false);\n      $(newStepDomElement)\n        .addClass('filmstripStepCurrent')\n        .attr('aria-hidden', false)\n        .attr('aria-current', true);\n    },\n\n    addIScrollToStep: function(newStep) {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      if (me.currOutputMode == 'tabletC') {\n        var currStep = rawData['arrStepData'][newStep];\n        if (\n          currStep['arrActions'].length > 0 &&\n          currStep['arrActions'][0].objParameters &&\n          currStep['arrActions'][0].objParameters.strSubScreenID\n        ) {\n          var subscreenId = currStep['arrActions'][0].objParameters.strSubScreenID;\n          if (subscreenId) {\n            var stepSubscreenDomElement =\n              SUB_SCREEN_INTERACTIONS.getSubScreenDOMElement(subscreenId);\n            if (typeof ISCROLL_INTERFACE != 'undefined') {\n              ISCROLL_INTERFACE.recycleScroller(stepSubscreenDomElement);\n              ISCROLL_INTERFACE.parseChildDOMElements(stepSubscreenDomElement, true);\n            }\n          }\n        }\n      }\n    },\n\n    sendFilmstripSlideTrackingDataIn: function(assetId, assetType) {\n      var me = this;\n      var index = me.filmstripStatementData[assetId].slideIndex;\n      var subscreenData = me.filmstripStatementData[assetId].subscreens[index];\n\n      CONTENT_TRACKING.interaction({\n        type: 'experienced',\n        activity: {\n          id: subscreenData.strID,\n          type: 'subscreen',\n          title: subscreenData.strTitle\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n    },\n\n    sendFilmstripSlideTrackingDataOut: function(assetId, assetType) {\n      var me = this;\n      var slideAvailable = me.filmstripStatementData[assetId].slideAvailable;\n      var index = me.filmstripStatementData[assetId].slideIndex;\n      var subscreenData = me.filmstripStatementData[assetId].subscreens[index];\n\n      CONTENT_TRACKING.interaction({\n        type: 'left',\n        activity: {\n          id: subscreenData.strID,\n          type: 'subscreen',\n          title: subscreenData.strTitle\n        },\n        response: {\n          timeAvailable: slideAvailable,\n          timeResponse: new Date()\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n    }\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('filmstrip', Filmstrip);\n})();\n"},function(t,e,n){n(0)(n(51))},function(t,e){t.exports="/* globals ASSET_RENDERER, LOCALISER, SCREEN_INTERACTIONS, CORE, O_EXTENDER, ASSET_INTERACTIONS,\nEM */\n/**\n * @title The hottext asset\n * @description Creates buttons that when clicked will open a subscreen.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('hottext', objCurrSupportData);\n\nvar HOT_TEXT_ASSET_RENDERER = {\n  strObjID: 'The hot text asset inspector extension object',\n  _arrAssetHTMLTemplateIDs: [['hottext', 'hottextAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['hottextItem', 'hottextItemWrapperC']],\n\n  // ***************************** Property extensions *****************************\n\n  // ***************************** Render methods extensions *****************************\n  _render_hottext_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatAssetCourseObject.renderLang = gomo.translationManager.langCode;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData.strType];\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_HOT_TEXT_ITEMS_XX',\n        this._generateHotTextItems(_objWhatRawAssetData, _objWhatAssetCourseObject)\n      );\n\n      // STYLE_CHECKER.addStyle(_objWhatRawAssetData[\"strTextStyle\"]);\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get('HOT_TEXT_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData.strType\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData.strID;\n      var _strReturnValue = LOCALISER.get('HOT_TEXT_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData.strID\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  _generateHotTextItems: function(_objWhatRawAssetData, _objWhatAssetCourseObject) {\n    if (_objWhatRawAssetData.arrHottext && _objWhatRawAssetData.arrHottext.length > 0) {\n      var count = 0;\n      var _htmHotTexts = '';\n\n      while (count < _objWhatRawAssetData.arrHottext.length) {\n        var _objCurrHotTextData = _objWhatRawAssetData.arrHottext[count];\n        var _htmCurrHotText = this._objSubAssetTemplates['hottextItem'];\n\n        _htmCurrHotText = _htmCurrHotText.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n        _htmCurrHotText = _htmCurrHotText.replace(/XX_SUB_ASSET_ID_XX/g, _objCurrHotTextData.strID);\n        _htmCurrHotText = _htmCurrHotText.replace(/XX_HOT_TEXT_ARRAY_POSITION_XX/g, count);\n\n        _htmCurrHotText = _htmCurrHotText.replace(/XX_HOTTEXT_ITEM_INDEX_XX/g, count);\n\n        switch (_objWhatAssetCourseObject.arrOptionStates[count - 1]) {\n          case 'highlighted':\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_CLASS_XX/g,\n              'selectedHotTextItemC'\n            );\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_TEXT_XX/g,\n              LOCALISER.get('HOTTEXT_SELECTED_OPTION')\n            );\n            break;\n          case 'visited':\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_CLASS_XX/g,\n              'visitedHotTextItemC'\n            );\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_TEXT_XX/g,\n              LOCALISER.get('HOTTEXT_VISITED_OPTION')\n            );\n            break;\n          default:\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_CLASS_XX/g,\n              'unvisitedHotTextItemC'\n            );\n            _htmCurrHotText = _htmCurrHotText.replace(\n              /XX_HOT_TEXT_STATE_TEXT_XX/g,\n              LOCALISER.get('HOTTEXT_UNVISITED_OPTION')\n            );\n            break;\n        }\n        _htmCurrHotText = _htmCurrHotText.replace(\n          /XX_HOT_TEXT_CONTENT_XX/g,\n          this.insertFormattedHtml(_objCurrHotTextData.strText)\n        );\n\n        _htmHotTexts += _htmCurrHotText;\n        count++;\n      }\n      return _htmHotTexts;\n    } else {\n      // return \"ERROR: No hot text items found for '\" + _objWhatRawAssetData.strID + \"'.\";\n      var _strNoItemsError = LOCALISER.get('HOT_TEXT_NO_ITEMS_ERROR', [_objWhatRawAssetData.strID]);\n      return _strNoItemsError;\n    }\n  }\n  // ***************************** Update methods extensions *****************************\n\n  // ***************************** Helper methods extensions *****************************\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, HOT_TEXT_ASSET_RENDERER);\n\nvar HOTTEXT_ASSET_INTERACTIONS = {\n  strObjID: 'The hot text asset interactions extension object',\n\n  _strHotTextIDPrefix: 'hottextItem_',\n  _strHotTextIDSuffix: '_L',\n\n  _strHotTextItemClass: 'hottextSubAssetC',\n\n  _strHotTextItemHighlightedState: 'highlighted',\n  _strHotTextItemVisitedState: 'visited',\n  _strHotTextItemUnvisitedState: 'unvisited',\n\n  _strUnvisitedItemTitle: 'Unvisited item',\n  _strHighlightedItemTitle: 'Highlighted item',\n  _strVisitedItemTitle: 'Visited item',\n\n  handleEvent_showHotTextItem: function(_objWhatHotTextData) {\n    var _objAssetCourseData = ASSET_INTERACTIONS.getAssetData(_objWhatHotTextData['strAssetID']);\n\n    var _domCurrItem = _objWhatHotTextData['domLink'];\n\n    _objAssetCourseData.arrOptionStates[\n      _objWhatHotTextData.intHottextItemIndex\n    ] = this._strHotTextItemHighlightedState;\n    _domCurrItem.className = _domCurrItem.className.replace(\n      ' ' + this._strHotTextItemVisitedState,\n      ' ' + this._strHotTextItemHighlightedState\n    );\n    _domCurrItem.className = _domCurrItem.className.replace(\n      ' ' + this._strHotTextItemUnvisitedState,\n      ' ' + this._strHotTextItemHighlightedState\n    );\n    _domCurrItem.title = LOCALISER.get('HOTTEXT_SELECTED_OPTION');\n    _objAssetCourseData.strLastInteractedSubAssetID = _objWhatHotTextData['strSubAssetID'];\n\n    for (var count = 0; _objAssetCourseData.objRawData.arrHottext.length > count; count++) {\n      if (\n        _objAssetCourseData.objRawData.arrHottext[count].strID ==\n        _objWhatHotTextData['strSubAssetID']\n      ) {\n        _objWhatHotTextData.arrActions =\n          _objAssetCourseData.objRawData.arrHottext[count].arrActions;\n      }\n    }\n\n    var _objActionOptions = {};\n    _objActionOptions.objActions = _objWhatHotTextData.arrActions;\n    _objActionOptions.objOptionalExtraData = _objWhatHotTextData;\n\n    EM.trigger('screenAssetInteracting', _objAssetCourseData);\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  is_hottext_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _resetHotTextItemStates: function(_objWhatAssetData, _booFullReset) {\n    var _domScreenWrapper = SCREEN_INTERACTIONS.getScreenWrapper(\n      _objWhatAssetData.objParent.strObjID\n    );\n    var _arrHotTextItems = CORE.getElementsByClassName(\n      _domScreenWrapper,\n      this._strHotTextItemClass\n    );\n\n    var count = 0;\n    while (count < _arrHotTextItems.length) {\n      var _domCurrItem = _arrHotTextItems[count];\n\n      var _strHotTextAssetID = this._getHotTextItemAssetID(_domCurrItem.id);\n      var _objCurrAssetData = _objWhatAssetData.objParent.findAsset(_strHotTextAssetID);\n      var _arrCurrAssetHotTextState = _objCurrAssetData.arrOptionStates;\n\n      if (_booFullReset) {\n        _domCurrItem.className = _domCurrItem.className.replace(\n          ' ' + this._strHotTextItemHighlightedState,\n          ' ' + this._strHotTextItemUnvisitedState\n        );\n        _domCurrItem.className = _domCurrItem.className.replace(\n          ' ' + this._strHotTextItemVisitedState,\n          ' ' + this._strHotTextItemUnvisitedState\n        );\n        _domCurrItem.title = LOCALISER.get('HOTTEXT_UNVISITED_OPTION');\n        _arrCurrAssetHotTextState = [];\n      } else {\n        if (_domCurrItem.className.indexOf(' ' + this._strHotTextItemHighlightedState) > -1) {\n          _domCurrItem.className = _domCurrItem.className.replace(\n            ' ' + this._strHotTextItemHighlightedState,\n            ' ' + this._strHotTextItemVisitedState\n          );\n          _domCurrItem.title = LOCALISER.get('HOTTEXT_VISITED_OPTION');\n          _arrCurrAssetHotTextState[0] = this._strHotTextItemVisitedState;\n        }\n      }\n      count++;\n    }\n  },\n\n  _returnFocusToHOTTEXTAsset: function(_domWhatAssetElement, _objAssetData) {\n    var _strAssetID = _objAssetData['strObjID'];\n    var _strLastSubAssetID = _objAssetData['strLastInteractedSubAssetID'];\n    var _domHotspotLink = this._objWhatDOM.getElementById(\n      this._strHotTextIDPrefix +\n        'YY' +\n        _strAssetID +\n        'YY_' +\n        _strLastSubAssetID +\n        this._strHotTextIDSuffix\n    );\n    this._resetHotTextItemStates(_objAssetData, false);\n    _domHotspotLink.focus();\n  },\n\n  _getHotTextItemAssetID: function(_strWhatDOMID) {\n    // hottextItem_XX_ASSET_ID_XX_XX_SUB_ASSET_ID_XX_L\n    var _arrIDSplit = _strWhatDOMID.split('YY');\n    return _arrIDSplit[1];\n  },\n\n  _reset_hottext_Asset: function(_objWhatAssetData, _booFullReset) {\n    this._resetHotTextItemStates(_objWhatAssetData, true);\n    _objWhatAssetData.booComplete = false;\n    _objWhatAssetData.arrOptionStates = [];\n  },\n\n  _checkCompletion_hottext_Asset: function(_objWhatAssetDataWrapper) {\n    if (ASSET_RENDERER.doesAssetSupportOutputMode(_objWhatAssetDataWrapper.objRawData.strType)) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n        _objWhatAssetDataWrapper['objRawData']\n      );\n      var _arrUnvisitedItems = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        'unvisitedHotTextItemC'\n      );\n\n      return _arrUnvisitedItems.length == 0;\n    }\n  },\n\n  _performLanguagePreprocess_hottext_Asset: function(_objWhatAssetData) {\n    // Don't reset anything if we're already showing the current translation lang\n    if (_objWhatAssetData.objParent.renderLang === gomo.translationManager.langCode) {\n      return;\n    }\n    _objWhatAssetData.objParent.renderLang = gomo.translationManager.langCode;\n    this._resetHotTextItemStates(_objWhatAssetData, true);\n  },\n\n  getAccessibleElements_hottext: function() {\n    var accessibleElements = ['.hottextSubAssetC'];\n    return accessibleElements;\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, HOTTEXT_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(53))},function(t,e){t.exports="/* globals ASSET_RENDERER, O_EXTENDER, ASSET_INTERACTIONS, EM, TOPIC_STRUCTURE_PARSER, $ */\n\n/**\n * @title Button image asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the image asset\n * type.\n *\n * @author Johnathan Castle\n * @version 1.0 10/4/14\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('imagebutton', objCurrSupportData);\n\nvar IMAGE_BUTTON_ASSET_RENDERER = {\n  strObjID: 'The image button asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['imagebutton', 'imagebuttonAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_imagebutton_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData.strType];\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n      }\n      _htmReturnData = _htmReturnData.replace(\n        'resources/trans.gif?',\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objNormalSrc.strSrc) +\n        decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n\n      _objWhatRawAssetData.renderImagePath = 'objNormalSrc';\n\n      _htmReturnData = _htmReturnData.replace(/XX_ASSET_ID_EVENT_XX/g, _objWhatRawAssetData.strID);\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XXTEXTXX/g,\n        this.sanitiseAltText(_objWhatRawAssetData.objNormalSrc.strAltText)\n      );\n\n      if (_objWhatRawAssetData.arrActions && _objWhatRawAssetData.arrActions.length) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_DISABLED_XX',\n          ASSET_INTERACTIONS.checkEnabledState(_objWhatRawAssetData) ? '' : 'disableInteractions'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace('XX_DISABLED_XX', '');\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ALIGNMENT_CLASS_XX/g, _objWhatRawAssetData['strAlignment']\n      );\n      return _htmReturnData;\n    }\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IMAGE_BUTTON_ASSET_RENDERER);\n\nvar IMAGE_BUTTON_ASSET_INTERACTIONS = {\n  strObjID: 'The button image asset interactions extension object',\n\n  handleEvent_imageButtonAction: function(_objButtonData) {\n    var _objWhatAssetData = ASSET_INTERACTIONS.getAssetData(_objButtonData.strAssetID);\n    _objWhatAssetData.objRawData.booClicked = true;\n\n    var _objActionOptions = {};\n    _objActionOptions.objActions = _objWhatAssetData.objRawData.arrActions;\n    _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n    _objActionOptions.objOptionalExtraData.strAssetID = _objButtonData.strAssetID;\n    _objActionOptions.objOptionalExtraData.domLink = _objButtonData.domLink;\n\n    // Example feed back for completion of subscreen display.\n    // _objActionOptions.objOptionalExtraData.funTriggerCallBack = function(){alert('Screen\n    // displayed for Action ' + _objButtonData.strAssetID)};\n\n    EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  handleEvent_imageButtonOver: function(_objEventData) {\n    var _objWhatAssetData = ASSET_INTERACTIONS.getAssetData(_objEventData['strAssetID']);\n\n    _objWhatAssetData.objRawData.renderImagePath = 'objOverSrc';\n    gomo.translationManager.setImage(\n      _objWhatAssetData.objRawData.strID,\n      _objWhatAssetData.objRawData.renderImagePath\n    );\n\n    var _domSourceElement = _objEventData['domSourceElement'];\n    _domSourceElement.src = decodeURIComponent(_domSourceElement.src).replace(\n      decodeURIComponent(_objWhatAssetData.objRawData['objNormalSrc']['strSrc']),\n      decodeURIComponent(_objWhatAssetData.objRawData['objOverSrc']['strSrc'])\n    );\n  },\n\n  handleEvent_imageButtonOut: function(_objEventData) {\n    var _objWhatAssetData = ASSET_INTERACTIONS.getAssetData(_objEventData['strAssetID']);\n\n    _objWhatAssetData.objRawData.renderImagePath = 'objNormalSrc';\n    gomo.translationManager.setImage(\n      _objWhatAssetData.objRawData.strID,\n      _objWhatAssetData.objRawData.renderImagePath\n    );\n\n    var _domSourceElement = _objEventData['domSourceElement'];\n    _domSourceElement.src = decodeURIComponent(_domSourceElement.src).replace(\n      decodeURIComponent(_objWhatAssetData.objRawData['objOverSrc']['strSrc']),\n      decodeURIComponent(_objWhatAssetData.objRawData['objNormalSrc']['strSrc'])\n    );\n  },\n\n  _returnFocusToIMAGEBUTTONAsset: function(_domWhatAssetElement, _objAssetData) {},\n\n  _reset_imagebutton_Asset: function(_objWhatAssetData, _booFullReset) {},\n\n  is_imagebutton_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _checkCompletion_imagebutton_Asset: function(_objWhatAssetData) {\n    if (_objWhatAssetData.objRawData.booClicked) {\n      return true;\n    }\n    return false;\n  },\n\n  _performLanguagePreprocess_imagebutton_Asset: function(_objWhatAssetData) {\n    gomo.translationManager.setImage(\n      _objWhatAssetData.strObjID,\n      _objWhatAssetData.objRawData.renderImagePath\n    );\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetData.objRawData.strID);\n    if (found) {\n      this.updateImgButtonAlignment(found);\n    }\n  },\n\n  updateImgButtonAlignment: function(data) {\n    var imgButtonElement = $('#imagebuttonAsset_YY' + data.id + 'YY_WrapperL');\n    if (imgButtonElement.length && typeof data.strAlignment !== 'undefined') {\n      imgButtonElement[0].className =\n        imgButtonElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      imgButtonElement.addClass(data.strAlignment);\n    }\n  },\n\n  getAccessibleElements_imagebutton: function() {\n    var accessibleElements = ['.imageButtonAssetC'];\n    return accessibleElements;\n  },\n\n  _switchState_imagebutton_Asset: function(assetData, enabled) {\n    var buttonWrapperID = '#' + assetData.strType +\n    'Asset_YY' + assetData.strID + 'YY' + this.strMenuDomSuffix;\n    $(buttonWrapperID).find('a').toggleClass('disableInteractions', !enabled);\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IMAGE_BUTTON_ASSET_INTERACTIONS);\n\nvar IMAGE_BUTTON_PREPROCESSOR = {\n  strObjID: 'The image asset pre extension object',\n\n  _preProcess_imagebutton_Asset: function(_objWhatRawAssetData, _objWhatParentScreenObject) {\n    // If the user hasn't specified a over path, make it equal the base path to prevent broken\n    // images\n    if (\n      !_objWhatRawAssetData['objOverSrc']['strSrc'] ||\n      _objWhatRawAssetData['objOverSrc']['strSrc'] == ''\n    ) {\n      _objWhatRawAssetData['objOverSrc']['strSrc'] = _objWhatRawAssetData['objNormalSrc']['strSrc'];\n    }\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, IMAGE_BUTTON_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(55))},function(t,e){t.exports="/* globals ASSET_RENDERER, LOCALISER, MASTER_RENDERER, BOO_SHOW_HIDDEN_ELEMENTS, O_EXTENDER, $, EM,\nBOO_USE_SPRITE_SHEET_HOTSPOTS, CORE, SCREEN_INTERACTIONS, ASSET_INTERACTIONS,\nTOPIC_STRUCTURE_PARSER, _\n*/\n\n/**\n * @title Image asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the image asset\n * type.\n *\n * @author Johnathan Castle\n * @version 0.1 23/09/10\n * @version 2.0 12/03/12\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('imagehotspot', objCurrSupportData);\n\nvar IMAGE_HOTSPOT_ASSET_RENDERER = {\n  strObjID: 'The hotspot image asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['imagehotspot', 'imagehotspotAssetTemplateWrapperC']\n  ],\n  _arrSubAssetHTMLTemplateIDs: [\n    ['hotspot', 'imagehotspotAssetHotspotTemplateWrapperC'],\n    ['hotspot_sprite', 'imagehotspotAssetHotspotSpriteWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_imagehotspot_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[\n        _objWhatRawAssetData.strType\n      ];\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n      }\n      _htmReturnData = _htmReturnData.replace(\n        'resources/trans.gif?',\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objNormalSrc.strSrc) +\n          decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      if (_objWhatRawAssetData.objNormalSrc.strAltText) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_TEXT_XX/g,\n          this.sanitiseAltText(_objWhatRawAssetData.objNormalSrc.strAltText)\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(/XX_TEXT_XX/g, '');\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XXIMAGE_HOTSPOTSXX',\n        this._renderImageHotspotSubAssets(\n          _objWhatRawAssetData,\n          _objWhatAssetCourseObject\n        )\n      );\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get('IMAGE_HOTSPOT_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData.strType\n      ]);\n      this.debug(_strDebugError, 3);\n\n      var _strReturnValue = LOCALISER.get(\n        'IMAGE_HOTSPOT_RETURN_TEMPLATE_ERROR',\n        [_objWhatRawAssetData.strID]\n      );\n      return _strReturnValue;\n    }\n  },\n\n  _renderImageHotspotSubAssets: function(\n    _objWhatRawAssetData,\n    _objWhatAssetCourseObject\n  ) {\n    if (\n      _objWhatRawAssetData['arrHotspots'] &&\n      _objWhatRawAssetData['arrHotspots'].length > 0\n    ) {\n      var count = 0;\n      var _htmHotspots = '';\n\n      var _objImageMetaData = MASTER_RENDERER.getImageProperties(\n        decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n\n      var _intImageWidth = _objImageMetaData.strWidth;\n      var _intImageHeight = _objImageMetaData.strHeight;\n\n      while (count < _objWhatRawAssetData['arrHotspots'].length) {\n        var _objCurrHotspotData = _objWhatRawAssetData['arrHotspots'][count];\n        var _objCurrHotspotCoordsData = _objCurrHotspotData['objCoords'];\n\n        var _htmCurrHotspot = this._objSubAssetTemplates['hotspot'];\n\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          /XX_ASSET_ID_XX/g,\n          _objWhatRawAssetData['strID']\n        );\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          /XX_SUB_ASSET_ID_XX/g,\n          _objWhatRawAssetData['arrHotspots'][count]['strID']\n        );\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          /XX_TAB_INDEX_XX/g,\n          (count + 1) * 5\n        );\n        var _objCSSData = this._generatePercentileHotspotWrapperCSS(\n          _objCurrHotspotCoordsData,\n          _intImageWidth,\n          _intImageHeight\n        );\n        var _strCSSText = _objCSSData['strCSSText'];\n        var _objCoordsData = _objCSSData['objCoordsData'];\n\n        if (BOO_SHOW_HIDDEN_ELEMENTS && !BOO_USE_SPRITE_SHEET_HOTSPOTS) {\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            'class=\"hotspotSubAssetC\"',\n            'class=\"hotspotSubAssetC shownHotspotItemC\" ' + _strCSSText\n          );\n        } else {\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            'class=\"hotspotSubAssetC\"',\n            'class=\"hotspotSubAssetC\" ' + _strCSSText\n          );\n        }\n\n        if (BOO_USE_SPRITE_SHEET_HOTSPOTS) {\n          var _htmHotspotContent = this._generateImageHotspotSprite(\n            _objWhatRawAssetData,\n            _objCurrHotspotData,\n            _intImageWidth,\n            _intImageHeight,\n            _objCoordsData,\n            count\n          );\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_HOTSPOT_CONTENT_XX/g,\n            _htmHotspotContent\n          );\n        } else {\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_HOTSPOT_CONTENT_XX/g,\n            _objCurrHotspotData['strText']\n          );\n        }\n\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          /XX_HOTSPOT_ALT_TEXT_XX/g,\n          _objCurrHotspotData['strText']\n        );\n\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          /XX_HOTSPOT_INDEX_XX/g,\n          count\n        );\n\n        _htmHotspots += _htmCurrHotspot;\n        count++;\n      }\n      return _htmHotspots;\n    } else {\n      return '';\n    }\n  },\n\n  // <img src=\"resources/trans.gif?\" alt=\"XX_SPRITE_TEXT_XX\" class=\"hotspotSpriteImageC\"/>\n  _generateImageHotspotSprite: function(\n    _objWhatRawAssetData,\n    _objWhatHotspotData,\n    _intImageWidth,\n    _intImageHeight,\n    _objParentWrapperCoordsData,\n    count\n  ) {\n    var _htmSpriteTemplate = this._objSubAssetTemplates['hotspot_sprite'];\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      /resources\\/trans.gif\\?/g,\n      gomo.utility.getSrcPath(_objWhatRawAssetData.objNormalSrc.strSrc)\n    );\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      'XX_HOTSPOT_SRC_XX',\n      decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n    );\n\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      /alt=\"XX_SPRITE_TEXT_XX\"/g,\n      'alt=\"' + _objWhatHotspotData['strText'] + '\"'\n    );\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      /alt=XX_SPRITE_TEXT_XX/g,\n      'alt=\"' + _objWhatHotspotData['strText'] + '\"'\n    );\n\n    var _strCSSInfo = '';\n    _strCSSInfo = this._generatePercentileHotspotImageCSS(\n      _objWhatHotspotData['objCoords'],\n      _intImageWidth,\n      _intImageHeight,\n      _objParentWrapperCoordsData\n    );\n\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      'class=\"hotspotSpriteImageC\"',\n      'class=\"hotspotSpriteImageC\" ' + _strCSSInfo\n    );\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(\n      'class=hotspotSpriteImageC',\n      'class=\"hotspotSpriteImageC\" ' + _strCSSInfo\n    );\n\n    _htmSpriteTemplate = _htmSpriteTemplate.replace(/XX_HOTSPOT_ID_XX/g, count);\n\n    return _htmSpriteTemplate;\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IMAGE_HOTSPOT_ASSET_RENDERER);\n\nvar IMAGE_HOTSPOT_ASSET_INTERACTIONS = {\n  strObjID: 'The hotspot image asset interactions extension object',\n\n  _strImageHotspotIDPrefix: 'imageHotspot_',\n  _strImageHotspotIDSuffix: '_L',\n\n  _strCurrentAssetID: '',\n\n  _strHotspotSpriteClass: 'hotspotSpriteImageC',\n  _strInitialInstructionText: 'initialInstructionC',\n  _strFinalInstructionText: 'finalInstructionC',\n\n  _strHotspotHighlightedState: 'highlighted',\n  _strHotspotVisitedState: 'visited',\n  _strCurrentHotspot: '',\n\n  _performLanguagePreprocess_imagehotspot_Asset: function(\n    _objWhatAssetCourseObject\n  ) {\n    var rawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    // Convert image data for knockout updates\n    gomo.translationManager.setImage(rawAssetData.strID, 'objNormalSrc', {\n      newPath: 'renderPrimary'\n    });\n    var count = 0;\n    while (count < rawAssetData.arrHotspots.length) {\n      var newPathString = 'renderSecondary' + count;\n      gomo.translationManager.setImage(rawAssetData.strID, 'objNormalSrc', {\n        newPath: newPathString\n      });\n      count++;\n    }\n\n    // Update coords data in hotspot CSS\n    var imageMetaData = MASTER_RENDERER.getImageProperties(\n      decodeURIComponent(rawAssetData.objNormalSrc.strSrc)\n    );\n\n    var imageWidth = imageMetaData.strWidth;\n    var imageHeight = imageMetaData.strHeight;\n\n    count = 0;\n    while (count < rawAssetData['arrHotspots'].length) {\n      var _objCurrHotspotData = rawAssetData['arrHotspots'][count];\n      var _objCurrHotspotCoordsData = _objCurrHotspotData['objCoords'];\n\n      var _objCSSData = ASSET_RENDERER._generatePercentileHotspotWrapperCSS(\n        _objCurrHotspotCoordsData,\n        imageWidth,\n        imageHeight\n      );\n      var _objCoordsData = _objCSSData['objCoordsData'];\n\n      var hotspotElementId =\n        '#imageHotspot_' +\n        rawAssetData.strID +\n        '_' +\n        _objCurrHotspotData.strID +\n        '_L';\n      var hotspotElement = $(hotspotElementId);\n      hotspotElement.css(\n        'height',\n        _objCoordsData.objInPercentage.intHeight + '%'\n      );\n      hotspotElement.css(\n        'width',\n        _objCoordsData.objInPercentage.intWidth + '%'\n      );\n      hotspotElement.css('left', _objCoordsData.objInPercentage.intLeft + '%');\n      hotspotElement.css('top', _objCoordsData.objInPercentage.intTop + '%');\n\n      var hotspotElementImage = $(hotspotElementId + ' .hotspotSpriteImageC');\n      var imageCSSInfoString = ASSET_RENDERER._generatePercentileHotspotImageCSS(\n        _objCurrHotspotCoordsData,\n        imageWidth,\n        imageHeight,\n        _objCoordsData,\n        true\n      );\n      var imageCSSInfo = imageCSSInfoString.split(';');\n\n      var countCss = 0;\n      while (countCss < imageCSSInfo.length) {\n        var cssItem = imageCSSInfo[countCss].split(':');\n        hotspotElementImage.css(cssItem[0].replace(' ', ''), cssItem[1]);\n        countCss++;\n      }\n\n      // Translate hotspot description\n      this.translateHotspotTitle(_objWhatAssetCourseObject);\n\n      // Update the alignment\n      var found =\n        gomo.translationManager.findDataByAssetId(_objWhatAssetCourseObject.objRawData.strID);\n      if (found) {\n        this.updateImgHotspotAlignment(found);\n      }\n      count++;\n    }\n  },\n\n  updateImgHotspotAlignment: function(data) {\n    var imgHotspotElement = $('#imagehotspotAsset_YY' + data.id + 'YY_WrapperL');\n    if (imgHotspotElement.length && typeof data.strAlignment !== 'undefined') {\n      imgHotspotElement[0].className =\n        imgHotspotElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      imgHotspotElement.addClass(data.strAlignment);\n    }\n  },\n\n  /**\n   * Translate the hotspot description.\n   * @param {Object} _objWhatAssetData - The asset data containing the text to translate.\n   */\n  translateHotspotTitle: function(_objWhatAssetData) {\n    var assetId = _objWhatAssetData.objRawData.strID;\n    var countTopic = 0;\n    var countHotspots = 0;\n\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {id: assetId});\n\n          // Translate hotspot description\n          if (found && found['arrHotspots'] && found.arrHotspots.length > 0) {\n            while (countHotspots < found.arrHotspots.length) {\n              _objWhatAssetData.objRawData.arrHotspots[countHotspots].strText =\n                found.arrHotspots[countHotspots].strText;\n              gomo.translationManager.htmlDecodeAssetTranslations(\n                _objWhatAssetData.strObjID,\n                ['arrHotspots[' + countHotspots + '].strText']\n              );\n              countHotspots++;\n            }\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n  },\n\n  handleEvent_showImageHotSpot: function(_objWhatHotSpotData) {\n    var _objAssetCourseData = this.getAssetData(\n      _objWhatHotSpotData['strAssetID']\n    );\n    var _objAssetRawData = _objAssetCourseData.objRawData;\n    var _intHotspotIndex = _objWhatHotSpotData.intHotspotIndex;\n\n    this._resetHotspotStates(_objAssetCourseData, false);\n\n    var _domCurrSprite = CORE.getElementsByClassName(\n      _objWhatHotSpotData['domLink'],\n      this._strHotspotSpriteClass\n    )[0];\n    var unescapedNormalImageSrc = decodeURIComponent(\n      _objAssetRawData.objNormalSrc.strSrc\n    );\n    var unescapedActiveImageSrc = decodeURIComponent(\n      _objAssetRawData.objActiveSrc.strSrc\n    );\n    var unescapedVisitedImageSrc = decodeURIComponent(\n      _objAssetRawData.objVisitedSrc.strSrc\n    );\n\n    var domCurrSpriteDecoded = decodeURIComponent(_domCurrSprite.src);\n\n    var fromImage = domCurrSpriteDecoded.indexOf(unescapedNormalImageSrc) > -1\n      ? unescapedNormalImageSrc\n      : unescapedVisitedImageSrc;\n    this._updateImageSource(_domCurrSprite, fromImage, unescapedActiveImageSrc);\n\n    // Update translation to active image\n    if (gomo && gomo.translationManager) {\n      var newPathString = 'renderSecondary' + _intHotspotIndex;\n      gomo.translationManager.setImage(_objAssetRawData.strID, 'objActiveSrc', {\n        newPath: newPathString\n      });\n    }\n\n    _objAssetCourseData.arrOptionStates[\n      _intHotspotIndex\n    ] = this._strHotspotHighlightedState;\n\n    _objAssetCourseData.strLastInteractedSubAssetID =\n      _objWhatHotSpotData.strSubAssetID;\n    _objAssetCourseData.strAssetID = _objWhatHotSpotData.strAssetID;\n    _objAssetCourseData.domLink = _objWhatHotSpotData.domLink;\n\n    EM.trigger('screenAssetInteracting', _objAssetCourseData);\n    this._strCurrentHotspot = _objWhatHotSpotData['strAssetID'];\n\n    if (\n      _objAssetRawData.arrHotspots[_intHotspotIndex].arrActions &&\n      _objAssetRawData.arrHotspots[_intHotspotIndex].arrActions.length > 0\n    ) {\n      var _objActionOptions = {};\n      _objActionOptions.objActions =\n        _objAssetRawData.arrHotspots[_intHotspotIndex].arrActions;\n      _objActionOptions.objOptionalExtraData = _objAssetCourseData;\n\n      EM.trigger('processActions', _objActionOptions);\n    } else {\n      console.log(\n        'No actions found for the hotspot attached to the asset \\'' +\n          _objWhatHotSpotData['strAssetID'] +\n          '\\'.'\n      );\n    }\n  },\n\n  handleEvent_screenSizeChanged: function() {\n    // Popups are hidden by subscreen manager on resize. So ensure the relevant resets are called.\n    if (this._strCurrentHotspot) {\n      var _objAssetCourseData = this.getAssetData(this._strCurrentHotspot);\n      this._resetHotspotStates(_objAssetCourseData, false);\n      SCREEN_INTERACTIONS.returnFocusToScreen();\n    }\n  },\n\n  is_imagehotspot_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _resetHotspotStates: function(_objWhatAssetData, _booFullReset) {\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n      _objWhatAssetData.objRawData\n    );\n    var _arrHotspotSprites = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strHotspotSpriteClass\n    );\n    var _arrHotspotStates = _objWhatAssetData.arrOptionStates;\n    var count = 0;\n    var newPathString;\n    while (count < _arrHotspotSprites.length) {\n      var _domCurrSprite = _arrHotspotSprites[count];\n      var unescapedNormalImageSrc = decodeURIComponent(\n        _objWhatAssetData.objRawData.objNormalSrc.strSrc\n      );\n      var unescapedActiveImageSrc = decodeURIComponent(\n        _objWhatAssetData.objRawData.objActiveSrc.strSrc\n      );\n      var unescapedVisitedImageSrc = decodeURIComponent(\n        _objWhatAssetData.objRawData.objVisitedSrc.strSrc\n      );\n\n      if (_booFullReset) {\n        var domCurrSpriteDecoded = decodeURIComponent(_domCurrSprite.src);\n\n        var fromImage = domCurrSpriteDecoded.indexOf(unescapedVisitedImageSrc) > -1\n          ? unescapedVisitedImageSrc\n          : unescapedActiveImageSrc;\n        this._updateImageSource(_domCurrSprite, fromImage, unescapedNormalImageSrc);\n\n        // Reset translation to primary image\n        if (gomo && gomo.translationManager) {\n          newPathString = 'renderSecondary' + count;\n          gomo.translationManager.setImage(\n            _objWhatAssetData.objRawData.strID,\n            'objNormalSrc',\n            {\n              newPath: newPathString\n            }\n          );\n        }\n        _arrHotspotStates[count] = false;\n      } else {\n        if (_arrHotspotStates[count] === this._strHotspotHighlightedState) {\n          this._updateImageSource(\n            _domCurrSprite,\n            unescapedActiveImageSrc,\n            unescapedVisitedImageSrc\n          );\n\n          // Update translation to visited image\n          if (gomo && gomo.translationManager) {\n            newPathString = 'renderSecondary' + count;\n            gomo.translationManager.setImage(\n              _objWhatAssetData.objRawData.strID,\n              'objVisitedSrc',\n              {\n                newPath: newPathString\n              }\n            );\n          }\n\n          _arrHotspotStates[count] = this._strHotspotVisitedState;\n        }\n      }\n      count++;\n    }\n    this._strCurrentHotspot = '';\n  },\n\n  _returnFocusToIMAGEHOTSPOTAsset: function(\n    _domWhatAssetElement,\n    _objAssetData\n  ) {\n    var _strAssetID = _objAssetData['strObjID'];\n    var _strLastSubAssetID = _objAssetData['strLastInteractedSubAssetID'];\n    var _domHotspotLink = this._objWhatDOM.getElementById(\n      this._strImageHotspotIDPrefix +\n        _strAssetID +\n        '_' +\n        _strLastSubAssetID +\n        this._strImageHotspotIDSuffix\n    );\n    this._resetHotspotStates(_objAssetData, false);\n    if (\n      _domHotspotLink &&\n      _domHotspotLink !== undefined &&\n      _domHotspotLink.focus\n    ) {\n      _domHotspotLink.focus();\n    }\n  },\n\n  _reset_imagehotspot_Asset: function(_objWhatAssetData, _booFullReset) {\n    this._resetHotspotStates(_objWhatAssetData, true);\n    _objWhatAssetData.booComplete = false;\n    _objWhatAssetData.arrOptionStates = [];\n  },\n\n  _checkCompletion_imagehotspot_Asset: function(_objWhatAssetData) {\n    var _arrHotspots = _objWhatAssetData.objRawData.arrHotspots;\n    var _arrOptionStates = _objWhatAssetData.arrOptionStates;\n\n    if (_arrHotspots.length > _arrOptionStates.length) {\n      return false;\n    } else {\n      var _booAllVisited = true;\n\n      for (var i = 0; i < _arrOptionStates.length; i++) {\n        var _strCurrOptionState = _arrOptionStates[i];\n\n        var _booVisited =\n          _strCurrOptionState == this._strHotspotVisitedState ||\n          _strCurrOptionState == this._strHotspotHighlightedState;\n\n        if (!_booVisited) {\n          _booAllVisited = false;\n          break;\n        }\n\n        // _booAllVisited = true;\n      }\n\n      return _booAllVisited;\n    }\n  },\n\n  getAccessibleElements_imagehotspot: function() {\n    var accessibleElements = ['.hotspotSubAssetC'];\n    return accessibleElements;\n  },\n\n  /**\n   * Update the image element source path from the given image\n   * to the given destination image\n   *\n   * @param {HTMLImageElement} imgElement\n   * @param {string} from\n   * @param {string} to\n   * @private\n   */\n  _updateImageSource: function(imgElement, from, to) {\n    var imgSrcDecoded = decodeURIComponent(imgElement.src);\n    imgElement.src = imgSrcDecoded.replace(from, to);\n\n    gomo.eventManager.legacy('imageSourcesUpdated', {\n      arrImages: [imgElement],\n      strFrom: from,\n      strTo: to\n    });\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IMAGE_HOTSPOT_ASSET_INTERACTIONS);\n\nvar IMAGE_HOTSPOT_ASSET_PREPROCESSOR = {\n  strObjID: 'The image asset pre  extension object',\n\n  // If they're blank, set the visited and/or active SRC's to the same the base src.\n  _preProcess_imagehotspot_Asset: function(\n    _objWhatRawAssetData,\n    _objWhatParentScreenObject\n  ) {\n    if (_objWhatRawAssetData.objVisitedSrc.strSrc == '') {\n      _objWhatRawAssetData.objVisitedSrc.strSrc =\n        _objWhatRawAssetData.objNormalSrc.strSrc;\n    }\n\n    if (_objWhatRawAssetData.objActiveSrc.strSrc == '') {\n      _objWhatRawAssetData.objActiveSrc.strSrc =\n        _objWhatRawAssetData.objNormalSrc.strSrc;\n    }\n\n    var _strPreProcessedEntry = LOCALISER.get('IMAGE_PREPROCESSOR_ENTRY');\n    this._addToPreProcessedAssetList(\n      _objWhatRawAssetData['strType'],\n      _strPreProcessedEntry,\n      _objWhatRawAssetData['strID']\n    );\n\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, IMAGE_HOTSPOT_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(57))},function(t,e){t.exports="/* globals $, _, SCREEN_INTERACTIONS */\n\n/**\n * Image Markers asset\n * Allows hotpost with various icons to be placed over an image. Hotpost can have actions assigned\n * to them.\n */\n(function() {\n  // Create new image marker asset\n  var ImageMarkers = gomo.Asset.extend({\n\n    processData: function(data) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      me.data.isComplete = false;\n      me.maxIconSize = 25;\n\n      // Get image dimensions and calulate aspect ratio\n      var imageMetaData = gomo.getImageProperties(\n        decodeURIComponent(rawData.objNormalSrc.strSrc)\n      );\n\n      rawData.objNormalSrc.strPathAndSrc =\n        gomo.utility.getSrcPath(rawData.objNormalSrc.strSrc) + rawData.objNormalSrc.strSrc;\n\n      imageMetaData.aspectRatio = 1;\n      // These original render values are used when toggling display conditions\n      imageMetaData.originalRenderHeight = 0;\n      imageMetaData.originalRenderWidth = 0;\n      if (imageMetaData.strHeight && imageMetaData.strWidth) {\n        imageMetaData.aspectRatio =\n          parseInt(imageMetaData.strHeight) / parseInt(imageMetaData.strWidth);\n        imageMetaData.originalRenderHeight =\n          parseInt(imageMetaData.strHeight) * parseInt(imageMetaData.aspectRatio);\n      }\n      rawData.imageMetaData = imageMetaData;\n    },\n\n    afterRenderShown: function() {\n      var me = this;\n      me.initHotspots();\n    },\n\n    /**\n     * Before the asset is shown\n     */\n    beforeShown: function() {\n      var me = this;\n      // Reset all hotspots\n      me.resetImageMarkers();\n      // Resize the hotpot icons when screensize changes\n      var callbackFun = function() {\n        me.initHotspots();\n      };\n\n      gomo.outputChecker.addScreenSizeChangeListener(callbackFun);\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = data.objRawData;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n      if (found) {\n        var countHotspots = 0;\n        // Translate image hotspot alt text\n        if (found && found['arrHotspots'] && found.arrHotspots.length > 0) {\n          while (countHotspots < found.arrHotspots.length) {\n            rawData.arrHotspots[countHotspots].strText =\n              found.arrHotspots[countHotspots].strText;\n            gomo.translationManager.htmlDecodeAssetTranslations(rawData.strID, [\n              'arrHotspots[' + countHotspots + '].strAltText'\n            ]);\n            countHotspots++;\n          }\n        }\n        gomo.translationManager.setImage(\n          rawData.strID,\n          'objNormalSrc'\n        );\n        me.updateImgMarkerAlignment(found);\n      }\n    },\n\n    updateImgMarkerAlignment: function(data) {\n      var imgMarkerElement = $('#image-markersAsset_YY' + data.id + 'YY_WrapperL');\n      if (imgMarkerElement.length && typeof data.strAlignment !== 'undefined') {\n        imgMarkerElement[0].className =\n        imgMarkerElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n        imgMarkerElement.addClass(data.strAlignment);\n      }\n    },\n\n    registerEvents: function() {\n      var me = this;\n      me.events = {\n        'mouseenter .image-markers__hotspot': 'hotspotMouseEnter',\n        'mouseleave .image-markers__hotspot': 'hotspotMouseLeave',\n        'click .image-markers__hotspot': 'hotspotClick',\n        'keydown .image-markers__hotspot': 'hotspotClick'\n      };\n    },\n\n    initHotspots: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var imageMetaData = rawData.imageMetaData;\n      var imgParentWidth = me.$('.image-markers-wrapper').width();\n      var parsedMetaWidth = parseInt(imageMetaData.strWidth);\n      var parsedMetaHeight = parseInt(imageMetaData.strHeight);\n      var imgDomWidth = 0;\n      var imgDomHeight = 0;\n      // Check if display conditions are still hiding the element in the dom\n      if (!me.$el.hasClass('tempHiddenAssetC') && me.$('.image-markers__image').width() !== 0) {\n        imgDomWidth = me.$('.image-markers__image').width();\n        imgDomHeight = me.$('.image-markers__image').height();\n      } else {\n        imgDomWidth = imgParentWidth;\n        // Calculate the difference between the two image sizes\n        var diffBetweenImages = imgParentWidth / parsedMetaWidth;\n        imgDomHeight = parsedMetaHeight * diffBetweenImages;\n      }\n\n      var imageWidth = imgDomWidth;\n      var imageHeight = imgDomHeight;\n\n      // Adjust image size if fit to width is enabled\n      if (rawData.strAlignment === 'image-fit-to-widthC') {\n        imageWidth = imgParentWidth;\n        imageHeight = imageWidth * imageMetaData.aspectRatio;\n      }\n\n      // Calculate scale values to use for hotpost size and positioning if image is larger than\n      // the screen content width.\n      var widthScale = 1;\n      var heightScale = 1;\n      if (\n        parsedMetaWidth > imgParentWidth ||\n        imageWidth > parsedMetaWidth\n      ) {\n        widthScale = imageWidth / parsedMetaWidth;\n        heightScale = imageHeight / parsedMetaHeight;\n      }\n\n      // Set a max width on the hotspot wrapper so it is never larger than the image.\n      me.$('.image-markers__hotspots').css('max-width', parsedMetaWidth+'px');\n\n      // Apply size, position, font size and line height css to each hotspot.\n      _.each(rawData.arrHotspots, function(hotspot) {\n        var currHotspot = me.$('[data-hotspot-id=\"' + hotspot.strID + '\"]');\n\n        // Convert hotspot position and size values to percentages based on image size.\n        hotspot.objPercentCoords = {\n          width: ((parseInt(hotspot.objCoords.intWidth) * heightScale) / imageWidth) * 100,\n          height: ((parseInt(hotspot.objCoords.intHeight) * heightScale) / imageHeight) * 100,\n          top: ((parseInt(hotspot.objCoords.intTop) * heightScale) / imageHeight) * 100,\n          left: ((parseInt(hotspot.objCoords.intLeft) * widthScale) / imageWidth) * 100\n        };\n\n        var hotspotSize = Math.round(\n          (parseInt(imageHeight) / 100) * (parseInt(hotspot.objPercentCoords.height))\n        );\n\n        // Calculate a font size for the icon based on the size of the hotspot.\n        var padding = 12;\n        var fontSize = hotspotSize - padding;\n        if (fontSize > me.maxIconSize) {\n          fontSize = me.maxIconSize;\n        }\n\n        // Calculate line height for the icon based on the size of the hotspot.\n        var borderWidth = parseInt(\n          $(currHotspot).find('.image-markers__hotspot-icon').css('border-top-width')\n        );\n        var lineHeight = hotspotSize - borderWidth * 2;\n\n        // Apply the css to the hotspot.\n        currHotspot.css({\n          'top': (hotspot.objPercentCoords.top) + '%',\n          'left': (hotspot.objPercentCoords.left) + '%',\n          'width': (hotspot.objPercentCoords.width) + '%',\n          'height': (hotspot.objPercentCoords.height) + '%',\n          'font-size': fontSize + 'px',\n          'line-height': lineHeight + 'px'\n        });\n\n        // Disable the hotspot if it's linked to a hidden screen\n        if (this.arrActions && this.arrActions.length) {\n          if (!me.checkEnabledState(this, me.data.strObjID)) {\n            currHotspot.addClass('image-markers__hotspot-icon__disabled');\n          }\n        }\n\n        // Show the hotspot\n        currHotspot.removeClass('image-markers__hotspot-fade');\n      });\n    },\n\n    hotspotMouseEnter: function(event) {\n      var me = this;\n      // get hotspot id\n      var hotspotId = $(event.currentTarget).data('hotspot-id');\n      // get hotspot current state\n      var hotspotState = $(event.currentTarget).data('display-state');\n      var state = 'default';\n      switch (hotspotState) {\n        case 'default':\n          state = 'active';\n          break;\n        case 'active':\n          state = 'default';\n          break;\n        case 'visited':\n        case 'selected':\n          state = false;\n          break;\n      }\n      // change hotspot state\n      if (state) {\n        me.setState(hotspotId, state);\n      }\n    },\n\n    hotspotMouseLeave: function(event) {\n      var me = this;\n      // get hotspot id\n      var hotspotId = $(event.currentTarget).data('hotspot-id');\n      // get hotspot current state\n      var hotspotState = $(event.currentTarget).data('display-state');\n      var state = 'default';\n      switch (hotspotState) {\n        case 'default':\n          state = false;\n          break;\n        case 'active':\n          state = 'default';\n          break;\n        case 'visited':\n        case 'selected':\n          state = false;\n          break;\n      }\n      // change hotspot state\n      if (state) {\n        me.setState(hotspotId, state);\n      }\n    },\n\n    setState: function(hotspotId, state) {\n      var me = this;\n      // get the hotspot to change\n      var hotspot = me.$('[data-hotspot-id=\"'+hotspotId+'\"]');\n      // show the correct state\n      var newState = state;\n      if (state == 'selected') {\n        newState = 'active';\n      }\n      $(hotspot).find('.image-markers__hotspot-icon').each(function() {\n        if ($(this).data('display-state-name') == newState) {\n          $(this).removeClass('hidden');\n        } else {\n          $(this).addClass('hidden');\n        }\n      });\n      // set the state data\n      $(hotspot).data('display-state', state);\n    },\n\n    switchState: function(data, enabled) {\n      var me = this;\n      me.$('[data-hotspot-id=\"'+data.strID + '\"]').toggleClass(\n        'image-markers__hotspot-icon__disabled', !enabled\n      );\n    },\n\n    hotspotClick: function(event) {\n      var me = this;\n      // Check the keyboard and mouse events are supported\n      if (event.which !== 1 && event.which !== 32 && event.which !== 13) {\n        return;\n      }\n      var hotspot = $(event.currentTarget);\n      var hotspotId = $(hotspot).data('hotspot-id');\n      var hotspotState = $(hotspot).data('display-state');\n\n      if (hotspotState !='selected') {\n        // set hotspot to selected\n        $(hotspot).data('display-state', 'selected');\n        me.setState(hotspotId, 'selected');\n        me.checkVisitedStates(hotspotId);\n        me.checkCompletion();\n        me.triggerActions(hotspotId);\n      }\n    },\n\n    triggerActions: function(hotspotId) {\n      var me = this;\n      var data = me.data;\n      var rawData = me.data.objRawData;\n      var domLink = $('[data-hotspot-id=\"'+ hotspotId +'\"]');\n\n      // Find actions for selected hotspot and trigger them\n      _.each(rawData.arrHotspots, function(hotspot) {\n        if (hotspot.strID == hotspotId) {\n          var actionData = {};\n          actionData.objActions = hotspot.arrActions;\n          actionData.objOptionalExtraData = hotspot;\n          actionData.objOptionalExtraData.strAssetID = data.strObjID;\n          actionData.objOptionalExtraData.domLink = domLink;\n          actionData.objOptionalExtraData.objParent = SCREEN_INTERACTIONS.getCurrentScreenData();\n          gomo.eventManager.legacy('screenAssetInteracting', data);\n          gomo.eventManager.legacy('processActions', actionData);\n        }\n      });\n    },\n\n    checkVisitedStates: function(hotspotId) {\n      var me = this;\n      var allHotspots = me.$('.image-markers__hotspot');\n      // Look at all hotpspots except the current active one and set them to visited if they have\n      // been previously selected.\n      _.each(allHotspots, function(hotspot) {\n        if (\n          $(hotspot).data('display-state') == 'selected' &&\n          $(hotspot).data('hotspot-id') != hotspotId\n        ) {\n          me.setState($(hotspot).data('hotspot-id'), 'visited');\n        }\n      });\n    },\n\n    resetSelectedStates: function() {\n      var me = this;\n      var allHotspots = me.$('.image-markers__hotspot');\n      // Make sure no markers are still set to 'selected' on returning focus\n      _.each(allHotspots, function(hotspot) {\n        if ( $(hotspot).data('display-state') == 'selected' ) {\n          me.setState($(hotspot).data('hotspot-id'), 'visited');\n        }\n      });\n    },\n\n    returnFocusToSelf: function() {\n      var me = this;\n      me.resetSelectedStates();\n    },\n\n    checkCompletion: function() {\n      var me = this;\n      var isComplete = true;\n      var allHotspots = me.$('.image-markers__hotspot');\n      _.each(allHotspots, function(hotspot) {\n        if ($(hotspot).data('display-state') == 'default') {\n          isComplete = false;\n        }\n      });\n      if (isComplete) {\n        me.data.isComplete = true;\n      }\n    },\n\n    // Is asset completable?\n    isCompletable: function() {\n      return true;\n    },\n\n    /**\n     * @public\n     * @return {boolean}\n     */\n    isComplete: function() {\n      var me = this;\n      return me.data.isComplete;\n    },\n\n    resetImageMarkers: function() {\n      var me = this;\n      var allHotspots = me.$('.image-markers__hotspot');\n      // Remove the resize event\n      $(window).off('resize.me');\n      // Reset all hotspot data\n      _.each(allHotspots, function(hotspot) {\n        me.setState($(hotspot).data('hotspot-id'), 'default');\n        $(hotspot).addClass('image-markers__hotspot-fade');\n      });\n    },\n\n    getAccessibleElements: function() {\n      var accessibleElements = ['.image-markers__hotspot'];\n      return accessibleElements;\n    }\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('image-markers', ImageMarkers);\n})();\n"},function(t,e,n){n(0)(n(59))},function(t,e){t.exports="/* globals ASSET_RENDERER, O_EXTENDER, ASSET_INTERACTIONS, TOPIC_STRUCTURE_PARSER, CORE, $ */\n\n/**\n * @title Image asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the image asset\n * type.\n *\n * @author Johnathan Castle\n * @version 0.1 23/09/10\n * @version 2.0 12/03/12\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('imagestatic', objCurrSupportData);\n\nvar IMAGE_STATIC_ASSET_RENDERER = {\n  strObjID: 'The static image asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['imagestatic', 'imagestaticAssetTemplateWrapperC']\n  ],\n  _arrSubAssetHTMLTemplateIDs: [],\n\n  _strAlignmentClassSuffix: '_AlignedImageC',\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_imagestatic_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[\n        _objWhatRawAssetData.strType\n      ];\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'resources/trans.gif?',\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objNormalSrc.strSrc) +\n          decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n\n      var _strAlignmentClass =\n        _objWhatRawAssetData.strImageAlignment + this._strAlignmentClassSuffix;\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _strAlignmentClass\n      );\n\n      var _strBorderStyleDeclaration = this._generateBorderStyle(\n        _objWhatRawAssetData\n      );\n      _htmReturnData = _htmReturnData.replace(\n        /class=\"imageAssetC\"/,\n        'class=\"imageAssetC\"' + _strBorderStyleDeclaration\n      );\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XXTEXTXX/g,\n        this.sanitiseAltText(_objWhatRawAssetData.objNormalSrc.strAltText)\n      );\n      return _htmReturnData;\n    }\n  },\n\n  _generateBorderStyle: function(_objWhatRawAssetData) {\n    var _strBorderStyle = ' style=\\'border: ';\n    _strBorderStyle += _objWhatRawAssetData.strBorderWidth + 'px ';\n    _strBorderStyle += _objWhatRawAssetData.strBorderStyle + ' ';\n    _strBorderStyle += _objWhatRawAssetData.strBorderColour;\n    _strBorderStyle += ';\\' ';\n    return _strBorderStyle;\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IMAGE_STATIC_ASSET_RENDERER);\n\nvar IMAGE_STATIC_ASSET_INTERACTIONS = {\n  strObjID: 'The static image asset interactions extension object',\n\n  _strImageAssetClass: 'imageAssetC',\n\n  is_imagestatic_AssetCompletable: function(_objWhatAssetData) {\n    return false;\n  },\n\n  _performLanguagePreprocess_imagestatic_Asset: function(_objWhatAssetCourseObject) {\n    gomo.translationManager.setImage(_objWhatAssetCourseObject.objRawData.strID, 'objNormalSrc');\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetCourseObject.objRawData.strID);\n    if (found) {\n      this.updateImageAlignment(found);\n    }\n  },\n\n  _doPostRenderShowActions_imagestatic_Asset: function(assetData) {\n    if (assetData &&\n      assetData.objRawData &&\n      assetData.objRawData.objNormalSrc &&\n      assetData.objRawData.objNormalSrc.strSrc) {\n      // If we are using a gif, it may be animated so rewrite the source so it plays again.\n      if (assetData.objRawData.objNormalSrc.strSrc.indexOf('.gif') > -1 && assetData.strObjID) {\n        this._reset_gif(assetData.strObjID);\n      }\n    }\n  },\n  updateImageAlignment: function(data) {\n    var imageElement = $('#imagestaticAsset_YY' + data.id + 'YY_WrapperL');\n    if (imageElement.length && typeof data.strImageAlignment !== 'undefined') {\n      imageElement[0].className =\n        imageElement[0].className.replace(/\\b[A-Za-z]*_AlignedImageC\\b/, '');\n      imageElement.addClass(data.strImageAlignment + '_AlignedImageC');\n    }\n  },\n\n  _returnFocusToIMAGESTATICAsset: function(_domWhatAssetElement, _objAssetData) {},\n\n  _reset_imagestatic_Asset: function(_objWhatAssetData, _booFullReset) {\n    var _domAssetWrapper = ASSET_RENDERER.getAssetDOMElement(\n      _objWhatAssetData.objRawData\n    );\n    var _domImage = CORE.getElementsByClassName(\n      _domAssetWrapper,\n      this._strImageAssetClass\n    )[0];\n    var unescapedSrc = decodeURIComponent(\n      _objWhatAssetData.objRawData.objNormalSrc.strSrc\n    );\n\n    if (\n      _domImage.src != gomo.utility.getSrcPath(unescapedSrc) + unescapedSrc\n    ) {\n      _domImage.src =\n        gomo.utility.getSrcPath(unescapedSrc) + unescapedSrc;\n      _domImage.alt =\n        gomo.utility.decodeHtml(_objWhatAssetData.objRawData.objNormalSrc.strAltText);\n      _domImage.title =\n        gomo.utility.decodeHtml(_objWhatAssetData.objRawData.objNormalSrc.strAltText);\n    }\n  },\n\n  _reset_gif: function(assetId) {\n    // Get the image element.\n    var assetElement = $('#assetWrapperFor_YY' + assetId + 'YY_L');\n    if (assetElement) {\n      var imageElement = $(assetElement).find('img.imageAssetC');\n    }\n    if (imageElement && imageElement.length) {\n      var src = imageElement[0].src;\n      if (src) {\n        // Rewrite the src to trigger it to play again\n        $(imageElement).attr('src', src);\n      }\n    }\n  },\n\n  _checkCompletion_imagestatic_Asset: function(_objWhatAssetData) {\n    return true;\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IMAGE_STATIC_ASSET_INTERACTIONS);\n\nvar IMAGE_STATIC_PREPROCESSOR = {\n  strObjID: 'The image asset pre  extension object',\n\n  // If they're blank, set the visited and/or active SRC's to the same the base src.\n  _preProcess_imagestatic_Asset: function(\n    _objWhatRawAssetData,\n    _objWhatParentScreenObject\n  ) {\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, IMAGE_STATIC_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(61))},function(t,e){t.exports="/* globals ASSET_RENDERER, O_EXTENDER, ASSET_INTERACTIONS, EM, ISCROLL_INTERFACE,\n$, OUTPUT_MODE_CHECKER, Gamma, CONTENT_TRACKING */\n\n/**\n * @title Imagewall asset\n * @description Provides 'imagewall' functionality, which displays a series of\n * cropped images, expanding out to full size on click, and displaying subscreen\n *\n * @author Paul Stanyer\n * @version 2.0 11/07/12\n */\n\nASSET_RENDERER.addAssetSupportData('imagewall', {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n});\n\nvar IMAGEWALL_ASSET_RENDERER = {\n  strObjID: 'The imagewall asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['imagewall', 'imagewallAssetTemplateWrapperC'],\n    ['imagewallcell', 'imagewallCellWrapperC'],\n    ['gammaImagewall', 'imagewallGammaWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_imagewall_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    // Disable scroll to on click because this asset does not support it.\n    _objWhatAssetCourseObject.disableScrollTo = true;\n\n    var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData.strType];\n    if (_booPreviewMode) {\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n      );\n    } else {\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _objWhatRawAssetData['strID'] + 'YY'\n      );\n    }\n\n    _htmReturnData = _htmReturnData.replace(\n      'XX_GAMMA_WALL_XX',\n      this._renderImageGammaWall(_objWhatRawAssetData)\n    );\n\n    return _htmReturnData;\n  },\n\n  /*\n   * Renders the gamma imagewall\n   */\n  _renderImageGammaWall: function(_objWhatRawAssetData) {\n    // Get template HTML segment\n    var _htmReturnData = this._objAssetTemplates['gammaImagewall'];\n\n    var _intCount = 0;\n    var _htmlCells = '';\n    while (_intCount < _objWhatRawAssetData.arrCells.length) {\n      _htmlCells += this._renderImagewallCell(\n        _objWhatRawAssetData.arrCells[_intCount],\n        _objWhatRawAssetData.strID,\n        _intCount\n      );\n      _intCount++;\n    }\n\n    _htmReturnData = _htmReturnData.replace('XX_IMAGEWALL_CELLS_XX', _htmlCells);\n\n    // Return our built HTML\n    return _htmReturnData;\n  },\n\n  /*\n   * Renders the generic imagewall HTML\n   */\n  _renderImagewallCell: function(_objCell, assetId, arrayPosition) {\n    // Get template HTML segment\n    var _htmReturnData = this._objAssetTemplates['imagewallcell'];\n\n    _htmReturnData = _htmReturnData.replace(/XX_CELL_ID_XX/g, _objCell.strID);\n    _htmReturnData = _htmReturnData.replace(/XX_ASSET_ID_XX/g, assetId);\n    _htmReturnData = _htmReturnData.replace('XX_TITLE_XX', _objCell.strTitle);\n    _htmReturnData = _htmReturnData.replace('XX_CONTENT_XX', _objCell.strContent);\n    _htmReturnData = _htmReturnData.replace('XX_ALT_TXT_XX', _objCell.objImageSrc.strAltText);\n    _htmReturnData = _htmReturnData.replace(\n      'XX_IMG_SRC_XX',\n      gomo.utility.getSrcPath(_objCell.objImageSrc.strSrc) +\n        decodeURIComponent(_objCell.objImageSrc.strSrc)\n    );\n\n    _htmReturnData = _htmReturnData.replace(/XX_ARRAY_POSITION_XX/g, arrayPosition);\n    // Return our built HTML\n    return _htmReturnData;\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IMAGEWALL_ASSET_RENDERER);\n\n/**\n *\n */\nvar IMAGEWALL_ASSET_INTERACTIONS = {\n  strObjID: 'The Imagewall asset interactions extension object',\n  strImageWallPrefix: 'imagewallSingleImgHolder',\n  objActiveImageWalls: {},\n  objImageWallInitStatus: {},\n  imageWallReset: false,\n\n  imagewallStatementData: {},\n\n  handleEvent_imageWallItemSelected: function(cellData) {\n    var assetData = ASSET_INTERACTIONS.getAssetData(cellData.assetId);\n\n    if (this.imagewallStatementData[assetData.strObjID].slideAvailable) {\n      this.sendImagewallSlideTrackingDataOut(\n        assetData.objRawData.arrCells,\n        assetData.strObjID,\n        assetData.strAssetType\n      );\n    }\n    var count = 0;\n    while (count < assetData.objRawData.arrCells.length) {\n      if (assetData.objRawData.arrCells[count].strID == cellData.assetCellId) {\n        assetData.objRawData.arrCells[count].completed = true;\n        this.imagewallStatementData[assetData.strObjID].slideAvailable = new Date();\n        this.imagewallStatementData[assetData.strObjID].slideIndex = count;\n        this.sendImagewallSlideTrackingDataIn(\n          assetData.objRawData.arrCells,\n          assetData.strObjID,\n          assetData.strAssetType\n        );\n      }\n      count++;\n    }\n\n    EM.trigger('screenAssetInteracting', assetData);\n  },\n\n  _performPreLoadTopicActions_imagewall_Asset: function() {\n    this._hardResetImagewallAsset();\n  },\n\n  _performPreShowActions_imagewall_Asset: function(_objWhatAssetDataHolder) {\n    if (!ASSET_INTERACTIONS.shouldAssetReset(_objWhatAssetDataHolder)) {\n      return;\n    }\n    this.imagewallStatementData[_objWhatAssetDataHolder.strObjID] = {\n      slideAvailable: null,\n      slideIndex: null\n    };\n  },\n\n  _performLanguagePostprocess_imagewall_Asset: function(_objWhatAssetData) {\n    var _strAssetElementId = 'gamma-container_YY' + _objWhatAssetData.strObjID + 'YY';\n\n    // Don't reset the imagewall if it's not yet been set - i.e on inital page load\n    if (this.imageWallReset == false) {\n      ASSET_INTERACTIONS._reset_imagewall_Asset(_objWhatAssetData);\n      this.objActiveImageWalls[_strAssetElementId] = ASSET_RENDERER._renderImageGammaWall(\n        _objWhatAssetData.objRawData\n      );\n      ASSET_INTERACTIONS._doPostRenderShowActions_imagewall_Asset(_objWhatAssetData);\n    }\n  },\n\n  _doPostRenderShowActions_imagewall_Asset: function(_objWhatAssetCourseObject) {\n    var _strElementId =\n      ASSET_INTERACTIONS.strImageWallPrefix + _objWhatAssetCourseObject.strObjID + 'L';\n    var _strAssetElementId = 'gamma-container_YY' + _objWhatAssetCourseObject.strObjID + 'YY';\n\n    if (!ASSET_INTERACTIONS.shouldAssetReset(_objWhatAssetCourseObject)\n        || (this.objImageWallInitStatus[_strAssetElementId]\n        && this.objImageWallInitStatus[_strAssetElementId] === 'in-progress')) {\n      return;\n    }\n\n    var me = this;\n    this.imageWallReset = false;\n\n    if (typeof this.objActiveImageWalls[_strAssetElementId] !== 'undefined') {\n      document.getElementById(_strAssetElementId).innerHTML = this.objActiveImageWalls[\n        _strAssetElementId\n      ];\n    }\n\n    var _objGammaSettings = {\n      viewport: [\n        {\n          width: 900,\n          columns: 4\n        },\n        {\n          width: 500,\n          columns: 3\n        },\n        {\n          width: 320,\n          columns: 2\n        },\n        {\n          width: 0,\n          columns: 2\n        }\n      ],\n      svMarginsVH: {\n        vertical: 0,\n        horizontal: 0\n      },\n      overlayAnimated: true,\n      historyapi: false,\n      nextOnClickImage: false,\n      swipe: false,\n      elementId: '#gamma-container_YY' + _objWhatAssetCourseObject.strObjID + 'YY'\n    };\n\n    var funGammaLoaded = function() {\n      me.objImageWallInitStatus[_strAssetElementId] = 'complete';\n      ISCROLL_INTERFACE.refreshIScrolls();\n      var _strCurrentElementId = _strElementId;\n      var _domAsset = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetCourseObject.objRawData);\n\n      $(_domAsset)\n        .find('img')\n        .map(function(n, i) {\n          // Return to this to get it working\n          $(i).data(\n            'data-bind',\n            'attr: { alt:renderImages()[' +\n              n +\n              '].strAltText, src:renderImages()[' +\n              n +\n              '].strSrc}'\n          );\n          // $(i).data(\"attr\", \"src:renderImages()[\"+n+\"].strSrc}\");\n        });\n\n      var _domGammaOverlay = $(_domAsset).find('.gamma-overlay')[0];\n      var _domGammaSingleView = $(_domAsset).find('.gamma-single-view')[0];\n\n      var overlay = $('#' + _strCurrentElementId);\n      if (overlay.length && !_domGammaSingleView) {\n        /*\n        * If we already have an overlay, but no gamma singleview is found,\n        * exit the function it's already been run\n        */\n        return;\n      } else if (overlay.length) {\n        // If we've found the singleview and the overlay, remove the current overlay\n        $(overlay).remove();\n      }\n\n      // No overlay was found, so we need to create one\n      $('#pageWrapperL').append('<div id=\"' + _strCurrentElementId + '\"></div>');\n\n      var _domGammaClose = $(_domGammaSingleView).find('.gamma-btn-close')[0];\n      var _domGammaNext = $(_domGammaSingleView).find('.gamma-next')[0];\n      var _domGammaPrev = $(_domGammaSingleView).find('.gamma-prev')[0];\n\n      $(_domGammaClose).on('click', function() {\n        EM.trigger('enableSwipe');\n        me.sendImagewallSlideTrackingDataOut(\n          _objWhatAssetCourseObject.objRawData.arrCells,\n          _objWhatAssetCourseObject.strObjID,\n          _objWhatAssetCourseObject.strAssetType\n        );\n        me.imagewallStatementData[_objWhatAssetCourseObject.strObjID].slideAvailable = null;\n      });\n\n      // update asset completion when scrolling between images.\n      $([_domGammaNext, _domGammaPrev]).each( function() {\n        $(this).on('click', function() {\n          var assetId = _objWhatAssetCourseObject.strObjID;\n          var cellId = _objWhatAssetCourseObject.objRawData.arrCells[Gamma.current].strID;\n          EM.trigger('imageWallItemSelected', {assetId: assetId, assetCellId: cellId});\n        });\n      });\n\n      $(_domGammaOverlay).appendTo('#' + _strCurrentElementId);\n      $(_domGammaSingleView).appendTo('#' + _strCurrentElementId);\n    };\n\n    this.objImageWallInitStatus[_strAssetElementId] = 'in-progress';\n    Gamma.init(_objGammaSettings, function() {\n      funGammaLoaded();\n    });\n    if (OUTPUT_MODE_CHECKER.isAndroid_4_1_to_4_3()) {\n      Gamma.setTransEndEventName('webkitTransitionEnd');\n    }\n  },\n\n  /* The thirdparty library is limited to one instance so we need to reset it on each screen\n  reveal */\n  _reset_imagewall_Asset: function(_objWhatAssetData, _booForceReset) {\n    this.imageWallReset = true;\n\n    var _strAssetElementId = 'gamma-container_YY' + _objWhatAssetData.strObjID + 'YY';\n    var assetDom = document.getElementById(_strAssetElementId);\n    this.objImageWallInitStatus[_strAssetElementId] = 'reset';\n\n    if (assetDom) {\n      var wallContainerHeight = $(assetDom).height();\n      $('#' + _strAssetElementId).css('min-height', wallContainerHeight);\n\n      if (typeof this.objActiveImageWalls[_strAssetElementId] !== 'undefined') {\n        assetDom.innerHTML = '';\n      } else {\n        this.objActiveImageWalls[_strAssetElementId] = assetDom.innerHTML;\n      }\n    }\n\n    Gamma.singleview = null;\n    Gamma.svDescription = null;\n  },\n\n  _hardResetImagewallAsset: function(_objWhatAssetData, _booForceReset) {\n    this.objActiveImageWalls = {};\n    this.objImageWallInitStatus = {};\n    Gamma.singleview = null;\n    Gamma.svDescription = null;\n  },\n\n  is_imagewall_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _checkCompletion_imagewall_Asset: function(_objWhatAssetDataWrapper) {\n    var completed = true;\n    var count = 0;\n    while (count < _objWhatAssetDataWrapper.objRawData.arrCells.length) {\n      if (!_objWhatAssetDataWrapper.objRawData.arrCells[count].completed) {\n        completed = false;\n        break;\n      }\n      count++;\n    }\n\n    return completed;\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements_imagewall: function() {\n    // this can't be made tabable unless we modify the buttons of the 3rd party js.\n    var accessibleElements = [''];\n    return accessibleElements;\n  },\n\n  sendImagewallSlideTrackingDataIn: function(data, assetId, assetType) {\n    var index = this.imagewallStatementData[assetId].slideIndex;\n    CONTENT_TRACKING.interaction({\n      type: 'experienced',\n      activity: {\n        id: data[index].strID,\n        type: 'subscreen',\n        title: data[index].strTitle,\n        description: data[index].strContent\n      },\n      referrer: {\n        id: assetId,\n        type: 'asset',\n        assetType: assetType\n      },\n      parent: 'asset/' + assetId,\n      topicGrouping: true\n    });\n  },\n\n  sendImagewallSlideTrackingDataOut: function(data, assetId, assetType) {\n    var slideAvailable = this.imagewallStatementData[assetId].slideAvailable;\n    var index = this.imagewallStatementData[assetId].slideIndex;\n    CONTENT_TRACKING.interaction({\n      type: 'left',\n      activity: {\n        id: data[index].strID,\n        type: 'subscreen',\n        title: data[index].strTitle,\n        description: data[index].strContent\n      },\n      response: {\n        timeAvailable: slideAvailable,\n        timeResponse: new Date()\n      },\n      referrer: {\n        id: assetId,\n        type: 'asset',\n        assetType: assetType\n      },\n      parent: 'asset/' + assetId,\n      topicGrouping: true\n    });\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IMAGEWALL_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(63))},function(t,e){t.exports="/* globals ASSET_RENDERER, LOCALISER, O_EXTENDER, CORE, SCREEN_INTERACTIONS,\nOUTPUT_MODE_CHECKER, ASSET_INTERACTIONS, ARR_POPUP_CONFIG, EM, ISCROLL_INTERFACE,\nTEMPLATE_MANANGER, TOPIC_STRUCTURE_PARSER, BOO_BROWSER_EDGE_SCROLLER, $ */\n\n/**\n * @title Image zoom asset\n * @description Allows an image to be zoomed on hover or click.\n *\n * @author Johnathan Castle\n * @version 0.1 23/09/10\n * @version 2.0 12/03/12\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('imagezoom', objCurrSupportData);\n\nvar IMAGEZOOM_ASSET_RENDERER = {\n  strObjID: 'The zoom image asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['imagezoom', 'zoomableAssetTemplateWrapperC'],\n    ['imagezoom_zoomableLayer', 'zoomableLayerAssetTemplateWrapperC'],\n    [\n      'imagezoom_zoomableLayer_accessible',\n      'zoomableLayerAssetTemplateWrapperAccessibleC'\n    ]\n  ],\n  _arrSubAssetHTMLTemplateIDs: [],\n\n  // ***************************** Render methods extensions *****************************\n\n  renderZoomedImageAsset: function(\n    _objWhatAssetCourseObject,\n    _floWhatScaleFactor\n  ) {\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    var _htmReturnData;\n\n    if (\n      this._objAssetTemplates[_objWhatRawAssetData.strType + '_zoomableLayer']\n    ) {\n      if (this._strCurrOutputModeClass == 'accessibleC') {\n        _htmReturnData = this._objAssetTemplates[\n          _objWhatRawAssetData.strType + '_zoomableLayer_accessible'\n        ];\n      } else {\n        _htmReturnData = this._objAssetTemplates[\n          _objWhatRawAssetData.strType + '_zoomableLayer'\n        ];\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n      );\n\n      _htmReturnData = _htmReturnData.replace(\n        /resources\\/trans.gif\\?/g,\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objActiveSrc.strSrc)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        /XX_IMAGE_SRC_XX/g,\n        decodeURIComponent(_objWhatRawAssetData.objActiveSrc.strSrc)\n      );\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ALT_TEXT_XX/g,\n        this.sanitiseAltText(_objWhatRawAssetData.objNormalSrc.strAltText)\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get(\n        'IMAGE_ZOOMED_IMAGE_DEBUG_TEMPLATE_ERROR',\n        [_objWhatRawAssetData.strType]\n      );\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData.strID;\n      var _strReturnValue = LOCALISER.get(\n        'IMAGE_ZOOMED_IMAGE_RETURN_TEMPLATE_ERROR',\n        [_objWhatRawAssetData.strID]\n      );\n      return _strReturnValue;\n    }\n  },\n\n  _render_imagezoom_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[\n        _objWhatRawAssetData.strType\n      ];\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ASSET_ID_XX',\n        'YY' + _objWhatRawAssetData.strID + 'YY'\n      );\n\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        _objWhatRawAssetData.strID\n      );\n\n      _htmReturnData = _htmReturnData.replace(\n        'resources/trans.gif?',\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_IMAGE_SRC_XX',\n        decodeURIComponent(_objWhatRawAssetData.objNormalSrc.strSrc)\n      );\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ALT_TEXT_XX/g,\n        this.sanitiseAltText(_objWhatRawAssetData.objNormalSrc.strDescription)\n      );\n      _htmReturnData = _htmReturnData.replace('XXIMAGE_HOTSPOTSXX', '');\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get(\n        'IMAGE_ZOOMABLE_DEBUG_TEMPLATE_ERROR',\n        [_objWhatRawAssetData.strType]\n      );\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData.strID;\n      var _strReturnValue = LOCALISER.get(\n        'IMAGE_ZOOMABLE_RETURN_TEMPLATE_ERROR',\n        [_objWhatRawAssetData.strID]\n      );\n      return _strReturnValue;\n    }\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IMAGEZOOM_ASSET_RENDERER);\n\nvar IMAGEZOOM_ASSET_INTERACTIONS = {\n  strObjID: 'The zoomable image asset interactions extension object',\n\n  _strZoomableMetaContent: 'user-scalable=1',\n\n  _strZoomedContentLayerID: 'zoomContentL',\n  _strZoomedWrapperLayerID: 'zoomWrapperL',\n  // _strZoomedImageScrollWrapperLayerID : \"zoomContentL\",\n  _strZoomImageLoadingMessageClass: 'zoomLoadingMessageC',\n\n  _strTouchZoomablePopupTemplateID: 'touchZoomableImagePopupTemplateWrapperC',\n  _strTouchZoomablePopupID: 'zoomWrapperL',\n  _strTouchZoomablePopupContentID: 'zoomContentL',\n  _strInjectablesID: 'injectableBlocksL',\n\n  // In screen popup details.\n  _strInScreenPopupClass: 'inScreenDynamicZoomedImageC',\n  _strLeftPopupHandednessClass: 'leftHandPopupC',\n  _strRightPopupHandednessClass: 'rightHandPopupC',\n\n  _strColumnCountClassPrefix: 'screenColumns',\n  _strColumnAffinityClassPrefix: 'ColumnIndex',\n  _strColumnClassSuffix: 'C',\n\n  _strCurrentAssetID: '',\n\n  _floMaxZoomFactor: 16,\n  _floMinZoomFactor: 0.125,\n  _floCurrZoomFactor: 1.0,\n  _objCurrZoomedAsset: null,\n  _objZoomIScrollWrapper: null,\n\n  _booImageZoomed: false,\n  _booIsHorizontalLayout: false,\n\n  _strMetaID: 'viewportSettingsL',\n\n  // REFACTOR NOTE: This function is far too large and needs splitting up into various sub methods.\n  handleEvent_zoomableImageHover: function(_strAssetID) {\n    if (this._strCurrOutputMode == 'graphicalC') {\n      var _intSmallImageOffsetLeft = 0;\n      var _intSmallImageOffsetTop = 0;\n\n      var _domSmallImageWrapperElement = this._objWhatDOM.getElementById(\n        'imagezoomAsset_YY' + _strAssetID + 'YY_WrapperL'\n      );\n      var _domSmallImageAsset = CORE.getElementsByClassName(\n        _domSmallImageWrapperElement,\n        'imagezoomAssetC'\n      )[0];\n\n      var _intXY = {};\n      this._calculateElementOffset(_domSmallImageAsset, _intXY);\n      _intSmallImageOffsetLeft = _intXY.x;\n      _intSmallImageOffsetTop = _intXY.y;\n\n      var _objWhatAssetCourseObject = this.getAssetData(_strAssetID);\n\n      var _domZoomPopup = this._getInPagePopup(_objWhatAssetCourseObject);\n\n      _domZoomPopup.innerHTML = ASSET_RENDERER.renderZoomedImageAsset(\n        _objWhatAssetCourseObject,\n        1\n      );\n\n      var _domLargeImageAsset = CORE.getElementsByClassName(\n        _domZoomPopup,\n        'imagezoomAssetC'\n      )[0];\n\n      _domZoomPopup.style.display = 'none';\n\n      // REFACTOR NOTE: Remove this functionality and add it to the HTML element\n      _domSmallImageAsset.onmousemove = function(event) {\n        if (!event) {\n          event = window.event;\n        }\n\n        var _intSmallImageRelativeLeft =\n          event.clientX - _intSmallImageOffsetLeft;\n        var _intSmallImageRelativeTop = event.clientY - _intSmallImageOffsetTop;\n\n        var _floHorizontalPercentage =\n          _intSmallImageRelativeLeft / _domSmallImageAsset.offsetWidth;\n        var _floVerticalPercentage =\n          _intSmallImageRelativeTop / _domSmallImageAsset.offsetHeight;\n\n        var _intHorizontalScrollRange =\n          _domLargeImageAsset.offsetWidth - _domZoomPopup.offsetWidth;\n        var _intVerticalScrollRange =\n          _domLargeImageAsset.offsetHeight - _domZoomPopup.offsetHeight;\n\n        var _intWindowWidth = OUTPUT_MODE_CHECKER.getScreenDimensions()[\n          'intViewportWidth'\n        ];\n        var _floScreenPercentage = (event.clientX / _intWindowWidth) * 100;\n        var _strCurrHandednessClass;\n\n        if (_floScreenPercentage <= 50) {\n          _strCurrHandednessClass =\n            ASSET_INTERACTIONS._strRightPopupHandednessClass;\n        } else {\n          _strCurrHandednessClass =\n            ASSET_INTERACTIONS._strLeftPopupHandednessClass;\n        }\n\n        var _strBaseClass = ASSET_INTERACTIONS._strInScreenPopupClass;\n        _strBaseClass += ' ' + _strCurrHandednessClass;\n\n        var _domCurrScreen = SCREEN_INTERACTIONS.getScreenWrapper(\n          SCREEN_INTERACTIONS.getLastScreenID()\n        );\n        var _domInScreenPopup = CORE.getElementsByClassName(\n          _domCurrScreen,\n          ASSET_INTERACTIONS._strInScreenPopupClass\n        )[0];\n        _domInScreenPopup.className = _strBaseClass;\n\n        _domZoomPopup.scrollLeft =\n          _intHorizontalScrollRange * _floHorizontalPercentage;\n        _domZoomPopup.scrollTop =\n          _intVerticalScrollRange * _floVerticalPercentage;\n\n        _domZoomPopup.style.display = 'block';\n      };\n\n      _domSmallImageAsset.onmouseout = function(event) {\n        _domZoomPopup.style.display = 'none';\n      };\n    }\n  },\n\n  handleEvent_zoomableImageClicked: function(_strAssetID) {\n    switch (this._strCurrOutputMode) {\n      case 'accessibleC':\n        this._strCurrentAssetID = _strAssetID;\n        window.open('zoomable_image_popup.htm', ARR_POPUP_CONFIG);\n        break;\n      case 'graphicalC':\n        this._strCurrentAssetID = _strAssetID;\n        window.open('zoomable_image_popup.htm', ARR_POPUP_CONFIG);\n        break;\n      case 'tabletC':\n        EM.trigger('zoomImage', _strAssetID);\n        break;\n      case 'smartphoneC':\n        if (OUTPUT_MODE_CHECKER.isBlackberryPhone()) {\n          this._strCurrentAssetID = _strAssetID;\n          window.open('zoomable_image_popup.htm', ARR_POPUP_CONFIG);\n        } else {\n          EM.trigger('zoomImage', _strAssetID);\n        }\n        break;\n    }\n  },\n\n  handleEvent_zoomImage: function(_strAssetID) {\n    EM.trigger('disableSwiping');\n\n    this._floCurrZoomFactor = 1.0;\n\n    var _objWhatAssetCourseObject = this.getAssetData(_strAssetID);\n    // Checks for and if required creates the popup.\n    var _domZoomContentWrapper = this._getTouchZoomablePopupWrapper();\n    var _domTouchZoomablePopupWrapper = this._objWhatDOM.getElementById(\n      this._strTouchZoomablePopupID\n    );\n\n    var _htmZoomContent = ASSET_RENDERER.renderZoomedImageAsset(\n      _objWhatAssetCourseObject,\n      this._floCurrZoomFactor\n    );\n    _domZoomContentWrapper.innerHTML = _htmZoomContent;\n\n    EM.trigger('toggleBlanking', {\n      objWhatDOM: false,\n      strState: 'ON',\n      intNewZIndex: 39\n    });\n\n    this._objCurrZoomedAsset = _objWhatAssetCourseObject;\n\n    _domTouchZoomablePopupWrapper.style.display = 'block';\n\n    this._booImageZoomed = true;\n\n    EM.trigger('deviceOrientationChange');\n\n    this._addIZoomScroll();\n  },\n\n  handleEvent_unzoomImage: function() {\n    EM.trigger('enableSwipe');\n\n    EM.trigger('toggleBlanking', {objWhatDOM: false, strState: 'OFF'});\n\n    this._objWhatDOM.getElementById(\n      this._strZoomedWrapperLayerID\n    ).style.display = 'none';\n    this._intCurrZoomFactor = 1;\n    this._objCurrZoomedAsset = null;\n\n    this._booImageZoomed = false;\n\n    this._removeZoomIScroll();\n    this._objWhatDOM.getElementById(this._strZoomedContentLayerID).innerHTML =\n      '';\n    EM.trigger('deviceOrientationChange');\n  },\n\n  handleEvent_changeImageZoom: function(_intZoomDirection) {\n    var _floNewZoomFactor = this._floCurrZoomFactor;\n    if (_intZoomDirection > 0) {\n      _floNewZoomFactor = _floNewZoomFactor * 2;\n      if (_floNewZoomFactor > this._floMaxZoomFactor) {\n        _floNewZoomFactor = this._floMaxZoomFactor;\n      }\n    }\n    if (_intZoomDirection < 0) {\n      _floNewZoomFactor = _floNewZoomFactor / 2;\n      if (_floNewZoomFactor < this._floMinZoomFactor) {\n        _floNewZoomFactor = this._floMinZoomFactor;\n      }\n    }\n    this._floCurrZoomFactor = _floNewZoomFactor;\n    this._removeZoomIScroll();\n    this._objWhatDOM.getElementById(\n      this._strZoomedContentLayerID\n    ).innerHTML = ASSET_RENDERER.renderZoomedImageAsset(\n      this._objCurrZoomedAsset,\n      this._floCurrZoomFactor\n    );\n    this._addIZoomScroll();\n  },\n\n  handleEvent_updateZoomablePopupIScroll: function() {\n    if (window['ISCROLL_INTERFACE']) {\n      ISCROLL_INTERFACE.refreshIScrolls();\n    }\n  },\n\n  handleEvent_zoomableImageLoaded: function(_objWhatLink) {\n    var _domLoadingMessage = CORE.getElementsByClassName(\n      this._objWhatDOM,\n      this._strZoomImageLoadingMessageClass\n    )[0];\n    if (_domLoadingMessage) {\n      _domLoadingMessage.style.display = 'none';\n    }\n  },\n\n  getCurrentPopupZoomedImageDetails: function() {\n    var _objWhatAssetCourseObject = this.getAssetData(this._strCurrentAssetID);\n\n    var _domObj = this._objWhatDOM.createElement('div');\n    _domObj.innerHTML = ASSET_RENDERER.renderZoomedImageAsset(\n      _objWhatAssetCourseObject,\n      this._floCurrZoomFactor\n    );\n\n    return _domObj.innerHTML;\n  },\n\n  _performLanguagePreprocess_imagezoom_Asset: function(_objWhatAssetCourseObject) {\n    gomo.translationManager.setImage(_objWhatAssetCourseObject.objRawData.strID, 'objNormalSrc', {\n      newPath: 'renderThumbnail'\n    });\n    gomo.translationManager.setImage(_objWhatAssetCourseObject.objRawData.strID, 'objActiveSrc', {\n      newPath: 'renderZoomImage'\n    });\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetCourseObject.objRawData.strID);\n    if (found) {\n      this.updateImgZoomAlignment(found);\n    }\n  },\n\n  updateImgZoomAlignment: function(data) {\n    var imgZoomElement = $('#imagezoomAsset_YY' + data.id + 'YY_WrapperL');\n    if (imgZoomElement.length && typeof data.strAlignment !== 'undefined') {\n      imgZoomElement[0].className =\n        imgZoomElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      imgZoomElement.addClass(data.strAlignment);\n    }\n  },\n\n  is_imagezoom_AssetCompletable: function(_objWhatAssetData) {\n    // REFACTOR NOTE: This *could* be checked more accurately, tbd.\n    return false;\n  },\n\n  _calculateElementOffset: function(_domElement, _intOffsetRefObj) {\n    _intOffsetRefObj.x = _intOffsetRefObj.y = 0;\n    var _intScrollTop = 0;\n    var _objTemp = _domElement;\n    if (_objTemp.offsetParent) {\n      do {\n        _intOffsetRefObj.x += _objTemp.offsetLeft;\n        _intOffsetRefObj.y += _objTemp.offsetTop;\n        _intScrollTop += _objTemp.scrollTop;\n      } while ((_objTemp = _objTemp.offsetParent));\n    }\n    _intOffsetRefObj.y = _intOffsetRefObj.y - _intScrollTop;\n  },\n\n  _getInPagePopup: function(_objWhatAssetCourseObject) {\n    var _domCurrScreen = SCREEN_INTERACTIONS.getScreenWrapper(\n      SCREEN_INTERACTIONS.getLastScreenID()\n    );\n    var _domInScreenPopup = CORE.getElementsByClassName(\n      _domCurrScreen,\n      this._strInScreenPopupClass\n    )[0];\n\n    var _strBaseClass = this._strInScreenPopupClass;\n\n    if (!_domInScreenPopup) {\n      _domInScreenPopup = this._objWhatDOM.createElement('div');\n      _domCurrScreen.appendChild(_domInScreenPopup);\n    }\n\n    _domInScreenPopup.className = _strBaseClass;\n\n    if (BOO_BROWSER_EDGE_SCROLLER) this._adjustPopupForBrowserEdgeScroller();\n\n    return _domInScreenPopup;\n  },\n\n  _adjustPopupForBrowserEdgeScroller: function() {\n    var _offset =\n      parseInt($('.' + this._strInScreenPopupClass).css('top'), 10) * 2;\n    var _elementHeight = $('#contentWrapperL').height() - _offset;\n    $('.' + this._strInScreenPopupClass).css({\n      height: _elementHeight + 'px',\n      position: 'fixed'\n    });\n  },\n\n  _getTouchZoomablePopupWrapper: function() {\n    var _domZoomablePopupWrapper = this._objWhatDOM.getElementById(\n      this._strTouchZoomablePopupContentID\n    );\n    if (!_domZoomablePopupWrapper) {\n      var _arrHTMLFragments = TEMPLATE_MANANGER.getTemplate(\n        this._strTouchZoomablePopupTemplateID\n      ).getContentAsDOMNodes(true);\n      var _domInjectableWrapper = this._objWhatDOM.getElementById(\n        this._strInjectablesID\n      );\n\n      var count = 0;\n      while (count < _arrHTMLFragments.length) {\n        var _domCurrItem = _arrHTMLFragments[count];\n        _domInjectableWrapper.appendChild(_domCurrItem);\n        count++;\n      }\n    }\n    _domZoomablePopupWrapper = this._objWhatDOM.getElementById(\n      this._strTouchZoomablePopupContentID\n    );\n\n    return _domZoomablePopupWrapper;\n  },\n\n  _addIZoomScroll: function() {\n    var _domImageHolder = this._objWhatDOM.getElementById(\n      this._strZoomedContentLayerID\n    );\n    if (typeof ISCROLL_INTERFACE != 'undefined') {\n      ISCROLL_INTERFACE.parseChildDOMElements(\n        _domImageHolder,\n        false,\n        false,\n        true\n      );\n    }\n  },\n\n  _removeZoomIScroll: function() {\n    var _domImageHolder = this._objWhatDOM.getElementById(\n      this._strZoomedContentLayerID\n    );\n    if (typeof ISCROLL_INTERFACE != 'undefined') {\n      ISCROLL_INTERFACE.recycleScroller(_domImageHolder);\n    }\n  },\n\n  _returnFocusToIMAGEZOOMAsset: function(_domWhatAssetElement, _objAssetData) {\n    var _strAssetID = _objAssetData['strObjID'];\n    var _strLastSubAssetID = _objAssetData['strLastInteractedSubAssetID'];\n    var _domHotspotLink = this._objWhatDOM.getElementById(\n      this._strImageHotspotIDPrefix +\n        _strAssetID +\n        '_' +\n        _strLastSubAssetID +\n        this._strImageHotspotIDSuffix\n    );\n    this._resetHotspotStates(_objAssetData, false);\n    _domHotspotLink.focus();\n  },\n\n  _reset_imagezoom_Asset: function(_objWhatAssetData, _booFullReset) {\n    _objWhatAssetData.booComplete = false;\n    _objWhatAssetData.arrOptionStates = [];\n  },\n\n  _checkCompletion_imagezoom_Asset: function(_objWhatAssetData) {\n    return true;\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements_imagezoom: function() {\n    var accessibleElements = ['.zoomImageLinkC'];\n    return accessibleElements;\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IMAGEZOOM_ASSET_INTERACTIONS);\n\nvar IMAGEZOOM_ASSET_PREPROCESSOR = {\n  strObjID: 'The zoomable image asset pre  extension object',\n\n  // If they're blank, set the visited and/or active SRC's to the same the base src.\n  _preProcess_imagezoom_Asset: function(\n    _objWhatRawAssetData,\n    _objWhatParentScreenObject\n  ) {\n    if (_objWhatRawAssetData.objActiveSrc.strSrc == '') {\n      _objWhatRawAssetData.objActiveSrc.strSrc =\n        _objWhatRawAssetData.objNormalSrc.strSrc;\n    }\n\n    var _strPreProcessedEntry = LOCALISER.get('IMAGE_PREPROCESSOR_ENTRY');\n    this._addToPreProcessedAssetList(\n      _objWhatRawAssetData['strType'],\n      _strPreProcessedEntry,\n      _objWhatRawAssetData['strID']\n    );\n\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, IMAGEZOOM_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(65))},function(t,e){t.exports="/* globals ASSET_RENDERER, TOPIC_MANAGER, CORE, LOCALISER,\nO_EXTENDER, ASSET_INTERACTIONS, EM, _, $ */\n\n/**\n * @title Button asset extension\n * @description Button asset for the Player which passes on processes to the Actions Asset\n *\n * @author JC\n * @version 0.1 05/02/14\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\n\nASSET_RENDERER.addAssetSupportData('menubutton', objCurrSupportData);\n\nvar MENUBUTTON_ASSET_RENDERER = {\n  // ***************************** Property extensions *****************************\n  strObjID: 'The menu button asset renderer extension object',\n  _arrAssetHTMLTemplateIDs: [\n    ['menubutton', 'menuButtonWrapperC'],\n    ['menubuttonLabel', 'menuButtonLabelWrapperC'],\n    ['menubuttonProgress', 'menuButtonProgressWrapperC'],\n    ['menubuttonImage', 'menuButtonImageWrapperC'],\n    ['menubuttonTime', 'menuButtonTimeWrapperC'],\n    ['menubuttonRecommendationIcon', 'menuButtonRecommendationIconWrapperC']\n  ],\n\n  trackingStates: [\n    'TOPIC_PROGRESS_NOT_STARTED',\n    'TOPIC_PROGRESS_INCOMPLETE',\n    'TOPIC_PROGRESS_COMPLETE'\n  ],\n\n  // ***************************** Render methods extensions *****************************\n  _render_menubutton_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    var _intCurrentTopicCompletion = 0;\n    var recommendedTopic = false;\n\n    if (_objWhatRawAssetData.arrActions.length >= 1) {\n      var count = 0;\n      var _booFoundNavigationAction = false;\n      while (count < _objWhatRawAssetData.arrActions.length) {\n        var _objCurrAction = _objWhatRawAssetData.arrActions[count];\n        if (_objCurrAction.strType == 'internal_link') {\n          _booFoundNavigationAction = true;\n          break;\n        }\n        count++;\n      }\n\n      if (\n        _booFoundNavigationAction &&\n        _objCurrAction.objParameters &&\n        _objCurrAction.objParameters.target_id\n      ) {\n        var _strTopicId = TOPIC_MANAGER.getTopicId(_objCurrAction.objParameters.target_id);\n        var _objCurrTopic = CORE.getCourseItemById(_strTopicId);\n        recommendedTopic = _.isBoolean(_objCurrTopic.recommend) && _objCurrTopic.recommend;\n\n        if (_objCurrTopic.intTrackingState) {\n          _intCurrentTopicCompletion = _objCurrTopic.intTrackingState;\n        } else {\n          // Otherwise it's a topic ID that doesn't exist; show it not started.\n          _intCurrentTopicCompletion = 0;\n        }\n      }\n    }\n    var _strTemplate = _objWhatRawAssetData.strType;\n    var _htmlButtonContentTemplate = this._sortMenuButtonContentOrder(_objWhatRawAssetData, {\n      recommendedTopic: recommendedTopic\n    });\n\n    if (this._objAssetTemplates[_strTemplate]) {\n      var _htmReturnData = this._objAssetTemplates[_strTemplate];\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_ASSET_ID_XX',\n          'YY' + _objWhatRawAssetData.strID + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace('XX_ASSET_ID_XX', _objWhatRawAssetData.strID);\n      _htmReturnData = _htmReturnData.replace(\n        'XX_BUTTON_RENDER_TYPE_XX',\n        this._get_menubutton_class(_objWhatRawAssetData.strButtonType)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_BUTTON_RECOMMENDATION_XX',\n        recommendedTopic ? 'recommended' : ''\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_MENU_BUTTON_CONTENT_XX',\n        _htmlButtonContentTemplate\n      );\n      if (_objWhatRawAssetData.strIconImageFilename) {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_IMAGESRC_XX',\n          _objWhatRawAssetData.strIconImageFilename\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_TEXTCONTENT_XX',\n          this.insertFormattedHtml(_objWhatRawAssetData.strLabel)\n        );\n      }\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ITEM_TIME_XX',\n        _objWhatRawAssetData.strTargetTime\n      );\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      if (_objWhatRawAssetData.arrActions && _objWhatRawAssetData.arrActions.length) {\n        _htmReturnData = _htmReturnData.replace(\n          ' XX_DISABLED_XX',\n          ASSET_INTERACTIONS.checkEnabledState(_objWhatRawAssetData) ? '' : ' disableInteractions'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(' XX_DISABLED_XX', '');\n      }\n\n      _htmReturnData = _htmReturnData.replace(/XX_PROGRESS_XX/g, _intCurrentTopicCompletion);\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ACCESSIBILITY_PROGRESS_XX/g,\n        LOCALISER.get(this.trackingStates[_intCurrentTopicCompletion])\n      );\n\n      return _htmReturnData;\n    } else {\n      this.debug('No Template found in Button Asset for ' + _strTemplate);\n    }\n  },\n  // ***************************** Helper methods extensions *****************************\n  _get_menubutton_class: function(strButtonType) {\n    var strClass;\n\n    // REFACTOR: This is all hardcoded for now but needs to have class\n    // names generated by the manifest in 2.0/2.1.\n    switch (strButtonType) {\n      case 'dropdownValue1':\n        strClass = 'btn btn-default btn-lg btn-warning';\n        break;\n      case 'dropdownValue2':\n        strClass = 'btn btn-default';\n        break;\n      case 'dropdownValue3':\n        strClass = 'btn btn-default btn-sm btn-danger';\n        break;\n      case 'dropdownValue4':\n        strClass = 'btn btn-default btn-xs';\n        break;\n      default:\n        strClass = 'btn btn-default';\n        break;\n    }\n\n    return strClass;\n  },\n\n  _sortMenuButtonContentOrder: function(_objWhatRawAssetData, options) {\n    var _htmlMenuButtonContent = '';\n\n    var _htmlLabelTemplate = '';\n    var _htmlTimeTemplate = '';\n    var _htmlImageTemplate = '';\n    var _htmlProgressTemplate = '';\n\n    _htmlLabelTemplate = this._objAssetTemplates['menubuttonLabel'];\n    _htmlProgressTemplate = this._objAssetTemplates['menubuttonProgress'];\n\n    if (_objWhatRawAssetData.strTargetTime) {\n      _htmlTimeTemplate = this._objAssetTemplates['menubuttonTime'];\n    }\n    if (_objWhatRawAssetData.strIconImageFilename) {\n      _htmlImageTemplate = this._objAssetTemplates['menubuttonImage'];\n    }\n\n    // TODO : When the data handles the order it can be sorted here.\n    _htmlMenuButtonContent =\n      _htmlLabelTemplate + _htmlTimeTemplate + _htmlImageTemplate + _htmlProgressTemplate;\n\n    if (options && options.recommendedTopic) {\n      _htmlMenuButtonContent += this._objAssetTemplates['menubuttonRecommendationIcon'];\n    }\n\n    return _htmlMenuButtonContent;\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, MENUBUTTON_ASSET_RENDERER);\n\nvar MENUBUTTON_ASSET_INTERACTIONS = {\n  strObjID: 'Menu button asset interactions',\n  strMenuButtonDomPrefix: 'menuButtonAsset_',\n  strMenuButtonDomSuffix: '_WrapperL',\n\n  handleEvent_menuButtonAction: function(_objButtonData) {\n    var _objWhatAssetData = ASSET_INTERACTIONS.getAssetData(_objButtonData.strAssetID);\n    _objWhatAssetData.objRawData.booClicked = true;\n\n    var _objActionOptions = {};\n    _objActionOptions.objActions = _objWhatAssetData.objRawData.arrActions;\n    _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n    _objActionOptions.objOptionalExtraData.strAssetID = _objButtonData.strAssetID;\n\n    // Example feed back for completion of subscreen display.\n    // _objActionOptions.objOptionalExtraData.funTriggerCallBack = function(){alert('Screen\n    // displayed for Action ' + _objButtonData.strAssetID)};\n\n    EM.trigger('screenAssetInteracting', _objWhatAssetData);\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  is_menubutton_AssetCompletable: function(_objWhatAssetData) {\n    return false;\n  },\n\n  _returnFocusToMENUBUTTONAsset: function(_domWhatAssetElement, _objAssetData) {\n    var _strAssetID = _objAssetData['strObjID'];\n    var _domButtonWrapperL = this._objWhatDOM.getElementById(\n      this.strMenuButtonDomPrefix + 'YY' + _strAssetID + 'YY' + this.strMenuButtonDomSuffix\n    );\n    var _domButton = CORE.getElementsByClassName(_domButtonWrapperL, 'buttonC')[0];\n    _domButton.focus();\n  },\n\n  _checkCompletion_menubutton_Asset: function(_objWhatAssetDataWrapper) {\n    if (_objWhatAssetDataWrapper.objRawData.booClicked) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  _performLanguagePreprocess_menubutton_Asset: function(_objWhatAssetData) {\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetData.objRawData.strID);\n    if (found) {\n      this.updateMenuButtonAlignment(found);\n    }\n  },\n\n  _topicStatusChanged_menubutton_Asset: function(_objWhatAssetData) {\n    if (_objWhatAssetData.objRawData\n      && _objWhatAssetData.objRawData.arrActions) {\n      var navigationAction = _.find(\n        _objWhatAssetData.objRawData.arrActions,\n        {strType: 'internal_link'}\n      );\n      if (typeof(navigationAction) !== 'undefined'\n      && navigationAction.objParameters\n      && navigationAction.objParameters.target_id) {\n        var topicId = TOPIC_MANAGER.getTopicId(navigationAction.objParameters.target_id);\n        var currTopic = CORE.getCourseItemById(topicId);\n\n        if (currTopic && currTopic.intTrackingState) {\n          $('#menubuttonAsset_YY'+_objWhatAssetData.strObjID+'YY_WrapperL').find('.menuProgressC')\n            .removeClass('trackingState0C trackingState1C trackingState2C')\n            .addClass('trackingState' + currTopic.intTrackingState + 'C');\n        }\n      }\n    }\n  },\n\n  updateMenuButtonAlignment: function(data) {\n    var menuButtonElement = $('#menubuttonAsset_YY' + data.id + 'YY_WrapperL');\n    if (menuButtonElement.length && typeof data.strAlignment !== 'undefined') {\n      menuButtonElement[0].className =\n        menuButtonElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      menuButtonElement.addClass(data.strAlignment);\n    }\n  },\n\n  getAccessibleElements_menubutton: function() {\n    var accessibleElements = ['.menuButtonC'];\n    return accessibleElements;\n  },\n\n  _switchState_menubutton_Asset: function(assetData, enabled) {\n    var buttonWrapperID = '#' + assetData.strType +\n    'Asset_YY' + assetData.strID + 'YY' + this.strMenuDomSuffix;\n    $(buttonWrapperID).find('.buttonC').toggleClass('disableInteractions', !enabled);\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, MENUBUTTON_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(67))},function(t,e){t.exports="/* globals ASSET_RENDERER, O_EXTENDER, ASSET_INTERACTIONS */\n\n/**\n* @title FILMSTRIP asset extension collection\n* @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n* object literals via the O_EXTENDER object to be able to process the filmstrip asset\n* type.\n*\n* @author Johnathan Castle\n* @version 2.0 23/09/10\n*/\n\nvar objCurrSupportData =\n{\n  'graphicalC': true,\n  'accessibleC': true,\n  'tabletC': true,\n  'smartphoneC': true\n};\nASSET_RENDERER.addAssetSupportData('rule', objCurrSupportData);\n\n/**\n* @title Horizontal rule asset\n* @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n* object literals via the O_EXTENDER object to be able to process the rule asset\n* type.\n*\n* @author Johnathan Castle\n* @version 0.1 08/5/14\n*/\n\nvar RULE_ASSET_RENDERER = {\n  strObjID: 'The rule asset render extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['rule', 'ruleAssetTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_rule_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ASSET_ID_XX',\n        'YY' + _objWhatRawAssetData['strID'] + 'YY'\n      );\n\n      var _strCombinedCSS = 'border-width:' + _objWhatRawAssetData.strBorderWidth * 2 + 'px; ';\n      _strCombinedCSS += 'border-color:' + _objWhatRawAssetData.strBorderColour + '; ';\n      _strCombinedCSS += 'border-top-style:' + _objWhatRawAssetData.strBorderStyle + ';';\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_HR_ASSET_SELECTED_STYLE_XX\"',\n        'XX_HR_ASSET_SELECTED_STYLE_XX\" style=\"' + _strCombinedCSS + '\"'\n      );\n\n      return _htmReturnData;\n    } else {\n      this.debug('ASSET_RENDERER._renderRuleAsset(), ERROR: Unknown asset type of ' +\n        _objWhatRawAssetData['strType'] + '.', 3);\n      return 'Asset Error, no template found, ID: ' + _objWhatRawAssetData['strID'];\n    }\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, RULE_ASSET_RENDERER);\n\n\nvar RULE_ASSET_INTERACTIONS = {\n  strObjID: 'The filmstrip asset interactions extension object',\n\n  is_rule_AssetCompletable: function(_objWhatAssetData) {\n    return false;\n  },\n\n  _doPostRenderShowActions_rule_Asset: function(_objWhatAssetDataHolder) {},\n\n  _returnFocusToRULEAsset: function(_domWhatAssetElement) {},\n\n  _reset_rule_Asset: function(_objWhatAssetData, _booForceReset) {},\n\n  _checkCompletion_rule_Asset: function(_objWhatAssetData) {\n    return true;\n  }\n\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, RULE_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(69))},function(t,e){t.exports="/* globals SWIPE_CONTROL, ISCROLL_INTERFACE, CONTENT_TRACKING, OUTPUT_MODE_CHECKER, $, _ */\n\n(function() {\n  // Create new Tabs\n  var Tabs = gomo.Asset.extend({\n    notVisited: 'notVisitedC',\n    visited: 'visitedC',\n    opened: 'openedC',\n    closed: 'closedC',\n    accordionAssetClosed: 'accordionAssetClosedC',\n    accordionAssetOpen: 'accordionAssetOpenC',\n    resizing: null,\n    tabsDisplayed: true,\n\n    tabsStatementData: {},\n    objOpenCells: {},\n\n    processData: function(data) {\n      var me = this;\n      var rawData = me.data.objRawData;\n\n      if (\n        rawData.strVersion === '1.0' &&\n        rawData.arrTranslatableFields.indexOf('arrStepData.#.strIcon') < 0\n      ) {\n        rawData.arrTranslatableFields.splice(1, 0, 'arrStepData.#.strIcon');\n        rawData.strVersion = '1.1';\n      }\n\n      // format tab item title & content\n      for (var i = 0; i < rawData.arrStepData.length; i++) {\n        rawData.arrStepData[i].strFormattedTitleText = me.formatHTML(\n          rawData.arrStepData[i].strTitle\n        );\n        rawData.arrStepData[i].strFormattedContentText = me.formatHTML(\n          rawData.arrStepData[i].strContent\n        );\n      }\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n\n      // Prepend the icon class value\n      if (found && found['arrStepData'] && found['arrStepData'].length) {\n        _.each(found['arrStepData'], function(value) {\n          if (value.strIcon !== '' && value.strIcon.indexOf('fa ') < 0) {\n            value.strIcon = 'fa ' + value.strIcon;\n          }\n        });\n      }\n    },\n\n    translationPostprocess: function() {\n      var me = this;\n      me.setVisibleAsset();\n    },\n\n    beforeShown: function() {\n      var me = this;\n\n      // don't re-run this code if we've already initialised in continuous scroll\n      if (!me.shouldAssetReset()) {\n        return;\n      }\n\n      // tabs\n      me.$el.find('.tabsStepWrapperC').on('shown.bs.tab', function(e) {\n        if (me.$el.find('.tabsStepWrapperC.active').length) {\n          me.$el\n            .find('.tabsStepWrapperC.active')\n            .removeClass(me.notVisited + ' active')\n            .addClass(me.visited);\n        }\n\n        me.$(e.currentTarget)\n          .addClass('active ' + me.visited)\n          .removeClass(me.notVisited);\n\n        var currentIndex = me.tabsStatementData[me.id].tabIndex;\n\n        me.sendTabsTrackingDataOut(me.data.objRawData.arrStepData[currentIndex], me.id);\n\n        me.tabsStatementData[me.id].tabIndex = me.$(this).index();\n        me.tabsStatementData[me.id].tabAvailable = new Date();\n        me.tabsStatementData[me.id].hasOpenTab = true;\n\n        currentIndex = me.tabsStatementData[me.id].tabIndex;\n        me.sendTabsTrackingDataIn(\n          me.data.objRawData.arrStepData[currentIndex],\n          me.data.objRawData.strID\n        );\n\n        gomo.eventManager.legacy('screenAssetInteracting', me.data);\n      });\n\n      // if number of tabs extends beyond screen width\n      if (typeof SWIPE_CONTROL != 'undefined') {\n        SWIPE_CONTROL.disableSwipingOnElementClassname('tabsStepTitleC');\n      }\n\n      // accordion\n      me.$el\n        .find('.accordionAssetWrapperC .accordionStepContentWrapperC')\n        .off('hidden.bs.collapse')\n        .on('hidden.bs.collapse', function(e) {\n          if (typeof ISCROLL_INTERFACE != 'undefined') {\n            ISCROLL_INTERFACE.refreshIScrolls();\n          }\n\n          var currentIndex = me.tabsStatementData[me.id].tabIndex;\n          if (currentIndex !== null) {\n            me.sendTabsTrackingDataOut(\n              me.data.objRawData.arrStepData[currentIndex],\n              me.data.objRawData.strID\n            );\n          }\n\n          me.$(this)\n            .closest('.accordionAssetWrapperC')\n            .removeClass(me.accordionAssetOpen)\n            .addClass(me.accordionAssetClosed);\n          // Remove opened class\n          if (me.$(this).is(e.target)) {\n            me.$(this).siblings().find('.accordionStepTitleC').removeClass(me.opened);\n            delete me.objOpenCells[this['id']];\n          }\n        });\n\n      me.$el\n        .find('.accordionAssetWrapperC')\n        .find('.accordionStepContentWrapperC')\n        .off('shown.bs.collapse')\n        .on('shown.bs.collapse', function(e) {\n          if (typeof ISCROLL_INTERFACE != 'undefined') {\n            ISCROLL_INTERFACE.refreshIScrolls();\n          }\n\n          me.$(this)\n            .closest('.accordionAssetWrapperC')\n            .removeClass(me.accordionAssetClosed)\n            .addClass(me.accordionAssetOpen);\n\n          if (me.$(this).is(e.target)) {\n            me.$(this)\n              .siblings()\n              .find('.accordionStepTitleC')\n              .removeClass(me.notVisited)\n              .addClass(me.visited + ' ' + me.opened);\n\n            me.objOpenCells[this['id']] = this;\n          }\n\n          me.tabsStatementData[me.id].tabIndex = me.$(this).parent().index();\n          me.tabsStatementData[me.id].tabAvailable = new Date();\n          me.tabsStatementData[me.id].hasOpenTab = true;\n          var currentIndex = me.tabsStatementData[me.id].tabIndex;\n          me.sendTabsTrackingDataIn(\n            me.data.objRawData.arrStepData[currentIndex],\n            me.data.objRawData.strID\n          );\n\n          gomo.eventManager.legacy('screenAssetInteracting', me.data);\n        });\n\n      var callbackFun = function() {\n        me.setVisibleAsset();\n      };\n\n      gomo.outputChecker.addScreenSizeChangeListener(callbackFun);\n\n      me.setVisibleAsset();\n    },\n\n    reset: function() {\n      var me = this;\n      me.setVisibleAsset();\n    },\n\n    setVisibleAsset: function() {\n      var me = this;\n\n      if (!me.$el.attr('id')) return;\n\n      var tabsStepWidth = 0;\n      // make sure the screen wrapper is visible before measuring\n      if (!gomo.outputChecker.animationEnabled) {\n        me.$el.closest('[id^=\"screenWrapper\"]').css({'display': 'block', 'opacity': '1'});\n      }\n\n      me.$el.find('.tabsAssetWrapperC').css('display', 'block');\n\n      me.$el.find('.tabsStepWrapperC').each(function() {\n        tabsStepWidth += $(this).outerWidth();\n      });\n\n      me.tabsDisplayed = tabsStepWidth <= me.$el.find('.tabsAssetWrapperC').width();\n\n      if (!gomo.outputChecker.animationEnabled) {\n        me.$el.closest('[id^=\"screenWrapper\"]').css({'display': '', 'opacity': ''});\n      }\n\n      // set the asset that should be displayed\n      if (me.tabsDisplayed) {\n        me.$el.find('.tabsAssetWrapperC').css('display', 'block');\n        me.$el.find('.accordionAssetWrapperC').css('display', 'none');\n        me.resetTabs();\n\n        me.tabsStatementData[me.id] = {\n          assetType: me.data.strAssetType,\n          hasOpenTab: true,\n          tabAvailable: new Date(),\n          tabIndex: 0\n        };\n\n        me.sendTabsTrackingDataIn(me.data.objRawData.arrStepData[0], me.data.objRawData.strID);\n      } else {\n        me.$el.find('.tabsAssetWrapperC').css('display', 'none');\n        me.$el.find('.accordionAssetWrapperC').css('display', 'block');\n        me.resetAccordion();\n\n        me.tabsStatementData[me.id] = {\n          assetType: me.data.strAssetType,\n          hasOpenTab: false,\n          tabAvailable: new Date(),\n          tabIndex: null\n        };\n      }\n    },\n\n    resetTabs: function() {\n      var me = this;\n\n      if (me.$el.find('.tabsNavC').length) {\n        me.$el.find('.tabsNavC').scrollLeft(0);\n\n        me.$el\n          .find('.tabsStepWrapperC')\n          .removeClass('active' + ' ' + me.visited)\n          .addClass(me.notVisited);\n\n        me.$el\n          .find('.tabsStepWrapperC:first')\n          .addClass('active ' + me.visited)\n          .removeClass(me.notVisited);\n\n        me.$el.find('.tabsContentWrapperC').removeClass('active in');\n        me.$el.find('.tabsContentWrapperC:first').addClass('active fade in');\n      }\n    },\n\n    resetAccordion: function() {\n      var me = this;\n      for (var strDomId in me.objOpenCells) {\n        if (Object.prototype.hasOwnProperty.call(me.objOpenCells, strDomId)) {\n          me.$el\n            .find(me.objOpenCells[strDomId])\n            .collapse('hide');\n        }\n      }\n\n      while (typeof me.$el.find('.accordionAssetWrapperC .' + me.visited)[0] != 'undefined') {\n        var _domCurrentVisited = me.$el.find('.accordionAssetWrapperC .' + me.visited)[0];\n        _domCurrentVisited.className = _domCurrentVisited.className.replace(\n          me.visited,\n          me.notVisited\n        );\n      }\n    },\n\n    registerEvents: function() {\n      if (OUTPUT_MODE_CHECKER.isDesktop()) {\n        var me = this;\n        me.events = {\n          'touchstart .tabsNavC': 'startScrollWatch',\n          'touchend .tabsNavC': 'stopScrollWatch'\n        };\n      }\n    },\n\n    startScrollWatch: function() {\n      gomo.eventManager.legacy('disableParentIScrollInstaces');\n      gomo.eventManager.legacy('disableScreenSwipe');\n    },\n\n    stopScrollWatch: function() {\n      gomo.eventManager.legacy('enableParentIScrollInstaces');\n      gomo.eventManager.legacy('enableScreenSwipe');\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    isComplete: function() {\n      var me = this;\n\n      if (me.tabsDisplayed) {\n        return me.$el.find('.tabsStepWrapperC.' + me.notVisited).length === 0;\n      }\n      return me.$el.find('.accordionStepTitleC.' + me.notVisited).length === 0;\n    },\n\n    getAccessibleElements: function() {\n      return OUTPUT_MODE_CHECKER.isDesktop() ? ['.tabsStepButton'] : ['.accordionStepTitleC'];\n    },\n\n    sendTabsTrackingDataIn: function(data, assetId) {\n      var me = this;\n\n      CONTENT_TRACKING.interaction({\n        type: 'experienced',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: me.tabsStatementData[assetId].assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n      me.tabsStatementData[assetId].hasOpenTab = true;\n    },\n\n    sendTabsTrackingDataOut: function(data, assetId) {\n      var me = this;\n      var tabAvailable = me.tabsStatementData[assetId].tabAvailable;\n      CONTENT_TRACKING.interaction({\n        type: 'left',\n        activity: {\n          id: data.strID,\n          type: 'subscreen',\n          title: data.strTitle,\n          description: data.strContent\n        },\n        response: {\n          timeAvailable: tabAvailable,\n          timeResponse: new Date()\n        },\n        referrer: {\n          id: assetId,\n          type: 'asset',\n          assetType: me.tabsStatementData[assetId].assetType\n        },\n        parent: 'asset/' + assetId,\n        topicGrouping: true\n      });\n      me.tabsStatementData[assetId].hasOpenTab = false;\n    }\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('tabs', Tabs);\n})();\n\n"},function(t,e,n){n(0)(n(71))},function(t,e){t.exports="/* global $, BOO_WRAP_TEXT_ASSET_CONTENT, INT_LEFT_TEXT_FILL_PADDING, INT_TOP_TEXT_FILL_PADDING */\n(function() {\n  // Create new TextAsset\n  var TextAsset = gomo.Asset.extend({\n    handleOwnEnabledState: true,\n\n    processData: function(data) {\n      var me = this;\n      var rawData = data.objRawData;\n\n      rawData.alignment = rawData.strTextAlign + 'C';\n      rawData.importedStyle = rawData.strTextStyle + me.importedStyleSuffix;\n      // Do we apply a content wrapper?\n      rawData.wrapContent = BOO_WRAP_TEXT_ASSET_CONTENT;\n      rawData.padding = {\n        horizontal: INT_LEFT_TEXT_FILL_PADDING,\n        vertical: INT_TOP_TEXT_FILL_PADDING\n      };\n\n      // Set the background colour if required\n      if (rawData.strScreenBackgroundColor) {\n        rawData.bgFillClass = 'bgFill';\n        rawData.bgFillStyle = this.getInlineStyle(data);\n      }\n\n      // Are we handling instructions texts?\n      if (isInstructionTextStyle(rawData.strTextStyle)) {\n        var screenData = data.objParent;\n        var visibilityPattern = '';\n        var collectionId = '';\n        var childInstructionTexts = getChildInstructionTexts(rawData, screenData);\n        // Find all child instructions and link them via a collection id etc.\n        if (childInstructionTexts.length > 1) {\n          collectionId = generateCollectionId();\n          visibilityPattern = collectionVisibilityPattern(childInstructionTexts);\n          var count = 0;\n          while (count < childInstructionTexts.length) {\n            var currentText = childInstructionTexts[count];\n            currentText['collectionId'] = collectionId;\n            currentText['visibilityPattern'] = visibilityPattern;\n            if (isInstructionTextStyle(currentText.strTextStyle)) {\n              currentText['instructionText'] = currentText.strTextStyle + visibilityPattern;\n            }\n            count++;\n          }\n          // Only one child instruction\n        } else if (childInstructionTexts.length == 1) {\n          visibilityPattern = '_GroupOfOneInstructionC';\n        }\n\n        rawData.instructionText = rawData.strTextStyle + rawData['visibilityPattern'];\n      }\n\n      // Is this a heading? Add heading role if it is.\n      var headingStyle = isHeadingTextStyle(rawData.strTextStyle);\n      if (headingStyle) {\n        rawData.role = 'heading';\n        rawData.headingLevel = headingStyle.match(/\\d/g);\n      }\n    },\n\n    // Before we render the asset ...\n    beforeRender: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      rawData.textContent = me.formatHTML(rawData.strContent);\n    },\n\n    // Before the asset is shown ...\n    beforeShown: function() {},\n\n    translationPreprocess: function() {\n      var found =\n        gomo.translationManager.findDataByAssetId(this.data.strObjID);\n      if (found) {\n        this.updateTextAlignment(found);\n      }\n    },\n\n    updateTextAlignment: function(data) {\n      var textElement = $('#textAsset_YY' + data.id + 'YY_WrapperL');\n      if (textElement.length && typeof data.strTextAlign !== 'undefined') {\n        textElement[0].className =\n          textElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n        textElement.addClass(data.strTextAlign + 'C');\n      }\n    },\n\n\n    checkAndHandleEnabledState: function() {\n      var me = this;\n      me.switchState();\n    },\n\n    // update inline actions states\n    switchState: function() {\n      var me = this;\n      var textContent = me.data.objRawData.strContent;\n\n      var asRegex = /\\[actionset=([^\\]]+)\\]/g;\n      var linkStates = [];\n      textContent.replace(asRegex, function(match, groupOne) {\n        if (typeof groupOne !== 'undefined') {\n          var breakUp = groupOne.split('.');\n          var actionId = 'actionSetLink_' + breakUp[1] + '_L';\n          var linkState = 'enabledAction';\n          if (me.checkEnabledState(groupOne) == false) {\n            linkState = 'disabledAction';\n          }\n          linkStates.push({actionId: actionId, state: linkState});\n        }\n      });\n\n      linkStates.forEach(function(element) {\n        var toggleState = 'enabledAction';\n        if (element.state === toggleState) {\n          toggleState = 'disabledAction';\n        }\n        me.$el.find('#' + element.actionId).removeClass(toggleState).addClass(element.state);\n      });\n    },\n\n    //\n    registerEvents: function() {},\n\n    /**\n     * @return {string}\n     */\n    getContent: function() {\n      return this.formatHTML(this.data.objRawData.strContent);\n    },\n\n    /**\n     * @return {array} accessibleElements\n     */\n    getAccessibleElements: function() {\n      var accessibleElements = ['span[role=\"button\"]', 'a'];\n      return accessibleElements;\n    }\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('text', TextAsset);\n\n  /**\n   *\n   * Private support methods....\n   *\n   */\n\n  var instructionStyles = {\n    initial: 'gomo-initialInstruction',\n    intermediate: 'gomo-intermediateInstruction',\n    finalInstruction: 'gomo-finalInstruction'\n  };\n\n  /**\n   * @private\n   * @function isInstructionTextStyle\n   * @param {string} textStyle\n   * @return {boolean} If text style is an instruction\n   */\n  function isInstructionTextStyle(textStyle) {\n    var found = false;\n    for (var i in instructionStyles) {\n      if (Object.prototype.hasOwnProperty.call(instructionStyles, i)) {\n        found = found || instructionStyles[i] == textStyle;\n      }\n    }\n    return found;\n  }\n\n  var headingStyles = {\n    h1: 'gomo-h1Title',\n    h2: 'gomo-h2SubHeading',\n    h3: 'gomo-h3SubHeading'\n  };\n\n  /**\n   * @private\n   * @function isHeadingTextStyle\n   * @param {string} textStyle\n   * @return {boolean} If text style is an heading\n   */\n  function isHeadingTextStyle(textStyle) {\n    var found = false;\n    for (var i in headingStyles) {\n      if (Object.prototype.hasOwnProperty.call(headingStyles, i)) {\n        found = found || headingStyles[i] == textStyle;\n        if (found) break;\n      }\n    }\n    return found ? i : found;\n  }\n\n  /**\n   * @private\n   * @function collectionVisibilityPattern\n   * @param {Object[]} textAssets\n   * @return {string} The visibility pattern name\n   */\n  function collectionVisibilityPattern(textAssets) {\n    if (textAssets.length == 3) {\n      return '_GroupOfThreeInstructionsType1C';\n    }\n\n    var firstInstruction = textAssets[0];\n    var secondInstruction = textAssets[1];\n    var combinedStyle = firstInstruction.strTextStyle + ' ' + secondInstruction.strTextStyle;\n\n    // Initial and intermediate instruction...\n    if (\n      ~combinedStyle.indexOf(instructionStyles.initial) &&\n      ~combinedStyle.indexOf(instructionStyles.intermediate)\n    ) {\n      return '_GroupOfTwoInstructionsType1C';\n    }\n\n    // Initial and final instruction...\n    if (\n      ~combinedStyle.indexOf(instructionStyles.initial) &&\n      ~combinedStyle.indexOf(instructionStyles.finalInstruction)\n    ) {\n      return '_GroupOfTwoInstructionsType2C';\n    }\n\n    // Intermediate and final instruction...\n    if (\n      ~combinedStyle.indexOf(instructionStyles.intermediate) &&\n      ~combinedStyle.indexOf(instructionStyles.finalInstruction)\n    ) {\n      return '_GroupOfTwoInstructionsType3C';\n    }\n  }\n\n  /**\n   * @private\n   * @function generateCollectionId\n   * @return {string} A randomly generated id\n   */\n  function generateCollectionId() {\n    var dateString = new Date().getTime();\n    var randomNumber = Math.ceil(Math.random() * 100000000);\n    var id = 'asset-set_' + dateString + randomNumber;\n    return id;\n  }\n\n  /**\n   * @private\n   * @function getChildInstructionTexts\n   * @param {Object} rawAssetData\n   * @param {Object} screenData\n   * @return {Array} The child instruction text assets\n   */\n  function getChildInstructionTexts(rawAssetData, screenData) {\n    if (!screenData.getIntructionTextTriggered) {\n      screenData.getIntructionTextTriggered = true;\n      var childInstructionTexts = [];\n      var childInstructionTextIds = [];\n      var instructionTextTypes = {};\n\n      var screenAssets = screenData.arrAssets;\n      // Look for instruction text in each asset\n      var assetCount = 0;\n      while (assetCount < screenAssets.length) {\n        // Found another instruction?\n        var currentAsset = screenAssets[assetCount].objRawData;\n        if (isInstructionTextStyle(currentAsset.strTextStyle)) {\n          // Add to child instructions\n          childInstructionTexts.push(currentAsset);\n          childInstructionTextIds.push(currentAsset['strID']);\n          //\n          if (!instructionTextTypes[currentAsset.strTextStyle]) {\n            instructionTextTypes[currentAsset.strTextStyle] = 1;\n          } else {\n            instructionTextTypes[currentAsset.strTextStyle]++;\n          }\n        }\n        assetCount++;\n      }\n\n      if (childInstructionTextIds.length > 3) {\n        // 4 or more text assets set to an instruction text style detected. Please group no more\n        // than 3 at a time.\n        gomo.localiser.localisedAlert('TEXT_TOO_MANY_GROUPED_ERROR', [\n          childInstructionTextIds.join('\\n')\n        ]);\n      }\n      checkForDuplicateInstructionTypes(instructionTextTypes);\n      return childInstructionTexts;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * @private\n   * @function checkForDuplicateInstructionTypes\n   * @param {string[]} instructionTypes\n   */\n  function checkForDuplicateInstructionTypes(instructionTypes) {\n    var foundDuplicate = false;\n    var duplicateErrorMessage = gomo.localiser.get('TEXT_SAME_TYPE_GROUPING_ERROR_PREFIX');\n    // Check for duplicates and build the error message.\n    for (var instructionType in instructionTypes) {\n      if (instructionTypes[instructionType] > 1) {\n        duplicateErrorMessage += instructionType + ' : ' + instructionTypes[instructionType] + '\\n';\n        foundDuplicate = true;\n      }\n    }\n    // If we have duplicates, show the error message.\n    if (foundDuplicate) {\n      duplicateErrorMessage += gomo.localiser.get('TEXT_SAME_TYPE_GROUPING_ERROR_SUFFIX');\n      alert(duplicateErrorMessage);\n    }\n  }\n})();\n"},function(t,e,n){n(0)(n(73))},function(t,e){t.exports="/* global _, ASSET_RENDERER, LOCALISER, O_EXTENDER, ASSET_RENDERER, TOPIC_INTERACTIONS, CORE */\n/* global TOPIC_MANAGER, ASSET_INTERACTIONS, CONTENT_TRACKING, SCREEN_INTERACTIONS */\n/* eslint-disable max-len */\n\n/**\n * @title A blank extentsion file\n * @description This file is intended to server as a template for creating new assets.\n * Please replace the ASSESSMENT_RESULTS with the new assets type e.g. for\n * the text asset, replace ASSESSMENT_RESULTS with TEXT.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('assessmentresults', objCurrSupportData);\n\nvar ASSESSMENT_RESULTS_ASSET_RENDERER = {\n  strObjID: 'The ASSESSMENT_RESULTS asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['assessmentresults', 'assessmentResultsAssetTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_assessmentresults_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ASSET_ID_XX',\n        'YY' + _objWhatRawAssetData['strID'] + 'YY'\n      );\n      return _htmReturnData;\n    } else {\n      // this.debug(\"ASSET_RENDERER._renderAssessmentIntroAsset(), ERROR: Unknown asset type of \" +\n      // _objWhatRawAssetData[\"strType\"] + \".\", 3);\n      var _strDebugError = LOCALISER.get('ASSESSMENT_RESULTS_DEBUG_TYPE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('ASSESSMENT_RESULTS_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\n// ***************************** Helper methods extensions *****************************\n\nO_EXTENDER.extend(ASSET_RENDERER, ASSESSMENT_RESULTS_ASSET_RENDERER);\n\nvar ASSESSMENT_RESULTS_ASSET_INTERACTIONS = {\n  strObjID: 'The assessment results asset interactions extension object',\n  _strAssessmentFeedbackWrapperClass: 'assessmentFeedbackHolderC',\n\n  is_assessmentresults_AssetCompletable: function(_objWhatAssetData) {\n    return false;\n  },\n\n  _performPreShowActions_assessmentresults_Asset: function(_objWhatAssetData) {\n    this._populateResultsFeedback(_objWhatAssetData);\n  },\n\n  _performLanguagePreprocess_assessmentresults_Asset: function(_objWhatAssetData) {\n    var assetId = _objWhatAssetData.objRawData.strID;\n    var countTopic = 0;\n\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {id: assetId});\n\n          if (found && found.objGradeFeebacks) {\n            _objWhatAssetData.objRawData.objGradeFeebacks = found.objGradeFeebacks;\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n\n    // If the assessment results is part of the current screen then go ahead and change the content\n    // otherwise do not because it will fire a completion tracking event.\n    if (_objWhatAssetData.objParent.strObjID == SCREEN_INTERACTIONS.strCurrentScreenId) {\n      this._populateResultsFeedback(_objWhatAssetData);\n    }\n  },\n\n  _populateResultsFeedback: function(_objWhatAssetWrapper) {\n    var _objWhatRawAssetData = _objWhatAssetWrapper.objRawData;\n    var _domAssetWrapper = ASSET_RENDERER.getAssetDOMElement(_objWhatRawAssetData);\n    var _domFeedbackWrapper = CORE.getElementsByClassName(\n      _domAssetWrapper,\n      this._strAssessmentFeedbackWrapperClass\n    )[0];\n\n    var _objScoreData = this._getAssessmentScoreData(_objWhatRawAssetData);\n    var _htmFeedbackText = '';\n    var _strFeedbackText;\n\n    if (\n      _objScoreData['intPercentage'] >= _objScoreData['intGoodPass'] &&\n      _objWhatRawAssetData['objGradeFeebacks']['strHighPassFeedback'] &&\n      ['objGradeFeebacks']['strHighPassFeedback'] !== ''\n    ) {\n      _strFeedbackText = this._insertScoreData(\n        _objWhatRawAssetData['objGradeFeebacks']['strHighPassFeedback'],\n        _objScoreData\n      );\n      _htmFeedbackText = ASSET_RENDERER.insertFormattedHtml(_strFeedbackText);\n    } else if (_objScoreData['intPercentage'] >= _objScoreData['intBasePass']) {\n      _strFeedbackText = this._insertScoreData(\n        _objWhatRawAssetData['objGradeFeebacks']['strBasePassFeedback'],\n        _objScoreData\n      );\n      _htmFeedbackText = ASSET_RENDERER.insertFormattedHtml(_strFeedbackText);\n    } else {\n      _strFeedbackText = this._insertScoreData(\n        _objWhatRawAssetData['objGradeFeebacks']['strFailedFeedback'],\n        _objScoreData\n      );\n      _htmFeedbackText = ASSET_RENDERER.insertFormattedHtml(_strFeedbackText);\n    }\n    _domFeedbackWrapper.innerHTML = _htmFeedbackText;\n  },\n\n  _getAssessmentScoreData: function(_objWhatRawAssetData) {\n    var _objAnsweredQuestionAssets = TOPIC_INTERACTIONS.getAnsweredQuestionAssets();\n    var _objScoreData = {\n      intPercentage: 0,\n      intTotal: 0,\n      intCorrect: 0,\n      intGoodPass: _objWhatRawAssetData['objScoreGrades']['intHighScoreGrade'],\n      intBasePass: _objWhatRawAssetData['objScoreGrades']['intBaseScoreGrade']\n    };\n    var keys = _.keys(_objAnsweredQuestionAssets);\n    _objScoreData['intTotal'] = _.size(keys);\n    _objScoreData['intCorrect'] = _.size(\n      _.filter(keys, function(key) {\n        return !!_objAnsweredQuestionAssets[key].booIsCorrect;\n      })\n    );\n    _objScoreData['intPercentage'] = parseInt(\n      (_objScoreData['intCorrect'] / _objScoreData['intTotal']) * 100\n    );\n\n    /**\n     * Given a \"deepest prop(erty)\" on objRawData.additionalTrackingData.response, returns a\n     * function that when invoked, will fetch that property.\n     * e.g. prop('timeAvailable')\n     * @param {string} deepestProp\n     * @return {function}\n     */\n    var prop = function(deepestProp) {\n      return _.property(['objRawData', 'additionalTrackingData', 'response', deepestProp]);\n    };\n\n    /**\n     * Given a function that returns a \"deep prop(erty)\" (which is assumed to be a date),\n     * sorts the collection of answered questions by that (date) property.\n     * e.g. sorted(prop('timeAvailable'))\n     * @param {function} deepProp\n     * @return {Date[]}\n     */\n    var sorted = function(deepProp) {\n      return []\n        .concat(\n          _.filter(\n            _.map(keys, function(key) {\n              return deepProp(_objAnsweredQuestionAssets[key]);\n            }),\n            _.isDate\n          )\n        )\n        .sort(function(a, b) {\n          return a - b;\n        });\n    };\n\n    var response = {\n      timeAvailable: _.compose(_.first, sorted, prop)('timeAvailable'),\n      timeResponse: _.compose(_.last, sorted, prop)('timeResponse')\n    };\n\n    if (isNaN(_objScoreData['intPercentage'])) {\n      _objScoreData['intPercentage'] = 0;\n    }\n\n    // Set asset interaction on all new asset instances.\n    // Or set on old instances when the old config passes.\n    if (_objWhatRawAssetData.strVersion !== '1.0'\n      || (\n        _objWhatRawAssetData.booIsTrackedAssessment ||\n        _objWhatRawAssetData.booIsCourseCompletingAssessment\n      )) {\n      //\n      // Tracked assessment status!\n      //\n      var _objCurrTopicData = TOPIC_MANAGER.getCurrentTopic();\n      CONTENT_TRACKING.interaction({\n        type: 'completed',\n        activity: {\n          id: _objCurrTopicData['strObjID'], // Use the Asset ID\n          title: _objCurrTopicData['strTitle'], // Use the topic title - it will make more sense.\n          type: 'assessment'\n        },\n        result: {\n          completion: true,\n          score: {\n            min: 0,\n            max: 100,\n            raw: _objScoreData['intPercentage']\n          }\n        },\n        response: response\n      });\n    }\n\n    // Set course score for new asset instances when config is set.\n    // Or set on old instances when the old config passes.\n    if (_objWhatRawAssetData.strVersion !== '1.0' && _objWhatRawAssetData.booSetScore\n      || (\n        _objWhatRawAssetData.strVersion == '1.0' && (\n          _objWhatRawAssetData.booIsTrackedAssessment ||\n          _objWhatRawAssetData.booIsCourseCompletingAssessment\n        )\n      )) {\n      // set course score\n      CORE.setCourseScore(_objScoreData['intPercentage']);\n    }\n\n    // Is this a 'course completing' assessment\n    if (_objWhatRawAssetData.booIsCourseCompletingAssessment) {\n      //\n      // Overall course completion status!!!\n      //\n      var _strCompletionType = _objWhatRawAssetData.strCourseCompletionPattern;\n      if (_strCompletionType != 'null') {\n        var passed =\n          _objScoreData['intPercentage'] >=\n          _objWhatRawAssetData['objScoreGrades']['intBaseScoreGrade'];\n          // Set course score if we are a scored course.\n        var courseScore =\n          _objWhatRawAssetData.strVersion !== '1.0' &&\n          _objWhatRawAssetData.booSetScore ?\n            _objScoreData['intPercentage'] :\n            false;\n        switch (_strCompletionType) {\n          case 'passed-failed':\n            CORE.setCoursePassFail(passed, courseScore, response);\n            if (passed) {\n              // Ensure tincan sends a completed status too...\n              CORE.setCourseCompleted(courseScore, 'tincan', response);\n            }\n            break;\n          case 'completed':\n            if (passed) {\n              CORE.setCourseCompleted(courseScore, null, response);\n            } else {\n              CORE.setCourseIncomplete(courseScore, null, response);\n            }\n            break;\n          default:\n            console.log(\n              'ERROR: Unknown course completion type of \"' +\n                _strCompletionType +\n                '\" found in _getAssessmentScoreData(), extension_assessment_results_asset.js'\n            );\n            break;\n        }\n      }\n    }\n\n    return _objScoreData;\n  },\n\n  _insertScoreData: function(_strWhatFeedbackText, _objScoreData) {\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(\n      /\\[percent\\]/gi,\n      _objScoreData['intPercentage']\n    );\n\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(\n      /\\[correct\\]/gi,\n      _objScoreData['intCorrect']\n    );\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[right\\]/gi, _objScoreData['intCorrect']);\n\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(\n      /\\[incorrect\\]/gi,\n      _objScoreData['intWrong']\n    );\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[wrong\\]/gi, _objScoreData['intWrong']);\n\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[total\\]/gi, _objScoreData['intTotal']);\n    _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[max\\]/gi, _objScoreData['intTotal']);\n\n    if (_objScoreData['intCorrect'] > 1) {\n      _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[s\\]/gi, 's');\n    } else {\n      _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[s\\]/gi, '');\n    }\n\n    if (_objScoreData['intWrong'] > 1) {\n      _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[ws\\]/gi, 's');\n    } else {\n      _strWhatFeedbackText = _strWhatFeedbackText.replace(/\\[ws\\]/gi, '');\n    }\n\n    return _strWhatFeedbackText;\n  },\n\n  _reset_assessmentresults_Asset: function(_objWhatAssetData, _booFullReset) {},\n\n  _checkCompletion_assessmentresults_Asset: function() {\n    return true;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, ASSESSMENT_RESULTS_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(75))},function(t,e){t.exports="/* global $, _, gomo */\n/* global ISCROLL_INTERFACE, TOPIC_MANAGER, OUTPUT_MODE_CHECKER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_DYNAMIC_CONTINUOUS_SCROLLING */\n/* global global */\n\n(function() {\n  var Draganddrop = gomo.QuestionAsset.extend({\n    optionClassName: 'dragItem',\n    optionCorrectnessClass: 'correctnessMarkerC',\n    confirmButtonClass: 'confirmButtonC',\n    resetButtonClass: 'resetButtonC',\n    scoreInfo: {},\n    isScrolling: false,\n\n    processData: function(data) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n\n      me.data.attempts = 0;\n      me.data.selectedOptions = [];\n      me.data.isComplete = false;\n\n      rawData.additionalTrackingData = {\n        activity: {},\n        result: {},\n        response: {}\n      };\n\n      rawData.assetId = rawData.strID;\n      rawData.optionStates = me.data.arrOptionStates;\n      rawData.strAttempts = parseInt(rawData.strAttempts);\n      rawData.optionItems = rawData.dragItems;\n\n      // format drag item text\n      while (count < rawData.dragItems.length) {\n        rawData.dragItems[count].strFormattedOptionText = me.formatHTML(\n          rawData.dragItems[count].strOptionText\n        );\n        count++;\n      }\n\n      // format drop area label text\n      count = 0;\n      while (count < rawData.dropAreas.length) {\n        rawData.dropAreas[count].strFormattedDropLabel = me.formatHTML(\n          rawData.dropAreas[count].strDropLabel\n        );\n        count++;\n      }\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n\n      if (\n        found &&\n        found.dragItems &&\n        found.dropAreas &&\n        rawData.dragItems &&\n        rawData.dropAreas\n      ) {\n        while (count < rawData.dragItems.length) {\n          found.dragItems[count].strFormattedOptionText = me.formatHTML(\n            rawData.dragItems[count].strOptionText\n          );\n          count++;\n        }\n        gomo.translationManager.setArrayOfImages(rawData.strID, 'dragItems', 'objNormalSrc');\n        count = 0;\n        while (count < rawData.dropAreas.length) {\n          found.dropAreas[count].strFormattedDropLabel = me.formatHTML(\n            rawData.dropAreas[count].strDropLabel\n          );\n          count++;\n        }\n      }\n    },\n\n    translationPostprocess: function() {\n      var me = this;\n      if (me.el.innerHTML.length > 0) {\n        me.data.booInteractable = true;\n        $(me.el).removeClass('assetDisabled');\n        // refresh the drag containers so they are the correct size.\n        me.initialiseAsset();\n        me.initTextDragContainers();\n      }\n    },\n\n    beforeShown: function() {\n      var me = this;\n      me.initialiseAsset();\n    },\n\n    afterRenderShown: function() {\n      var me = this;\n      me.initTextDragContainers();\n    },\n\n    registerEvents: function() {\n      var me = this;\n      me.events = {\n        'click .confirmButtonC': 'confirmButton',\n        'click .resetButtonC': 'resetButton'\n      };\n    },\n\n    initialiseAsset: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      rawData.additionalTrackingData.response.timeAvailable = new Date();\n      me.initDrag();\n      me.initDrop();\n      me.initImageDragContainers();\n\n      gomo.topicInteractions.removeAnsweredQuestionFromTopic(me.data);\n      gomo.topicInteractions.addViewedQuestionToTopic(me.data);\n\n      // Check for subscreen actions and add the appropriate aria value\n      if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n        me.$el\n          .find('.' + me.confirmButtonClass)\n          .attr('aria-haspopup', 'dialog');\n      }\n    },\n\n    initTextDragContainers: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      // Set the size on the drag container after the drag item renders.\n      while (count < rawData.dragItems.length) {\n        var dragItem = me.$('.dragItem')[count];\n        var dragContainer = me.$('.dragItemContainer')[count];\n        if (rawData.dragItems[count].objNormalSrc.strSrc.length === 0) {\n          // Clear sizing to allow drag items to resize after translation if required.\n          $(dragContainer).css({width: '', height: ''});\n          $(dragItem).css({width: '', height: ''});\n          // Then apply width and height to the container. Required so it remains the correct size\n          // after drag starts.\n          $(dragItem)\n            .outerWidth($(dragItem).outerWidth())\n            .outerHeight($(dragItem).outerHeight());\n          $(dragContainer)\n            .outerWidth($(dragItem).outerWidth())\n            .outerHeight($(dragItem).outerHeight());\n        }\n        count++;\n      }\n    },\n\n    initImageDragContainers: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n\n      // size the drag items and thier containers correctly\n      while (count < rawData.dragItems.length) {\n        var dragItem = me.$('.dragItem')[count];\n        var dragContainer = me.$('.dragItemContainer')[count];\n        // if the drag item is an image update the path & work out dimensions\n        if (rawData.dragItems[count].objNormalSrc.strSrc.length > 0) {\n          $(dragItem)\n            .find('.dragItemImage')\n            .attr(\n              'src',\n              gomo.utility.getSrcPath(rawData.dragItems[count].objNormalSrc.strSrc) +\n                rawData.dragItems[count].objNormalSrc.strSrc\n            );\n          // get the image data\n          var imgData = gomo.fileManager.getImageProperties(\n            decodeURI(rawData.dragItems[count].objNormalSrc.strSrc)\n          );\n\n          var imgHeight = imgData.strHeight;\n          var imgWidth = imgData.strWidth;\n          var imgRatio = imgWidth/imgHeight;\n\n          // calculate how big the container should be based on the css applied to the image\n          var imgActualHeight = $(dragItem).outerHeight();\n          var imgActualWidth = imgActualHeight * imgRatio;\n\n          // size the image only drag items and containers\n          $(dragItem).outerWidth(imgActualWidth);\n          $(dragContainer).outerWidth(imgActualWidth);\n          $(dragContainer).outerHeight(imgActualHeight);\n        }\n        count++;\n      }\n    },\n\n    initDrag: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      me.$('.dragItem').draggable({\n        containment: me.$('.dragDropWrapper'),\n        cursor: 'pointer',\n        refreshPositions: true,\n        revert: function(dropArea) {\n          // reset any margin added when scrolling\n          me.isScrolling = false;\n          if ($(this).data().inDropArea) {\n            // dont revert if in drop area\n            return false;\n          } else {\n            // reset drag item position and parent, then animate back to start point.\n            var topPos = $(this).offset().top - $(this).data().dragContainer.offset().top;\n            var leftPos = $(this).offset().left - $(this).data().dragContainer.offset().left;\n            $(this).detach().css({\n              top: topPos,\n              left: leftPos\n            }).appendTo($(this).data().dragContainer);\n            $(this).parent().removeClass('emptyContainer');\n            $(this).animate({\n              top: 0,\n              left: 0\n            }, 'slow', function() {\n              // reset zIndex back to normal\n              $(this).css('zIndex', 10);\n              // reset margin added when scrolling so the drag item displays correctly\n              $(this).css('margin-top', 0);\n              // reset positioning\n              $(this).data('dragItemPosition', {top: 0, left: 0});\n              $(this).data('parentPosition', {top: 0, left: 0});\n            });\n            return false;\n          }\n        },\n        start: function(event, ui) {\n          if (!me.data.booInteractable) {\n            event.preventDefault();\n          } else {\n            // disable iscroll and screen swiping as it interferes with dragging\n            gomo.eventManager.legacy('disableParentIScrollInstaces');\n            gomo.eventManager.legacy('disableScreenSwiping');\n            // increase zIndex to avoid drag items appearing underneath others.\n            // resets on revert or drop.\n            $(this).css('zIndex', 1000);\n            if ($(this).data().inDropArea) {\n              // remove the drag item from the drop area and attach back to the drag item container\n              $(this).detach().appendTo($(this).data().dragContainer);\n              // restore the top margin that we had before dropping to allow page scrolling to work\n              $(this).css('margin-top', $(this).data().topMargin);\n            }\n          }\n        },\n        drag: function(event, ui) {\n          var newScrollTop = 0;\n          var currentScrollTop = 0;\n          // check drag item location, if near top or bottom of the screen scroll page\n          if (\n            $(this).offset().top + $(this).height() > $('body').height() * 0.9 ||\n            $(this).offset().top < $('body').height() * 0.1\n          ) {\n            if (OUTPUT_MODE_CHECKER.applyScrolling()) {\n              me.isScrolling = true;\n              // scroll iscroll container\n              var currScreen =\n                $('#screenWrapper_' + TOPIC_MANAGER._getCurrScreenObject().strObjID + 'L');\n              var currScreenScrollWrapperId;\n              if (BOO_DYNAMIC_CONTINUOUS_SCROLLING) {\n                currScreenScrollWrapperId = 'contentWrapperL';\n              } else {\n                currScreenScrollWrapperId =\n                  $(currScreen).find('.scrollMaskingWrapperC').attr('id');\n              }\n              currentScrollTop = ISCROLL_INTERFACE.getCurrScrollPos(currScreenScrollWrapperId).y;\n              if ($(this).offset().top < $('body').height() * 0.1) {\n                newScrollTop = currentScrollTop + 10;\n              } else {\n                newScrollTop = currentScrollTop - 10;\n              }\n              ISCROLL_INTERFACE.scrollToPosition(currScreenScrollWrapperId, 0, newScrollTop);\n            } else {\n              // scroll the content wrapper which is a different element in each topic model\n              var contentWrapper = '#contentWrapperL';\n              currentScrollTop = $(contentWrapper).scrollTop();\n              var newDragItemTopMargin = 0;\n              var newDragItemBottomMargin = 0;\n              if ($(this).offset().top < $('body').height() * 0.1) {\n                // scroll page up\n                newScrollTop = currentScrollTop - 10;\n                newDragItemTopMargin = parseInt($(this).css('margin-top')) - 10;\n                newDragItemBottomMargin = parseInt($(this).css('margin-bottom')) + 10;\n              } else {\n                // scroll page down\n                newScrollTop = currentScrollTop + 10;\n                newDragItemTopMargin = parseInt($(this).css('margin-top')) + 10;\n              }\n              // move the page and the drag item\n              $(contentWrapper).scrollTop(newScrollTop);\n              $(this).css('margin-top', newDragItemTopMargin + 'px');\n              $(this).css('margin-bottom', newDragItemBottomMargin + 'px');\n            }\n          }\n\n          // adjust drag item position so its correct now its attached back to the drag container\n          var dragItemLeftOffset =\n            $(this).data().parentPosition.left - $(this).data().dragItemPosition.left;\n          var actualPos = ui.position;\n          var offsetTop = actualPos.top +\n            $(this).data().dragItemPosition.top -\n            $(this).data().parentPosition.top;\n          var offsetLeft = actualPos.left - dragItemLeftOffset;\n          ui.position.top = offsetTop;\n          ui.position.left = offsetLeft;\n        },\n        stop: function(event, ui) {\n          // enable iscroll and swiping & refresh the iscroll\n          gomo.eventManager.legacy('enableParentIScrollInstaces');\n          ISCROLL_INTERFACE.refreshIScrolls();\n          me.isScrolling = false;\n          // store position and top margin of the drag item. Used when we detach fron the drop area\n          $(this).data('dragItemPosition', {\n            top: $(this).position().top - parseInt($(this).css('margin-top')),\n            left: $(this).position().left\n          });\n          // store the top margin when dropped for when we detach the drag item\n          $(this).data('topMargin', $(this).css('margin-top'));\n          // reset any css added when scrolling so the drag item displays in the drop area correctly\n          $(this).css('marginTop', 0);\n          $(this).css('marginBottom', 0);\n        },\n        create: function(event, ui) {\n          // we are not in a drop area when the drag item is created\n          $(this).data('inDropArea', false);\n          // store parent id so we can switch back to it when dragging out of a drop area\n          $(this).data('dragContainer', $(this).parent());\n          // store drag item id\n          $(this).data('dragId', $(this).attr('id'));\n          // set correctness\n          $(this).data('isCorrect', false);\n          // positioning\n          $(this).data('dragItemPosition', {top: 0, left: 0});\n          $(this).data('topMargin', 0);\n          $(this).data('parentPosition', {top: 0, left: 0});\n\n          var count = 0;\n          while (count < rawData.dragItems.length) {\n            // store correct drop area\n            if (rawData.dragItems[count].strID == $(this).data().dragId) {\n              $(this).data('correctDropArea', rawData.dragItems[count].strCorrectDropArea);\n              // set to correct if it doesn't need to be dragged, 0 means no drop area selected\n              if ($(this).data().correctDropArea == '0') {\n                $(this).data('isCorrect', true);\n              }\n            }\n            count++;\n          }\n        }\n      });\n    },\n\n    initDrop: function() {\n      var me = this;\n\n      me.$('.dropArea').droppable({\n        accept: '.dragItem',\n        drop: function(event, ui) {\n          var dragItemTarget = $(ui.draggable).data().correctDropArea;\n          var dropAreaId = $(this).data().dropAreaId;\n          var snapArea = $(this).find('.dropAreaSnapContainer');\n\n          $(ui.draggable).data('parentPosition', {\n            top: $(ui.draggable).parent().position().top,\n            left: $(ui.draggable).parent().position().left\n          });\n\n          // set the drag item correctness\n          if (dragItemTarget == dropAreaId) {\n            $(ui.draggable).data('isCorrect', true);\n          } else {\n            $(ui.draggable).data('isCorrect', false);\n          }\n\n          // set the drop area id\n          $(ui.draggable).data('dropAreaId', dropAreaId);\n\n          // remove hover class from drop area\n          $(this).removeClass('dragHover');\n\n          $(ui.draggable).parent().addClass('emptyContainer');\n          // snap to the snap area within the drop area.\n          $(ui.draggable).detach().css({\n            top: 0,\n            left: 0\n          }).appendTo(snapArea);\n\n          // reset the z-index back to normal\n          $(ui.draggable).css('zIndex', 10);\n\n          // track if we are in a drop area\n          $(ui.draggable).data('inDropArea', true);\n        },\n        over: function(event, ui) {\n          // add hover class to drop area unless screen is autoscrolling because it looses track\n          // of position and shows hover on the wrong drop area.\n          if (!me.isScrolling) {\n            $(this).addClass('dragHover');\n          }\n        },\n        out: function(event, ui) {\n          // remove hover class from drop area\n          $(this).removeClass('dragHover');\n          // track if we are in a drop area\n          $(ui.draggable).data('inDropArea', false);\n          // reset the drag item correctness to false if it is meant\n          // to be in a drop area, true if not\n          if ($(ui.draggable).data().correctDropArea == '0') {\n            $(ui.draggable).data('isCorrect', true);\n          } else {\n            $(ui.draggable).data('isCorrect', false);\n          }\n        },\n        create: function(event, ui) {\n          // store drop area id\n          $(this).data('dropAreaId', $(this).attr('id'));\n        }\n      });\n    },\n\n    confirmButton: function() {\n      var me = this;\n      var assetData = me.data;\n      var rawData = me.data.objRawData;\n      var optionElements = [];\n\n      gomo.eventManager.legacy('enableScreenSwipe');\n\n      me.setSelectedOptions();\n\n      if (!assetData.booInteractable) {\n        return false;\n      }\n\n      try {\n        assetData.booInteractable = false;\n        $(me.el).addClass('assetDisabled');\n        assetData.attempts++;\n\n        var responseValue = '';\n        _.each(assetData.selectedOptions, function(value, key) {\n          responseValue += rawData.dragItems[key].strOptionText;\n        });\n        assetData.responseValue = responseValue;\n\n        me.setVariablesToGlobal(me);\n\n        me.scoreAsset();\n        assetData.booIsCorrect = me.scoreInfo['booIsCorrect'];\n\n        var responses = _.reject(\n          _.map(me.scoreInfo.objOptionData, function(dragItem, index) {\n            var prefix = (index + 1) + '.';\n            return dragItem.strCorrectDropArea !== '0' && dragItem.dropAreaId ?\n              [\n                prefix + me.getDropAreaPosition(dragItem.strCorrectDropArea),\n                prefix + me.getDropAreaPosition(dragItem.dropAreaId)\n              ] : null;\n          }),\n          _.isNull\n        );\n\n        // Correct responses\n        var correctResponses = _.map(me.scoreInfo.objOptionData, function(dragItem, index) {\n          var prefix = (index + 1) + '.';\n          return dragItem.strCorrectDropArea !== '0' ?\n            [\n              prefix + me.getDropAreaPosition(dragItem.strCorrectDropArea)\n            ] : null;\n        });\n\n        // Response details\n        var responseDetails = _.map(responses, _.last);\n\n        // Additional tracking data\n        var additionalTrackingData = rawData.additionalTrackingData;\n        additionalTrackingData.activity.type = 'matching';\n        additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n        var associatedAsset = gomo.assetManager.findInstance(rawData.strAssociatedAssetId);\n        additionalTrackingData.activity.description =\n          associatedAsset && associatedAsset.getContent ? associatedAsset.getContent() : null;\n        additionalTrackingData.activity.weighting = parseInt(rawData.strWeighting) || 1;\n        additionalTrackingData.result.detail = assetData.booIsCorrect ? 'correct' : 'incorrect';\n        additionalTrackingData.response.timeResponse = new Date();\n        additionalTrackingData.response.detail = responseDetails.join(',');\n        additionalTrackingData.id = rawData.strID;\n        additionalTrackingData.source = _.map(rawData.dragItems, function(item, index) {\n          return {\n            'id': (index+1).toString(),\n            'description': {'en-GB': item.strFormattedOptionText}\n          };\n        });\n        additionalTrackingData.target = _.map(rawData.dropAreas, function(item, index) {\n          return {\n            'id': gomo.utility.convertNumberToCharacter(index),\n            'description': {'en-GB': item.strFormattedDropLabel}\n          };\n        });\n\n        // Add answered question to topic\n        gomo.topicInteractions.addAnsweredQuestionToTopic(assetData, additionalTrackingData);\n\n        // Reset attemps if global override\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT) {\n          assetData.attempts = 1;\n        }\n\n        if (assetData.attempts == rawData.strAttempts || assetData.booIsCorrect) {\n          // build option elements array in correct order for marking\n          _.each(me.scoreInfo.objOptionData, function(element) {\n            optionElements.push(me.$('#' + element.strID +'.dragItem')[0]);\n          });\n          me.showOptionCorrectness(optionElements);\n          me.deactivateButtons();\n          gomo.eventManager.legacy('questionMaxAttemptsReached');\n          assetData.isComplete = true;\n          assetData.booInteractable = false;\n          $(me.el).addClass('assetDisabled');\n        } else {\n          this.showResetButton();\n        }\n\n        var actions;\n        var additionalStyles;\n\n        // subscreens\n        if (assetData.booIsCorrect) {\n          actions = rawData.arrCorrectActions;\n          additionalStyles = 'correctFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_CorrectFeedbackSubScreenC';\n        } else if (!assetData.booIsCorrect && assetData.attempts < rawData.strAttempts) {\n          actions = rawData.arrFirstIncorrectActions;\n          additionalStyles = 'incorrectFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_IncorrectFeedbackSubScreenC';\n        } else {\n          actions = rawData.arrFinalIncorrectActions;\n          additionalStyles = 'incorrectFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_IncorrectFeedbackSubScreenC';\n        }\n\n        gomo.eventManager.legacy('screenAssetInteracting', assetData);\n\n        if (actions != 'null') {\n          var actionOptions = {};\n          actionOptions.objActions = actions;\n          actionOptions.objOptionalExtraData = assetData;\n          actionOptions.objOptionalExtraData.strType = assetData.strAssetType;\n          actionOptions.objOptionalExtraData.strAdditionalStyles = additionalStyles;\n          actionOptions.objOptionalExtraData.strAssetID = assetData.strObjID;\n\n          gomo.eventManager.legacy('processActions', actionOptions);\n        }\n\n        if (rawData.arrActions && rawData.arrActions.length && assetData.isComplete) {\n          me.processAssetActions();\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          gomo.eventManager.legacy('showNextButtonFromAsset');\n        }\n      } catch (err) {\n        if (global.LogManager) {\n          global.LogManager.add('ERROR', err);\n        }\n        return;\n      }\n    },\n\n    resetButton: function() {\n      var me = this;\n      me.resetOptions();\n      me.resetQuestion();\n      me.showConfirmButton();\n      me.data.booInteractable = true;\n      $(me.el).removeClass('assetDisabled');\n      ISCROLL_INTERFACE.refreshIScrolls();\n    },\n\n    scoreAsset: function() {\n      var me = this;\n      var isQuestionCorrect = true;\n      var dragItems = me.$('.dragItem');\n      var dragItemsData = me.data.objRawData.dragItems;\n\n      _.each(dragItemsData, function(dragItem) {\n        var draggedItem = _.find(dragItems, function(item) {\n          return $(item).data().dragId === dragItem.strID;\n        });\n        dragItem.booIsCorrect = $(draggedItem).data().isCorrect;\n        isQuestionCorrect = !dragItem.booIsCorrect ? false : isQuestionCorrect;\n        dragItem.dropAreaId = $(draggedItem).data().dropAreaId;\n      });\n\n      // create score info object for question scoring/marking to use\n      me.scoreInfo = {\n        'booIsCorrect': isQuestionCorrect,\n        'objOptionData': dragItemsData\n      };\n    },\n\n    resetQuestion: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      var dragItems = me.$('.dragItem');\n\n      // Reset the data for the drag items that gets set on drop.\n      while (count < rawData.dragItems.length) {\n        rawData.dragItems[count].booIsCorrect = false;\n        rawData.dragItems[count].dropAreaId = false;\n        count++;\n      }\n\n      // Reset the drag item dom elements and thier data\n      count = 0;\n      while (count < dragItems.length) {\n        // reset drag item correctness\n        if ($(dragItems[count]).data().correctDropArea == '0') {\n          $(dragItems[count]).data('isCorrect', true);\n        } else {\n          $(dragItems[count]).data('isCorrect', false);\n        }\n\n        $(dragItems[count]).data('dropAreaId', false);\n\n        // move drag item back to start position\n        if ($(dragItems[count]).data().inDropArea) {\n          // reset the drop area id\n          $(dragItems[count]).data('inDropArea', false);\n          $(dragItems[count]).detach().css({\n            top: 0,\n            left: 0\n          }).appendTo($(dragItems[count]).data().dragContainer);\n        }\n\n        // reset any positioning data\n        $(dragItems[count]).data('dragItemPosition', {top: 0, left: 0});\n        $(dragItems[count]).data('parentPosition', {top: 0, left: 0});\n\n        count++;\n      }\n    },\n\n    getDropAreaPosition: function(dropAreaId) {\n      var index = _.findIndex(this.data.objRawData.dropAreas, function(item) {\n        return item.strID === dropAreaId;\n      });\n      return index === -1 ? '' : gomo.utility.convertNumberToCharacter(index);\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    isComplete: function() {\n      var me = this;\n      return me.data.isComplete;\n    },\n\n    reset: function() {\n      var me = this;\n      me.resetOptions();\n      me.resetQuestion();\n      if (me.$('.resetButtonC').length > 0) {\n        me.showConfirmButton();\n      }\n      me.data.attempts = 0;\n      me.data.selectedOptions = [];\n      me.data.booInteractable = true;\n      $(me.el).removeClass('assetDisabled');\n    }\n  });\n\n  // register the new asset definition...\n  gomo.assetManager.register('drag-and-drop', Draganddrop);\n})();\n"},function(t,e,n){n(0)(n(77))},function(t,e){t.exports="/* global ASSET_INTERACTIONS, O_EXTENDER, ASSET_RENDERER, CORE, LOCALISER, EM */\n/* global MASTER_RENDERER, BOO_HIGHLIGHT_CORRECT_ANSWER, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global TOPIC_INTERACTIONS, $, _, BOO_SINGLE_ATTEMPT_IN_ASSESSMENT */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK, CONTENT_TRACKING, SCREEN_INTERACTIONS */\n\n/**\n * @title drop down on graphic asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the dropdownsongraphic\n * asset type.\n *\n * @author Caroline Wilgar\n * @version 2.0 [25/05/2012]\n *\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('dropdownsongraphic', objCurrSupportData);\n\nvar DDOG_ASSET_RENDERER = {\n  strObjID: 'The dropdowns on graphic asset renderer extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['dropdownsongraphic', 'ddogAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [\n    ['ddogDropdown', 'ddogAssetDropDownTemplateWrapperC'],\n    ['ddogDropdownOption', 'ddogDropDownOptionTemplateWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_dropdownsongraphic_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {\n        timeAvailable: new Date()\n      }\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      // _htmReturnData = _htmReturnData.replace('alt=XX_IMAGE_ALT_XX', 'alt=\"XX_IMAGE_ALT_XX\"');\n      var _strAltText = '';\n      if (_objWhatRawAssetData.objImageBaseSrc.strAltText) {\n        _strAltText = _objWhatRawAssetData.objImageBaseSrc.strAltText;\n      }\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XX_IMAGE_ALT_XX/g,\n        this.sanitiseAltText(_strAltText)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        /resources\\/trans.gif\\?/g,\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_IMAGE_SOURCE_XX',\n        decodeURIComponent(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n      );\n\n      var _objImageMetaData = MASTER_RENDERER.getImageProperties(\n        decodeURIComponent(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n      );\n      var _htmDropDowns = this._getDdogDropDowns(\n        _objWhatAssetCourseObject,\n        _objWhatRawAssetData,\n        _objImageMetaData['strWidth'],\n        _objImageMetaData['strHeight']\n      );\n      _htmReturnData = _htmReturnData.replace('XX_DDOG_DROPDOWNS_XX', _htmDropDowns);\n\n      _htmReturnData = _htmReturnData.replace(\n        /XX_SELECT_OPTION_XX/g,\n        LOCALISER.get('DDOG_SELECT_OPTION')\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_CONFIRM_BUTTON_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get('DDOG_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('DDOG_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  // REFACTOR NOTE: Split function up, too large\n  _getDdogDropDowns: function(\n    _objWhatAssetCourseObject,\n    _objWhatRawAssetData,\n    _intImageWidth,\n    _intImageHeight\n  ) {\n    var _htmReturnData = '';\n    var count = 0;\n    var _booHotspotError = false;\n    var _arrDropdownData = _objWhatRawAssetData.arrDropdowns;\n\n    while (count < _arrDropdownData.length) {\n      var _objCurrOption = _arrDropdownData[count];\n\n      var _htmDropDown = this._objSubAssetTemplates['ddogDropdown'];\n\n      _htmDropDown = _htmDropDown.replace(/XX_ASSET_ID_XX/g, _objWhatRawAssetData['strID']);\n      _htmDropDown = _htmDropDown.replace(/XX_DROPDOWN_INDEX_XX/g, count);\n\n      var _intLeft;\n      var _intTop;\n\n      if (\n        _objCurrOption.objDropdownCoords.intLeft !== '' &&\n        _objCurrOption.objDropdownCoords.intLeft !== null &&\n        (_objCurrOption.objDropdownCoords.intTop !== '' &&\n          _objCurrOption.objDropdownCoords.intTop !== null)\n      ) {\n        _intTop = (_objCurrOption.objDropdownCoords.intTop / _intImageHeight) * 100;\n        _intLeft = (_objCurrOption.objDropdownCoords.intLeft / _intImageWidth) * 100;\n      } else {\n        _booHotspotError = true;\n        _intLeft = 100 * (count + 1);\n        _intTop = 200;\n      }\n      _htmDropDown = _htmDropDown.replace(\n        'class=ddogDropDownWrapperC',\n        'class=\"ddogDropDownWrapperC\"'\n      );\n      _htmDropDown = _htmDropDown.replace(\n        'class=\"ddogDropDownWrapperC\"',\n        'class=\"ddogDropDownWrapperC\" style=\"top:' + _intTop + '%; left:' + _intLeft + '%;\"'\n      );\n\n      var _htmOptions = '';\n      var _strOptions = _objCurrOption.strOptions;\n      _objCurrOption.strOptionsArray = _strOptions.split('||');\n      var _arrOptions = _objCurrOption.strOptionsArray;\n      for (var _index = 0; _index < _arrOptions.length; _index++) {\n        _htmOptions += this._objSubAssetTemplates['ddogDropdownOption'];\n        _htmOptions = _htmOptions.replace('XX_DROPDOWN_OPTION_VALUE_XX', _arrOptions[_index]);\n        _htmOptions = _htmOptions.replace('XX_DDOG_OPTION_TEXT_XX', _arrOptions[_index]);\n        _htmOptions = _htmOptions.replace(\n          'XX_CORRECT_OPTION_MARKER_XX',\n          this._showDDOGCorrectOptionMarker(_objCurrOption, _index)\n        );\n        _htmOptions = _htmOptions.replace('XX_OPTION_ID_XX', '[' + _index + ']');\n        _htmOptions = _htmOptions.replace('XX_OPTION_CLASS_ID_XX', _index);\n        _htmOptions = _htmOptions.replace('XX_DROPDOWN_ID_XX', '[' + count + ']');\n      }\n      _htmDropDown = _htmDropDown.replace('</select>', _htmOptions + '</select>');\n\n      _htmReturnData = _htmReturnData + _htmDropDown;\n\n      count++;\n    }\n    if (_booHotspotError) {\n      LOCALISER.l_alert('DDOG_MISSING_HOTSPOT_ERROR', [_objWhatRawAssetData['strID']]);\n    }\n    return _htmReturnData;\n  },\n\n  _showDDOGCorrectOptionMarker: function(_objWhatOptionData, _intOptionIndex) {\n    if (BOO_HIGHLIGHT_CORRECT_ANSWER) {\n      var _intCorrectOption = parseInt(_objWhatOptionData.intCorrectOption);\n      if (_intCorrectOption == _intOptionIndex + 1) {\n        return '!!!';\n      }\n    }\n    return '';\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, DDOG_ASSET_RENDERER);\n\nvar DDOG_ASSET_INTERACTIONS = {\n  strObjID: 'The drop down on graphic asset interactions extension object',\n\n  _strDDOGDropdownClass: 'ddogDropDownWrapperC',\n  _strSmartphoneDDOGDropdownClass: 'ddogSmartphoneSelectC',\n  _strDDOGDropDownOptionClass: 'ddogDropDownOptionC',\n  _booCorrectOptionErrorShown: false,\n\n  _objCurrDropdownAsset: null,\n  _intCurrDropdownSet: null,\n\n  _performPreShowActions_dropdownsongraphic_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    var optionClass = this._strDDOGDropDownOptionClass;\n\n    if (rawData.randomiseAnswers) {\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, optionClass);\n\n      var options = $(assetElement).find(optionClass);\n      var optionsWrapper = $(options).parent();\n\n      $(optionsWrapper).each(function(index, element) {\n        var wrapperOptions = $(element).find(optionClass);\n        var randomisedOptions = [];\n        var correctOptionIndex = parseInt(rawData.arrDropdowns[index]['strCorrectOption']);\n        var correctOptionText =\n          rawData.arrDropdowns[index]['strOptionsArray'][correctOptionIndex - 1];\n\n        for (var i = 0; i < wrapperOptions.length; i++) {\n          randomisedOptions.push(wrapperOptions[i].value);\n        }\n\n        rawData.arrDropdowns[index]['randomisedOptions'] = randomisedOptions;\n        rawData.arrDropdowns[index]['correctRandomisedOption'] =\n          rawData.arrDropdowns[index]['randomisedOptions'].indexOf(correctOptionText) + 1;\n      });\n    }\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_dropdownsongraphicConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var rawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    var _arrSelectWrapperDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strDDOGDropdownClass\n    );\n    var _arrSelectDOMElements = _domWhatAssetElement.getElementsByTagName('select');\n    var _arrUserSelectedOptions = this._getSelectedDDOGOptions(\n      _arrSelectDOMElements,\n      _objWhatAssetData\n    );\n    var unlimitedAttempts = false;\n    if (rawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_arrUserSelectedOptions) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = '';\n      var selectedOptionText = [];\n      var count = 0;\n\n      while (count < _arrUserSelectedOptions.length) {\n        var options = rawData.arrDropdowns[count].strOptions.split('||');\n        var prefix = count + 1 + '.';\n        responseValue += ' ' + options[_arrUserSelectedOptions[count] - 1];\n        selectedOptionText.push(\n          prefix + gomo.utility.convertNumberToCharacter(_arrUserSelectedOptions[count] - 1)\n        );\n        count++;\n      }\n\n      _objWhatAssetData.responseValue = responseValue;\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      var _objScoreInfo = this._scoreDDOGAsset(_objWhatAssetData, _arrUserSelectedOptions);\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = _.map(_objScoreInfo.objOptionData, function(item, index) {\n        var prefix = index + 1 + '.';\n        var answer = parseInt(item.strCorrectOption) - 1;\n        return prefix + gomo.utility.convertNumberToCharacter(answer);\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = rawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'matching';\n      additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n      var associatedAsset = rawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(rawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n\n      additionalTrackingData.activity.weighting = parseInt(rawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n\n      // Send a statement for each dropdown\n      count = 0;\n      while (count < rawData.arrDropdowns.length) {\n        var questionData = rawData.arrDropdowns[count];\n        var associatedAssetDescription = ASSET_INTERACTIONS.getAssetContent(associatedAsset) ||\n          SCREEN_INTERACTIONS.getCurrentScreenData().strTitle;\n\n        // send tracking statement for each likert question\n        CONTENT_TRACKING.interaction({\n          type: 'answered',\n          id: questionData.strID,\n          activity: {\n            id: questionData.strID,\n            title: gomo.utility.decodeHtml(associatedAssetDescription),\n            type: 'choice',\n            correctResponses: [\n              gomo.utility.decodeHtml(\n                gomo.utility.convertNumberToCharacter(questionData.strCorrectOption-1)\n              )\n            ]\n          },\n          result: {\n            success: questionData.booIsCorrect,\n            response: gomo.utility.decodeHtml(\n              gomo.utility.convertNumberToCharacter(_arrUserSelectedOptions[count]-1)\n            ),\n            detail: questionData.booIsCorrect ? 'correct' : 'incorrect'\n          },\n          response: {\n            detail: gomo.utility.convertNumberToCharacter(_arrUserSelectedOptions[count]-1)\n          },\n          object: {\n            id: questionData.strID,\n            definition: {\n              name: {'en-GB': gomo.utility.decodeHtml(associatedAssetDescription)},\n              description: {\n                'en-GB': gomo.utility.decodeHtml(associatedAssetDescription)\n              },\n              type: 'http://adlnet.gov/expapi/activities/cmi.interaction',\n              interactionType: 'choice',\n              correctResponsesPattern: [\n                gomo.utility.decodeHtml(\n                  gomo.utility.convertNumberToCharacter(questionData.strCorrectOption-1)\n                )\n              ],\n              choices: _.map(questionData.strOptionsArray, function(option, index) {\n                return {\n                  id: gomo.utility.convertNumberToCharacter(index),\n                  description: {\n                    'en-GB': gomo.utility.decodeHtml(option)\n                  }\n                };\n              })\n            }\n          }\n        });\n        count++;\n      }\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        rawData.additionalTrackingData\n      );\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        this._toggleDDOGOptions(_arrSelectDOMElements, true);\n\n        if (isNaN(parseInt(rawData.strAttempts))) {\n          LOCALISER.l_alert('DDOG_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT && this._strCurrTopicModel == 'assessment') {\n          rawData.strAttempts = 1;\n        }\n\n        var _strAddditionalClass = null;\n        var _strWhatFeedbackSubScreenID = 'null';\n        if (_objWhatAssetData.booIsCorrect) {\n          if (\n            rawData.arrCorrectActions.length > 0 &&\n            rawData.arrCorrectActions[0].objParameters &&\n            rawData.arrCorrectActions[0].objParameters.strSubScreenID\n          ) {\n            _strWhatFeedbackSubScreenID = rawData.arrCorrectActions[0].objParameters.strSubScreenID;\n          }\n          this._showOptionCorrectness(_arrSelectWrapperDOMElements, _objScoreInfo);\n          _strAddditionalClass = 'correctFeedbackSubScreenC';\n          _strAddditionalClass +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < rawData.strAttempts || unlimitedAttempts)\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          var firstIncorrectActions = rawData.arrFirstIncorrectActions;\n          if (\n            firstIncorrectActions.length > 0 &&\n            firstIncorrectActions[0].objParameters &&\n            firstIncorrectActions[0].objParameters.strSubScreenID\n          ) {\n            _strWhatFeedbackSubScreenID = firstIncorrectActions[0].objParameters.strSubScreenID;\n          }\n          _strAddditionalClass = 'incorrectFeedbackSubScreenC';\n          _strAddditionalClass +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          if (\n            rawData.arrIncorrectActions.length > 0 &&\n            rawData.arrIncorrectActions[0].objParameters &&\n            rawData.arrIncorrectActions[0].objParameters.strSubScreenID\n          ) {\n            _strWhatFeedbackSubScreenID =\n              rawData.arrIncorrectActions[0].objParameters.strSubScreenID;\n          }\n          _strAddditionalClass = 'incorrectFeedbackSubScreenC';\n          _strAddditionalClass +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n          this._showOptionCorrectness(_arrSelectWrapperDOMElements, _objScoreInfo);\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == rawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrSelectWrapperDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n          _objWhatAssetData.booInteractable = false;\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        if (_strWhatFeedbackSubScreenID != 'null') {\n          EM.trigger('showSubScreen', {\n            strType: _objWhatAssetData.strAssetType,\n            strAssetID: _objWhatAssetData.strObjID,\n            strTargetSubScreenID: _strWhatFeedbackSubScreenID,\n            strAdditionalStyles: _strAddditionalClass\n          });\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        if (rawData.arrActions && rawData.arrActions.length && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option from each drop down before selecting confirm.\");\n      LOCALISER.l_alert('DDOG_CONFIRM_ERROR');\n    }\n  },\n\n  is_dropdownsongraphic_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _markCorrectOption: function(_arrWhatOptions, _intCorrectAnswerIndex) {\n    if (BOO_HIGHLIGHT_CORRECT_ANSWER) {\n      _arrWhatOptions[_intCorrectAnswerIndex - 1] =\n        '!!! ' + _arrWhatOptions[_intCorrectAnswerIndex - 1];\n    }\n    return _arrWhatOptions;\n  },\n\n  _getSelectedDDOGOptions: function(_arrSelectDOMElements, _objWhatAssetData) {\n    if (_arrSelectDOMElements && _arrSelectDOMElements.length > 0) {\n      return this._getSelectedDDOGOptionsFromSelectElements(_arrSelectDOMElements);\n    } else {\n      return this._getSelectedDDOGOptionsFromOptionStates(_objWhatAssetData);\n    }\n  },\n\n  _getSelectedDDOGOptionsFromSelectElements: function(_arrSelectDOMElements) {\n    var _arrReturn = [];\n    var _booAllOptionsSelected = true;\n    var _objSelect = null;\n    var _intIndex = null;\n    for (var i = 0; i < _arrSelectDOMElements.length && _booAllOptionsSelected; i++) {\n      _objSelect = _arrSelectDOMElements[i];\n\n      _intIndex = _objSelect.selectedIndex;\n\n      if (_intIndex > 0) {\n        var selectedIndex = _objSelect.selectedIndex;\n\n        for (var index = 0; index < _objSelect.options.length; index++) {\n          if (_objSelect.options[_intIndex].className.indexOf(index) != -1) {\n            selectedIndex = index + 1;\n          }\n        }\n\n        _arrReturn[_arrReturn.length] = selectedIndex;\n      } else {\n        _booAllOptionsSelected = false;\n      }\n    }\n    if (_booAllOptionsSelected) {\n      return _arrReturn;\n    }\n    return false;\n  },\n\n  _getSelectedDDOGOptionsFromOptionStates: function(_objWhatAssetData) {\n    var _arrOptionStates = [];\n    var _arrOptionsData = this._objCurrDropdownAsset.objRawData.arrDropdowns;\n    var count = 0;\n    while (count < _arrOptionsData.length) {\n      if (\n        _objWhatAssetData.objOptionStates[count] ||\n        _objWhatAssetData.objOptionStates[count] === 0\n      ) {\n        _arrOptionStates.push(_objWhatAssetData.objOptionStates[count] + 1);\n      } else {\n        return false;\n      }\n      count++;\n    }\n    return _arrOptionStates;\n  },\n\n  _performLanguagePreprocess_dropdownsongraphic_Asset: function(_objWhatAssetCourseObject) {\n    var assetId = _objWhatAssetCourseObject.objRawData.strID;\n    var countTopic = 0;\n\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {\n            id: assetId\n          });\n\n          // Create dropdown items based on options string\n          if (found && found.arrDropdowns) {\n            var translationDropdowns = found.arrDropdowns;\n            var countDropdowns = 0;\n            var imageWidth = 100;\n            var imageHeight = 100;\n            var _objImageMetaData = '';\n\n            // Set image properties\n            if (found.objImageBaseSrc && found.objImageBaseSrc.strSrc) {\n              _objImageMetaData = MASTER_RENDERER.getImageProperties(\n                decodeURIComponent(found.objImageBaseSrc.strSrc)\n              );\n              imageWidth = _objImageMetaData['strWidth'];\n              imageHeight = _objImageMetaData['strHeight'];\n            } else if (\n              _objWhatAssetCourseObject.objRawData.objImageBaseSrc &&\n              _objWhatAssetCourseObject.objRawData.objImageBaseSrc.strSrc\n            ) {\n              _objImageMetaData = MASTER_RENDERER.getImageProperties(\n                decodeURIComponent(_objWhatAssetCourseObject.objRawData.objImageBaseSrc.strSrc)\n              );\n              imageWidth = _objImageMetaData['strWidth'];\n              imageHeight = _objImageMetaData['strHeight'];\n            }\n\n            while (countDropdowns < translationDropdowns.length) {\n              var currentTranslatedDropdown = translationDropdowns[countDropdowns];\n\n              // Rebuild option list\n              if (currentTranslatedDropdown) {\n                currentTranslatedDropdown.strOptionsArray =\n                currentTranslatedDropdown.strOptions.split(\n                  '||'\n                );\n              }\n\n              // Reposition dropdowns\n              if (currentTranslatedDropdown && currentTranslatedDropdown.objDropdownCoords) {\n                var imageLeft;\n                var imageTop;\n\n                if (\n                  currentTranslatedDropdown.objDropdownCoords.intLeft !== '' &&\n                  currentTranslatedDropdown.objDropdownCoords.intLeft !== null &&\n                  (currentTranslatedDropdown.objDropdownCoords.intTop !== '' &&\n                    currentTranslatedDropdown.objDropdownCoords.intTop !== null)\n                ) {\n                  imageTop =\n                    (currentTranslatedDropdown.objDropdownCoords.intTop / imageHeight) * 100;\n                  imageLeft =\n                    (currentTranslatedDropdown.objDropdownCoords.intLeft / imageWidth) * 100;\n\n                  var hotspotElementId = '#ddog_' + assetId + '_DropDown_' + countDropdowns + '_L';\n                  var hotspotElement = $(hotspotElementId);\n                  hotspotElement.css('left', imageLeft + '%');\n                  hotspotElement.css('top', imageTop + '%');\n                }\n              }\n              countDropdowns++;\n            }\n          }\n          if (found) {\n            if (typeof found.objImageBaseSrc == 'undefined') {\n              var altText = '';\n              if (typeof _objImageMetaData.strAltText !== 'undefined') {\n                altText = _objImageMetaData.strAltText;\n              }\n              found.objImageBaseSrc = {\n                strAltText: altText,\n                strSrc: _objImageMetaData.strFilename\n              };\n            }\n            gomo.translationManager.setImage(assetId, 'objImageBaseSrc');\n          }\n\n          if (found) {\n            this.updateDdogAlignment(found);\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n\n    // Update first item in dropdown list as we can't add extra\n    // html children to disable a LOCALISATION update\n    gomo.translationManager.setDynamicTranslationsItem(\n      assetId,\n      'localisationSelectText',\n      LOCALISER.get('DDOG_SELECT_OPTION')\n    );\n  },\n\n  updateDdogAlignment: function(data) {\n    var ddogElement = $('#dropdownsongraphicAsset_YY' + data.id + 'YY_WrapperL');\n    if (ddogElement.length && typeof data.strAlignment !== 'undefined') {\n      ddogElement[0].className =\n        ddogElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      ddogElement.addClass(data.strAlignment);\n    }\n  },\n\n  _doPostRenderShowActions_dropdownsongraphic_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n\n    // Set asset id in element html for _scrollIntoView_Asset\n    var elementSelector =\n      '#' + ASSET_RENDERER.getAssetDOMId(_objWhatAssetData.objRawData) + ' select';\n    ASSET_INTERACTIONS._setScrollIntoView_Asset(\n      elementSelector,\n      _objWhatAssetData.objRawData.strID\n    );\n\n    var el = $(elementSelector);\n    if (el && el.length) {\n      // Trigger _scrollIntoView_Asset on clicking the textarea\n      el.click(function() {\n        ASSET_INTERACTIONS._scrollIntoView_Asset(this);\n      });\n      el.blur(function() {\n        ASSET_INTERACTIONS._scrollIntoViewReset_Asset();\n      });\n    }\n  },\n\n  _scoreDDOGAsset: function(_objWhatAssetData, _arrOptionStates) {\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrDropdowns;\n    var _arrOptionCorrectness = [];\n    var _booIsCorrect = true;\n\n    for (var i = 0; i < _arrRawOptionData.length; i++) {\n      var _objOptionData = _arrRawOptionData[i];\n      var _intCorrectOption = parseInt(_objOptionData.strCorrectOption);\n\n      if (isNaN(_intCorrectOption)) {\n        // alert(\"Please enter a number for the correct option.\");\n        if (!this._booCorrectOptionErrorShown) {\n          LOCALISER.l_alert('DDOG_CORRECT_OPTION_ERROR');\n          this._booCorrectOptionErrorShown = true;\n        }\n        _arrOptionCorrectness[i] = false;\n        _objOptionData.booIsCorrect = false;\n        _booIsCorrect = false;\n      } else {\n        if (_arrOptionStates[i] != _intCorrectOption) {\n          _arrOptionCorrectness[i] = false;\n          _booIsCorrect = false;\n          _objOptionData.booIsCorrect = false;\n        } else {\n          _arrOptionCorrectness[i] = true;\n          _objOptionData.booIsCorrect = true;\n        }\n      }\n      // console.log('_booIsCorrect: ' + _booIsCorrect);\n    }\n\n    return {\n      booIsCorrect: _booIsCorrect,\n      objOptionData: _arrRawOptionData,\n      arrOptionCorrectness: _arrOptionCorrectness\n    };\n  },\n\n  _returnFocusToDROPDOWNSONGRAPHICAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  _toggleDDOGOptions: function(_arrSelectElements, _booDisable) {\n    var _objOption = 0;\n\n    while (_objOption < _arrSelectElements.length) {\n      this._toggleDDOGOption(_arrSelectElements[_objOption], _booDisable);\n      _objOption++;\n    }\n  },\n\n  _toggleDDOGOption: function(_objSelect, _booDisable) {\n    _objSelect.disabled = _booDisable;\n  },\n\n  _resetDDOGOptions: function(_domWhatAssetElement, _objWhatAssetData) {\n    var _arrSelectDOMElements = _domWhatAssetElement.getElementsByTagName('select');\n    var _arrFakeSelectDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      'ddogDropDownWrapperC'\n    );\n    if (_arrSelectDOMElements && _arrSelectDOMElements.length > 0) {\n      this._resetDesktopDDOGOptions(_domWhatAssetElement, _arrSelectDOMElements);\n    } else {\n      this._resetMobileDDOGOptions(\n        _domWhatAssetElement,\n        _arrFakeSelectDOMElements,\n        _objWhatAssetData\n      );\n    }\n  },\n\n  _resetDesktopDDOGOptions: function(_domWhatAssetElement, _arrSelectElements) {\n    var _intOption = 0;\n    while (_intOption < _arrSelectElements.length) {\n      this._toggleDDOGOption(_arrSelectElements[_intOption], false);\n      _arrSelectElements[_intOption].selectedIndex = 0;\n      this._resetOptionMarkerImage(_arrSelectElements[_intOption], _domWhatAssetElement);\n      _intOption++;\n    }\n  },\n\n  _resetMobileDDOGOptions: function(\n    _domWhatAssetElement,\n    _arrFakeSelectDOMElements,\n    _objWhatAssetData\n  ) {\n    var count = 0;\n    while (count < _arrFakeSelectDOMElements.length) {\n      var _domCurrFakeSelect = _arrFakeSelectDOMElements[count];\n      var _domCurrInner = CORE.getElementsByClassName(\n        _domCurrFakeSelect,\n        'ddogAssetDropDownMobileInnerC'\n      )[0];\n      _domCurrInner.innerHTML = 'Select';\n      delete _objWhatAssetData.objOptionStates[count];\n      this._resetOptionMarkerImage(_arrFakeSelectDOMElements[count], _domWhatAssetElement);\n      count++;\n    }\n  },\n\n  // REFACTOR NOTE: need to remove this reset_QuestionAsset\n  // thing and merge it with _reset_ASSET_TYPE_Asset\n  _reset_dropdownsongraphic_QuestionAsset: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    if (ASSET_RENDERER.doesAssetSupportOutputMode(_objWhatAssetData.objRawData['strType'])) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n\n      this._resetDDOGOptions(_domWhatAssetElement, _objWhatAssetData);\n\n      this._booCorrectOptionErrorShown = false;\n\n      this._resetStandardQuestion(_strWhatAssetID);\n    }\n  },\n\n  _reset_dropdownsongraphic_Asset: function(_objWhatAssetData, _booFullReset) {\n    if (ASSET_RENDERER.doesAssetSupportOutputMode(_objWhatAssetData.objRawData['strType'])) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n      // var _arrSelectDOMElements = _domWhatAssetElement.getElementsByTagName(\"select\");\n      // Imported function found in extension_ddog_asset\n      this._resetDDOGOptions(_domWhatAssetElement, _objWhatAssetData);\n      this._resetUserQuestionAttempts(_objWhatAssetData);\n      this._showQuestionConfirmButton(_objWhatAssetData);\n\n      this._booCorrectOptionErrorShown = false;\n    }\n  },\n\n  getAccessibleElements_dropdownsongraphic: function() {\n    var accessibleElements = ['.ddogDropDownWrapperC select', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, DDOG_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(79))},function(t,e){t.exports="/* global $, EM, ASSET_RENDERER, O_EXTENDER, TOPIC_INTERACTIONS */\n/* global ASSET_INTERACTIONS, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK, _ */\n\n/**\n * @title MCQ asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the mcq asset\n * type.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('dropdownList', objCurrSupportData);\n\nvar DROPDOWN_LIST_ASSET_RENDERER = {\n  strObjID: 'The dropdown list asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['dropdownList', 'dropdownListAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['dropdownListOption', 'dropdownListAssetOptionTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_dropdownList_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XX_IMPORTED_STYLE_XX',\n        _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix\n      );\n\n      var _htmOptionText = this._getDropdownListOptionHtml(\n        _objWhatAssetCourseObject,\n        _objWhatRawAssetData\n      );\n      _htmReturnData = _htmReturnData.replace('XX_DROPDOWN_LIST_OPTIONS_XX', _htmOptionText);\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"MCQ_ASSET_RENDERER._renderMCQAsset(),\n          ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3);\n      */\n      var _strDebugError = LOCALISER.get('MCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('MCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  _getDropdownListOptionHtml: function(_objWhatAssetCourseObject, _objWhatRawAssetData) {\n    if (this._objSubAssetTemplates[_objWhatRawAssetData['strType'] + 'Option']) {\n      var _htmReturnData = '';\n      var count = 0;\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n        var _htmOptionTemplate = this._objSubAssetTemplates[\n          _objWhatRawAssetData['strType'] + 'Option'\n        ];\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_OPTION_NUM_XX/g, count + 1);\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_DROPDOWN_ID_XX/g, count);\n        // select markup is required for some browsers or the option is stripped out\n        _htmOptionTemplate = _htmOptionTemplate.replace(new RegExp('<select>', 'i'), '');\n        _htmOptionTemplate = _htmOptionTemplate.replace(new RegExp('</select>', 'i'), '');\n        if (_objWhatAssetCourseObject.arrOptionStates[count]) {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strSelectedOptionClass\n          );\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            ' class=\"dropdownListOptionC XX_OPTION_STATE_XX\"',\n            ' class=\"dropdownListOptionC\" checked=\"true\"'\n          );\n        } else {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strUnselectedOptionClass\n          );\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            ' class=\"dropdownListOptionC XX_OPTION_STATE_XX\"',\n            ' class=\"dropdownListOptionC\"'\n          );\n        }\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XX_OPTION_TEXT_XX',\n          this._showCorrectOptionMarker(_objCurrOption) +\n            this.insertFormattedHtml(_objCurrOption.strOptionText)\n        );\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XX_OPTION_VALUE_XX',\n          this._showCorrectOptionMarker(_objCurrOption) +\n            this.insertFormattedHtml(_objCurrOption.strOptionText)\n        );\n\n        _htmReturnData += _htmOptionTemplate;\n        count++;\n      }\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"MCQ_ASSET_RENDERER._getMCQOptionHTML(), ERROR: Unknown\n          asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3\n      ); */\n      var _strDebugError = LOCALISER.get('MCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"Asset Error, no sub template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('MCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, DROPDOWN_LIST_ASSET_RENDERER);\n\nvar DROPDOWN_LIST_ASSET_INTERACTIONS = {\n  strObjID: 'The Dropdown List asset interactions extension object',\n  _strDROPDOWNLISTOptionClass: 'dropdownListOptionC',\n\n  _performPreShowActions_dropdownList_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    if (rawData.randomiseAnswers) {\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, this._strDROPDOWNLISTOptionClass);\n\n      var selectElement = $(assetElement).find('.dropdownListOptionsC')[0];\n      selectElement.selectedIndex = 0;\n    }\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_dropdownListConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objRawData);\n    //\n    var selectElement = $(_domWhatAssetElement).find('.dropdownListOptionsC')[0];\n\n    var selectedOption = selectElement.options[selectElement.selectedIndex];\n    var selectedOptionIndex = selectedOption.index;\n\n    // retrieve arrOption index\n    for (var j = 0; j < selectElement.options.length; j++) {\n      if (\n        selectedOption.id ==\n        'dropdownListAsset_YY' + _objRawData['strID'] + 'YY_Option' + (j + 1) + 'WrapperL'\n      ) {\n        selectedOptionIndex = j;\n        break;\n      }\n    }\n\n    var unlimitedAttempts = false;\n    if (_objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    var alwaysShowFinalAttemptResponse = false;\n    if (\n      typeof _objRawData.showFinalAttempt !== 'undefined' &&\n      _objRawData.showFinalAttempt == true\n    ) {\n      alwaysShowFinalAttemptResponse = true;\n    }\n\n    var responseValue = '';\n    var selectedOptionText = '';\n    if (typeof selectedOptionIndex == 'number') {\n      responseValue += _objRawData.arrOptions[selectedOptionIndex].strOptionText;\n      selectedOptionText = gomo.utility.convertNumberToCharacter(selectedOptionIndex);\n    }\n\n    _objWhatAssetData.responseValue = responseValue;\n    this.setVariablesToGlobal(_objWhatAssetData);\n\n    var _objOptionStates = {};\n    _objOptionStates[selectedOptionIndex] = true;\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var _objScoreInfo = this._scoreDropdownListOptions(\n        selectedOptionIndex,\n        _objWhatAssetData,\n        _objOptionStates\n      );\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      for (var i = 0; i < _objScoreInfo.objOptionData.length; i += 1) {\n        if (_objScoreInfo.objOptionData[i].booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(i));\n          break;\n        }\n      }\n\n      // Additional tracking data\n      var additionalTrackingData = _objRawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = correctResponses;\n      var associatedAsset = _objRawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting = parseInt(_objRawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText;\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(_objRawData.arrOptions, function(option, index) {\n        return {\n          'id': gomo.utility.convertNumberToCharacter(index),\n          'description': {\n            'en-GB': option.strOptionText\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        _objRawData.additionalTrackingData\n      );\n\n      this._toggleDropdownListOptions(selectElement, true);\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        var _objOptionData = _objScoreInfo['objCurrRawOption'];\n\n        if (isNaN(parseInt(_objRawData.strAttempts))) {\n          LOCALISER.l_alert('MCQ_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT) {\n          _objRawData.strAttempts = 1;\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == _objRawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showSingleOptionCorrectness(_domWhatAssetElement, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n\n          _objWhatAssetData.booInteractable = false;\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < _objRawData.strAttempts ||\n            unlimitedAttempts) &&\n          !alwaysShowFinalAttemptResponse\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = _objRawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n        var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (_objRawData.arrActions && _objRawData.arrActions.length\n           && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('MCQ_CONFIRM_ERROR');\n    }\n  },\n\n  is_dropdownList_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _doPostRenderShowActions_dropdownList_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n  },\n\n  _toggleDropdownListOptions: function(_selectElement, _booEnableDisable) {\n    _selectElement.disabled = _booEnableDisable;\n  },\n\n  _scoreDropdownListOptions: function(selectionValue, _objWhatAssetData, _objOptionStates) {\n    var _arrOptionCorrectness = [];\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _objCurrRawOption = _arrRawOptionData[selectionValue];\n    var _objSelectedStates = [];\n\n    _objSelectedStates[selectionValue] = true;\n    if (_objCurrRawOption.booIsCorrect) {\n      _arrOptionCorrectness[selectionValue] = true;\n      return {\n        booIsCorrect: true,\n        objCurrRawOption: _objCurrRawOption,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objSelectedStates\n      };\n    }\n    return {\n      booIsCorrect: false,\n      objCurrRawOption: _objCurrRawOption,\n      objOptionData: _arrRawOptionData,\n      arrOptionCorrectness: _arrOptionCorrectness,\n      objSelectedStates: _objSelectedStates\n    };\n  },\n\n  _returnFocusToDROPDOWNLISTAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  _reset_dropdownList_QuestionAsset: function(_objWhatAssetData) {\n    this.resetQuestionOptions(_objWhatAssetData);\n  },\n\n  _reset_dropdownList_Asset: function(_objWhatAssetData) {\n    this.resetQuestionOptions(_objWhatAssetData);\n    this._resetUserQuestionAttempts(_objWhatAssetData);\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var selectElement = $(_domWhatAssetElement).find('.dropdownListOptionsC')[0];\n    this._resetOptionMarkerImage(selectElement, _domWhatAssetElement);\n  },\n\n  resetQuestionOptions: function(_objWhatAssetData) {\n    // resetting a question with the reset button only passes in an id so get the data\n    if (!_objWhatAssetData.objRawData) {\n      _objWhatAssetData = this.getAssetData(_objWhatAssetData);\n    }\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var selectElement = $(_domWhatAssetElement).find('.dropdownListOptionsC')[0];\n\n    selectElement.selectedIndex = 0;\n    this._showQuestionConfirmButton(_objWhatAssetData);\n    _objWhatAssetData.booInteractable = true;\n    this._toggleDropdownListOptions(selectElement, false);\n  },\n\n  _performLanguagePreprocess_dropdownList_Asset: function(_objWhatAssetData) {\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetData.objRawData.strID);\n    if (found) {\n      this.updateListAlignment(found);\n    }\n  },\n\n  updateListAlignment: function(data) {\n    var listElement = $('#dropdownListAsset_YY' + data.id + 'YY_WrapperL');\n    if (listElement.length && typeof data.strAlignment !== 'undefined') {\n      listElement[0].className =\n        listElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      listElement.addClass(data.strAlignment);\n    }\n  },\n\n  getAccessibleElements_dropdownList: function() {\n    var accessibleElements = ['.dropdownListOptionsWrapperC select', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, DROPDOWN_LIST_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(81))},function(t,e){t.exports="/* global $, _, CORE, EM, ASSET_RENDERER, O_EXTENDER */\n/* global TOPIC_INTERACTIONS, ASSET_INTERACTIONS, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK */\n\n/**\n * @title Graphical MCQ asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the Graphical MCQ asset\n * type.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('graphicalmcq', objCurrSupportData);\n\nvar GRAPHICALMCQ_ASSET_RENDERER = {\n  strObjID: 'The graphicalmcq asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['graphicalmcq', 'graphicalMcqAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['graphicalmcqoption', 'graphicalMcqAssetOptionTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_graphicalmcq_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XXIMPORTEDSTYLEXX',\n        _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix\n      );\n\n      var _htmOptionText = this._getGraphicalMCQOptionHTML(\n        _objWhatAssetCourseObject,\n        _objWhatRawAssetData\n      );\n      _htmReturnData = _htmReturnData.replace('XXGRAPHICALMCQOPTIONSXX', _htmOptionText);\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n      // alert(\"_htmReturnData: \" + _htmReturnData);\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"GRAPHICALMCQ_ASSET_RENDERER._renderGraphicalMCQAsset(),\n          ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3\n      ); */\n      var _strDebugError = LOCALISER.get('GRAPHICALMCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('GRAPHICALMCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  // ***************************** Update methods extensions *****************************\n  /* _updateGraphicalMCQAsset: function(_objWhatAssetData, _strWhatResourcePath) {\n    var _objDOMElement = this.getAssetDOMElement(_objWhatAssetData);\n    var _objOptionsWrapper = CORE.getElementsByClassName(\n      _objDOMElement,\n      'graphicalMcqOptionsWrapperC'\n    );\n    _objOptionsWrapper.innerHTML = this._getGraphicalMCQOptionHTML(_objWhatAssetData);\n    // _objDOMElement.src = _strWhatResourcePath + _objWhatAssetData.objImageBaseSrc.strSrc;\n    // _objDOMElement.className = _objDOMElement.className.replace(\"assetHighC\", \"assetNormC\");\n  }, */\n\n  // ***************************** Helper methods extensions *****************************\n  // Option:\n  /* <img\n    id=\"graphicalMcqAssetXX_ASSET_ID_XXOptionXXOPTIONNUMXXWrapperL\"\n    class=\"graphicalMcqOptionC XXOPTIONCORRECTNESSXX\"\n    src=\"../resources/trans.gif?\"\n  /> */\n\n  _getGraphicalMCQOptionHTML: function(\n    _objWhatAssetCourseObject,\n    _objWhatRawAssetData\n  ) {\n    if (this._objSubAssetTemplates[_objWhatRawAssetData['strType'] + 'option']) {\n      var _htmReturnData = '';\n      var count = 0;\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n        var _htmOptionTemplate = this._objSubAssetTemplates[\n          _objWhatRawAssetData['strType'] + 'option'\n        ];\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONNUMXX/g, count + 1);\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_OPTION_XX/g, count);\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n\n        if (_objWhatAssetCourseObject.arrOptionStates[count]) {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strSelectedOptionClass\n          );\n        } else {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strUnselectedOptionClass\n          );\n        }\n\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'resources/trans.gif?',\n          gomo.utility.getSrcPath(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XX_IMAGE_SRC_XX',\n          decodeURIComponent(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n\n        // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_OPTION_ALT_TEXT_XX/g,\n          this.sanitiseAltText(_objCurrOption.objImageBaseSrc.strAltText)\n        );\n\n        /* var _objImageMetaData = MASTER_RENDERER.getImageProperties(\n          decodeURIComponent(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_IMAGE_WIDTH_XX/g,\n          _objImageMetaData[\"strWidth\"]\n        );\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_IMAGE_HEIGHT_XX/g,\n          _objImageMetaData[\"strHeight\"]\n        ); */\n\n        _htmReturnData += _htmOptionTemplate;\n        count++;\n      }\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"GRAPHICALMCQ_ASSET_RENDERER._getGraphicalMCQOptionHTML(),\n          ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3); */\n      var _strDebugError = LOCALISER.get('GRAPHICALMCQ_DEBUG_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"Asset Error, no sub template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('GRAPHICALMCQ_RETURN_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, GRAPHICALMCQ_ASSET_RENDERER);\n\nvar GRAPHICALMCQ_ASSET_INTERACTIONS = {\n  strObjID: 'The graphical mcq asset interactions extension object',\n\n  _strGRAPHICALMCQOptionClass: 'mcqOptionC',\n\n  _performPreShowActions_graphicalmcq_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    if (rawData.randomiseAnswers) {\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, this._strGRAPHICALMCQOptionClass);\n    }\n\n    // Check for a subscreen action in options\n    var subscreenActionInOptions = _.find(rawData.arrOptions, function(option) {\n      var result = gomo.utility.checkForShowSubscreenAction(option.arrOptionFeedbackActions);\n      return result;\n    });\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (subscreenActionInOptions\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_graphicalmcqOptionClicked: function(_objWhatOptionData) {\n    // alert(\"handleEvent_mcqOptionClicked\")\n    var _objWhatAssetData = this.getAssetData(_objWhatOptionData['strAssetID']);\n    // alert(_objWhatAssetData.booInteractable)\n    if (_objWhatAssetData.booInteractable) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n      var _arrOptionDOMElements = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strGRAPHICALMCQOptionClass\n      );\n\n      this._resetOptions(\n        _arrOptionDOMElements,\n        _domWhatAssetElement,\n        _objWhatAssetData.arrOptionStates\n      );\n\n      var _domCurrOption = $(_arrOptionDOMElements).filter(function() {\n        return (\n          $(this).attr('id') ==\n          'graphicalMcqAsset_' +\n            _objWhatOptionData['strAssetID'] +\n            '_Option' +\n            _objWhatOptionData['strOptionIndex'] +\n            'WrapperL'\n        );\n      });\n\n      $(_domCurrOption)\n        .removeClass(this._strUnselectedOptionClass)\n        .addClass(this._strSelectedOptionClass);\n      _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = true;\n    }\n  },\n\n  handleEvent_graphicalmcqConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objRawData);\n    var _arrOptionDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strGRAPHICALMCQOptionClass\n    );\n    var _objOptionStates = this._getSelectedOptions(_objWhatAssetData, _arrOptionDOMElements);\n    var unlimitedAttempts = false;\n    if (_objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    var alwaysShowFinalAttemptResponse = false;\n    if (\n      typeof _objRawData.showFinalAttempt !== 'undefined' &&\n      _objRawData.showFinalAttempt == true\n    ) {\n      alwaysShowFinalAttemptResponse = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = [];\n      var selectedOptionText = [];\n      _.each(_objOptionStates, function(value, key) {\n        responseValue.push(_objRawData.arrOptions[key].objImageBaseSrc.strSrc);\n        selectedOptionText.push(gomo.utility.convertNumberToCharacter(key));\n      });\n      _objWhatAssetData.responseValue = responseValue.join(' ');\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      var _objScoreInfo = this._scoreGraphicalMCQAsset(_objWhatAssetData, _objOptionStates);\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      _.each(_objScoreInfo.objOptionData, function(response, index) {\n        if (response.booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(index));\n        }\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = _objRawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n      var associatedAsset = _objRawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting = parseInt(_objRawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(_objRawData.arrOptions, function(option, index) {\n        return {\n          'id': gomo.utility.convertNumberToCharacter(index),\n          'description': {\n            'en-GB': option.objImageBaseSrc.strSrc\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        _objRawData.additionalTrackingData\n      );\n\n      this._toggleGraphicalMCQOptions(_arrOptionDOMElements, false);\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        var _objOptionData = _objScoreInfo['objCurrRawOption'];\n\n        if (isNaN(parseInt(_objRawData.strAttempts))) {\n          LOCALISER.l_alert('MCQ_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT && this._strCurrTopicModel == 'assessment') {\n          _objRawData.strAttempts = 1;\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == _objRawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrOptionDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n\n          _objWhatAssetData.booInteractable = false;\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < _objRawData.strAttempts ||\n            unlimitedAttempts) &&\n          !alwaysShowFinalAttemptResponse\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = _objRawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n        var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (_objRawData.arrActions && _objRawData.arrActions.length\n          && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('GRAPHICALMCQ_CONFIRM_ERROR');\n    }\n  },\n\n  _performLanguagePreprocess_graphicalmcq_Asset: function(_objWhatAssetData) {\n    var pathToArray = 'arrOptions';\n    var pathToImage = 'objImageBaseSrc';\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetData.objRawData.strID);\n    gomo.translationManager.setArrayOfImages(_objWhatAssetData.strObjID, pathToArray, pathToImage);\n    if (found) {\n      this.updateGmcqAlignment(found);\n    }\n  },\n\n  updateGmcqAlignment: function(data) {\n    var gmcqElement = $('#graphicalmcqAsset_YY' + data.id + 'YY_WrapperL');\n    if (gmcqElement.length && typeof data.strAlignment !== 'undefined') {\n      gmcqElement[0].className =\n        gmcqElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      gmcqElement.addClass(data.strAlignment);\n    }\n  },\n\n  is_graphicalmcq_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _disableGraphicalMCQOptions: function(_arrOptionElements) {\n    /* for(var _objOption in _arrOptionElements) {\n          if(_arrOptionElements[_objOption].nodeName.toLowerCase() == \"input\")\n            _arrOptionElements[_objOption].disabled = true;\n    }*/\n\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = true;\n      }\n\n      _objOption++;\n    }\n  },\n\n  _enableGraphicalMCQOptions: function(_arrOptionElements) {\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = false;\n      }\n\n      _objOption++;\n    }\n  },\n\n  _toggleGraphicalMCQOptions: function(_arrOptionElements, _booEnableDisable) {\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = _booEnableDisable;\n      }\n      _objOption++;\n    }\n  },\n\n  _doPostRenderShowActions_graphicalmcq_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n  },\n\n  _scoreGraphicalMCQAsset: function(_objWhatAssetData, _objOptionStates) {\n    var _arrOptionCorrectness = [];\n    var _intSelectedIndex;\n\n    _.each(_objOptionStates, function(value, key) {\n      _intSelectedIndex = key;\n      return false;\n    });\n\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _objCurrRawOption = _arrRawOptionData[_intSelectedIndex];\n    var _objSelectedStates = [];\n    _objSelectedStates[_intSelectedIndex] = true;\n    if (_objCurrRawOption.booIsCorrect) {\n      _arrOptionCorrectness[_intSelectedIndex] = true;\n      return {\n        booIsCorrect: true,\n        objCurrRawOption: _objCurrRawOption,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objSelectedStates\n      };\n    }\n    return {\n      booIsCorrect: false,\n      objCurrRawOption: _objCurrRawOption,\n      objOptionData: _arrRawOptionData,\n      arrOptionCorrectness: _arrOptionCorrectness,\n      objSelectedStates: _objSelectedStates\n    };\n  },\n\n  _returnFocusToGRAPHICALMCQAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  getAccessibleElements_graphicalmcq: function() {\n    var accessibleElements = ['.mcqOptionC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, GRAPHICALMCQ_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(83))},function(t,e){t.exports="/* global $, _, CORE, EM, ASSET_RENDERER, O_EXTENDER */\n/* global TOPIC_INTERACTIONS, TOPIC_STRUCTURE_PARSER */\n/* global MASTER_RENDERER, ASSET_INTERACTIONS, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK */\n\n/**\n * @title Graphical MCQ asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the Graphical MCQ asset\n * type.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('graphicalsfl', objCurrSupportData);\n\nvar GRAPHICALSFL_ASSET_RENDERER = {\n  strObjID: 'The graphical SFL asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['graphicalsfl', 'graphicalSflAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['graphicalsfloption', 'graphicalSflAssetOptionTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_graphicalsfl_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XXIMPORTEDSTYLEXX',\n        _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix\n      );\n\n      var _htmOptionText = this._getGraphicalSFLOptionHTML(\n        _objWhatAssetCourseObject,\n        _objWhatRawAssetData\n      );\n      _htmReturnData = _htmReturnData.replace('XXGRAPHICALSFLOPTIONSXX', _htmOptionText);\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n      // alert(\"_htmReturnData: \" + _htmReturnData);\n      return _htmReturnData;\n    } else {\n      // this.debug(\"GRAPHICALMCQ_ASSET_RENDERER._renderGraphicalMCQAsset(), \" +\n      //  \"ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\", 3);\n      var _strDebugError = LOCALISER.get('GRAPHICALSFL_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('GRAPHICALSFL_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  _getGraphicalSFLOptionHTML: function(\n    _objWhatAssetCourseObject,\n    _objWhatRawAssetData\n  ) {\n    if (this._objSubAssetTemplates[_objWhatRawAssetData['strType'] + 'option']) {\n      var _htmReturnData = '';\n      var count = 0;\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n        var _htmOptionTemplate = this._objSubAssetTemplates[\n          _objWhatRawAssetData['strType'] + 'option'\n        ];\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONNUMXX/g, count + 1);\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_OPTION_XX/g, count);\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n\n        if (_objWhatAssetCourseObject.arrOptionStates[count]) {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strSelectedOptionClass\n          );\n        } else {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strUnselectedOptionClass\n          );\n        }\n\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'resources/trans.gif?',\n          gomo.utility.getSrcPath(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XX_IMAGE_SRC_XX',\n          decodeURIComponent(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n\n        // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_OPTION_ALT_TEXT_XX/g,\n          this.sanitiseAltText(_objCurrOption.objImageBaseSrc.strAltText)\n        );\n\n        var _objImageMetaData = MASTER_RENDERER.getImageProperties(\n          decodeURIComponent(_objCurrOption.objImageBaseSrc.strSrc)\n        );\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_IMAGE_WIDTH_XX/g,\n          _objImageMetaData['strWidth']\n        );\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          /XX_IMAGE_HEIGHT_XX/g,\n          _objImageMetaData['strHeight']\n        );\n\n        _htmReturnData += _htmOptionTemplate;\n        count++;\n      }\n      return _htmReturnData;\n    } else {\n      // this.debug(\"GRAPHICALMCQ_ASSET_RENDERER._getGraphicalMCQOptionHTML(), \" +\n      //  \"ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\", 3);\n      var _strDebugError = LOCALISER.get('GRAPHICALSFL_DEBUG_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"Asset Error, no sub template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('GRAPHICALSFL_RETURN_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, GRAPHICALSFL_ASSET_RENDERER);\n\nvar GRAPHICALSFL_ASSET_INTERACTIONS = {\n  strObjID: 'The graphical SFL asset interactions extension object',\n\n  _strGRAPHICALSFLOptionClass: 'sflOptionC',\n  _strGRAPHICALSFLConfirmAnchorClass: 'contentButtonNormC',\n  _strGRAPHICALSFLConfirmDisableClass: 'confirmButtonDisabledC',\n\n  _performPreShowActions_graphicalsfl_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    if (assetData.objRawData.randomiseAnswers) {\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, this._strGRAPHICALSFLOptionClass);\n    }\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  // {'strAssetID':'XX_ASSET_ID_XX', 'strOptionIndex':'XXOPTIONNUMXX'}\n  handleEvent_graphicalsflOptionClicked: function(_objWhatOptionData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatOptionData['strAssetID']);\n    if (_objWhatAssetData.booInteractable) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n      var _arrOptionDOMElements = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strGRAPHICALSFLOptionClass\n      );\n\n      var _domCurrOption = $(_arrOptionDOMElements).filter(function() {\n        return (\n          $(this).attr('id') ==\n          'graphicalSflAsset_' +\n            _objWhatOptionData['strAssetID'] +\n            '_Option' +\n            _objWhatOptionData['strOptionIndex'] +\n            'WrapperL'\n        );\n      });\n\n      if ($(_domCurrOption).hasClass(this._strUnselectedOptionClass)) {\n        // mark as checked\n        $(_domCurrOption)\n          .removeClass(this._strUnselectedOptionClass)\n          .addClass(this._strSelectedOptionClass);\n\n        _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = true;\n      } else {\n        // mark as unchecked\n        $(_domCurrOption)\n          .removeClass(this._strSelectedOptionClass)\n          .addClass(this._strUnselectedOptionClass);\n\n        _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = false;\n      }\n    }\n  },\n\n  handleEvent_graphicalsflConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var rawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    var _arrOptionDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strGRAPHICALSFLOptionClass\n    );\n    var _objOptionStates = this._getSelectedOptions(_objWhatAssetData, _arrOptionDOMElements);\n    var unlimitedAttempts = false;\n    if (rawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = [];\n      var selectedOptionText = [];\n      _.each(_objOptionStates, function(value, key) {\n        responseValue.push(rawData.arrOptions[key].objImageBaseSrc.strSrc);\n        selectedOptionText.push(gomo.utility.convertNumberToCharacter(key));\n      });\n      _objWhatAssetData.responseValue = responseValue.join(' ');\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      var _objScoreInfo = this._scoreGraphicalSFLAsset(_objWhatAssetData, _objOptionStates);\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      _.map(_objScoreInfo.objOptionData, function(response, index) {\n        if (response.booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(index));\n        }\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = rawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n      var associatedAsset = rawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(rawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting = parseInt(rawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(rawData.arrOptions, function(option, index) {\n        return {\n          'id': gomo.utility.convertNumberToCharacter(index),\n          'description': {\n            'en-GB': option.objImageBaseSrc.strSrc\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        rawData.additionalTrackingData\n      );\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        if (isNaN(parseInt(rawData.strAttempts))) {\n          // alert(\"The number of attempts for this asset (id: \" + _objWhatAssetData.strObjID +\n          // \") is not currently a number. It is currently: \" + rawData.strAttempts +\n          // \". Please set the number of attempts to be an integer.\");\n          LOCALISER.l_alert('SFL_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT && this._strCurrTopicModel == 'assessment') {\n          rawData.strAttempts = 1;\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = rawData.arrCorrectActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < rawData.strAttempts || unlimitedAttempts)\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = rawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = rawData.arrFinalIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == rawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrOptionDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (rawData.arrActions && rawData.arrActions.length && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('GRAPHICALSFL_CONFIRM_ERROR');\n    }\n  },\n\n  _performLanguagePreprocess_graphicalsfl_Asset: function(_objWhatAssetData) {\n    var pathToArray = 'arrOptions';\n    var pathToImage = 'objImageBaseSrc';\n    var found =\n      gomo.translationManager.findDataByAssetId(_objWhatAssetData.objRawData.strID);\n    gomo.translationManager.setArrayOfImages(\n      _objWhatAssetData.strObjID,\n      pathToArray,\n      pathToImage\n    );\n    if (found) {\n      this.updateGsflAlignment(found);\n    }\n  },\n\n  updateGsflAlignment: function(data) {\n    var gsflElement = $('#graphicalsflAsset_YY' + data.id + 'YY_WrapperL');\n    if (gsflElement.length && typeof data.strAlignment !== 'undefined') {\n      gsflElement[0].className =\n        gsflElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      gsflElement.addClass(data.strAlignment);\n    }\n  },\n\n  is_graphicalsfl_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _doPostRenderShowActions_graphicalsfl_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n  },\n\n  _scoreGraphicalSFLAsset: function(_objWhatAssetData, _objOptionStates) {\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _arrOptionCorrectness = [];\n\n    var count = 0;\n    var _intCorrect = 0;\n    var _intWrong = 0;\n    while (count < _arrRawOptionData.length) {\n      var _objCurrRawOption = _arrRawOptionData[count];\n      if (\n        (_objCurrRawOption.booIsCorrect && _objOptionStates[count]) ||\n        (!_objCurrRawOption.booIsCorrect && !_objOptionStates[count])\n      ) {\n        _intCorrect++;\n        _arrOptionCorrectness[count] = true;\n      } else {\n        _intWrong++;\n        _arrOptionCorrectness[count] = false;\n      }\n      count++;\n    }\n\n    if (_intCorrect == 0) {\n      return {\n        booIsCorrect: false,\n        strCorrectness: 'incorrect',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    } else if (_intCorrect > 0 && _intWrong > 0) {\n      return {\n        booIsCorrect: false,\n        strCorrectness: 'partiallyCorrect',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    } else if (_intCorrect == _arrRawOptionData.length && _intWrong == 0) {\n      return {\n        booIsCorrect: true,\n        strCorrectness: 'correct',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    }\n    // alert(\"ERROR: Uncaught score state of _intCorrect: '\" +\n    //  _intCorrect + \"', _intWrong: '\" + _intWrong +\n    //  \"' in SFL_ASSET_INTERACTIONS._scoreGraphicalSFLAsset(), extension_sfl_asset.js\");\n    LOCALISER.l_alert('SFL_UNCAUGHT_SCORE_PATTERN', [_intCorrect, _intWrong]);\n    return {\n      booIsCorrect: false\n    };\n  },\n\n  // REFACTOR NOTE: Function seems un-used?\n  _disableGraphicalSFLOptions: function(_arrOptionElements) {\n    var count = 0;\n    while (count < _arrOptionElements.length) {\n      if (_arrOptionElements[count].tagName.toUpperCase() == 'INPUT') {\n        _arrOptionElements[count].disabled = true;\n      }\n      count++;\n    }\n  },\n\n  // REFACTOR NOTE: Function seems un-used?\n  _disableGraphicalSFLConfirm: function(_arrConfirmAnchor) {\n    var count = 0;\n    while (count < _arrConfirmAnchor.length) {\n      _arrConfirmAnchor[count].className += ' ' + this._strGRAPHICALSFLConfirmDisableClass;\n      count++;\n    }\n  },\n\n  _returnFocusToGRAPHICALSFLAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  _viewQuestionAnswer_graphicalsfl_questionType: function(_objWhatAssetData) {\n    this._viewQuestionAnswer_sfl_questionType(_objWhatAssetData);\n  },\n\n  getAccessibleElements_graphicalsfl: function() {\n    var accessibleElements = ['.sflOptionC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, GRAPHICALSFL_ASSET_INTERACTIONS);\n\nvar GRAPHICALSFL_ASSET_PREPROCESSOR = {\n  strObjID: 'The graphical SFL pre-processor object',\n\n  _preProcess_graphicalsfl_Asset: function(_objWhatRawAssetData, _objWhatParentScreenObject) {\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, GRAPHICALSFL_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(85))},function(t,e){t.exports="/* global $, _, CORE, EM, ASSET_RENDERER, O_EXTENDER */\n/* global TOPIC_INTERACTIONS, ASSET_INTERACTIONS, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK, BOO_SHOW_HIDDEN_ELEMENTS */\n/* global BOO_USE_SPRITE_SHEET_HOTSPOTS */\n/* global MASTER_RENDERER, TOPIC_STRUCTURE_PARSER */\n\n/**\n * @title Hotspot MCQ\n * @description The hotspot MCQ question asset\n *\n * @author Paul Stanyer\n * @version 2.0 09/07/12\n *\n * REFACTOR NOTE: This needs to be made more generic. This is a fairly specific Asset that is not\n * likely to be used much.\n */\n\nASSET_RENDERER.addAssetSupportData('hotspotmcq', {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n});\n\nvar HOTSPOTMCQ_ASSET_RENDERER = {\n  strObjID: 'The hotspotmcq asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['hotspotmcq', 'hotspotMcqAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [\n    ['hotspotmcq', 'hotspotMcqAssetHotspotTemplateWrapperC'],\n    ['hotspotmcqImage', 'hotspotMcqAssetHotspotImageTemplateWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n  _render_hotspotmcq_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[\n        _objWhatRawAssetData['strType']\n      ];\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n\n      _htmReturnData = _htmReturnData.replace(\n        'resources/trans.gif?',\n        gomo.utility.getSrcPath(_objWhatRawAssetData.objImageBaseSrc.strSrc) +\n          decodeURIComponent(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n      );\n\n      // Note: on asset conversion sanitiseAltText has changed to convertStringQuote.\n      _htmReturnData = _htmReturnData.replace(\n        /XXTEXTXX/g,\n        this.sanitiseAltText(_objWhatRawAssetData.objImageBaseSrc.strAltText)\n      );\n\n      _htmReturnData = _htmReturnData.replace(\n        'XXHOTSPOTMCQ_HOTSPOTSXX',\n        this._renderHotspotSubAssets(\n          _objWhatRawAssetData,\n          _objWhatAssetCourseObject\n        )\n      );\n\n      /* var _objImageMetaData = MASTER_RENDERER.getImageProperties(\n        _objWhatRawAssetData.objImageBaseSrc.strSrc);\n      if (_objImageMetaData) {\n        var _floAdjustedScaleFactor = this._getScaleFactor(\n          _objWhatRawAssetData,\n          _objWhatAssetCourseObject\n        );\n        _htmReturnData = _htmReturnData.replace(\n          'XX_IMAGE_SCALE_X_XX',\n          this._calculateImageSizes( _floAdjustedScaleFactor, _objImageMetaData['strWidth']) + 'px'\n        );\n        _htmReturnData = _htmReturnData.replace(\n          'XX_IMAGE_SCALE_Y_XX',\n          this._calculateImageSizes(_floAdjustedScaleFactor, _objImageMetaData['strHeight']) + 'px'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace('XX_IMAGE_SCALE_X_XX', '');\n        _htmReturnData = _htmReturnData.replace('XX_IMAGE_SCALE_Y_XX', '');\n      } */\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"HOTSPOTMCQ_ASSET_RENDERER._renderHotspotMCQAsset(), ERROR: Unknown\n          asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3\n      ); */\n      var _strDebugError = LOCALISER.get('HOTSPOTMCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('HOTSPOTMCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  _renderHotspotSubAssets: function(\n    _objWhatRawAssetData,\n    _objWhatAssetCourseObject\n  ) {\n    if (_objWhatRawAssetData.arrOptions.length > 0) {\n      var count = 0;\n      var _htmHotspots = '';\n      var _objBaseImageMetaData = MASTER_RENDERER.getImageProperties(\n        decodeURIComponent(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n      );\n\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrHotspotData = _objWhatRawAssetData.arrOptions[count];\n        var _htmCurrHotspot = this._objSubAssetTemplates['hotspotmcq'];\n        var _htmCurrHotspotImage = this._objSubAssetTemplates[\n          'hotspotmcqImage'\n        ];\n        var _objCurrHotspotCoords = this._generatePercentileHotspotWrapperCSS(\n          _objCurrHotspotData.objMCQHotspotCoords,\n          _objBaseImageMetaData.strWidth,\n          _objBaseImageMetaData.strHeight\n        );\n        _htmCurrHotspot = _htmCurrHotspot.replace(\n          'XX_SUB_ASSET_ID_XX',\n          _objCurrHotspotData.strID\n        );\n\n        if (_objCurrHotspotCoords) {\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_ASSET_ID_XX/g,\n            _objWhatRawAssetData['strID']\n          );\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_TAB_INDEX_XX/g,\n            (count + 1) * 5\n          );\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_ARRAY_INDEX_XX/g,\n            count\n          );\n\n          if (BOO_SHOW_HIDDEN_ELEMENTS && !BOO_USE_SPRITE_SHEET_HOTSPOTS) {\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              'class=\"hotspotMCQSubAssetC\"',\n              'class=\"hotspotMCQSubAssetC shownHotspotItemC\" ' +\n                _objCurrHotspotCoords.strCSSText\n            );\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              'class=hotspotMCQSubAssetC',\n              'class=\"hotspotMCQSubAssetC shownHotspotItemC\" ' +\n                _objCurrHotspotCoords.strCSSText\n            );\n          } else {\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              'class=\"hotspotMCQSubAssetC\"',\n              'class=\"hotspotMCQSubAssetC\" ' + _objCurrHotspotCoords.strCSSText\n            );\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              'class=hotspotMCQSubAssetC',\n              'class=\"hotspotMCQSubAssetC\" ' + _objCurrHotspotCoords.strCSSText\n            );\n          }\n\n          if (BOO_USE_SPRITE_SHEET_HOTSPOTS) {\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              /XX_HOTSPOT_CONTENT_XX/g,\n              _htmCurrHotspotImage\n            );\n            var _strStyleTag =\n              ' style=\"' +\n              this._generatePercentileHotspotImageCSS(\n                _objCurrHotspotCoords.objCoordsData.objInPixels,\n                _objBaseImageMetaData.strWidth,\n                _objBaseImageMetaData.strHeight,\n                _objCurrHotspotCoords.objCoordsData,\n                true\n              ) +\n              '\"';\n\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              'class=\"hotspotMCQSpriteImageC\"',\n              'class=\"hotspotMCQSpriteImageC\" ' + _strStyleTag\n            );\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              /XX_HOTSPOT_SRC_XX/g,\n              decodeURIComponent(_objWhatRawAssetData.objImageBaseSrc.strSrc)\n            );\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              /XX_HOTSPOT_ID_XX/g,\n              count\n            );\n          } else {\n            _htmCurrHotspot = _htmCurrHotspot.replace(\n              /XX_HOTSPOT_CONTENT_XX/g,\n              _objCurrHotspotData['strOptionAltText']\n            );\n          }\n\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_HOTSPOT_ALT_TEXT_XX/g,\n            _objCurrHotspotData['strOptionAltText']\n          );\n          /* _htmCurrHotspot = _htmCurrHotspot.replace(\n            /\"XX_HOTSPOT_ALT_TEXT_XX\"/g,\n            \"'\" + _objCurrHotspotData['strOptionAltText'] + \"'\"\n          ); */\n\n          _htmCurrHotspot = _htmCurrHotspot.replace(\n            /XX_HOTSPOT_INDEX_XX/g,\n            count\n          );\n\n          _htmHotspots += _htmCurrHotspot;\n        }\n\n        count++;\n      }\n      return _htmHotspots;\n    } else {\n      return '';\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, HOTSPOTMCQ_ASSET_RENDERER);\n\nvar HOTSPOTMCQ_ASSET_INTERACTIONS = {\n  _booConfirmOnOptionSelect: false,\n\n  strObjID: 'The hotspot mcq asset interactions extension object',\n\n  _strHOTSPOTMCQOptionClass: 'hotspotMcqOptionC',\n  _strMCQHotspotSpriteClass: 'hotspotMCQSpriteImageC',\n  _strMCQHotspotHighlightedState: 'highlighted',\n\n  _performPreShowActions_hotspotmcq_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    // Check for a subscreen action in options\n    var subscreenActionInOptions = _.find(rawData.arrOptions, function(option) {\n      var result = gomo.utility.checkForShowSubscreenAction(option.arrOptionFeedbackActions);\n      return result;\n    });\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (subscreenActionInOptions\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  _performLanguagePreprocess_hotspotmcq_Asset: function(\n    _objWhatAssetCourseObject\n  ) {\n    var rawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    // Convert image data for knockout updates\n    gomo.translationManager.setImage(rawAssetData.strID, 'objImageBaseSrc', {\n      newPath: 'renderPrimary'\n    });\n    var count = 0;\n    while (count < rawAssetData.arrOptions.length) {\n      var newPathString = 'renderSecondary' + count;\n      gomo.translationManager.setImage(rawAssetData.strID, 'objImageBaseSrc', {\n        newPath: newPathString\n      });\n      count++;\n    }\n\n    // Update coords data in hotspot CSS\n    var imageMetaData = MASTER_RENDERER.getImageProperties(\n      decodeURIComponent(rawAssetData.objImageBaseSrc.strSrc)\n    );\n\n    var imageWidth = imageMetaData.strWidth;\n    var imageHeight = imageMetaData.strHeight;\n\n    count = 0;\n    while (count < rawAssetData['arrOptions'].length) {\n      var _objCurrHotspotData = rawAssetData['arrOptions'][count];\n      var _objCurrHotspotCoordsData =\n        _objCurrHotspotData['objMCQHotspotCoords'];\n\n      var _objCSSData = ASSET_RENDERER._generatePercentileHotspotWrapperCSS(\n        _objCurrHotspotCoordsData,\n        imageWidth,\n        imageHeight\n      );\n      var _objCoordsData = _objCSSData['objCoordsData'];\n\n      var hotspotElementId =\n        '#hotspotMcqHotspot_' +\n        rawAssetData.strID +\n        '_' +\n        _objCurrHotspotData.strID +\n        '_L';\n      var hotspotElement = $(hotspotElementId);\n      hotspotElement.css(\n        'height',\n        _objCoordsData.objInPercentage.intHeight + '%'\n      );\n      hotspotElement.css(\n        'width',\n        _objCoordsData.objInPercentage.intWidth + '%'\n      );\n      hotspotElement.css('left', _objCoordsData.objInPercentage.intLeft + '%');\n      hotspotElement.css('top', _objCoordsData.objInPercentage.intTop + '%');\n\n      var hotspotElementImage = $(\n        hotspotElementId + ' .hotspotMCQSpriteImageC'\n      );\n      var imageCSSInfoString = ASSET_RENDERER._generatePercentileHotspotImageCSS(\n        _objCurrHotspotCoordsData,\n        imageWidth,\n        imageHeight,\n        _objCoordsData,\n        true\n      );\n      var imageCSSInfo = imageCSSInfoString.split(';');\n\n      var countCss = 0;\n      while (countCss < imageCSSInfo.length) {\n        var cssItem = imageCSSInfo[countCss].split(':');\n        hotspotElementImage.css(cssItem[0].replace(' ', ''), cssItem[1]);\n        countCss++;\n      }\n\n      // Decode asset alt text\n      gomo.translationManager.htmlDecodeAssetTranslations(\n        _objWhatAssetCourseObject.strObjID,\n        ['arrOptions[' + count + '].strOptionAltText']\n      );\n\n      count++;\n    }\n  },\n\n  handleEvent_hotspotmcqConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objRawData);\n    var _arrOptionDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strMCQOptionClass\n    );\n    var _objOptionStates = this._getSelectedOptions(\n      _objWhatAssetData,\n      _arrOptionDOMElements\n    );\n    var unlimitedAttempts = false;\n    if (_objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    var alwaysShowFinalAttemptResponse = false;\n    if (\n      typeof _objRawData.showFinalAttempt !== 'undefined' &&\n      _objRawData.showFinalAttempt == true\n    ) {\n      alwaysShowFinalAttemptResponse = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = '';\n      var selectedOptionText = [];\n      _.each(_objOptionStates, function(value, key) {\n        responseValue +=\n          'X ' + _objRawData.arrOptions[key].objMCQHotspotCoords.intLeft + ' ';\n        responseValue +=\n          'Y ' + _objRawData.arrOptions[key].objMCQHotspotCoords.intTop + ' ';\n        selectedOptionText.push(gomo.utility.convertNumberToCharacter(key));\n      });\n\n      _objWhatAssetData.responseValue = responseValue;\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      var _objScoreInfo = this._scoreHotspotMCQAsset(\n        _objWhatAssetData,\n        _objOptionStates\n      );\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      _.each(_objScoreInfo.objOptionData, function(response, index) {\n        if (response.booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(index));\n        }\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = _objRawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = [\n        correctResponses.join(',')\n      ];\n      var associatedAsset = _objRawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting =\n        parseInt(_objRawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(_objRawData.arrOptions, function(\n        option,\n        index\n      ) {\n        return {\n          id: gomo.utility.convertNumberToCharacter(index),\n          description: {\n            'en-GB': option.strOptionAltText ? option.strOptionAltText : ''\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        _objRawData.additionalTrackingData\n      );\n\n      this._toggleHotspotMCQOptions(_arrOptionDOMElements, false);\n\n      if (\n        !BOO_PROGRESS_ON_CONFIRM_CLICK ||\n        this._strCurrTopicModel != 'assessment'\n      ) {\n        var _objOptionData = _objScoreInfo['objCurrRawOption'];\n\n        if (isNaN(parseInt(_objRawData.strAttempts))) {\n          LOCALISER.l_alert('MCQ_ATTEMPTS_VALUE_ERROR', [\n            _objWhatAssetData.strObjID\n          ]);\n        }\n\n        if (\n          BOO_SINGLE_ATTEMPT_IN_ASSESSMENT &&\n          this._strCurrTopicModel == 'assessment'\n        ) {\n          _objRawData.strAttempts = 1;\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts ==\n            _objRawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrOptionDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n\n          _objWhatAssetData.booInteractable = false;\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts <\n            _objRawData.strAttempts ||\n            unlimitedAttempts) &&\n          !alwaysShowFinalAttemptResponse\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = _objRawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType =\n            _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID =\n            _objWhatAssetData.strObjID;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (\n          _objRawData.arrActions &&\n          _objRawData.arrActions.length &&\n          _objWhatAssetData.booComplete\n        ) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('HOTSPOTMCQ_CONFIRM_ERROR');\n    }\n  },\n\n  handleEvent_hotspotMcqResetAssetButtonClicked: function(_strWhatAssetID) {\n    var _objAssetCourseData = this.getAssetData(_strWhatAssetID);\n    this._resetHotspotMcqStates(_objAssetCourseData, true);\n    this._resetStandardQuestion(_strWhatAssetID);\n    // If we were are not using confirm button, hide it again.\n    if (this._booConfirmOnOptionSelect) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n        _objAssetCourseData.objRawData\n      );\n      var _domConfirmButton = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strConfirmButtonClass\n      )[0];\n      _domConfirmButton.className = _domConfirmButton.className.replace(\n        'visibleButtonC',\n        'hiddenButtonC'\n      );\n    }\n  },\n\n  handleEvent_showHotspotMCQHotSpot: function(_objWhatHotSpotData) {\n    var _objAssetCourseData = this.getAssetData(\n      _objWhatHotSpotData['strAssetID']\n    );\n    var _intHotspotIndex = _objWhatHotSpotData.intHotspotIndex;\n\n    if (!_objAssetCourseData.booInteractable) {\n      return false;\n    }\n\n    this._resetHotspotMcqStates(_objAssetCourseData, true);\n\n    var _domCurrSprite = CORE.getElementsByClassName(\n      _objWhatHotSpotData['domLink'],\n      this._strMCQHotspotSpriteClass\n    )[0];\n    var unescapedNormalImageSrc = decodeURIComponent(\n      _objAssetCourseData.objRawData.objImageBaseSrc.strSrc\n    );\n    var unescapedActiveImageSrc = decodeURIComponent(\n      _objAssetCourseData.objRawData.objImageHighlightedSrc.strSrc\n    );\n\n    if (_objAssetCourseData.objRawData.objImageHighlightedSrc) {\n      _domCurrSprite.src = decodeURIComponent(_domCurrSprite.src).replace(\n        unescapedNormalImageSrc,\n        unescapedActiveImageSrc\n      );\n\n      var _strFromFile = unescapedNormalImageSrc;\n      var _strToFile = unescapedActiveImageSrc;\n\n      EM.trigger('imageSourcesUpdated', {\n        arrImages: [_domCurrSprite],\n        strFrom: _strFromFile,\n        strTo: _strToFile\n      });\n      _objAssetCourseData.arrOptionStates[\n        _objWhatHotSpotData.intHotspotIndex\n      ] = this._strMCQHotspotHighlightedState;\n    }\n\n    // Update translation to active image\n    if (gomo && gomo.translationManager) {\n      var newPathString = 'renderSecondary' + _intHotspotIndex;\n      gomo.translationManager.setImage(\n        _objAssetCourseData.objRawData.strID,\n        'objImageHighlightedSrc',\n        {newPath: newPathString}\n      );\n    }\n\n    _objAssetCourseData.arrOptionStates[\n      _objWhatHotSpotData['intHotspotIndex']\n    ] = this._strMCQHotspotHighlightedState;\n\n    _objAssetCourseData.strLastInteractedSubAssetID =\n      _objWhatHotSpotData['strSubAssetID'];\n\n    if (this._booConfirmOnOptionSelect) {\n      EM.trigger(\n        'hotspotmcqConfirmButtonClicked',\n        _objWhatHotSpotData['strAssetID']\n      );\n    }\n  },\n\n  is_hotspotmcq_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _resetHotspotMcqStates: function(_objWhatAssetData, _booFullReset) {\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n      _objWhatAssetData.objRawData\n    );\n    var _arrHotspotSprites = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strMCQHotspotSpriteClass\n    );\n    var _arrHotspotStates = _objWhatAssetData.arrOptionStates;\n    var count = 0;\n    var _strFromFile;\n    var _strToFile;\n    var newPathString;\n\n    while (\n      count < _arrHotspotSprites.length &&\n      _objWhatAssetData.objRawData.objImageHighlightedSrc &&\n      _objWhatAssetData.objRawData.objImageHighlightedSrc.strSrc != ''\n    ) {\n      var _domCurrSprite = _arrHotspotSprites[count];\n      var unescapedNormalImageSrc = decodeURIComponent(\n        _objWhatAssetData.objRawData.objImageBaseSrc.strSrc\n      );\n      var unescapedActiveImageSrc = decodeURIComponent(\n        _objWhatAssetData.objRawData.objImageHighlightedSrc.strSrc\n      );\n\n      if (_booFullReset) {\n        if ($(_domCurrSprite).attr('src').indexOf(unescapedActiveImageSrc) > -1) {\n          $(_domCurrSprite).attr('src', $(_domCurrSprite).attr('src').replace(\n            unescapedActiveImageSrc,\n            unescapedNormalImageSrc\n          ));\n\n          _strFromFile = unescapedActiveImageSrc;\n          _strToFile = unescapedNormalImageSrc;\n\n          EM.trigger('imageSourcesUpdated', {\n            arrImages: [_domCurrSprite],\n            strFrom: _strFromFile,\n            strTo: _strToFile\n          });\n          _arrHotspotStates[count] = false;\n        }\n\n        // Reset translation to primary image\n        if (gomo && gomo.translationManager) {\n          newPathString = 'renderSecondary' + count;\n          gomo.translationManager.setImage(\n            _objWhatAssetData.objRawData.strID,\n            'objImageBaseSrc',\n            {\n              newPath: newPathString\n            }\n          );\n        }\n      } else {\n        if (_objWhatAssetData.objRawData.objImageHighlightedSrc) {\n          _domCurrSprite.src = _domCurrSprite.src.replace(\n            unescapedActiveImageSrc,\n            unescapedNormalImageSrc\n          );\n\n          _strFromFile = unescapedActiveImageSrc;\n          _strToFile = unescapedNormalImageSrc;\n\n          EM.trigger('imageSourcesUpdated', {\n            arrImages: [_domCurrSprite],\n            strFrom: _strFromFile,\n            strTo: _strToFile\n          });\n\n          // Update translation to visited image\n          if (gomo && gomo.translationManager) {\n            newPathString = 'renderSecondary' + count;\n            gomo.translationManager.setImage(\n              _objWhatAssetData.objRawData.strID,\n              'objImageBaseSrc',\n              {newPath: newPathString}\n            );\n          }\n        }\n      }\n      count++;\n    }\n  },\n\n  _scoreHotspotMCQAsset: function(_objWhatAssetData, _objOptionStates) {\n    var _arrOptionCorrectness = [];\n    var _intSelectedIndex;\n\n    _.each(_objOptionStates, function(value, key) {\n      _intSelectedIndex = key;\n      return false;\n    });\n\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _objCurrRawOption = _arrRawOptionData[_intSelectedIndex];\n    var _objSelectedStates = [];\n    _objSelectedStates[_intSelectedIndex] = true;\n    if (_objCurrRawOption.booIsCorrect) {\n      _arrOptionCorrectness[_intSelectedIndex] = true;\n      return {\n        booIsCorrect: true,\n        objCurrRawOption: _objCurrRawOption,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objSelectedStates\n      };\n    }\n    return {\n      booIsCorrect: false,\n      objCurrRawOption: _objCurrRawOption,\n      objOptionData: _arrRawOptionData,\n      arrOptionCorrectness: _arrOptionCorrectness,\n      objSelectedStates: _objSelectedStates\n    };\n  },\n\n  _toggleHotspotMCQOptions: function(_arrOptionElements, _booEnableDisable) {\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = _booEnableDisable;\n      }\n      _objOption++;\n    }\n  },\n\n  _doPostRenderShowActions_hotspotmcq_Asset: function(_objWhatRawAssetData) {\n    // when we are using the options to confirm, we should hide the button\n    if (this._booConfirmOnOptionSelect) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(\n        _objWhatRawAssetData['objRawData']\n      );\n      var _domConfirmButton = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strConfirmButtonClass\n      )[0];\n      _domConfirmButton.className = _domConfirmButton.className.replace(\n        'visibleButtonC',\n        'hiddenButtonC'\n      );\n    }\n\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatRawAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatRawAssetData);\n  },\n\n  _returnFocusToHOTSPOTMCQAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  getAccessibleElements_hotspotmcq: function() {\n    var accessibleElements = ['.hotspotMCQSubAssetC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, HOTSPOTMCQ_ASSET_INTERACTIONS);\n\nvar HOTSPOTMCQ_ASSET_PREPROCESSOR = {\n  strObjID: 'The hotspot MCQ asset pre-extension object',\n\n  _preProcess_hotspotmcq_Asset: function(\n    _objWhatRawAssetData,\n    _objWhatParentScreenObject\n  ) {\n    var _strPreProcessedEntry = LOCALISER.get('HOTSPOTMCQ_PREPROCESSOR_ENTRY');\n\n    if (\n      !_objWhatRawAssetData['objImageHighlightedSrc']['strSrc'] ||\n      _objWhatRawAssetData['objImageHighlightedSrc']['strSrc'] === ''\n    ) {\n      _objWhatRawAssetData['objImageHighlightedSrc']['strSrc'] =\n        _objWhatRawAssetData['objImageBaseSrc']['strSrc'];\n    }\n\n    this._addToPreProcessedAssetList(\n      _objWhatRawAssetData['strType'],\n      _strPreProcessedEntry,\n      _objWhatRawAssetData['strID']\n    );\n\n    return _objWhatRawAssetData;\n  }\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, HOTSPOTMCQ_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(87))},function(t,e){t.exports="/* globals EM, BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM,\nglobal, CONTENT_TRACKING, _, $*/\n(function() {\n  // Create new Likert\n  var Likert = gomo.QuestionAsset.extend({\n    confirmButtonClass: 'confirmButtonC',\n    resetButtonClass: 'resetButtonC',\n\n    processData: function(data) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n\n      me.data.attempts = 0;\n      me.data.selectedOptions = [];\n      me.data.isComplete = false;\n      rawData.assetId = rawData.strID;\n      rawData.strAttempts = parseInt(rawData.strAttempts);\n\n      var renderScaleItems = [];\n      while (count < rawData.scaleItems.length) {\n        // Make a render version of the data which we can modify safely\n        renderScaleItems[count] = {\n          strID: rawData.scaleItems[count].strID,\n          strName: rawData.scaleItems[count].strName,\n          strOptionText: rawData.scaleItems[count].strOptionText,\n          objNormalSrc: {\n            strSrc: rawData.scaleItems[count].objNormalSrc.strSrc\n          }\n        };\n        var currentItem = renderScaleItems[count];\n        if (currentItem.objNormalSrc && currentItem.objNormalSrc.strSrc !== '') {\n          var strSrc = currentItem.objNormalSrc.strSrc;\n          currentItem.objNormalSrc.strSrc = gomo.utility.getSrcPath(strSrc) + strSrc;\n        }\n        count++;\n      }\n\n      count = 0;\n\n      while (count < rawData.questions.length) {\n        rawData.questions[count].strQuestion = me.formatHTML(rawData.questions[count].strQuestion);\n        rawData.questions[count].formattedScaleLabels = renderScaleItems;\n        count++;\n      }\n\n      // Additional tracking data\n      rawData.additionalTrackingData = {\n        activity: {},\n        result: {},\n        response: {}\n      };\n    },\n\n    // Before the asset is shown...\n    beforeShown: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      var steps = rawData.scaleItems.length;\n\n      // Additional tracking data\n      rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n      // Draw likert\n      while (count < rawData.questions.length) {\n        me.initLikert(rawData.questions[count].strID, steps);\n        count++;\n      }\n\n      gomo.topicInteractions.removeAnsweredQuestionFromTopic(me.data);\n      gomo.topicInteractions.addViewedQuestionToTopic(me.data);\n\n      // Check for subscreen actions and add the appropriate aria value\n      if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n        || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n        me.$el\n          .find('.' + me.confirmButtonClass)\n          .attr('aria-haspopup', 'dialog');\n      }\n    },\n\n    registerEvents: function() {\n      var me = this;\n\n      me.events = {\n        'click .confirmButtonC': 'confirmButton',\n        'click .resetButtonC': 'resetButton',\n        'slidestop .likert': 'stopSliding',\n        'slidestart .likert': 'startSliding'\n      };\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      var found = gomo.translationManager.findDataByAssetId(me.id);\n\n      if (found && found.questions && rawData.questions) {\n        while (count < rawData.questions.length) {\n          var foundQuestion = found.questions[count];\n          var rawQuestion = rawData.questions[count];\n          if (typeof foundQuestion === 'undefined' || typeof rawQuestion === 'undefined') {\n            break;\n          }\n          found.questions[count].strQuestion = me.formatHTML(rawData.questions[count].strQuestion);\n          count++;\n        }\n        found.formattedScaleLabels = rawData.scaleItems;\n        gomo.translationManager.setArrayOfImages(rawData.strID, 'scaleItems', 'objNormalSrc');\n      }\n      // Change the slider into RTL if needed.\n      me.setSliderDirection();\n    },\n\n    initLikert: function(id, steps) {\n      var me = this;\n      var likertTarget = me.$('#likert_' + id);\n      var isRtl = false;\n      steps -= 1;\n\n      // If the current language is a RTL language initialise the likert in rtl mode\n      if (gomo.translationManager.getCurrentLangCodeAndTitle().is_rtl === 1) {\n        isRtl = true;\n      }\n\n      // Initialise the likert slider\n      likertTarget.slider({\n        animate: 'fast',\n        step: 1,\n        max: steps,\n        value: 0,\n        isRTL: isRtl\n      });\n\n      // Size the labels\n      var likertLabelWrapper = me.$('.likert-labels[data-likert-id=\\'likert_' + id + '\\']');\n      var likertLabels = likertLabelWrapper.find('.likert-label');\n      var labelWidth = 100 / likertLabels.length;\n      _.each(likertLabels, function(label) {\n        $(label).css('width', labelWidth + '%');\n      });\n\n      // Adjust likert margins dependant on label size\n      me.$('.likert').css('margin', '0 ' + labelWidth/2 + '%');\n\n      me.updateLabel({'target': likertTarget});\n    },\n\n    startSliding: function(event) {\n      var me = this;\n      if (me.data.booInteractable) {\n        EM.trigger('disableScreenSwiping');\n      }\n    },\n\n    stopSliding: function(event) {\n      var me = this;\n      if (me.data.booInteractable) {\n        me.updateLabel(event);\n\n        setTimeout(function() {\n          EM.trigger('enableScreenSwipe');\n        }, 500);\n      }\n    },\n\n    updateLabel: function(event) {\n      var me = this;\n      // On small devices all labels are hidden apart form the current one so we need to update it\n      // when the slider changes.\n      var currStep = me.$(event.target).slider('value');\n      var likertId = me.$(event.target).attr('id');\n      var likertLabelWrapper = me.$('.likert-labels[data-likert-id=\\'' + likertId + '\\']');\n      var likertLabels = likertLabelWrapper.find('.likert-label');\n      // Show the correct label\n      me.$(likertLabels).addClass('likert-label-size-small-visibility');\n      me.$(likertLabels[currStep]).removeClass('likert-label-size-small-visibility');\n    },\n\n    confirmButton: function() {\n      var me = this;\n      var data = me.data;\n      var rawData = me.data.objRawData;\n      var optionElements = gomo.getElementsByClassName(me.el, me.optionClassName);\n\n      me.setSelectedOptions();\n\n      if (!data.booInteractable) {\n        return false;\n      }\n\n      try {\n        data.booInteractable = false;\n        data.attempts++;\n        data.responseValue = '';\n\n        me.enableSlider(false);\n\n        me.setVariablesToGlobal(me);\n        me.scoreAsset();\n\n        data.booIsCorrect = me.scoreInfo['booIsCorrect'];\n\n        // Additional tracking data for the asset as a whole\n        var additionalTrackingData = rawData.additionalTrackingData;\n        additionalTrackingData.activity.type = 'other';\n        additionalTrackingData.activity.weighting = parseInt(rawData.strWeighting) || 1;\n        var associatedAsset = gomo.assetManager.findInstance(rawData.strAssociatedAssetId);\n        additionalTrackingData.activity.description =\n          associatedAsset && associatedAsset.getContent ? associatedAsset.getContent() : null;\n        additionalTrackingData.result.detail = data.booIsCorrect ? 'correct' : 'incorrect';\n        additionalTrackingData.response.timeResponse = new Date();\n        additionalTrackingData.id = rawData.strID;\n\n        // Add answered question to topic\n        gomo.topicInteractions.addAnsweredQuestionToTopic(data, additionalTrackingData);\n\n        // Reset attemps if global override\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT) {\n          data.attempts = 1;\n        }\n\n        if (data.attempts == rawData.strAttempts || data.booIsCorrect) {\n          me.showOptionCorrectness(optionElements);\n          me.deactivateButtons();\n          gomo.eventManager.legacy('questionMaxAttemptsReached');\n          data.isComplete = true;\n        } else {\n          this.showResetButton();\n        }\n\n        var actions;\n        var additionalStyles;\n        // Subscreens\n        if (data.booIsCorrect) {\n          actions = data.objRawData.arrCorrectActions;\n          additionalStyles = 'correctFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_CorrectFeedbackSubScreenC';\n        } else if (\n          !data.booIsCorrect && data.attempts < data.objRawData.strAttempts ||\n          !data.booIsCorrect && data.objRawData.strAttempts === 0\n        ) {\n          actions = data.objRawData.arrFirstIncorrectActions;\n          additionalStyles = 'incorrectFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_IncorrectFeedbackSubScreenC';\n        } else {\n          actions = data.objRawData.arrFinalIncorrectActions;\n          additionalStyles = 'incorrectFeedbackSubScreenC';\n          additionalStyles += ' ' + me.classPrefixAssetPosition() + '_IncorrectFeedbackSubScreenC';\n        }\n\n        gomo.eventManager.legacy('screenAssetInteracting', data);\n\n        if (actions != 'null') {\n          var actionOptions = {};\n          actionOptions.objActions = actions;\n          actionOptions.objOptionalExtraData = data;\n          actionOptions.objOptionalExtraData.strType = data.strAssetType;\n          actionOptions.objOptionalExtraData.strAdditionalStyles = additionalStyles;\n          actionOptions.objOptionalExtraData.strAssetID = data.strObjID;\n\n          gomo.eventManager.legacy('processActions', actionOptions);\n        }\n\n        if (rawData.arrActions && rawData.arrActions.length && data.isComplete) {\n          me.processAssetActions();\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          gomo.eventManager.legacy('showNextButtonFromAsset');\n        }\n      } catch (err) {\n        if (global.LogManager) {\n          global.LogManager.add('ERROR', err);\n        }\n        return;\n      }\n    },\n\n    resetButton: function() {\n      var me = this;\n\n      me.resetOptions();\n      me.resetLikert();\n      me.showConfirmButton();\n      me.data.booInteractable = true;\n    },\n\n    scoreAsset: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n      var isQuestionCorrect = true;\n\n      // Score each likert scale item.\n      while (count < rawData.questions.length) {\n        var selectedOption = parseInt(\n          me.$('#likert_' + rawData.questions[count].strID).slider('value')\n        ) || 0;\n        var questionData = rawData.questions[count];\n        var selectedOptionId = questionData.formattedScaleLabels[selectedOption].strID;\n        var correctOption = questionData.strCorrectItem;\n        if (selectedOptionId == correctOption) {\n          questionData.isCorrect = true;\n        } else {\n          questionData.isCorrect = false;\n        }\n\n        var selectedLabel = questionData.formattedScaleLabels[selectedOption].strOptionText ||\n          questionData.formattedScaleLabels[selectedOption].objNormalSrc.strSrc.split('.')[0];\n\n        // Format the correctResponses to include all scale items if no correct answer is selected\n        var correctAnswer = gomo.utility.decodeHtml(questionData.strCorrectItem);\n        if (questionData.strCorrectItem === 'null') {\n          correctAnswer = '';\n        }\n        // send tracking statement for each likert question\n        CONTENT_TRACKING.interaction({\n          type: 'answered',\n          id: questionData.strID,\n          activity: {\n            id: questionData.strID,\n            title: gomo.utility.decodeHtml(questionData.strQuestion),\n            type: 'likert',\n            correctResponses: [correctAnswer]\n          },\n          result: {\n            success: questionData.isCorrect,\n            response: gomo.utility.decodeHtml(selectedLabel),\n            detail: questionData.isCorrect ? 'correct' : 'incorrect'\n          },\n          response: {\n            detail: gomo.utility.decodeHtml(selectedLabel)\n          },\n          object: {\n            id: questionData.strID,\n            definition: {\n              name: {'en-GB': gomo.utility.decodeHtml(questionData.strQuestion)},\n              description: {\n                'en-GB': gomo.utility.decodeHtml(questionData.strQuestion)\n              },\n              type: 'http://adlnet.gov/expapi/activities/cmi.interaction',\n              interactionType: 'likert',\n              correctResponsesPattern: [correctAnswer],\n              scale: _.map(questionData.formattedScaleLabels, function(label) {\n                return {\n                  id: label.strID,\n                  description: {'en-GB': gomo.utility.decodeHtml(label.strOptionText) ||\n                  gomo.utility.decodeHtml(label.objNormalSrc.strSrc.split('.')[0])}\n                };\n              })\n            }\n          }\n        });\n        count++;\n      }\n\n      // Check each questions correctness. They all have to be complete for the asset to be correct.\n      count = 0;\n      while (count < rawData.questions.length) {\n        if (!rawData.questions[count].isCorrect) {\n          isQuestionCorrect = false;\n          break;\n        }\n        count++;\n      }\n\n      // create score info object for question scoring/marking to use\n      if (isQuestionCorrect) {\n        me.scoreInfo = {\n          booIsCorrect: true,\n          objCurrRawOption: [],\n          objOptionData: [],\n          arrOptionCorrectness: [],\n          objSelectedStates: []\n        };\n      } else {\n        me.scoreInfo = {\n          booIsCorrect: false,\n          objCurrRawOption: [],\n          objOptionData: [],\n          arrOptionCorrectness: [],\n          objSelectedStates: []\n        };\n      }\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    isComplete: function() {\n      var me = this;\n\n      return me.data.isComplete;\n    },\n\n    resetLikert: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var count = 0;\n\n      me.enableSlider(true);\n\n      while (count < rawData.questions.length) {\n        var questionId = rawData.questions[count].strID;\n        if (typeof me.$('#likert_' + questionId).slider('instance') != 'undefined') {\n          me.$('#likert_' + questionId).slider('value', 0);\n        }\n        count++;\n      }\n    },\n\n    reset: function() {\n      var me = this;\n\n      me.data.attempts = 0;\n      me.data.selectedOptions = [];\n      me.data.booInteractable = true;\n\n      me.resetOptions();\n      me.resetLikert();\n\n      if (me.$('.resetButtonC').length > 0) {\n        me.showConfirmButton();\n      }\n    },\n\n    enableSlider: function(enable) {\n      var me = this;\n\n      if (enable) {\n        // enable all sliders\n        _.each(me.$('.likert'), function() {\n          me.$(this).slider('enable');\n        });\n        // enable slider pointer events\n        me.$('.ui-slider-handle').css('pointer-events', 'all');\n      } else {\n        // disable all sliders\n        _.each(me.$('.likert'), function() {\n          me.$(this).slider('disable');\n        });\n        // disable slider pointer events\n        me.$('.ui-slider-handle').css('pointer-events', 'none');\n      }\n    },\n\n    setSliderDirection: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var isRtlLanguage = false;\n      if (gomo.translationManager.getCurrentLangCodeAndTitle().is_rtl === 1) {\n        isRtlLanguage = true;\n      }\n      // change each of the likert sliders to rtl id needed\n      if (isRtlLanguage) {\n        $(rawData.questions).each(function(i, val) {\n          me.$('#likert_' + val.strID).slider( 'option', 'isRTL', true);\n        });\n      } else {\n        $(rawData.questions).each(function(i, val) {\n          me.$('#likert_' + val.strID).slider( 'option', 'isRTL', false);\n        });\n      }\n    },\n\n    getAccessibleElements: function() {\n      var accessibleElements = ['.ui-slider-handle', '.activeButtonC'];\n      return accessibleElements;\n    }\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('likert', Likert);\n})();\n"},function(t,e,n){n(0)(n(89))},function(t,e){t.exports="/* global $, _, CORE, EM, ASSET_RENDERER, O_EXTENDER, TOPIC_INTERACTIONS */\n/* global ASSET_INTERACTIONS, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK, OUTPUT_MODE_CHECKER */\n\n/**\n * @title MCQ asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the mcq asset\n * type.\n *\n * @author Johnathan Castle\n * @version 2.0 23/09/10\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('mcq', objCurrSupportData);\n\nvar MCQ_ASSET_RENDERER = {\n  strObjID: 'The mcq asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['mcq', 'mcqAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['mcqoption', 'mcqAssetOptionTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_mcq_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XXIMPORTEDSTYLEXX',\n        _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix\n      );\n\n      var _htmOptionText = this._getMCQOptionHTML(_objWhatAssetCourseObject, _objWhatRawAssetData);\n      _htmReturnData = _htmReturnData.replace('XXMCQOPTIONSXX', _htmOptionText);\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n\n      var associatedAsset = null;\n      if (_objWhatRawAssetData.strAssociatedAssetId) {\n        // Attempt to set the associated asset data if it exists\n        associatedAsset = ASSET_INTERACTIONS.getAssetData(\n          _objWhatRawAssetData.strAssociatedAssetId\n        );\n      }\n      if (associatedAsset) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ARIA_LABELLEDBY_XX/g,\n          ASSET_RENDERER.getAssetDOMId(associatedAsset.objRawData)\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(/aria-labelledby\\s*=\\s*[A-Z_\"]+/g, '');\n      }\n\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"MCQ_ASSET_RENDERER._renderMCQAsset(),\n        ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3\n      ); */\n      var _strDebugError = LOCALISER.get('MCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('MCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  // ***************************** Update methods extensions *****************************\n  /* _updateMCQAsset : function(_objWhatRawAssetData, _strWhatResourcePath) {\n    var _objDOMElement = this.getAssetDOMElement(_objWhatRawAssetData);\n    var _objOptionsWrapper = CORE.getElementsByClassName(_objDOMElement, \"mcqOptionsWrapperC\");\n    _objOptionsWrapper.innerHTML = this._getMCQOptionHTML(_objWhatRawAssetData);\n    // _objDOMElement.src = _strWhatResourcePath + _objWhatRawAssetData['@src'];\n    // _objDOMElement.className = _objDOMElement.className.replace(\"assetHighC\", \"assetNormC\");\n  }, */\n\n  // ***************************** Helper methods extensions *****************************\n\n  // Option:\n  /*\n    <div\n      id=\"mcqAssetXX_ASSET_ID_XXOptionXXOPTIONNUMXXWrapperL\"\n      class=\"mcqOptionC assetNormC XXOPTIONCORRECTNESSXX\"\n    >\n      XXOPTIONTEXTXX\n    </div>\n  */\n\n  _getMCQOptionHTML: function(_objWhatAssetCourseObject, _objWhatRawAssetData) {\n    if (this._objSubAssetTemplates[_objWhatRawAssetData['strType'] + 'option']) {\n      var _htmReturnData = '';\n      var count = 0;\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n        var _htmOptionTemplate = this._objSubAssetTemplates[\n          _objWhatRawAssetData['strType'] + 'option'\n        ];\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONNUMXX/g, count + 1);\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_OPTION_XX/g, count);\n        if (_objWhatAssetCourseObject.arrOptionStates[count]) {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strSelectedOptionClass\n          );\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            ' class=\"mcqOptionC XX_OPTION_STATE_XX\"',\n            ' class=\"mcqOptionC\" checked=\"true\"'\n          );\n        } else {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strUnselectedOptionClass\n          );\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            ' class=\"mcqOptionC XX_OPTION_STATE_XX\"',\n            ' class=\"mcqOptionC\"'\n          );\n        }\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XXOPTIONTEXTXX',\n          this._showCorrectOptionMarker(_objCurrOption) +\n            this.insertFormattedHtml(_objCurrOption.strOptionText)\n        );\n        _htmReturnData += _htmOptionTemplate;\n        count++;\n      }\n      return _htmReturnData;\n    } else {\n      /* this.debug(\n        \"MCQ_ASSET_RENDERER._getMCQOptionHTML(),\n        ERROR: Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\",\n        3\n      ); */\n      var _strDebugError = LOCALISER.get('MCQ_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"Asset Error, no sub template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('MCQ_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, MCQ_ASSET_RENDERER);\n\nvar MCQ_ASSET_INTERACTIONS = {\n  strObjID: 'The mcq asset interactions extension object',\n  _strMCQOptionClass: 'mcqOptionC',\n\n  _performPreShowActions_mcq_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    if (rawData.randomiseAnswers) {\n      var optionClass =\n        OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC'\n          ? this._strMCQOptionClass\n          : 'mcqOptionWrapperC';\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, optionClass);\n    }\n\n    // Check for a subscreen action in options\n    var subscreenActionInOptions = _.find(rawData.arrOptions, function(option) {\n      var result = gomo.utility.checkForShowSubscreenAction(option.arrOptionFeedbackActions);\n      return result;\n    });\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (subscreenActionInOptions\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  // {'strAssetID':'XX_ASSET_ID_XX', 'strOptionIndex':'XXOPTIONNUMXX'}\n  handleEvent_mcqOptionClicked: function(_objWhatOptionData) {\n    // alert(\"handleEvent_mcqOptionClicked\")\n    var _objWhatAssetData = this.getAssetData(_objWhatOptionData['strAssetID']);\n    // alert(_objWhatAssetData.booInteractable)\n    if (_objWhatAssetData.booInteractable) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n      var _arrOptionDOMElements = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strMCQOptionClass\n      );\n\n      this._resetOptions(\n        _arrOptionDOMElements,\n        _domWhatAssetElement,\n        _objWhatAssetData.arrOptionStates\n      );\n\n      var optionType = (OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC') ? 'Wrapper' : 'Input';\n\n      var _domCurrOption = $(_arrOptionDOMElements).filter(function() {\n        return (\n          $(this).attr('id') ==\n          'mcqAsset_' +\n            _objWhatOptionData['strAssetID'] +\n            '_Option' +\n            _objWhatOptionData['strOptionIndex'] +\n            optionType + 'L'\n        );\n      });\n      if (OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC') {\n        $(_domCurrOption)\n          .removeClass(this._strUnselectedOptionClass)\n          .addClass(this._strSelectedOptionClass)\n          .attr('aria-checked', 'true');\n      } else {\n        $(_domCurrOption)\n          .attr('aria-checked', 'true')\n          .prop('checked', true);\n      }\n      _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = true;\n    }\n  },\n\n  handleEvent_mcqConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objRawData);\n    var _arrOptionDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strMCQOptionClass\n    );\n    var _objOptionStates = this._getSelectedOptions(_objWhatAssetData, _arrOptionDOMElements);\n    var unlimitedAttempts = false;\n    if (_objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    var alwaysShowFinalAttemptResponse = false;\n    if (\n      typeof _objRawData.showFinalAttempt !== 'undefined' &&\n      _objRawData.showFinalAttempt == true\n    ) {\n      alwaysShowFinalAttemptResponse = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = '';\n      var selectedOptionText = [];\n      _.each(_objOptionStates, function(value, key) {\n        responseValue += _objRawData.arrOptions[key].strOptionText;\n        selectedOptionText.push(gomo.utility.convertNumberToCharacter(key));\n      });\n      _objWhatAssetData.responseValue = responseValue;\n      this.setVariablesToGlobal(_objWhatAssetData);\n      var _objScoreInfo = this._scoreMCQAsset(_objWhatAssetData, _objOptionStates);\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      _.map(_objScoreInfo.objOptionData, function(response, index) {\n        if (response.booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(index));\n        }\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = _objRawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n      var associatedAsset = _objRawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting = parseInt(_objRawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(_objRawData.arrOptions, function(option, index) {\n        return {\n          'id': gomo.utility.convertNumberToCharacter(index),\n          'description': {\n            'en-GB': option.strOptionText\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        _objRawData.additionalTrackingData\n      );\n\n      this._toggleMCQOptions(_arrOptionDOMElements, false);\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        var _objOptionData = _objScoreInfo['objCurrRawOption'];\n\n        if (isNaN(parseInt(_objRawData.strAttempts))) {\n          LOCALISER.l_alert('MCQ_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT && this._strCurrTopicModel == 'assessment') {\n          _objRawData.strAttempts = 1;\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == _objRawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrOptionDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n\n          _objWhatAssetData.booInteractable = false;\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < _objWhatAssetData.objRawData.strAttempts ||\n            unlimitedAttempts) &&\n          !alwaysShowFinalAttemptResponse\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = _objRawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = _objOptionData.arrOptionFeedbackActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (_objRawData.arrActions && _objRawData.arrActions.length\n          && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('MCQ_CONFIRM_ERROR');\n    }\n  },\n\n  is_mcq_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _doPostRenderShowActions_mcq_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n  },\n\n  _disableMCQOptions: function(_arrOptionElements) {\n    /* for(var _objOption in _arrOptionElements) {\n      if(_arrOptionElements[_objOption].nodeName.toLowerCase() == \"input\")\n        _arrOptionElements[_objOption].disabled = true;\n    } */\n\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = true;\n      }\n\n      _objOption++;\n    }\n  },\n\n  _enableMCQOptions: function(_arrOptionElements) {\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = false;\n      }\n\n      _objOption++;\n    }\n  },\n\n  _toggleMCQOptions: function(_arrOptionElements, _booEnableDisable) {\n    var _objOption = 0;\n\n    while (_objOption < _arrOptionElements.length) {\n      if (_arrOptionElements[_objOption].nodeName.toLowerCase() == 'input') {\n        _arrOptionElements[_objOption].disabled = _booEnableDisable;\n      }\n      _objOption++;\n    }\n  },\n\n  _scoreMCQAsset: function(_objWhatAssetData, _objOptionStates) {\n    var _arrOptionCorrectness = [];\n    var _intSelectedIndex;\n\n    _.each(_objOptionStates, function(value, key) {\n      _intSelectedIndex = key;\n      return false;\n    });\n\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _objCurrRawOption = _arrRawOptionData[_intSelectedIndex];\n    var _objSelectedStates = [];\n    _objSelectedStates[_intSelectedIndex] = true;\n    if (_objCurrRawOption.booIsCorrect) {\n      _arrOptionCorrectness[_intSelectedIndex] = true;\n      return {\n        booIsCorrect: true,\n        objCurrRawOption: _objCurrRawOption,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objSelectedStates\n      };\n    }\n    return {\n      booIsCorrect: false,\n      objCurrRawOption: _objCurrRawOption,\n      objOptionData: _arrRawOptionData,\n      arrOptionCorrectness: _arrOptionCorrectness,\n      objSelectedStates: _objSelectedStates\n    };\n  },\n\n  _returnFocusToMCQAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  getAccessibleElements_mcq: function() {\n    var accessibleElements = ['.mcqOptionC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, MCQ_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(91))},function(t,e){t.exports="/* global $, CORE, EM, ASSET_RENDERER, VARIABLES_HOLDER, O_EXTENDER, TOPIC_INTERACTIONS */\n/* global ASSET_INTERACTIONS, DECONTAMINATER, LOCALISER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_SHOW_CORRECTNESS_ICONS_ON_CONFIRM_CLICK */\n\n/**\n * @title input text asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the inputtext asset type.\n *\n * @author Caroline Wilgar\n * @version 2.0 [25/05/2012]\n *\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('numberinput', objCurrSupportData);\n\nvar NUMBER_INPUT_ASSET_RENDERER = {\n  strObjID: 'The number input asset renderer extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['numberinput', 'numberInputAssetTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_numberinput_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_DEFAULT_INPUT_TEXT_XX',\n        VARIABLES_HOLDER.parseHTMLForVariableMarkup(_objWhatRawAssetData.strInitialText, true)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _objWhatRawAssetData['strID'] + 'YY'\n      );\n      return _htmReturnData;\n    } else {\n      this.debug(\n        'ASSET_RENDERER._renderNumberInputAsset(), ERROR: Unknown asset type of ' +\n          _objWhatRawAssetData['strType'] +\n          '.',\n        3\n      );\n      return 'Asset Error, no template found, ID: ' + _objWhatRawAssetData['strID'];\n    }\n  },\n\n  _numberinputGetRowCount: function(_objWhatRawAssetData) {\n    var intRowCount = 1;\n    if (_objWhatRawAssetData.strFormat === 'multiLine') {\n      intRowCount = 5;\n    }\n    return intRowCount;\n  }\n};\nO_EXTENDER.extend(ASSET_RENDERER, NUMBER_INPUT_ASSET_RENDERER);\n\nvar NUMBER_INPUT_ASSET_INTERACTIONS = {\n  strObjID: 'The number input asset interactions extension object',\n\n  _strNumberInputTextAreaClass: 'numberInputAreaC',\n  _strNumberInputCorrectnessClass: 'correctnessMarkerC',\n\n  _performPreShowActions_numberinput_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_numberInputChangeAttempted: function(_objWhatTextData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatTextData._strWhatAssetID);\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n    return true; // having return boo onkeydown seems to stop event entirely\n  },\n\n  handleEvent_numberInputRemoveDefaultText: function(_objWhatTextData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatTextData._strWhatAssetID);\n    var decomtaminatedTextValue = this._decomtaminatedNumberInputString(\n      _objWhatTextData._domTextArea.value\n    );\n    var decontaminatedInitialText = this._decomtaminatedNumberInputString(\n      _objWhatAssetData.objRawData.strInitialText\n    );\n    if (decomtaminatedTextValue == decontaminatedInitialText) {\n      _objWhatTextData._domTextArea.value = '';\n    }\n  },\n\n  handleEvent_numberinputConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var unlimitedAttempts = false;\n    if (_objWhatAssetData.objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var _domTextArea = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strNumberInputTextAreaClass\n    )[0];\n\n    _objWhatAssetData.objOptionStates.textValue = _domTextArea.value;\n\n    if (_objWhatAssetData.objOptionStates.textValue) {\n      // Test for number\n      if ($.isNumeric(_objWhatAssetData.objOptionStates.textValue)) {\n        _objWhatAssetData.booInteractable = false;\n        _domTextArea.disabled = true;\n\n        _objWhatAssetData.intUsersQuestionAttempts++;\n\n        if (\n          _objRawData.strCorrectAnswer == '' ||\n          this._numberInputIsCorrect(\n            _objRawData.strCorrectAnswer,\n            _objWhatAssetData.objOptionStates.textValue\n          )\n        ) {\n          _objWhatAssetData.booIsCorrect = true;\n        }\n\n        // Additional tracking data\n        var additionalTrackingData = _objWhatAssetData.objRawData.additionalTrackingData;\n        additionalTrackingData.activity.type = 'numeric';\n        additionalTrackingData.activity.correctResponses =\n          _objRawData.strCorrectAnswer.split('||');\n        var associatedAsset = _objRawData.strAssociatedAssetId ?\n          ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId) : null;\n        additionalTrackingData.activity.description =\n          ASSET_INTERACTIONS.getAssetContent(associatedAsset);\n        additionalTrackingData.activity.weighting = parseInt(_objRawData.strWeighting) || 1;\n        additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect ?\n          'correct' : 'incorrect';\n        additionalTrackingData.response.timeResponse = new Date();\n        additionalTrackingData.response.detail = _objWhatAssetData.objOptionStates.textValue;\n        additionalTrackingData.id = _strWhatAssetID;\n\n        // Add answered question to topic\n        TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n          _objWhatAssetData,\n          _objWhatAssetData.objRawData.additionalTrackingData\n        );\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT) {\n          _objWhatAssetData.objRawData.strAttempts = 1;\n        }\n\n        var strAdditionalStyles = null;\n        var _arrActions = null;\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = _objWhatAssetData.objRawData.arrCorrectActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < _objWhatAssetData.objRawData.strAttempts ||\n            unlimitedAttempts)\n        ) {\n          /*\n          * First incorrect response if...\n          * the anser is wrong\n          * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n          */\n          _arrActions = _objWhatAssetData.objRawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = _objWhatAssetData.objRawData.arrFinalIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == _objWhatAssetData.objRawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n          this._numberInputShowCorrectness(_objWhatAssetData, _domWhatAssetElement);\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (_objRawData.arrActions && _objRawData.arrActions.length\n          && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n\n        this.setVariablesToGlobal(_objWhatAssetData);\n      } else {\n        LOCALISER.l_alert('NUMBERINPUT_CONFIRM_ERROR');\n      }\n    } else {\n      LOCALISER.l_alert('TEXTINPUT_NO_ATTEMPT');\n    }\n  },\n\n  _reset_numberinput_QuestionAsset: function(_strWhatAssetID) {\n    this._resetStandardQuestion(_strWhatAssetID);\n\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var _domTextArea = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strNumberInputTextAreaClass\n    )[0];\n\n    _domTextArea.value = _domTextArea.defaultValue;\n    _domTextArea.disabled = false;\n\n    this._showQuestionConfirmButton(_objWhatAssetData);\n  },\n\n  _numberInputIsCorrect: function(strCorrectAnswers, strUserInput) {\n    var booCorrectInput = false;\n    var arrCorrectAnswers = strCorrectAnswers.split('||');\n    var decomtaminatedUserInput = this._decomtaminatedNumberInputString(strUserInput);\n    decomtaminatedUserInput = decomtaminatedUserInput.toLowerCase();\n\n    var count = 0;\n    while (count < arrCorrectAnswers.length) {\n      var strCorrectAnswer = arrCorrectAnswers[count].toLowerCase();\n      if (strCorrectAnswer === decomtaminatedUserInput) {\n        booCorrectInput = true;\n        break;\n      }\n      count++;\n    }\n\n    return booCorrectInput;\n  },\n\n  _numberInputShowCorrectness: function(objWhatAssetData, domCurrentAsset) {\n    if (BOO_SHOW_CORRECTNESS_ICONS_ON_CONFIRM_CLICK) {\n      var domCorrectnessMarker = CORE.getElementsByClassName(\n        domCurrentAsset,\n        this._strNumberInputCorrectnessClass\n      )[0];\n      if (objWhatAssetData.booIsCorrect) {\n        $(domCurrentAsset).addClass('correct-option');\n        domCorrectnessMarker.className = domCorrectnessMarker.className.replace(\n          'unSetCorrectnessC',\n          'correctAnswerC'\n        );\n      } else {\n        $(domCurrentAsset).addClass('incorrect-option');\n        domCorrectnessMarker.className = domCorrectnessMarker.className.replace(\n          'unSetCorrectnessC',\n          'incorrectAnswerC'\n        );\n      }\n    }\n  },\n\n  showNUMBERINPUTfeedback: function(_objWhatAssetData) {\n    if (\n      _objWhatAssetData.objRawData.arrFeedbackActions.length > 0 &&\n      _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters &&\n      _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters.strSubScreenID\n    ) {\n      EM.trigger('showSubScreen', {\n        strAssetID: _objWhatAssetData.strObjID,\n        strTargetSubScreenID:\n          _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters.strSubScreenID\n      });\n    }\n  },\n\n  is_numberinput_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _decomtaminatedNumberInputString: function(_strRaw) {\n    var objDecontaminaterResult = DECONTAMINATER.clean(_strRaw);\n\n    return objDecontaminaterResult.strText;\n  },\n\n  _viewQuestionAnswer_numberinput_questionType: function(_objWhatAssetData) {\n    this.showNUMBERINPUTfeedback(_objWhatAssetData);\n  },\n\n  _doPostRenderShowActions_numberinput_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n\n    // Set asset id in element html for _scrollIntoView_Asset\n    var elementSelector =\n      '#' + ASSET_RENDERER.getAssetDOMId(_objWhatAssetData.objRawData) + ' textarea';\n    ASSET_INTERACTIONS._setScrollIntoView_Asset(\n      elementSelector,\n      _objWhatAssetData.objRawData.strID\n    );\n\n    var el = $(elementSelector);\n    if (el && el.length) {\n      // Trigger _scrollIntoView_Asset on clicking the textarea\n      el.click(function() {\n        ASSET_INTERACTIONS._scrollIntoView_Asset(this);\n      });\n      el.blur(function() {\n        ASSET_INTERACTIONS._scrollIntoViewReset_Asset();\n      });\n    }\n  },\n\n  _reset_numberinput_Asset: function(_objWhatAssetData, _booFullReset) {\n    // Parse the string for special characters\n    _objWhatAssetData.objRawData.strInitialText = gomo.utility.decodeHtml(\n      _objWhatAssetData.objRawData.strInitialText\n    );\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    if (_domWhatAssetElement) {\n      var _domTextArea = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strNumberInputTextAreaClass\n      )[0];\n\n      _domTextArea.value = _objWhatAssetData.objRawData.strInitialText;\n      _domTextArea.disabled = false;\n\n      this._resetUserQuestionAttempts(_objWhatAssetData);\n      this._showQuestionConfirmButton(_objWhatAssetData);\n      // Reset correctness markers and active confrim/reset.\n      $(_domWhatAssetElement).find('.correctnessMarkerC').removeClass().addClass(\n        'unSetCorrectnessC correctnessMarkerC'\n      );\n      $(_domWhatAssetElement).removeClass('correct-option incorrect-option');\n      this._activateButtons(_objWhatAssetData);\n    }\n  },\n\n  _returnFocusToNUMBERINPUTAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  _checkCompletion_numberinput_Asset: function(_objWhatAssetData) {\n    return (_objWhatAssetData.intUsersQuestionAttempts >= _objWhatAssetData.objRawData.strAttempts\n      || _objWhatAssetData.booIsCorrect);\n  },\n\n  _performLanguagePreprocess_numberinput_Asset: function(_objWhatAssetData) {\n    gomo.translationManager.htmlDecodeAssetTranslations(_objWhatAssetData.strObjID, [\n      'strInitialText'\n    ]);\n  },\n\n  getAccessibleElements_numberinput: function() {\n    var accessibleElements = ['.numberInputAreaC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, NUMBER_INPUT_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(93))},function(t,e){t.exports="/* global $, _, CORE, EM, ASSET_RENDERER, O_EXTENDER, TOPIC_INTERACTIONS */\n/* global ASSET_INTERACTIONS, LOCALISER, OUTPUT_MODE_CHECKER */\n/* global BOO_SINGLE_ATTEMPT_IN_ASSESSMENT, BOO_HIDE_NEXT_UNTIL_CONFIRM */\n/* global BOO_PROGRESS_ON_CONFIRM_CLICK */\n\n/**\n * @title SFL asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the SFL asset\n * type.\n *\n * @author Johnathan Castle\n * @version 2.0 28/07/11\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('sfl', objCurrSupportData);\n\nvar SFL_ASSET_RENDERER = {\n  strObjID: 'The SFL asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [['sfl', 'sflAssetTemplateWrapperC']],\n  _arrSubAssetHTMLTemplateIDs: [['sfloption', 'sflAssetOptionTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_sfl_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n      _htmReturnData = _htmReturnData.replace(\n        'XXIMPORTEDSTYLEXX',\n        _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix\n      );\n\n      var _htmOptionText = this._getSFLOptionHTML(_objWhatAssetCourseObject, _objWhatRawAssetData);\n      _htmReturnData = _htmReturnData.replace('XXSFLOPTIONSXX', _htmOptionText);\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n\n      var associatedAsset = null;\n      if (_objWhatRawAssetData.strAssociatedAssetId) {\n        // Attempt to set the associated asset data if it exists\n        associatedAsset = ASSET_INTERACTIONS.getAssetData(\n          _objWhatRawAssetData.strAssociatedAssetId\n        );\n      }\n      if (associatedAsset) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ARIA_LABELLEDBY_XX/g,\n          ASSET_RENDERER.getAssetDOMId(associatedAsset.objRawData)\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(/aria-labelledby\\s*=\\s*[A-Z_\"]+/g, '');\n      }\n\n      return _htmReturnData;\n    } else {\n      // this.debug(\"SFL_ASSET_RENDERER._renderSFLAsset(), ERROR: \" +\n      // \"Unknown asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\", 3);\n      var _strDebugError = LOCALISER.get('SFL_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('SFL_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  // ***************************** Update methods extensions *****************************\n  /* _updateSFLAsset: function(_objWhatRawAssetData, _strWhatResourcePath) {\n    var _objDOMElement = this.getAssetDOMElement(_objWhatRawAssetData);\n    var _objOptionsWrapper = CORE.getElementsByClassName(_objDOMElement, 'sflOptionsWrapperC');\n    _objOptionsWrapper.innerHTML = this._getSFLOptionHTML(_objWhatRawAssetData);\n    // _objDOMElement.src = _strWhatResourcePath + _objWhatRawAssetData['@src'];\n    // _objDOMElement.className = _objDOMElement.className.replace(\"assetHighC\", \"assetNormC\");\n  }, */\n\n  // ***************************** Helper methods extensions *****************************\n\n  // Option:\n  // <div\n  //    id=\"sflAssetXX_ASSET_ID_XXOptionXXOPTIONNUMXXWrapperL\"\n  //    class=\"sflOptionC assetNormC XXOPTIONCORRECTNESSXX\">XXOPTIONTEXTXX</div>\n\n  _getSFLOptionHTML: function(_objWhatAssetCourseObject, _objWhatRawAssetData) {\n    if (this._objSubAssetTemplates[_objWhatRawAssetData['strType'] + 'option']) {\n      var _htmReturnData = '';\n      var count = 0;\n      while (count < _objWhatRawAssetData.arrOptions.length) {\n        var _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n        var _htmOptionTemplate = this._objSubAssetTemplates[\n          _objWhatRawAssetData['strType'] + 'option'\n        ];\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONNUMXX/g, count + 1);\n        _htmOptionTemplate = _htmOptionTemplate.replace(/XX_OPTION_XX/g, count);\n        if (_objWhatAssetCourseObject.arrOptionStates[count]) {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strSelectedOptionClass\n          );\n        } else {\n          _htmOptionTemplate = _htmOptionTemplate.replace(\n            'XX_OPTION_STATE_XX',\n            this._strUnselectedOptionClass\n          );\n        }\n        _htmOptionTemplate = _htmOptionTemplate.replace(\n          'XXOPTIONTEXTXX',\n          this._showCorrectOptionMarker(_objCurrOption) +\n            this.insertFormattedHtml(_objCurrOption.strOptionText)\n        );\n        _htmReturnData += _htmOptionTemplate;\n        count++;\n      }\n      return _htmReturnData;\n    } else {\n      // this.debug(\"SFL_ASSET_RENDERER._getSFLOptionHTML(), ERROR: Unknown \" +\n      // \"asset type of \" + _objWhatRawAssetData[\"strType\"] + \".\", 3);\n      var _strDebugError = LOCALISER.get('SFL_DEBUG_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData[\"strID\"];\n      var _strReturnValue = LOCALISER.get('SFL_RETURN_OPTION_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, SFL_ASSET_RENDERER);\n\nvar SFL_ASSET_INTERACTIONS = {\n  strObjID: 'The SFL asset interactions extension object',\n\n  _strSFLOptionClass: 'sflOptionC',\n  _strSFLConfirmAnchorClass: 'contentButtonNormC',\n  _strSFLConfirmDisableClass: 'confirmButtonDisabledC',\n\n  _performPreShowActions_sfl_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n\n    if (rawData.randomiseAnswers) {\n      var optionClass =\n        OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC'\n          ? this._strSFLOptionClass\n          : 'sflOptionWrapperC';\n      ASSET_INTERACTIONS._randomiseOptions(rawData.strID, optionClass);\n    }\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_sflOptionClicked: function(_objWhatOptionData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatOptionData['strAssetID']);\n    if (_objWhatAssetData.booInteractable) {\n      var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n      var _arrOptionDOMElements = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strSFLOptionClass\n      );\n\n      var optionType = (OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC') ? 'Wrapper' : 'Input';\n\n      var _domCurrOption = $(_arrOptionDOMElements).filter(function() {\n        return (\n          $(this).attr('id') ==\n          'sflAsset_' +\n            _objWhatOptionData['strAssetID'] +\n            '_Option' +\n            _objWhatOptionData['strOptionIndex'] +\n            optionType + 'L'\n        );\n      });\n\n      if (OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC') {\n        if ($(_domCurrOption).hasClass(this._strUnselectedOptionClass)) {\n          // mark as checked\n          $(_domCurrOption)\n            .removeClass(this._strUnselectedOptionClass)\n            .addClass(this._strSelectedOptionClass)\n            .attr('aria-checked', 'true');\n\n          _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = true;\n        } else {\n          // mark as unchecked\n          $(_domCurrOption)\n            .removeClass(this._strSelectedOptionClass)\n            .addClass(this._strUnselectedOptionClass)\n            .attr('aria-checked', 'false');\n\n          _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1] = false;\n        }\n      } else {\n        $(_domCurrOption).attr('aria-checked', function(index, attr) {\n          _objWhatAssetData.arrOptionStates[_objWhatOptionData['strOptionIndex'] - 1]\n            = (attr === 'false');\n          return attr === 'false' ? 'true' : 'false';\n        });\n      }\n    }\n  },\n\n  handleEvent_sflConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var rawData = _objWhatAssetData.objRawData;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    var _arrOptionDOMElements = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strSFLOptionClass\n    );\n    var _objOptionStates = this._getSelectedOptions(_objWhatAssetData, _arrOptionDOMElements);\n    var unlimitedAttempts = false;\n    if (rawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    if (_objOptionStates) {\n      _objWhatAssetData.booInteractable = false;\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      var responseValue = [];\n      var selectedOptionText = [];\n      _.each(_objOptionStates, function(value, key) {\n        responseValue.push(rawData.arrOptions[key].strOptionText);\n        selectedOptionText.push(gomo.utility.convertNumberToCharacter(key));\n      });\n      _objWhatAssetData.responseValue = responseValue.join(', ');\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      var _objScoreInfo = this._scoreSFLAsset(_objWhatAssetData, _objOptionStates);\n\n      var _booIsCorrect = _objScoreInfo['booIsCorrect'];\n      _objWhatAssetData.booIsCorrect = _booIsCorrect;\n\n      var correctResponses = [];\n      _.map(_objScoreInfo.objOptionData, function(response, index) {\n        if (response.booIsCorrect) {\n          correctResponses.push(gomo.utility.convertNumberToCharacter(index));\n        }\n      });\n\n      // Additional tracking data\n      var additionalTrackingData = rawData.additionalTrackingData;\n      additionalTrackingData.activity.type = 'choice';\n      additionalTrackingData.activity.correctResponses = [correctResponses.join(',')];\n      var associatedAsset = rawData.strAssociatedAssetId\n        ? ASSET_INTERACTIONS.getAssetData(rawData.strAssociatedAssetId)\n        : null;\n      additionalTrackingData.activity.description = ASSET_INTERACTIONS.getAssetContent(\n        associatedAsset\n      );\n      additionalTrackingData.activity.weighting = parseInt(rawData.strWeighting) || 1;\n      additionalTrackingData.result.detail = _objWhatAssetData.booIsCorrect\n        ? 'correct'\n        : 'incorrect';\n      additionalTrackingData.response.timeResponse = new Date();\n      additionalTrackingData.response.detail = selectedOptionText.join(',');\n      additionalTrackingData.id = _strWhatAssetID;\n      additionalTrackingData.choices = _.map(rawData.arrOptions, function(option, index) {\n        return {\n          'id': gomo.utility.convertNumberToCharacter(index),\n          'description': {\n            'en-GB': option.strOptionText\n          }\n        };\n      });\n\n      // Add answered question to topic\n      TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n        _objWhatAssetData,\n        rawData.additionalTrackingData\n      );\n\n      if (!BOO_PROGRESS_ON_CONFIRM_CLICK || this._strCurrTopicModel != 'assessment') {\n        if (isNaN(parseInt(rawData.strAttempts))) {\n          // alert(\"The number of attempts for this asset (id: \" +\n          // _objWhatAssetData.strObjID + \") is not currently a number. It is currently: \" +\n          // rawData.strAttempts + \". Please set the number of attempts to be an integer.\");\n          LOCALISER.l_alert('SFL_ATTEMPTS_VALUE_ERROR', [_objWhatAssetData.strObjID]);\n        }\n\n        if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT && this._strCurrTopicModel == 'assessment') {\n          rawData.strAttempts = 1;\n        }\n\n        var _arrActions;\n        var strAdditionalStyles;\n\n        if (_objWhatAssetData.booIsCorrect) {\n          _arrActions = rawData.arrCorrectActions;\n          strAdditionalStyles = 'correctFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_CorrectFeedbackSubScreenC';\n        } else if (\n          !_objWhatAssetData.booIsCorrect &&\n          (_objWhatAssetData.intUsersQuestionAttempts < rawData.strAttempts || unlimitedAttempts)\n        ) {\n          /*\n           * First incorrect response if...\n           * the anser is wrong\n           * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n           */\n          _arrActions = rawData.arrFirstIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        } else {\n          // Final incorrect response\n          _arrActions = rawData.arrFinalIncorrectActions;\n          strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n          strAdditionalStyles +=\n            ' ' +\n            ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n            '_IncorrectFeedbackSubScreenC';\n        }\n\n        if (\n          _objWhatAssetData.intUsersQuestionAttempts == rawData.strAttempts ||\n          _objWhatAssetData.booIsCorrect\n        ) {\n          this._showOptionCorrectness(_arrOptionDOMElements, _objScoreInfo);\n          this._deactivateButtons(_objWhatAssetData);\n          EM.trigger('questionMaxAttemptsReached');\n        } else {\n          this._showQuestionResetButton(_objWhatAssetData);\n        }\n\n        EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n        // Get the visible button to anchor certain subscreens to\n        var selectedButton = $(_domWhatAssetElement).find(\n          '.' + this._strSFLConfirmAnchorClass + '.visibleButtonC'\n        )[0];\n        if (_arrActions != 'null') {\n          var _objActionOptions = {};\n          _objActionOptions.objActions = _arrActions;\n          _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n          _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n          _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n          _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n          _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n          EM.trigger('processActions', _objActionOptions);\n        }\n\n        if (rawData.arrActions && rawData.arrActions.length && _objWhatAssetData.booComplete) {\n          ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n        }\n\n        if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n          EM.trigger('showNextButtonFromAsset');\n        }\n      } else {\n        EM.trigger('goToPage', '1');\n      }\n    } else {\n      // alert(\"Please select an option before selecting confirm.\");\n      LOCALISER.l_alert('SFL_CONFIRM_ERROR');\n    }\n  },\n\n  is_sfl_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _scoreSFLAsset: function(_objWhatAssetData, _objOptionStates) {\n    var _arrRawOptionData = _objWhatAssetData.objRawData.arrOptions;\n    var _arrOptionCorrectness = [];\n\n    var count = 0;\n    var _intCorrect = 0;\n    var _intWrong = 0;\n    while (count < _arrRawOptionData.length) {\n      var _objCurrRawOption = _arrRawOptionData[count];\n      if (\n        (_objCurrRawOption.booIsCorrect && _objOptionStates[count]) ||\n        (!_objCurrRawOption.booIsCorrect && !_objOptionStates[count])\n      ) {\n        _intCorrect++;\n        _arrOptionCorrectness[count] = true;\n      } else {\n        _intWrong++;\n        _arrOptionCorrectness[count] = false;\n      }\n      count++;\n    }\n\n    if (_intCorrect == 0) {\n      return {\n        booIsCorrect: false,\n        strCorrectness: 'incorrect',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    } else if (_intCorrect > 0 && _intWrong > 0) {\n      return {\n        booIsCorrect: false,\n        strCorrectness: 'partiallyCorrect',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    } else if (_intCorrect == _arrRawOptionData.length && _intWrong == 0) {\n      return {\n        booIsCorrect: true,\n        strCorrectness: 'correct',\n        intCorrect: _intCorrect,\n        intWrong: _intWrong,\n        objOptionData: _arrRawOptionData,\n        arrOptionCorrectness: _arrOptionCorrectness,\n        objSelectedStates: _objOptionStates\n      };\n    }\n    // alert(\"ERROR: Uncaught score state of _intCorrect: '\" + _intCorrect +\n    // \"', _intWrong: '\" + _intWrong + \"' in SFL_ASSET_INTERACTIONS._scoreSFLAsset(), \" +\n    // \"extension_sfl_asset.js\");\n    LOCALISER.l_alert('SFL_UNCAUGHT_SCORE_PATTERN', [_intCorrect, _intWrong]);\n    return {booIsCorrect: false};\n  },\n\n  _doPostRenderShowActions_sfl_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n  },\n\n  // REFACTOR NOTE: Function seems un-used?\n  _disableSFLOptions: function(_arrOptionElements) {\n    var count = 0;\n    while (count < _arrOptionElements.length) {\n      if (_arrOptionElements[count].tagName.toUpperCase() == 'INPUT') {\n        _arrOptionElements[count].disabled = true;\n      }\n      count++;\n    }\n  },\n\n  // REFACTOR NOTE: Function seems un-used?\n  _disableSFLConfirm: function(_arrConfirmAnchor) {\n    var count = 0;\n    while (count < _arrConfirmAnchor.length) {\n      _arrConfirmAnchor[count].className += ' ' + this._strSFLConfirmDisableClass;\n      count++;\n    }\n  },\n\n  _returnFocusToSFLAsset: function(_domWhatAssetElement) {\n    var _domConfirmButton = CORE.getElementsByClassName(\n      _domWhatAssetElement,\n      this._strConfirmButtonClass\n    )[0];\n    _domConfirmButton.className = _domConfirmButton.className.replace(\n      this._strSFLConfirmDisableClass,\n      ''\n    );\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  getAccessibleElements_sfl: function() {\n    var accessibleElements = ['.sflOptionC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, SFL_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(95))},function(t,e){t.exports='/**\n* @title SFL asset extension collection\n* @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n* object literals via the O_EXTENDER object to be able to process the sfl asset\n* type.\n*\n* @author Johnathan Castle\n* @version 2.0 28/07/11\n*/\n\nvar objCurrSupportData =\n{\n\t"graphicalC":true,\n\t"accessibleC":true,\n\t"tabletC":true,\n\t"smartphoneC":true\n};\nASSET_RENDERER.addAssetSupportData("stateselector", objCurrSupportData);\n\nvar STATESELECTOR_ASSET_RENDERER =\n{\n\tstrObjID : "The stateselector asset inspector extension object",\n\n\t// ***************************** Property extensions *****************************\n\t_arrAssetHTMLTemplateIDs : [["stateselector","stateselectorAssetTemplateWrapperC"]],\n\t_arrSubAssetHTMLTemplateIDs : [["stateselectoroption","stateselectorAssetOptionTemplateWrapperC"]],\n\n\n\t// ***************************** Render methods extensions *****************************\n\t_render_stateselector_Asset : function (_objRenderData)\n\t{\n\t\tvar _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n\t\tvar _booPreviewMode = _objRenderData.booPreviewMode;\n\n\t\tvar _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\t\tif (this._objAssetTemplates[_objWhatRawAssetData["strType"]])\n\t\t{\n\t\t\tvar _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData["strType"]];\n\t\t\t_htmReturnData = _htmReturnData.replace("XXIMPORTEDSTYLEXX", _objWhatRawAssetData.strTextStyle + this._strImportedStyleSuffix);\n\n\t\t\tvar _htmOptionText = this._getStateSelectorOptionHTML(_objWhatAssetCourseObject, _objWhatRawAssetData);\n\t\t\t_htmReturnData = _htmReturnData.replace("XXSTATESELECTOROPTIONSXX", _htmOptionText);\n\n\t\t\tif (_booPreviewMode){\n\t\t\t\t_htmReturnData = _htmReturnData.replace(/XX_ASSET_ID_XX/g, "YY" + _objWhatRawAssetData["strID"] + "YYPreview");\n\t\t\t} else {\n\t\t\t\t_htmReturnData = _htmReturnData.replace(/XX_ASSET_ID_XX/g, "YY" + _objWhatRawAssetData["strID"] + "YY");\n\t\t\t}\n\t\t\t\n\t\t\t_htmReturnData = _htmReturnData.replace("XX_QUESTION_BUTTONS_XX", this._generateQuestionButtons(_objWhatRawAssetData, true));\n\t\t\treturn _htmReturnData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar _strDebugError = LOCALISER.get("STATESELECTOR_DEBUG_TEMPLATE_ERROR", [_objWhatRawAssetData["strType"]]);\n\t\t\tthis.debug(_strDebugError, 3);\n\n\t\t\t//return "ASSET ERROR: no template found, ID: " + _objWhatRawAssetData["strID"];\n\t\t\tvar _strReturnValue = LOCALISER.get("STATESELECTOR_RETURN_TEMPLATE_ERROR", [_objWhatRawAssetData["strID"]]);\n\t\t\treturn _strReturnValue;\n\t\t}\n\t},\n\n\t_getStateSelectorOptionHTML : function (_objWhatAssetCourseObject, _objWhatRawAssetData)\n\t{\n\t\tif (this._objSubAssetTemplates[_objWhatRawAssetData["strType"] + "option"])\n\t\t{\n\t\t\tvar _htmReturnData = "";\n\t\t\tvar count = 0;\n\t\t\twhile (count < _objWhatRawAssetData.arrOptions.length)\n\t\t\t{\n\t\t\t\tvar _objCurrOption = _objWhatRawAssetData.arrOptions[count];\n\t\t\t\tvar _htmOptionTemplate = this._objSubAssetTemplates[_objWhatRawAssetData["strType"] + "option"];\n\t\t\t\t_htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONNUMXX/g, (count + 1));\n\t\t\t\t_htmOptionTemplate = _htmOptionTemplate.replace(/XXOPTIONTEXTXX/g, this.insertFormattedHtml(_objCurrOption.strOptionText));\n\t\t\t\t_htmOptionTemplate = _htmOptionTemplate.replace("XXOPTIONVALUEXX", _objCurrOption.strOptionValue);\n\t\t\t\t_htmReturnData += _htmOptionTemplate;\n\t\t\t\tcount++;\n\t\t\t}\n\t\t\treturn _htmReturnData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//this.debug("STATESELECTOR_ASSET_RENDERER._getStateSelectorOptionHTML(), ERROR: Unknown asset type of " + _objWhatRawAssetData["strType"] + ".", 3);\n\t\t\tvar _strDebugError = LOCALISER.get("STATESELECTOR_DEBUG_OPTION_TEMPLATE_ERROR", [_objWhatRawAssetData["strType"]]);\n\t\t\tthis.debug(_strDebugError, 3);\n\n\t\t\t//return "ASSET ERROR: no template found, ID: " + _objWhatRawAssetData["strID"];\n\t\t\tvar _strReturnValue = LOCALISER.get("STATESELECTOR_RETURN_OPTION_TEMPLATE_ERROR", [_objWhatRawAssetData["strID"]]);\n\t\t\treturn _strReturnValue;\n\t\t}\n\t}\n}\n\nO_EXTENDER.extend(ASSET_RENDERER, STATESELECTOR_ASSET_RENDERER);\n\n\nvar STATESELECTOR_ASSET_INTERACTIONS =\n{\n\tstrObjID : "The state selector asset interactions extension object",\n\n\t// _strSFLOptionClass : "sflOptionC",\n\t// _strSFLConfirmAnchorClass : "contentButtonNormC",\n\t// _strSFLConfirmDisableClass : "confirmButtonDisabledC",\n\n\t//{\'strAssetID\':\'XX_ASSET_ID_XX\', \'strOptionIndex\':\'XXOPTIONNUMXX\'}\n\thandleEvent_stateselectorOptionClicked : function(_objWhatOptionData)\n\t{\n\t\tvar _objWhatAssetData = this.getAssetData(_objWhatOptionData[\'strAssetID\']);\n\t},\n\n\t\n\n\tis_stateselector_AssetCompletable : function (_objWhatAssetData)\n\t{\n\t\treturn true;\n\t},\n\n\t_doPostRenderShowActions_stateselector_Asset : function (_objWhatAssetData)\n\t{\n\t\tvar me = this;\n\t\tvar rawAssetData = _objWhatAssetData.objRawData;\n\t\tvar assetId = ASSET_RENDERER.getAssetWrapperDOMId(rawAssetData);\n  \t\tvar assetEl = ASSET_RENDERER._objCurrDOM.getElementById(assetId);\n\n  \t\t// Set the checkboxes from existing data\n  \t\tme.initialiseTheBoxes(rawAssetData, me.getResult(rawAssetData))\n\n  \t\t// Validate the values we set...\n  \t\tme.checkTheBoxes(rawAssetData);\n\n  \t\t// Get all the checkboxes...\n  \t\tvar checkboxes = $(assetEl).find(\'input:checkbox\');\n  \t\tvar $checkboxes = $(checkboxes);\n  \t\t\n  \t\t// Add event handlers to checkboxes...\n  \t\t$checkboxes.off(\'change\')\n  \t\t\t\t   .on(\'change\', function(){\n  \t\t\t\t\t\tvar result = me.checkTheBoxes(rawAssetData, this);\n  \t\t\t\t\t\tme.setResult(rawAssetData, result);\n  \t\t\t\t\t});\n\t},\n\n\tinitialiseTheBoxes: function(rawAssetData, values){\n\t\tvar me = this;\n\t\tvar assetId = ASSET_RENDERER.getAssetWrapperDOMId(rawAssetData);\n  \t\tvar assetEl = ASSET_RENDERER._objCurrDOM.getElementById(assetId);\n  \t\tvar checkboxes = $(assetEl).find(\'input:checkbox\');\n  \t\t// Do we have values and checkboxes...\n\t\tif(values && values.length && checkboxes && checkboxes.length){\n\t\t\t// Loop the checkboxes\n\t\t\tfor(var x=0; x<checkboxes.length; x++){\n\t\t\t\tvar $checkbox = $(checkboxes[x]);\n\t\t\t\tvar checkValue = $checkbox.val();\n\t\t\t\t// Check value...\n\t\t\t\tfor(var i=0; i<values.length; i++){\n\t\t\t\t\tvar currentValue = values[i];\n\t\t\t\t\tif(checkValue == currentValue){\n\t\t\t\t\t\t$checkbox.attr(\'checked\', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tcheckTheBoxes: function(rawAssetData, lastSelection){\n\t\tvar me = this;\n\t\tvar assetId = ASSET_RENDERER.getAssetWrapperDOMId(rawAssetData);\n  \t\tvar assetEl = ASSET_RENDERER._objCurrDOM.getElementById(assetId);\n  \t\tvar checked = $(assetEl).find(\'input:checkbox:checked\');\n\t\tvar min = +(rawAssetData.intMinOptions); \n\t\tvar max = +(rawAssetData.intMaxOptions); \n\t\tmin = isNaN(min) ? 0 : min;\n\t\tmax = isNaN(max) ? 6 : max;\n\n\t\tif(max < min){\n\t\t\tif(min == 0){\n\t\t\t\tmax = 0;\n\t\t\t} else {\n\t\t\t\tmax = min;\n\t\t\t}\n\t\t}\n\n\t\t// WE HAVE SELECTED MORE BOXES THAN WE SHOULD!\n\t\tif(checked.length > max){\n\t\t\tvar remove = checked.length - max;\n\t\t\tvar removed = 0;\n\t\t\tvar i = 0;\n\t\t\twhile(removed < remove && i != checked.length){\n\t\t\t\tif(lastSelection == undefined || checked[i] != lastSelection){\n\t\t\t\t\tremoved++;\n\t\t\t\t\t$(checked[i]).attr(\'checked\', false);\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\n\t\tchecked = $(assetEl).find(\'input:checkbox:checked\');\n\t\tvar result = [];\n\t\tfor(var i=0; i<checked.length; i++){\n\t\t\tresult.push($(checked[i]).val());\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tgetTrackingAttributes: function(rawAssetData){\n\t\treturn  {\n\t\t\ttrackingId: rawAssetData.strTrackingId || \'reportToStates\',\n\t\t\ttrackingName: rawAssetData.strTrackingName || \'exam\'\n\t\t}\n\t},\n\n\tsetResult: function(rawAssetData, result){\n\t\tvar me = this;\n\t\tvar trackingAttributes = me.getTrackingAttributes(rawAssetData);\n\t\tresult.unshift(trackingAttributes.trackingName);\n\t\tCONTENT_TRACKING.state.add(trackingAttributes.trackingId, result.join(\'-\'));\n\t\tCONTENT_TRACKING.saveState();\n\t},\n\n\tgetResult: function(rawAssetData){\n\t\tvar me = this;\n\t\tvar trackingAttributes = me.getTrackingAttributes(rawAssetData);\n\t\tvar result = CONTENT_TRACKING.state.get(trackingAttributes.trackingId) || \'\';\n\t\tresult = result.split(\'-\');\n\t\tif(result.length){\n\t\t\tresult.shift();\n\t\t\treturn result;\n\t\t}\n\t},\n\n\t\n\t_returnFocusTostateselectorAsset : function (_domWhatAssetElement)\n\t{\n\n\t}\n}\nO_EXTENDER.extend(ASSET_INTERACTIONS, STATESELECTOR_ASSET_INTERACTIONS);'},function(t,e,n){n(0)(n(97))},function(t,e){t.exports="/* global ASSET_INTERACTIONS, O_EXTENDER, CORE, ASSET_RENDERER, ASSET_INTERACTIONS */\n/* global TOPIC_INTERACTIONS, DECONTAMINATER, BOO_SHOW_CORRECTNESS_ICONS_ON_CONFIRM_CLICK */\n/* global EM, BOO_HIDE_NEXT_UNTIL_CONFIRM, $, LOCALISER, _, BOO_SINGLE_ATTEMPT_IN_ASSESSMENT */\n/* global VARIABLES_HOLDER, gomo */\n/**\n * @title input text asset extension collection\n * @description A series of objects designed to extend the ASSET_INSPECTOR and ASSET_RENDERER\n * object literals via the O_EXTENDER object to be able to process the inputtext asset type.\n *\n * @author Caroline Wilgar\n * @version 2.0 [25/05/2012]\n *\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('textinput', objCurrSupportData);\n\nvar TEXT_INPUT_ASSET_RENDERER = {\n  strObjID: 'The text input asset renderer extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['textAreaInput', 'textInputAssetTextAreaTemplateWrapperC'],\n    ['textInput', 'textInputAssetInputTemplateWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n  _render_textinput_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    _objWhatRawAssetData.additionalTrackingData = {\n      activity: {},\n      result: {},\n      response: {}\n    };\n\n    if (this._objAssetTemplates['textAreaInput'] || this._objAssetTemplates['textInput']) {\n      var _htmReturnData = this._objAssetTemplates['textAreaInput'];\n      if (_objWhatRawAssetData.strFormat === 'singleLine') {\n        _htmReturnData = this._objAssetTemplates['textInput'];\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_DEFAULT_INPUT_TEXT_XX',\n        VARIABLES_HOLDER.parseHTMLForVariableMarkup(_objWhatRawAssetData.strInitialText, true)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ROW_COUNT_XX',\n        this._textinputGetRowCount(_objWhatRawAssetData)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        'XX_QUESTION_BUTTONS_XX',\n        this._generateQuestionButtons(_objWhatRawAssetData, true)\n      );\n      _htmReturnData = _htmReturnData.replace(\n        /XX_ASSET_ID_XX/g,\n        'YY' + _objWhatRawAssetData['strID'] + 'YY'\n      );\n      return _htmReturnData;\n    } else {\n      this.debug(\n        'ASSET_RENDERER._renderTextInputAsset(), ERROR: Unknown asset type of ' +\n          _objWhatRawAssetData['strType'] +\n          '.',\n        3\n      );\n      return 'Asset Error, no template found, ID: ' + _objWhatRawAssetData['strID'];\n    }\n  },\n\n  _textinputGetRowCount: function(_objWhatRawAssetData) {\n    var intRowCount = 1;\n    if (_objWhatRawAssetData.strFormat === 'multiLine') {\n      intRowCount = 5;\n    }\n    return intRowCount;\n  }\n};\nO_EXTENDER.extend(ASSET_RENDERER, TEXT_INPUT_ASSET_RENDERER);\n\nvar TEXT_INPUT_ASSET_INTERACTIONS = {\n  strObjID: 'The text input asset interactions extension object',\n\n  _strTextAreaClass: 'textInputAreaC',\n  _strCorrectnessClass: 'correctnessMarkerC',\n\n  _performPreShowActions_textinput_Asset: function(assetData) {\n    var rawData = assetData.objRawData;\n    var assetElement = ASSET_RENDERER.getAssetDOMElement(rawData);\n    rawData.additionalTrackingData.response.timeAvailable = new Date();\n\n    // Check for subscreen actions and add the appropriate aria value\n    if (gomo.utility.checkForShowSubscreenAction(rawData.arrCorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFinalIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrFirstIncorrectActions)\n      || gomo.utility.checkForShowSubscreenAction(rawData.arrActions)) {\n      $(assetElement)\n        .find('.confirmButtonC')\n        .attr('aria-haspopup', 'dialog');\n    }\n  },\n\n  handleEvent_textInputChangeAttempted: function(_objWhatTextData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatTextData._strWhatAssetID);\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n    return true; // having return boo onkeydown seems to stop event entirely\n  },\n\n  handleEvent_textInputRemoveDefaultText: function(_objWhatTextData) {\n    var _objWhatAssetData = this.getAssetData(_objWhatTextData._strWhatAssetID);\n    var decomtaminatedTextValue = _objWhatTextData._domTextArea.value;\n    if (decomtaminatedTextValue == _objWhatAssetData.objRawData.strInitialText) {\n      _objWhatTextData._domTextArea.value = '';\n    }\n  },\n\n  handleEvent_textinputConfirmButtonClicked: function(_strWhatAssetID) {\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n    var _objRawData = _objWhatAssetData.objRawData;\n    var unlimitedAttempts = false;\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var _domTextArea = CORE.getElementsByClassName(_domWhatAssetElement, this._strTextAreaClass)[0];\n\n    if (_objRawData.strInitialText === _domTextArea.value) {\n      LOCALISER.l_alert('TEXTINPUT_NO_ATTEMPT');\n      return;\n    }\n\n    if (_objWhatAssetData.objRawData.strAttempts === '0') {\n      unlimitedAttempts = true;\n    }\n\n    if (!_objWhatAssetData.booInteractable) {\n      return false;\n    }\n\n    _objWhatAssetData.objOptionStates.textValue = _domTextArea.value;\n\n    if (_objWhatAssetData.objOptionStates.textValue) {\n      _objWhatAssetData.booInteractable = false;\n      _domTextArea.disabled = true;\n\n      _objWhatAssetData.intUsersQuestionAttempts++;\n\n      _objWhatAssetData.booIsCorrect = (\n        _objRawData.strCorrectAnswer == '' ||\n        this._textInputIsCorrect(\n          _objRawData.strCorrectAnswer,\n          _objWhatAssetData.objOptionStates.textValue\n        )\n      );\n      if (_objWhatAssetData.objRawData && _objWhatAssetData.objRawData.booAssessed === 'Yes') {\n        var additionalTrackingData = _objWhatAssetData.objRawData.additionalTrackingData;\n        additionalTrackingData.activity.type = 'fill-in';\n        additionalTrackingData.activity.correctResponses = _objRawData.strCorrectAnswer.split('||');\n        var associatedAsset = _objRawData.strAssociatedAssetId ?\n          ASSET_INTERACTIONS.getAssetData(_objRawData.strAssociatedAssetId)\n          :\n          null;\n        additionalTrackingData.activity.description =\n          ASSET_INTERACTIONS.getAssetContent(associatedAsset);\n        additionalTrackingData.activity.weighting = parseInt(_objRawData.strWeighting) || 1;\n        additionalTrackingData.result.detail =\n          _objWhatAssetData.booIsCorrect ? 'correct' : 'incorrect';\n        additionalTrackingData.response.timeResponse = new Date();\n        additionalTrackingData.response.detail = _objWhatAssetData.objOptionStates.textValue;\n        additionalTrackingData.id =_strWhatAssetID;\n\n        TOPIC_INTERACTIONS.addAnsweredQuestionAssetToTopic(\n          _objWhatAssetData,\n          _objWhatAssetData.objRawData.additionalTrackingData\n        );\n      }\n      if (BOO_SINGLE_ATTEMPT_IN_ASSESSMENT) {\n        _objWhatAssetData.objRawData.strAttempts = 1;\n      }\n      var strAdditionalStyles = null;\n      var _arrActions = null;\n      if (_objWhatAssetData.booIsCorrect) {\n        _arrActions = _objWhatAssetData.objRawData.arrCorrectActions;\n        strAdditionalStyles = 'correctFeedbackSubScreenC';\n        strAdditionalStyles +=\n          ' ' +\n          ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n          '_CorrectFeedbackSubScreenC';\n      } else if (\n        !_objWhatAssetData.booIsCorrect &&\n        (_objWhatAssetData.intUsersQuestionAttempts < _objWhatAssetData.objRawData.strAttempts ||\n          unlimitedAttempts)\n      ) {\n        /*\n        * First incorrect response if...\n        * the anser is wrong\n        * And the attempt is less that allowed attempt. Or the user has unlimited attempts\n        */\n        _arrActions = _objWhatAssetData.objRawData.arrFirstIncorrectActions;\n        strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n        strAdditionalStyles +=\n          ' ' +\n          ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n          '_IncorrectFeedbackSubScreenC';\n      } else {\n        // Final incorrect response\n        _arrActions = _objWhatAssetData.objRawData.arrFinalIncorrectActions;\n        strAdditionalStyles = 'incorrectFeedbackSubScreenC';\n        strAdditionalStyles +=\n          ' ' +\n          ASSET_INTERACTIONS.strClassPrefixAssetPosition(_objWhatAssetData) +\n          '_IncorrectFeedbackSubScreenC';\n      }\n\n      if (\n        _objWhatAssetData.intUsersQuestionAttempts == _objWhatAssetData.objRawData.strAttempts ||\n        _objWhatAssetData.booIsCorrect\n      ) {\n        this._deactivateButtons(_objWhatAssetData);\n        EM.trigger('questionMaxAttemptsReached');\n        this._textInputShowCorrectness(_objWhatAssetData, _domWhatAssetElement);\n      } else {\n        this._showQuestionResetButton(_objWhatAssetData);\n      }\n\n      this.setVariablesToGlobal(_objWhatAssetData);\n\n      EM.trigger('screenAssetInteracting', _objWhatAssetData);\n\n      var selectedButton = $(_domWhatAssetElement).find('.contentButtonNormC.visibleButtonC')[0];\n      if (_arrActions != 'null') {\n        var _objActionOptions = {};\n        _objActionOptions.objActions = _arrActions;\n        _objActionOptions.objOptionalExtraData = _objWhatAssetData;\n        _objActionOptions.objOptionalExtraData.strType = _objWhatAssetData.strAssetType;\n        _objActionOptions.objOptionalExtraData.strAdditionalStyles = strAdditionalStyles;\n        _objActionOptions.objOptionalExtraData.strAssetID = _objWhatAssetData.strObjID;\n        _objActionOptions.objOptionalExtraData.domLink = selectedButton;\n\n        EM.trigger('processActions', _objActionOptions);\n      }\n\n      if (_objRawData.arrActions && _objRawData.arrActions.length\n        && _objWhatAssetData.booComplete) {\n        ASSET_INTERACTIONS.processAssetActions(_objWhatAssetData);\n      }\n\n      if (BOO_HIDE_NEXT_UNTIL_CONFIRM) {\n        EM.trigger('showNextButtonFromAsset');\n      }\n    } else {\n      LOCALISER.l_alert('TEXTINPUT_NO_ATTEMPT');\n    }\n  },\n\n  _performLanguagePreprocess_textinput_Asset: function(_objWhatAssetData) {\n    var assetId = _objWhatAssetData.objRawData.strID;\n    var countTopic = 0;\n\n    gomo.translationManager.htmlDecodeAssetTranslations(_objWhatAssetData.strObjID, [\n      'strInitialText'\n    ]);\n\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {\n            id: assetId\n          });\n\n          // Translate answers to test against\n          if (found && found.strCorrectAnswer) {\n            _objWhatAssetData.objRawData.strCorrectAnswer = found.strCorrectAnswer;\n          }\n          // Translate text to return to on asset reset\n          if (found && found.strInitialText) {\n            _objWhatAssetData.objRawData.strInitialText = found.strInitialText;\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    if (_domWhatAssetElement) {\n      var _domTextArea = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strTextAreaClass\n      )[0];\n\n      _domTextArea.value = _objWhatAssetData.objRawData.strInitialText;\n    }\n  },\n\n  _reset_textinput_QuestionAsset: function(_strWhatAssetID) {\n    this._resetStandardQuestion(_strWhatAssetID);\n\n    var _objWhatAssetData = this.getAssetData(_strWhatAssetID);\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    var _domTextArea = CORE.getElementsByClassName(_domWhatAssetElement, this._strTextAreaClass)[0];\n\n    _domTextArea.value = _objWhatAssetData.objRawData.strInitialText;\n    _domTextArea.disabled = false;\n\n    this._showQuestionConfirmButton(_objWhatAssetData);\n  },\n\n  _textInputIsCorrect: function(strCorrectAnswers, strUserInput) {\n    var booCorrectInput = false;\n    var arrCorrectAnswers = strCorrectAnswers.split('||');\n    var decomtaminatedUserInput = gomo.utility.decodeHtml(strUserInput.toLowerCase());\n\n    var count = 0;\n    while (count < arrCorrectAnswers.length) {\n      var strCorrectAnswer = gomo.utility.decodeHtml(arrCorrectAnswers[count].toLowerCase());\n      if (strCorrectAnswer === decomtaminatedUserInput) {\n        booCorrectInput = true;\n        break;\n      }\n      count++;\n    }\n\n    return booCorrectInput;\n  },\n\n  _textInputShowCorrectness: function(objWhatAssetData, domCurrentAsset) {\n    if (BOO_SHOW_CORRECTNESS_ICONS_ON_CONFIRM_CLICK) {\n      var domCorrectnessMarker = CORE.getElementsByClassName(\n        domCurrentAsset,\n        this._strCorrectnessClass\n      )[0];\n      if (objWhatAssetData.booIsCorrect) {\n        $(domCurrentAsset).addClass('correct-option');\n        domCorrectnessMarker.className = domCorrectnessMarker.className.replace(\n          'unSetCorrectnessC',\n          'correctAnswerC'\n        );\n      } else {\n        $(domCurrentAsset).addClass('incorrect-option');\n        domCorrectnessMarker.className = domCorrectnessMarker.className.replace(\n          'unSetCorrectnessC',\n          'incorrectAnswerC'\n        );\n      }\n    }\n  },\n\n  showTEXTINPUTfeedback: function(_objWhatAssetData) {\n    if (\n      _objWhatAssetData.objRawData.arrFeedbackActions.length > 0 &&\n      _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters &&\n      _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters.strSubScreenID\n    ) {\n      EM.trigger('showSubScreen', {\n        strAssetID: _objWhatAssetData.strObjID,\n        strTargetSubScreenID:\n          _objWhatAssetData.objRawData.arrFeedbackActions[0].objParameters.strSubScreenID\n      });\n    }\n  },\n\n  is_textinput_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _decomtaminatedTextinputString: function(_strRaw) {\n    var objDecontaminaterResult = DECONTAMINATER.clean(_strRaw);\n\n    return objDecontaminaterResult.strText;\n  },\n\n  _viewQuestionAnswer_textinput_questionType: function(_objWhatAssetData) {\n    this.showTEXTINPUTfeedback(_objWhatAssetData);\n  },\n\n  _doPostRenderShowActions_textinput_Asset: function(_objWhatAssetData) {\n    TOPIC_INTERACTIONS.removeAnsweredQuestionAssetToTopic(_objWhatAssetData);\n    if (_objWhatAssetData.objRawData && _objWhatAssetData.objRawData.booAssessed === 'Yes') {\n      TOPIC_INTERACTIONS.addViewedQuestionAssetToTopic(_objWhatAssetData);\n    }\n    // Set asset id in element html for _scrollIntoView_Asset\n    var elementSelector =\n      '#' + ASSET_RENDERER.getAssetDOMId(_objWhatAssetData.objRawData) + ' textarea';\n    ASSET_INTERACTIONS._setScrollIntoView_Asset(\n      elementSelector,\n      _objWhatAssetData.objRawData.strID\n    );\n\n    var el = $(elementSelector);\n    if (el && el.length) {\n      // Trigger _scrollIntoView_Asset on clicking the textarea\n      el.click(function() {\n        ASSET_INTERACTIONS._scrollIntoView_Asset(this);\n      });\n      el.blur(function() {\n        ASSET_INTERACTIONS._scrollIntoViewReset_Asset();\n      });\n    }\n  },\n\n  _reset_textinput_Asset: function(_objWhatAssetData, _booFullReset) {\n    // Parse the string for special characters\n    _objWhatAssetData.objRawData.strInitialText = gomo.utility.decodeHtml(\n      _objWhatAssetData.objRawData.strInitialText\n    );\n\n    var _domWhatAssetElement = ASSET_RENDERER.getAssetDOMElement(_objWhatAssetData.objRawData);\n    if (_domWhatAssetElement) {\n      var _domTextArea = CORE.getElementsByClassName(\n        _domWhatAssetElement,\n        this._strTextAreaClass\n      )[0];\n\n      _domTextArea.value = _objWhatAssetData.objRawData.strInitialText;\n      _domTextArea.disabled = false;\n\n      this._resetUserQuestionAttempts(_objWhatAssetData);\n      this._showQuestionConfirmButton(_objWhatAssetData);\n      this._resetStandardQuestion(_objWhatAssetData.strObjID);\n      // Reset correctness markers and active confrim/reset.\n      $(_domWhatAssetElement).find('.correctnessMarkerC').removeClass().addClass(\n        'unSetCorrectnessC correctnessMarkerC'\n      );\n      $(_domWhatAssetElement).removeClass('correct-option incorrect-option');\n      this._activateButtons(_objWhatAssetData);\n    }\n  },\n\n  _returnFocusToTEXTINPUTAsset: function(_domWhatAssetElement) {\n    this._focusConfirmButton(_domWhatAssetElement);\n  },\n\n  _checkCompletion_textinput_Asset: function(_objWhatAssetData) {\n    return (_objWhatAssetData.intUsersQuestionAttempts >= _objWhatAssetData.objRawData.strAttempts\n      || _objWhatAssetData.booIsCorrect);\n  },\n\n  getAccessibleElements_textinput: function() {\n    var accessibleElements = ['.textInputAreaC', '.activeButtonC'];\n    return accessibleElements;\n  }\n};\nO_EXTENDER.extend(ASSET_INTERACTIONS, TEXT_INPUT_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(99))},function(t,e){t.exports="/* globals ASSET_RENDERER, BOO_APP_VERSION, BOO_USE_LOCAL_RESOURCES,\nMASTER_RENDERER, LOCALISER, OUTPUT_MODE_CHECKER, O_EXTENDER, EM, CORE, ANIMATOR_INTERFACE,\nINT_TRANSITION_TIMER, SCREEN_INTERACTIONS, SUB_SCREEN_INTERACTIONS, _, ASSET_INTERACTIONS,\n$, BOO_DYNAMIC_CONTINUOUS_SCROLLING, OBJ_REF, MediaElementPlayer, Media, mejs  */\n/**\n * @title AUDIO_PLAYER\n * @description This file is intended to server as a template for creating new assets.\n * Please replace the AUDIO with the new assets type e.g. for\n * the text asset, replace AUDIO with TEXT.\n *\n * @author Kasparas Galdikas\n * @version 2.0 25/01/12\n * @version 2.1 18/03/13 Add setTimeout to destroy on player objects.\n *   Double clicks were destroying players before they had loaded. JH\n *\n * REFACTOR NOTE: this needs to be cleaned up.\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('audioplayer', objCurrSupportData);\n\nvar AUDIO_PLAYER_ASSET_RENDERER = {\n  strObjID: 'The audio asset inspector extension object',\n\n  // ***************************** Property extensions *****************************\n  _arrAssetHTMLTemplateIDs: [\n    ['audioplayer', 'audioplayerAssetTemplateWrapperC'],\n    ['appAudioPlayerUi', 'appaudioplayerAssetTemplateWrapperC']\n  ],\n\n  // ***************************** Render methods extensions *****************************\n\n  _render_audioplayer_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _booPreviewMode = _objRenderData.booPreviewMode;\n\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n\n    if (this._objAssetTemplates[_objWhatRawAssetData['strType']]) {\n      var _strAssetType = _objWhatRawAssetData['strType'];\n\n      if (BOO_APP_VERSION) {\n        _strAssetType = 'appAudioPlayerUi';\n      }\n\n      var _htmReturnData = this._objAssetTemplates[_strAssetType];\n\n      if (BOO_APP_VERSION) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_CLEAN_XX/g,\n          _objWhatRawAssetData['strID']\n        );\n      }\n\n      if (_booPreviewMode) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YYPreview'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_ID_XX/g,\n          'YY' + _objWhatRawAssetData['strID'] + 'YY'\n        );\n      }\n\n      if (_objWhatRawAssetData.objAudioData.hiddenAsset) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_ASSET_VISIBILITY_XX/g,\n          'audioplayerAssetHiddenWrapperC'\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(/XX_ASSET_VISIBILITY_XX/g, '');\n      }\n\n      var arrControlOutput = [];\n      if (_objWhatRawAssetData.objControlDisplayOptions) {\n        var objControls = _objWhatRawAssetData.objControlDisplayOptions;\n        if (!objControls.playToggle) {\n          arrControlOutput.push('audioPlayerHiddenPlay');\n        }\n        if (!objControls.volumeMenuButton) {\n          arrControlOutput.push('audioPlayerHiddenVolume');\n        }\n        if (!objControls.progressControl) {\n          arrControlOutput.push('audioPlayerHiddenProgress');\n        }\n      }\n      if (arrControlOutput.length > 0) {\n        _htmReturnData = _htmReturnData.replace(\n          /XX_EXTRA_CLASSNAMES_XX/g,\n          arrControlOutput.join(' ')\n        );\n      } else {\n        _htmReturnData = _htmReturnData.replace(/XX_EXTRA_CLASSNAMES_XX/g, '');\n      }\n\n\n      var _strAudioPath;\n      if (BOO_USE_LOCAL_RESOURCES) {\n        _strAudioPath = gomo.utility.getSrcPath(_objWhatRawAssetData.objAudioData.strSrc);\n      } else {\n        _strAudioPath = MASTER_RENDERER.strInterfaceImagePath;\n      }\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_AUDIO_SRC_XX',\n        _strAudioPath + decodeURIComponent(_objWhatRawAssetData.objAudioData.strSrc)\n      );\n\n      var _htmTranscriptText = _objWhatRawAssetData.objAudioData.strTranscriptText;\n\n      if (_htmTranscriptText && _htmTranscriptText != '') {\n        _htmReturnData = _htmReturnData.replace(\n          'XX_AUDIO_TRANSCRIPT_XX',\n          ASSET_RENDERER.insertFormattedHtml(_htmTranscriptText)\n        );\n        _htmReturnData = _htmReturnData.replace('XX_TRANSCRIPT_VISIBILITY_XX', '');\n      } else {\n        _htmReturnData = _htmReturnData.replace('XX_AUDIO_TRANSCRIPT_XX', '');\n        _htmReturnData = _htmReturnData.replace(\n          'XX_TRANSCRIPT_VISIBILITY_XX',\n          'nonAudioAssetTranscriptC'\n        );\n      }\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get('AUDIO_PLAYER_DEBUG_TYPE_ERROR', [\n        _objWhatRawAssetData['strType']\n      ]);\n      this.debug(_strDebugError, 3);\n\n      var _strReturnValue = LOCALISER.get('AUDIO_PLAYER_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData['strID']\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  renderAudioPlayerElement: function(_objWhatRawAssetData, _htmAudioPlayer) {\n    var _strAudioPath;\n    if (BOO_APP_VERSION) {\n      _strAudioPath = OUTPUT_MODE_CHECKER.strAppFilePrefix\n       + gomo.utility.getSrcPath(_objWhatRawAssetData.objAudioData.strSrc);\n    } else if (BOO_USE_LOCAL_RESOURCES) {\n      _strAudioPath = gomo.utility.getSrcPath(_objWhatRawAssetData.objAudioData.strSrc);\n    } else {\n      _strAudioPath = MASTER_RENDERER.strInterfaceImagePath;\n    }\n\n    _htmAudioPlayer = _htmAudioPlayer.replace(\n      'XX_AUDIO_SRC_XX',\n      _strAudioPath + decodeURIComponent(_objWhatRawAssetData.objAudioData.strSrc)\n    );\n    _htmAudioPlayer = _htmAudioPlayer.replace(\n      'XX_ASSET_ID_XX',\n      'YY' + _objWhatRawAssetData['strID'] + 'YY'\n    );\n    return _htmAudioPlayer;\n  }\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, AUDIO_PLAYER_ASSET_RENDERER);\n\nvar AUDIO_PLAYER_ASSET_INTERACTIONS = {\n  strObjID: 'The audio asset interactions extension object',\n\n  // Pseudo public, used by Audio Renderer\n  objAudioPlayers: {},\n\n  _objAudioPlayerAnimationHandles: {},\n  _objDomAudioPlayerOuterWrapper: {},\n  _booAnimatingAudioPlayer: false,\n\n  _strAudioLayerSuffix: 'L',\n\n  _strAssetWrapperPrefix: 'audioplayerAsset_YY',\n  _strAudioWrapperPrefix: 'audioPlayerWrapper_YY',\n\n  _strAssetWrapperSuffix: 'YY_WrapperL',\n  _strAudioWrapperSuffix: 'YYL',\n  _strAudioTranscriptBtnPrefix: 'transcript',\n  _strAudioTranscriptBtnSuffix: 'BtnL',\n  _strAudioTranscriptContentWrapperSuffix: 'audioTranscriptContent',\n\n  _strAudioPlayerOuterWrapperID: '',\n\n  _booPopupVisible: false,\n  _objAnimateData: {},\n  _booPopupEverShown: false,\n\n  _booAudioAndroidTrustedOriginIssueShown: false,\n\n  _strJWPlayerURL: 'frameworks/player/audio-js/player.swf',\n\n  handleEvent_toggleAudioTranscript: function(_strWhatAssetID) {\n    var _domAudioTranscript = this._objWhatDOM.getElementById(\n      this._strAudioTranscriptContentWrapperSuffix + _strWhatAssetID + this._strAudioLayerSuffix\n    );\n\n    var _domTranscriptText;\n    if (!this._booAnimatingAudioPlayer) {\n      if (this._strCurrOutputMode != 'accessibleC') {\n        EM.trigger('updateAudioPlayerAnimationLock', true);\n\n        _domTranscriptText = CORE.getElementsByClassName(\n          _domAudioTranscript,\n          'transcriptTextC'\n        )[0];\n\n        /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n        * a global object in config. Then place an object at the top of this class\n        * with overrides. These overrides can then be altered per project with a\n        * config_override.js\n        **/\n        if (!this._booPopupEverShown) {\n          this._booPopupEverShown = true;\n        }\n\n        if (!this._booPopupVisible) {\n          // Show transcript\n          this._booPopupVisible = true;\n          _domAudioTranscript.style.display = 'block';\n\n          var _arrAnimations = [];\n          _arrAnimations[0] = {style: 'height', value: '1px'};\n          _arrAnimations[1] = {style: 'height', value: _domTranscriptText.offsetHeight};\n\n          this._objCurrentAnimator = ANIMATOR_INTERFACE;\n          var _strAnimateType = 'seekTo(1)';\n          var _intAnimateDuration = INT_TRANSITION_TIMER;\n          var _strOnComplete = 'audioPlayerAnimationComplete';\n          var _strTransition = 'elastic';\n\n          this._objAnimateData = this._objCurrentAnimator.objAnimate(\n            _strAnimateType,\n            _domAudioTranscript,\n            _arrAnimations,\n            _intAnimateDuration,\n            _strTransition,\n            _strOnComplete\n          );\n          this._objCurrentAnimator.animate(this._objAnimateData);\n        } else {\n          // Hide transcript\n          this._booPopupVisible = false;\n\n          this._objAnimateData.strType = 'seekTo(0)';\n          this._objCurrentAnimator.animate(this._objAnimateData);\n        }\n      } else {\n        if (_domAudioTranscript.offsetHeight < 1) {\n          _domTranscriptText = CORE.getElementsByClassName(\n            _domAudioTranscript,\n            'transcriptTextC'\n          )[0];\n          _domAudioTranscript.style.display = 'block';\n          _domAudioTranscript.style.height = _domTranscriptText.offsetHeight + 'px';\n        } else {\n          _domAudioTranscript.style.height = 0 + 'px';\n        }\n      }\n\n      // Toggle aria-expanded attribure\n      var buttonElement = $(\n        '#' +\n        this._strAudioTranscriptBtnPrefix +\n          _strWhatAssetID +\n          this._strAudioTranscriptBtnSuffix\n      );\n      if (!this._booPopupVisible) {\n        $(buttonElement).attr('aria-expanded', false);\n      } else {\n        $(buttonElement).attr('aria-expanded', true);\n      }\n    }\n  },\n\n  handleEvent_updateAudioPlayerAnimationLock: function(_booWhatState) {\n    this._booAnimatingAudioPlayer = _booWhatState;\n  },\n\n  handleEvent_audioPlayerAnimationComplete: function(_objOptions) {\n    var _strWhatElement = _objOptions.strWhatSubScreenElementID;\n    var _booAllAnimationsStill = true;\n\n    if (_booAllAnimationsStill) {\n      EM.trigger('updateAudioPlayerAnimationLock', false);\n      SCREEN_INTERACTIONS.refreshCurrentIScrollComponent();\n      SUB_SCREEN_INTERACTIONS.refreshCurrentIScrollComponent();\n    }\n    if (!this._booPopupVisible) {\n      var _domWhatElement = this._objWhatDOM.getElementById(_strWhatElement);\n      _domWhatElement.style.display = 'none';\n    }\n  },\n\n  handleEvent_stopAllAudio: function() {\n    for (var _strAssetID in this.objAudioPlayers) {\n      if (Object.prototype.hasOwnProperty.call(this.objAudioPlayers, _strAssetID)) {\n        var _objCurrAudio = this.objAudioPlayers[_strAssetID];\n\n        if (_objCurrAudio && _objCurrAudio.playing) {\n          try {\n            _objCurrAudio.pause();\n            _objCurrAudio.skipTo(0);\n            delete this.objAudioPlayers[_strAssetID];\n          } catch (e) {\n            // Do nothing\n          }\n        }\n      }\n    }\n  },\n\n  _performLanguagePreprocess_audioplayer_Asset: function(_objWhatAssetCourseObject) {\n    var assetId = _objWhatAssetCourseObject.objRawData.strID;\n    var countTopic = 0;\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {id: assetId});\n\n          // Rebuild the audio player so src and labels can change if the language has changed.\n          if (\n            found &&\n            found.objAudioData &&\n            found.objAudioData.strSrc &&\n            this.objAudioPlayers[assetId] &&\n            !_.isUndefined(this.objAudioPlayers[assetId].setSrc) &&\n            !_.isUndefined(this.objAudioPlayers[assetId].currentLanguage) &&\n            this.objAudioPlayers[assetId].currentLanguage !== gomo.translationManager.langCode\n          ) {\n            this.objAudioPlayers[assetId].remove();\n            var assetData = ASSET_INTERACTIONS.getAssetData(assetId);\n            this._initAudioPlayer(assetData.objRawData);\n          }\n\n          if (found) {\n            this.updateAudioAlignment(found);\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n  },\n\n  updateAudioAlignment: function(data) {\n    var audioElement = $('#audioplayerAsset_YY' + data.id + 'YY_WrapperL');\n    if (audioElement.length && typeof data.strAlignment !== 'undefined') {\n      audioElement[0].className =\n        audioElement[0].className.replace(/\\b[A-Za-z]*-alignC\\b/, '');\n      audioElement.addClass(data.strAlignment);\n    }\n  },\n\n  handleEvent_appAudioFakePlayForObjBuild: function(_strObjID) {\n    var _objCurrAudioData = this.objAudioPlayers[_strObjID];\n    if (_objCurrAudioData['booPlaying'] != true) {\n      _objCurrAudioData._objAudio.play();\n      setTimeout(function() {\n        _objCurrAudioData._objAudio.stop();\n      }, 0);\n    }\n  },\n\n  handleEvent_playAppAudio: function(_strObjID) {\n    var _objCurrAudioData = this.objAudioPlayers[_strObjID];\n    _objCurrAudioData['_domPlay'] = this._objWhatDOM.getElementById(\n      'appAudioPlay' + _strObjID + 'L'\n    );\n    _objCurrAudioData['_domPause'] = this._objWhatDOM.getElementById(\n      'appAudioPause' + _strObjID + 'L'\n    );\n    _objCurrAudioData['_domStop'] = this._objWhatDOM.getElementById(\n      'appAudioStop' + _strObjID + 'L'\n    );\n\n    if (_objCurrAudioData['booPlaying'] != true) {\n      _objCurrAudioData._objAudio.play();\n      _objCurrAudioData['booPlaying'] = true;\n      _objCurrAudioData['booPaused'] = false;\n\n      _objCurrAudioData['_domPlay'].className = 'appAudioPlayC activeC';\n      _objCurrAudioData['_domPlay'].style.display = 'none';\n      _objCurrAudioData['_domPause'].className = 'appAudioPauseC inactiveC';\n      _objCurrAudioData['_domPause'].style.display = 'inline-block';\n      _objCurrAudioData['_domStop'].className = 'appAudioStopC inactiveC';\n\n      this._currentPositionAppAudio(_strObjID);\n    }\n  },\n\n  handleEvent_pauseAppAudio: function(_strObjID) {\n    var _objCurrAudioData = this.objAudioPlayers[_strObjID];\n\n    if (_objCurrAudioData['booPlaying'] == true) {\n      _objCurrAudioData._objAudio.pause();\n      _objCurrAudioData['booPlaying'] = false;\n      _objCurrAudioData['booPaused'] = true;\n\n      _objCurrAudioData['_domPlay'].className = 'appAudioPlayC inactiveC';\n      _objCurrAudioData['_domPlay'].style.display = 'inline-block';\n      _objCurrAudioData['_domPause'].className = 'appAudioPauseC activeC';\n      _objCurrAudioData['_domPause'].style.display = 'none';\n      _objCurrAudioData['_domStop'].className = 'appAudioStopC inactiveC';\n\n      this._currentPositionAppAudio(_strObjID);\n    }\n  },\n\n  handleEvent_stopAppAudio: function(_strObjID) {\n    var _objCurrAudioData = this.objAudioPlayers[_strObjID];\n    if (_objCurrAudioData['booPlaying'] == true || _objCurrAudioData['booPaused'] == true) {\n      _objCurrAudioData._objAudio.stop();\n      _objCurrAudioData['booPlaying'] = false;\n      _objCurrAudioData['booPaused'] = false;\n\n      _objCurrAudioData['_domPlay'].className = 'appAudioPlayC inactiveC';\n      _objCurrAudioData['_domPlay'].style.display = 'inline-block';\n      _objCurrAudioData['_domPause'].className = 'appAudioPauseC inactiveC';\n      _objCurrAudioData['_domPause'].style.display = 'none';\n      _objCurrAudioData['_domStop'].className = 'appAudioStopC activeC';\n\n      this._currentPositionAppAudio(_strObjID);\n    }\n  },\n\n  playAudioAsset: function(options) {\n    if (this.objAudioPlayers[options.assetId]) {\n      var video = this.objAudioPlayers[options.assetId];\n      var time = video.media.currentTime;\n\n      try {\n        switch (options.actionType) {\n          case 'play':\n            // Add a play buffer to IE which sometimes starts too soon\n            if (OUTPUT_MODE_CHECKER.booIsIE()) {\n              // repeat with the interval to check for audio timer setup\n              var iePlayAudioCheck = setInterval(\n                function() {\n                  if (!isNaN(video.duration)) {\n                    video.play();\n                    video.media.setCurrentTime(time);\n                    clearInterval(iePlayAudioCheck);\n                  }\n                }, 20\n              );\n              // close the interval if it's not passed yet\n              setTimeout( function() {\n                clearInterval(iePlayAudioCheck);\n              }, 1000);\n            } else {\n              video.play();\n              video.media.setCurrentTime(time);\n            }\n            break;\n\n          case 'pause':\n            video.pause();\n            break;\n\n          case 'toggle':\n            if (video.media.paused) {\n              video.play();\n              /*\n              * Fix for IE to wait for the browser to start playing the video before it sets the\n              * currentTime\n              */\n              if (OUTPUT_MODE_CHECKER.booIsIE()) {\n                video.pause();\n                // repeat with the interval to check for audio timer setup\n                var ieToggleAudioCheck = setInterval(\n                  function() {\n                    if (!isNaN(video.duration)) {\n                      video.media.setCurrentTime(time);\n                      video.play();\n                      clearInterval(ieToggleAudioCheck);\n                    }\n                  }, 20\n                );\n                // close the interval if it's not passed yet\n                setTimeout( function() {\n                  clearInterval(ieToggleAudioCheck);\n                }, 1000);\n              } else {\n                video.setCurrentTime(time);\n              }\n            } else {\n              video.pause();\n            }\n            break;\n\n          default:\n            alert('Error, unknown audio option type : ' + options.actionType);\n        }\n        if (options.funCallBack) {\n          options.funCallBack();\n        }\n      } catch (err) {\n        alert('Error ' + options.actionType + 'ing audio asset ' + options.assetId + ' : ' + err);\n      }\n    }\n  },\n\n  is_audioplayer_AssetCompletable: function(_objWhatAssetData) {\n    return true;\n  },\n\n  _currentPositionAppAudio: function(_strObjID) {\n    var _objCurrAudioData = this.objAudioPlayers[_strObjID];\n    var _intIntervalDuration = 100;\n    if (_objCurrAudioData['booPlaying'] == true) {\n      _objCurrAudioData['currentPosition'] = setInterval(function() {\n        var _objCurrPlayer = ASSET_INTERACTIONS.objAudioPlayers[_strObjID]._objAudio;\n\n        // get media position\n        _objCurrPlayer.getCurrentPosition(\n          // success callback\n          function(_intPosition) {\n            if (_intPosition > -1) {\n              var _strTimer = ASSET_INTERACTIONS._cleanAppAudioTimer(_intPosition);\n              // Leave the console.log in as it can kick the refresh rate up on some devices\n              console.log(_strTimer);\n              ASSET_INTERACTIONS._objWhatDOM.getElementById(\n                'appAudioCurrentPosition' + _strObjID + 'L'\n              ).innerHTML = _strTimer;\n            }\n            if (_intPosition < (_intIntervalDuration - 99) / 1000) {\n              ASSET_INTERACTIONS._objWhatDOM.getElementById(\n                'appAudioCurrentPosition' + _strObjID + 'L'\n              ).innerHTML = '0:00';\n              _objCurrAudioData['booPlaying'] = false;\n              clearInterval(_objCurrAudioData['currentPosition']);\n            }\n          },\n          // error callback\n          function(e) {\n            console.log('Error getting pos=' + e);\n          }\n        );\n      }, _intIntervalDuration);\n    } else if (_objCurrAudioData['booPaused'] == true) {\n      clearInterval(_objCurrAudioData['currentPosition']);\n    } else {\n      clearInterval(_objCurrAudioData['currentPosition']);\n      ASSET_INTERACTIONS._objWhatDOM.getElementById(\n        'appAudioCurrentPosition' + _strObjID + 'L'\n      ).innerHTML = '0:00';\n    }\n  },\n\n  _cleanAppAudioTimer: function(_intPosition) {\n    var _strZeroPlaceholder = '';\n    var _intMinutes = Math.floor(_intPosition / 60);\n    var _intSeconds = Math.floor(_intPosition - _intMinutes * 60);\n    if (_intSeconds < 10) {\n      _strZeroPlaceholder = '0';\n    }\n    var _strTimer = _intMinutes + ':' + _strZeroPlaceholder + _intSeconds;\n\n    return _strTimer;\n  },\n\n  _initAudioPlayer: function(_objWhatAssetData) {\n    if (BOO_APP_VERSION) {\n      if (typeof this.objAudioPlayers[_objWhatAssetData.strID] == 'undefined') {\n        this._appAudioPlayer(_objWhatAssetData);\n      }\n    } else {\n      this._htmlAudioPlayer(_objWhatAssetData);\n    }\n  },\n\n  _appAudioPlayer: function(_objWhatAssetData) {\n    var _strAssetId =\n      this._strAssetWrapperPrefix + _objWhatAssetData['strID'] + this._strAssetWrapperSuffix;\n    var _domAssetWrapper = this._objWhatDOM.getElementById(_strAssetId);\n    var _domAudioPlayerWrapper = _domAssetWrapper.getElementsByClassName('audioPlayerC')[0];\n    _domAudioPlayerWrapper.className = 'audioPlayerC appAudioPlayerC';\n\n    var _strAppSrc = ASSET_RENDERER.renderAudioPlayerElement(_objWhatAssetData, 'XX_AUDIO_SRC_XX');\n\n    var _strCurrKey = _objWhatAssetData.strObjID;\n    // Create the audio object using phoneGap's Media API\n    this.objAudioPlayers[_strCurrKey] = {\n      _objAudio: new Media(\n        _strAppSrc,\n        // success callback\n        function() {\n          console.log('playAudio():Audio Success');\n        },\n        // error callback\n        function(err) {\n          alert('playAudio():Audio Error: ' + err.message);\n        }\n      )\n    };\n\n    var _objCurrAudioData = this.objAudioPlayers[_strCurrKey];\n\n    /* iOS Tablets stutter when trying to animate elements with 'audio' tags.\n    *  Reset a span here to audio after animation has happened.\n    */\n    _domAudioPlayerWrapper.innerHTML = ASSET_RENDERER.renderAudioPlayerElement(\n      _objWhatAssetData,\n      _domAudioPlayerWrapper.innerHTML\n    );\n\n    // Get audio file ready for duration\n    EM.trigger('appAudioFakePlayForObjBuild', _strCurrKey);\n\n    // Get duration\n    var counter = 0;\n    _objCurrAudioData['timerDuration'] = setInterval(function() {\n      counter = counter + 100;\n      var _strCurrKey = _objWhatAssetData.strObjID;\n      var _objCurrAudioData = ASSET_INTERACTIONS.objAudioPlayers[_strCurrKey];\n      var _objAudioPlayer = _objCurrAudioData._objAudio;\n\n      if (counter > 0) {\n        clearInterval(_objCurrAudioData['timerDuration']);\n      }\n      var _intDuration = _objAudioPlayer.getDuration();\n\n      if (_intDuration > 0) {\n        clearInterval(_objCurrAudioData['timerDuration']);\n        var _strDuration = ASSET_INTERACTIONS._cleanAppAudioTimer(_intDuration);\n        ASSET_INTERACTIONS._objWhatDOM.getElementById(\n          'appAudioDuration' + _strCurrKey + 'L'\n        ).innerHTML = _strDuration;\n      }\n    }, 1000);\n\n    if (_objWhatAssetData.objAudioData.booAutoplay == true) {\n      setTimeout(function() {\n        EM.trigger('playAppAudio', _strCurrKey);\n      }, 100);\n    }\n  },\n\n  _htmlAudioPlayer: function(_objWhatAssetData) {\n    var _strAudioPlayerID =\n      this._strAudioWrapperPrefix + _objWhatAssetData['strID'] + this._strAudioWrapperSuffix;\n\n    var _strAssetId =\n      this._strAssetWrapperPrefix + _objWhatAssetData['strID'] + this._strAssetWrapperSuffix;\n    var _domAssetWrapper = this._objWhatDOM.getElementById(_strAssetId);\n    /* If it's not renderered correctly, don't attempt to activate it.\n    the dom is empty on BB due to the prefix being wrong but BB doesn't\n    render a player anyway so it's moot. - JH */\n    if (!_domAssetWrapper) {\n      return;\n    }\n\n    var _domAudioPlayerWrapper = $(_domAssetWrapper).find('.audioPlayerC')[0];\n\n    /* iOS Tablets stutter when trying to animate elements with 'audio' tags.\n    *  Reset a span here to audio after animation has happened.\n    */\n    var _htmAudioPlayer =\n      '<audio  id=\"audioPlayerWrapper_XX_ASSET_ID_XXL\" src=\"XX_AUDIO_SRC_XX\" preload=\"auto\" ' +\n      'width=\"100%\"></audio>';\n    _domAudioPlayerWrapper.innerHTML = ASSET_RENDERER.renderAudioPlayerElement(\n      _objWhatAssetData,\n      _htmAudioPlayer\n    );\n\n    var _domAudioPlayer = this._objWhatDOM.getElementById(_strAudioPlayerID);\n    // If it's not renderer correctly, don't attempt to activate it (other processes should make the\n    // lack of renderer asset apperant).\n    if (!_domAudioPlayer) {\n      // alert(\"No tag?\")\n      return;\n    }\n\n    var _domTranscriptBtn = this._objWhatDOM.getElementById(\n      this._strAudioTranscriptBtnPrefix + 'YY' +\n        _objWhatAssetData['strID'] + 'YY' +\n        this._strAudioTranscriptBtnSuffix\n    );\n\n    if (_domTranscriptBtn) {\n      if (\n        (_objWhatAssetData['@transcriptaction'] && _objWhatAssetData['@transcriptaction'] != '') ||\n        (_objWhatAssetData['transcripttext'] && _objWhatAssetData['transcripttext'] != '')\n      ) {\n        _domTranscriptBtn.style.display = 'inline-block';\n      }\n    }\n\n    this._checkAudioAndroidTrustedOriginIssue();\n\n    var mediaElementOptions = {};\n    // Localise the player text.\n    mediaElementOptions.playText = gomo.localiser.get('AUDIO_PLAY_LABEL');\n    mediaElementOptions.pauseText = gomo.localiser.get('AUDIO_PAUSE_LABEL');\n    mediaElementOptions.muteText = gomo.localiser.get('AUDIO_MUTE_LABEL');\n    mediaElementOptions.unmuteText = gomo.localiser.get('AUDIO_UNMUTE_LABEL');\n    mejs.i18n.en['mejs.audio-player'] = gomo.localiser.get('AUDIO_PLAYER_LABEL');\n    mejs.i18n.en['mejs.volume-slider'] = gomo.localiser.get('AUDIO_VOLUME_SLIDER_LABEL');\n    // Set the player icon path.\n    mediaElementOptions.iconSprite = 'frameworks/framework-resources/mejs-controls.svg';\n    mediaElementOptions.success = function(mediaElement) {\n      _objWhatAssetData.booComplete = false;\n      if (mediaElement.addEventListener) {\n        mediaElement.addEventListener(\n          'play',\n          function() {\n            EM.trigger('screenAssetInteracting', _objWhatAssetData);\n          },\n          false\n        );\n        mediaElement.addEventListener(\n          'ended',\n          function() {\n            _objWhatAssetData.booComplete = true;\n            EM.trigger('screenAssetInteracting', _objWhatAssetData);\n            ASSET_INTERACTIONS.audioFinished(_objWhatAssetData);\n          },\n          false\n        );\n      }\n\n      // Add a zero tab index to the volume bar so it is included in the tab order.\n      $('.mejs__horizontal-volume-slider').attr('tabindex', 0);\n      // Remove offscreen elements as they are not required.\n      $('.mejs__offscreen').remove();\n\n      // Autoplay if selected, if in a continuous scroll topic and the current screen contains\n      // audio.\n      if (BOO_DYNAMIC_CONTINUOUS_SCROLLING && _objWhatAssetData.objAudioData.booAutoplay == true) {\n        var currScreenID = SCREEN_INTERACTIONS.strCurrentScreenId;\n        var parentScreenID = OBJ_REF.get(_objWhatAssetData.strID).objParent.strObjID;\n        if (currScreenID == parentScreenID) {\n          // Play the audio\n          mediaElement.play();\n        }\n      } else if (_objWhatAssetData.objAudioData.booAutoplay == true) {\n        mediaElement.play();\n      }\n    };\n\n    this.objAudioPlayers[_objWhatAssetData.strID] = new MediaElementPlayer(\n      _domAudioPlayer,\n      mediaElementOptions\n    );\n    // Store the current language so we don't translate again.\n    this.objAudioPlayers[_objWhatAssetData.strID].currentLanguage =\n      gomo.translationManager.langCode;\n\n    SCREEN_INTERACTIONS.refreshCurrentIScrollComponent();\n    SUB_SCREEN_INTERACTIONS.refreshCurrentIScrollComponent();\n  },\n\n  _checkAudioAndroidTrustedOriginIssue: function() {\n    if (OUTPUT_MODE_CHECKER.isAndroidDevice() && !BOO_USE_LOCAL_RESOURCES) {\n      if (!this._booAudioAndroidTrustedOriginIssueShown) {\n        alert(\n          'WARNING: You appear to be trying to play an audio file located on a remote server. Due' +\n          ' to limitations of the Android browser, this may fail. For best results, please set' +\n          ' the course to use local resources. _checkAndroidTrustedOriginIssue(),' +\n          ' extension_audio_asset.js'\n        );\n        this._booAudioAndroidTrustedOriginIssueShown = true;\n      }\n    }\n  },\n\n  _reset_audioplayer_Asset: function(_objWhatAssetData, _booFullReset) {\n    if (BOO_APP_VERSION) {\n      if (typeof this.objAudioPlayers[_objWhatAssetData.strObjID] != 'undefined') {\n        EM.trigger('stopAppAudio', _objWhatAssetData.strObjID);\n        this.objAudioPlayers[_objWhatAssetData.strObjID]._objAudio.release();\n        delete this.objAudioPlayers[_objWhatAssetData.strObjID];\n      }\n    } else {\n      if (this.objAudioPlayers[_objWhatAssetData.strObjID]) {\n        // REFACTOR NOTE: This isn't ideal, I'm unsure as to why a try catch is required here?\n        try {\n          var _objCurrAudio = this.objAudioPlayers[_objWhatAssetData.strObjID];\n          _objCurrAudio.setCurrentTime(0);\n          _objCurrAudio.pause();\n        } catch (e) {\n          // Do nothing\n        }\n      }\n\n      this._resetAudioTranscriptWrapper(_objWhatAssetData.strObjID);\n    }\n  },\n\n  _resetAudioTranscriptWrapper: function(_strWhatAssetID) {\n    if (!_strWhatAssetID) {\n      return false;\n    }\n\n    var _domAudioTranscript = this._objWhatDOM.getElementById(\n      this._strAudioTranscriptContentWrapperSuffix +\n        'YY' +\n        _strWhatAssetID +\n        'YY' +\n        this._strAudioLayerSuffix\n    );\n\n    if (_domAudioTranscript && this._booPopupVisible) {\n      this._booPopupVisible = false;\n\n      var _objCurrentAnimator = ANIMATOR_INTERFACE;\n      _objCurrentAnimator.animate(this._objAnimateData);\n    }\n\n    this._booPopupEverShown = false;\n  },\n\n  _doPostRenderShowActions_audioplayer_Asset: function(_objWhatAssetDataHolder) {\n    this._initAudioPlayer(_objWhatAssetDataHolder.objRawData);\n  },\n\n  _doPostRenderHideActions_audioplayer_Asset: function(_objWhatAssetDataHolder) {\n    this._reset_audioplayer_Asset(_objWhatAssetDataHolder, true);\n  },\n\n  _obscureForPopup_audioplayer_Asset: function(_objWhatAssetDataHolder) {\n    this._reset_audioplayer_Asset(_objWhatAssetDataHolder);\n  },\n\n  _restoreFromPopup_audioplayer_Asset: function(_objWhatAssetDataHolder) {\n    this._initAudioPlayer(_objWhatAssetDataHolder);\n  },\n\n  _checkCompletion_audioplayer_Asset: function(_objWhatAssetData) {\n    // If the asset completion can be tracked (is mediaElement Audio) then track properly\n    if (typeof _objWhatAssetData.objRawData.booComplete != 'undefined') {\n      return _objWhatAssetData.objRawData.booComplete;\n    }\n    return true;\n  },\n\n  audioFinished: function(_objAssetData) {\n    if (_objAssetData.completionActions && _objAssetData.completionActions.length) {\n      var actions = {\n        objActions: _objAssetData.completionActions,\n        objOptionalExtraData: _objAssetData\n      };\n      actions.objOptionalExtraData.strAssetID = _objAssetData.strID;\n      gomo.eventManager.legacy('processActions', actions);\n    }\n  },\n\n  _returnFocusToAUDIOPLAYERAsset: function(_domWhatAssetElement, _objAssetData) {\n    var objRawData = _objAssetData.objRawData;\n    var $asset = $(_domWhatAssetElement);\n    var playControlVisible = objRawData.objControlDisplayOptions.playToggle;\n    var transcriptText = objRawData.objAudioData.strTranscriptText;\n    if (playControlVisible) {\n      $asset.find('.mejs__playpause-button button').focus();\n      return;\n    }\n    if (transcriptText) {\n      $asset.find('.showTranscriptButtonC').focus();\n      return;\n    }\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, AUDIO_PLAYER_ASSET_INTERACTIONS);\n"},function(t,e,n){n(0)(n(101))},function(t,e){t.exports="/* globals ASSET_RENDERER, LOCALISER, O_EXTENDER, jQuery, _, ASSET_INTERACTIONS,\nTOPIC_STRUCTURE_PARSER */\n\n/**\n * @title The iFrame asset extension\n * @description This file contains the code requried to ernder the iFrame asset.\n *\n * @author Johnathan Castle\n * @version 2.0 24/06/14\n */\n\nvar objCurrSupportData = {\n  graphicalC: true,\n  accessibleC: true,\n  tabletC: true,\n  smartphoneC: true\n};\nASSET_RENDERER.addAssetSupportData('iframe', objCurrSupportData);\n\nvar IFRAME_ASSET_RENDERER = {\n  strObjID: 'The iFrame asset extension',\n  _arrAssetHTMLTemplateIDs: [['iframe', 'iframeAssetTemplateWrapperC']],\n\n  // ***************************** Render methods extensions *****************************\n  _render_iframe_Asset: function(_objRenderData) {\n    var _objWhatAssetCourseObject = _objRenderData.objWhatAssetCourseObject;\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    var _strDimensions;\n    if (this._objAssetTemplates[_objWhatRawAssetData.strType]) {\n      var _htmReturnData = this._objAssetTemplates[_objWhatRawAssetData['strType']];\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ASSET_ID_XX',\n        'YY' + _objWhatRawAssetData.strID + 'YY'\n      );\n\n      _strDimensions = this._generateRawWidth(_objWhatAssetCourseObject);\n      _htmReturnData = _htmReturnData.replace(\n        'class=\"iFrameAssetIFrameC\"',\n        'class=\"iFrameAssetIFrameC\"' + _strDimensions\n      );\n\n      _strDimensions = this._generateStyleWidth(_objWhatRawAssetData);\n      _htmReturnData = _htmReturnData.replace('iframeHolderC\"', 'iframeHolderC\" ' + _strDimensions);\n      _htmReturnData = _htmReturnData.replace('iframeLoaderC\"', 'iframeLoaderC\" ' + _strDimensions);\n\n      _htmReturnData = _htmReturnData.replace(\n        'XX_FRAME_STYLE_XX',\n        'iFrameBorder_' + _objWhatRawAssetData.strBorderType + '_C'\n      );\n\n      // Add alignment classname\n      _htmReturnData = _htmReturnData.replace(\n        'XX_ALIGNMENT_CLASS_XX',\n        _objWhatRawAssetData.strAlignment || ''\n      );\n\n      // Add frame name for screenreaders to use\n      var frameName = 'frame';\n      if (_objWhatRawAssetData.strLabel && _objWhatRawAssetData.strLabel.length) {\n        frameName = _objWhatRawAssetData.strLabel;\n      }\n      _htmReturnData = _htmReturnData.replace(\n        'XX_FRAME_NAME_XX', frameName\n      );\n\n      return _htmReturnData;\n    } else {\n      var _strDebugError = LOCALISER.get('HOT_TEXT_DEBUG_TEMPLATE_ERROR', [\n        _objWhatRawAssetData.strType\n      ]);\n      this.debug(_strDebugError, 3);\n\n      // return \"ASSET ERROR: no template found, ID: \" + _objWhatRawAssetData.strID;\n      var _strReturnValue = LOCALISER.get('HOT_TEXT_RETURN_TEMPLATE_ERROR', [\n        _objWhatRawAssetData.strID\n      ]);\n      return _strReturnValue;\n    }\n  },\n\n  _generateRawWidth: function(_objWhatAssetCourseObject) {\n    var _objWhatRawAssetData = _objWhatAssetCourseObject.objRawData;\n    var assetHeight = _objWhatRawAssetData.strHeight;\n    var assetId = _objWhatRawAssetData.strID;\n    var _strDimensions = '';\n    // The child iframe is always 100% the width of it's parent style width\n    _strDimensions += ' width=\"100%\"';\n\n    var heightInPx = null;\n    if (typeof _objWhatRawAssetData.strAspectRatio !== 'undefined'\n      && _objWhatRawAssetData.strAspectRatio !== 'freeform'\n      && _objWhatRawAssetData.strAspectRatio.indexOf(':')>0) {\n      var ratioList = _objWhatRawAssetData.strAspectRatio.split(':');\n      var heightPercentageFromRatio = ratioList[1]/ratioList[0]*100;\n      _objWhatAssetCourseObject.heightPercentageFromRatio = heightPercentageFromRatio;\n    } else if (_objWhatRawAssetData.strHeightUnit == 'px') {\n      _strDimensions += ' height=\"' + assetHeight + '\" ';\n    } else {\n      heightInPx = this.getHeightFromPercentage(assetHeight, assetId);\n      _strDimensions += ' height=\"' + heightInPx + '\" ';\n    }\n    return _strDimensions;\n  },\n\n  _generateStyleWidth: function(_objWhatRawAssetData) {\n    var assetWidth = _objWhatRawAssetData.strWidth;\n    var assetHeight = _objWhatRawAssetData.strHeight;\n    var assetId = _objWhatRawAssetData.strID;\n    var _strDimensions = '';\n\n    _strDimensions = 'style=\"';\n    if (_objWhatRawAssetData.strWidthUnit == 'px') {\n      _strDimensions += 'width:' + (assetWidth - 15) + 'px; ';\n    } else {\n      _strDimensions += 'width:' + assetWidth + '%; ';\n    }\n\n    var heightInPx = null;\n    if (typeof _objWhatRawAssetData.strAspectRatio !== 'undefined'\n      && _objWhatRawAssetData.strAspectRatio !== 'freeform'\n      && _objWhatRawAssetData.strAspectRatio.indexOf(':')>0) {\n      // Height based off ratio is set after render\n    } else if (_objWhatRawAssetData.strHeightUnit == 'px') {\n      _strDimensions += ' height:' + assetHeight + 'px;';\n    } else {\n      heightInPx = this.getHeightFromPercentage(assetHeight, assetId);\n      _strDimensions += ' height:' + heightInPx + 'px;';\n    }\n    _strDimensions += '\" ';\n    return _strDimensions;\n  },\n\n  /*\n  * Get the height percentage based off the current viewport height\n  */\n  getHeightFromPercentage: function(percentageOfViewport, assetId) {\n    var defaultPercentage = 50;\n    if (!jQuery.isNumeric(percentageOfViewport)) {\n      percentageOfViewport = defaultPercentage;\n      console.log('Warning - iFrame asset ' + assetId + ' % height is not correctly in data.');\n    }\n    var viewPortHeight = jQuery(window).height();\n    var heightInPx = viewPortHeight * percentageOfViewport;\n    heightInPx = heightInPx / 100;\n\n    return heightInPx;\n  },\n\n  booTerminal: true\n  // ***************************** Helper methods extensions *****************************\n};\n\nO_EXTENDER.extend(ASSET_RENDERER, IFRAME_ASSET_RENDERER);\n\nvar IFRAME_ASSET_INTERACTIONS = {\n  strObjID: 'The iframe embed asset interactions extension object',\n\n  is_iframe_AssetCompletable: function(_objWhatAssetData) {\n    return false;\n  },\n\n  _doPostRenderShowActions_iframe_Asset: function(_objWhatAssetDataHolder) {\n    if (_.isUndefined(_objWhatAssetDataHolder)) return;\n\n    if (gomo.outputChecker.currentMode === 'accessibleC') {\n      this._setHeightFromPercentageOfWidth(_objWhatAssetDataHolder);\n    }\n    if (\n      ASSET_INTERACTIONS.shouldAssetReset(_objWhatAssetDataHolder) ||\n      (\n        _objWhatAssetDataHolder.objParent &&\n        _objWhatAssetDataHolder.objParent.strObjType === 'subscreen'\n      )\n    ) {\n      this._showIframe(_objWhatAssetDataHolder);\n    }\n  },\n\n  _doPostRenderHideActions_iframe_Asset: function(_objWhatAssetDataHolder) {\n    if (_.isUndefined(_objWhatAssetDataHolder)) return;\n\n    if (\n      ASSET_INTERACTIONS.shouldAssetReset(_objWhatAssetDataHolder) ||\n      (\n        _objWhatAssetDataHolder.objParent &&\n        _objWhatAssetDataHolder.objParent.strObjType === 'subscreen'\n      )\n    ) {\n      this._hideIframe(_objWhatAssetDataHolder);\n    }\n  },\n\n  _performPreShowActions_iframe_Asset: function(_objWhatAssetDataHolder) {\n    this._setHeightFromPercentageOfWidth(_objWhatAssetDataHolder);\n    this._setIframeSrc(_objWhatAssetDataHolder);\n  },\n\n  _performLanguagePreprocess_iframe_Asset: function(_objWhatAssetCourseObject) {\n    var assetId = _objWhatAssetCourseObject.objRawData.strID;\n    var countTopic = 0;\n\n    if (gomo.translationManager.topicsData) {\n      // Check each topic\n      while (countTopic < gomo.translationManager.topicsData.length) {\n        if (\n          gomo.translationManager.topicsData[countTopic].topic &&\n          gomo.translationManager.topicsData[countTopic].topic.screens\n        ) {\n          var assets = gomo.translationManager.findAllAssets(\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          );\n          var found = _.findWhere(assets, {id: assetId});\n\n          // Create dropdown items based on options string\n          if (found && found.strTargetURL) {\n            found.strTargetURL = decodeURIComponent(found.strTargetURL);\n          }\n\n          if (found) {\n            break;\n          }\n        }\n        countTopic++;\n      }\n    }\n  },\n\n  _displayConditionsHide_iframe_Asset: function(assetData) {\n    // Set the iframe initialised property to false so that when it is shown again it will\n    // correctly set the src.\n    assetData.initialised = false;\n  },\n\n  _setIframeSrc: function(_objAssetData) {\n    var _strObjID = _objAssetData.strObjID;\n    var _strIframeWrapperID = 'iframeAsset_YY' + _strObjID + 'YY_WrapperL';\n\n    if (jQuery('#' + _strIframeWrapperID + ' iframe')[0]) {\n      _objAssetData.resetSrcUrl = jQuery('#' + _strIframeWrapperID + ' iframe')[0].src;\n\n      var domLoader = jQuery('#' + _strIframeWrapperID + ' .iframeLoaderC')[0];\n      domLoader.style.display = 'block';\n    }\n  },\n\n  /* REFACTOR NOTE: should this not be using the ANIMATOR_INTERFACE ? */\n  _showIframe: function(_objAssetData) {\n    var _strObjID = _objAssetData.strObjID;\n    var _strIframeWrapperID = 'iframeAsset_YY' + _strObjID + 'YY_WrapperL';\n    // If we have a pending hide then don't trigger it\n    _objAssetData.booShowIframe = true;\n\n    if (jQuery('#' + _strIframeWrapperID + ' iframe')[0]) {\n      jQuery('#' + _strIframeWrapperID + ' iframe')[0].src = decodeURIComponent(\n        _objAssetData.objRawData.strTargetURL\n      );\n      // Stop any hides that are setup to run if scrolling quickly on cont scroll\n      jQuery('#' + _strIframeWrapperID + ' iframe').stop(true, true);\n      jQuery('#' + _strIframeWrapperID + ' iframe').animate({opacity: 1}, 500);\n    }\n  },\n\n  /* REFACTOR NOTE: should this not be using the ANIMATOR_INTERFACE ? */\n  _hideIframe: function(_objAssetData) {\n    var _strObjID = _objAssetData.strObjID;\n    var _strIframeWrapperID = 'iframeAsset_YY' + _strObjID + 'YY_WrapperL';\n    _objAssetData.booShowIframe = false;\n\n    var domLoader = jQuery('#' + _strIframeWrapperID + ' .iframeLoaderC')[0];\n    if (domLoader) {\n      domLoader.style.display = 'none';\n    }\n\n    jQuery('#' + _strIframeWrapperID + ' iframe').animate({opacity: 0}, 300);\n\n    if (_objAssetData.resetSrcUrl) {\n      setTimeout(function() {\n        /*\n        * As we've set a timeout the element may have been removed by another process\n        * or the asset may have been set to show again from a continuous scroll topic\n        */\n        if (jQuery('#' + _strIframeWrapperID + ' iframe').length !== 0\n        && !_objAssetData.booShowIframe) {\n          jQuery('#' + _strIframeWrapperID + ' iframe')[0].src = _objAssetData.resetSrcUrl;\n        }\n      }, 1000);\n    }\n  },\n\n  /*\n  * Set the height percentage based off the current iframe width for a given aspect ratio\n  */\n  _setHeightFromPercentageOfWidth: function(_objAssetData) {\n    if (typeof _objAssetData.heightPercentageFromRatio == 'undefined') {\n      return;\n    }\n\n    var _strObjID = _objAssetData.strObjID;\n    var _strIframeWrapperID = 'iframeAsset_YY' + _strObjID + 'YY_WrapperL';\n    var iframeWidth = null;\n\n    var iframeElInner = jQuery('#' + _strIframeWrapperID + ' .iFrameAssetIFrameC');\n    var iframeElOuter = jQuery('#' + _strIframeWrapperID + ' .iframeHolderC');\n\n    iframeWidth = iframeElOuter.width();\n\n    if (iframeWidth) {\n      var heightInPx = iframeWidth * _objAssetData.heightPercentageFromRatio;\n      heightInPx = heightInPx / 100;\n      iframeElOuter.height(heightInPx);\n      iframeElInner.height(heightInPx);\n    }\n  },\n\n  _obscureForPopup_iframe_Asset: function(_objWhatAssetDataHolder) {},\n\n  _restoreFromPopup_iframe_Asset: function(_objWhatAssetDataHolder) {},\n\n  /*\n  * On IE destroying the iframe wont stop some video/audios from continuing to play in the\n  * background. We need to reset the source first\n  */\n  _reset_iframe_Asset: function(_objWhatAssetData, _booFullReset) {\n    var _strObjID = _objWhatAssetData.strObjID;\n    var _strIframeWrapperID = 'iframeAsset_YY' + _strObjID + 'YY_WrapperL';\n\n    // Make sure we have the trans.gif set otherwise it will be undefined and cause a Laravell\n    // whoops error popup\n    if (_objWhatAssetData.resetSrcUrl && typeof _objWhatAssetData.resetSrcUrl !== 'undefined') {\n      jQuery('#' + _strIframeWrapperID + ' iframe')[0].src = _objWhatAssetData.resetSrcUrl;\n    }\n  },\n\n  _checkCompletion_iframe_Asset: function() {\n    return true;\n  },\n\n  getAccessibleElements_iframe: function() {\n    var accessibleElements = ['.iframeAssetWrapperC', '.iFrameAssetIFrameC'];\n    return accessibleElements;\n  }\n};\n\nO_EXTENDER.extend(ASSET_INTERACTIONS, IFRAME_ASSET_INTERACTIONS);\n\nvar IFRAME_ASSET_PREPROCESSOR = {\n  strObjID: 'The iframe asset preparser extension object',\n\n  _preProcess_iframe_Asset: function(_objWhatRawAssetData, _objWhatParentScreenObject) {\n    return _objWhatRawAssetData;\n  },\n\n  booTerminal: true\n};\n\nO_EXTENDER.extend(TOPIC_STRUCTURE_PARSER, IFRAME_ASSET_PREPROCESSOR);\n"},function(t,e,n){n(0)(n(103))},function(t,e){t.exports="/* globals $, BOO_DYNAMIC_CONTINUOUS_SCROLLING, BOO_ALLOW_AUTOPLAY_VIDEOS, _, BOO_APP_VERSION,\nglobal, videojs_7_10_2, cordova, VIDEO_FULLWINDOW_MODE, OUTPUT_MODE_CHECKER */\n\n/**\n * The video asset responsible for displaying a video, captions and associated transcript.\n */\n(function() {\n  // Create new Video\n  var Video = gomo.Asset.extend({\n    /** ******************\n     ** ASSET extend overrides\n     ********************/\n\n    processData: function(data) {\n      var me = this;\n      me.isShown = false;\n      me.videoLoaded = false;\n      var rawData = data.objRawData;\n      rawData.assetId = rawData.strID;\n\n      // Set playback mode\n      rawData.thumbnailMode = me.isThumbnailMode();\n      if (rawData.thumbnailMode == false) {\n        rawData.htmlVideoMode = true;\n      }\n\n      rawData.hasSingleSubtitle = false;\n      if (rawData.objVideoData['strSubTitlesSrc'] != '') {\n        rawData.hasSingleSubtitle = true;\n        rawData.subtitlesSrc = gomo.utility.getSrcPath(rawData.objVideoData['strSubTitlesSrc']) +\n        decodeURIComponent(rawData.objVideoData['strSubTitlesSrc']);\n\n        // Get the current langauge data for setting subtitle links\n        var currentLanguage = gomo.translationManager.getCurrentLangCodeAndTitle();\n        currentLanguage.id = me.cleanupLanguageCode(currentLanguage.id);\n        rawData.currentLanguageCode = currentLanguage.id;\n        rawData.currentLanguageTitle = currentLanguage.title;\n      }\n\n      // Set data which didn't exist in old assets but is expected\n      if (!rawData.objControlDisplayOptions) {\n        rawData.objControlDisplayOptions = {};\n      }\n\n      rawData.hasLanguageSubtitles = false;\n      if (\n        typeof rawData.objLanguageSubtitles != 'undefined' &&\n        rawData.objLanguageSubtitles.length > 0\n      ) {\n        // Check that the src exist\n        var countSubtitles = 0;\n        while (countSubtitles < rawData.objLanguageSubtitles.length) {\n          if (rawData.objLanguageSubtitles[countSubtitles].strSrc !== '') {\n            // We only want to show one type of subtitle, so even if a single sub exists, this\n            // overrides it\n            rawData.hasSingleSubtitle = false;\n            rawData.hasLanguageSubtitles = true;\n            break;\n          }\n\n          countSubtitles++;\n        }\n\n        countSubtitles = 0;\n        while (countSubtitles < rawData.objLanguageSubtitles.length) {\n          var currentSubtitleData =\n            rawData.objLanguageSubtitles[countSubtitles];\n          // Only set the source if it's there\n          currentSubtitleData.subTitlesSrcExists = false;\n          if (currentSubtitleData.strSrc !== '') {\n            currentSubtitleData.subTitlesSrc =\n              rawData.objVideoData['strSubTitlesSrc'] +\n              gomo.utility.getSrcPath(currentSubtitleData.strSrc) +\n              decodeURIComponent(currentSubtitleData.strSrc);\n            currentSubtitleData.subTitlesSrcExists = true;\n          }\n\n          var langCodesAndTitles = gomo.translationManager.getAllLangCodesAndTitles();\n          var countLanguages = 0;\n          while (countLanguages < langCodesAndTitles.length) {\n            if (\n              langCodesAndTitles[countLanguages].id ==\n              currentSubtitleData.strLanguageCode\n            ) {\n              currentSubtitleData.languageTitle =\n                langCodesAndTitles[countLanguages].title;\n              currentSubtitleData.languageCode =\n                currentSubtitleData.strLanguageCode;\n              break;\n            }\n            countLanguages++;\n          }\n          // If the title wasn't found then remove it as we don't want to show languages that have\n          // been removed from the project\n          if (\n            typeof currentSubtitleData.languageTitle == 'undefined' ||\n            currentSubtitleData.languageTitle == ''\n          ) {\n            rawData.objLanguageSubtitles.splice(countSubtitles, 1);\n            // move down the array one position so we carry on at the right index on the next loop\n            countSubtitles--;\n          }\n\n          countSubtitles++;\n        }\n      }\n\n      // Set default video source or fallback video source\n      // Video source is dynamically made as translations may have updated the strSrc if we're\n      // interacting with it later\n      rawData.videoSrc = me.getVideoSrc();\n\n      if (me.showFallbackVideo()) {\n        rawData.showFallbackVideo = true;\n        rawData.fallbackVideoSrc =\n        gomo.utility.getSrcPath(rawData.objVideoData.strFallbackVideoSrc) +\n          decodeURIComponent(rawData.objVideoData.strFallbackVideoSrc) +\n          me.uniqueUrlSuffix();\n      }\n\n      // Set thumbnail if one exists\n      rawData.showThumbnail = false;\n      if (\n        rawData.objThumbnailData.strSrc !== null &&\n        rawData.objThumbnailData.strSrc !== ''\n      ) {\n        rawData.thumbnailSrc =\n        gomo.utility.getSrcPath(rawData.objThumbnailData.strSrc) +\n        decodeURIComponent(rawData.objThumbnailData.strSrc);\n        rawData.thumbnailAltText = decodeURIComponent(\n          rawData.objThumbnailData.strAltText\n        );\n        // Make sure the file exists in the resources to prevent browser errors\n        if (\n          gomo.fileManager.getImageProperties(\n            decodeURIComponent(rawData.objThumbnailData.strSrc)\n          ) !== false\n        ) {\n          rawData.showThumbnail = true;\n        }\n      }\n      // Set a default if one doesn't exist as \"thumbnailMode\" will require a background colour set\n      if (rawData.showThumbnail == false) {\n        rawData.defaultThumbnail = true;\n      }\n\n      // Set if transcripts should be shown\n      rawData.showTranscript = false;\n      if (\n        rawData.objVideoData.strTranscriptText ||\n        rawData.objVideoData.strTranscriptText !== ''\n      ) {\n        rawData.showTranscript = true;\n        rawData.transcriptContent = me.formatHTML(\n          rawData.objVideoData.strTranscriptText\n        );\n      }\n\n      rawData.videoType = 'mp4';\n\n      // Set mobile vs desktop mode for various template checks\n      rawData.isDesktopMode = true;\n      if (gomo.outputChecker.isSmartPhone() || gomo.outputChecker.isTablet()) {\n        rawData.isDesktopMode = false;\n      }\n\n      // Does this device support VideoJs\n      me.data.videoJsMode = me.isVideoJsCompatible();\n\n      me.translatedSrc = '';\n      me.translatedThumbnailSrc = '';\n    },\n\n    // Before we render the asset..\n    beforeRender: function() {\n      var me = this;\n      // Reset the element and data if we're rendering for the second time (display conditions)\n      if (me.videoJsSet && typeof me.videoJs == 'object') {\n        me.videoJs.dispose();\n        me.videoJsSet = false;\n      }\n    },\n\n    // Before the asset is shown...\n    beforeShown: function() {\n      var me = this;\n      if (!me.isShown) {\n        // Build videoJs object if required\n        me.initVideo();\n        // Hide video on first load for smoother animations\n        if (OUTPUT_MODE_CHECKER.strCurrentMode !== 'accessibleC') {\n          me.hideVideo();\n        }\n\n        // adjust source if we have a translation\n        if (me.translatedSrc.length > 0) {\n          me.setTranslatedSrc();\n        }\n        // adjust source if we have a translation\n        if (me.translatedThumbnailSrc.length > 0) {\n          me.setTranslatedThumbnailSrc();\n        }\n      }\n    },\n\n    /*\n     * If the language code is using an underscore this can cause issues on some browsers\n     * iOS will crash the webpage if 7 or more incorrect lang codes are set on a single video\n     */\n    cleanupLanguageCode: function(langCode) {\n      var cleanLanguage = langCode;\n      if (langCode && langCode.indexOf('_') > -1) {\n        cleanLanguage = langCode.replace('_', '-');\n      }\n      return cleanLanguage;\n    },\n\n    setTranslatedSrc: function() {\n      var me = this;\n\n      me.previousVideoSrc = me.translatedSrc;\n      // Change video source of we have a translation and VideoJS object exists\n      if (me.videoJs) {\n        me.videoJs.src(me.translatedSrc);\n        me.videoJs.currentTime(0);\n        me.videoJs.pause();\n      } else {\n        // Otherwise load the video object from within the assets element - not reliant on videoJs\n        try {\n          var videoEl = me.$el.find('video')[0];\n\n          if (typeof videoEl !== 'undefined') {\n            // Remove existing source\n            $(videoEl)\n              .find('source')\n              .remove();\n\n            var videoSource = document.createElement('source');\n            videoSource.type = 'video/mp4';\n            videoSource.src = me.translatedSrc;\n            videoEl.appendChild(videoSource);\n\n            videoEl.load();\n          }\n        } catch (err) {\n          if (global.LogManager) {\n            global.LogManager.add('ERROR', err);\n          } else {\n            console.log(err);\n          }\n          return;\n        }\n      }\n    },\n\n    setTranslatedThumbnailSrc: function() {\n      var me = this;\n      if (me.translatedThumbnailSrc.length) {\n        if (me.videoJs) {\n          me.videoJs.poster(me.translatedThumbnailSrc);\n        } else {\n          me.$el.find('video').attr('poster', me.translatedThumbnailSrc);\n        }\n      }\n    },\n\n    afterRenderShown: function() {\n      var me = this;\n\n      // Autoplay any videos which should be played\n      if (\n        me.data.objRawData.objVideoData.booAutoplay &&\n        BOO_ALLOW_AUTOPLAY_VIDEOS\n      ) {\n        // Some browsers (inc safari on Mac) haven't rewritten the element with VideoJS before\n        // attempting to play\n        setTimeout(function() {\n          me.playVideo();\n        }, 0);\n      }\n\n      if (!me.isShown) {\n        me.showVideo();\n      }\n    },\n\n    afterRenderHidden: function(opts) {\n      var me = this;\n      var animate = true;\n      var forceHide = false;\n\n      if (opts && typeof opts == 'object') {\n        animate = opts.hasOwnProperty('animations') ? opts.animations : true;\n        forceHide = opts.hasOwnProperty('forceHide') ? true : false;\n      }\n\n      // Force video to reset instantly if required because the video element will be removed if we\n      // let it animate.\n      if (forceHide) {\n        animate = false;\n      }\n\n      // Don't treat continuous scroll as seperate screens but do pause them.\n      if (!BOO_DYNAMIC_CONTINUOUS_SCROLLING) {\n        me.resetVideo(animate);\n        me.hideVideo(animate);\n      } else {\n        if (forceHide) {\n          me.resetVideo(false);\n        }\n        me.pauseVideo();\n      }\n\n      // Exit full screen - used to close iOS video player when orientation changes\n      $('video').each(function() {\n        if (this.webkitExitFullscreen && gomo.outputChecker.isIOSDevice()) {\n          this.webkitExitFullscreen();\n        }\n      });\n    },\n\n    // Set click events for asset elements\n    registerEvents: function() {\n      var me = this;\n      me.events = {\n        'click .showTranscriptButtonC': 'toggleTranscript',\n        'click .videoThumbInPageC': 'thumbnailSelected'\n      };\n\n      // Set gomoEvents\n      me.registerEvent('gomoVideoPlaying', me.eventVideoPlaying);\n      me.registerEvent(\n        'gomoVideoThumbnailSelected',\n        me.eventVideoThumbnailSelected\n      );\n\n      // Page visibility events\n      document.addEventListener('visibilitychange', function() {\n        me.pauseVideo();\n      });\n    },\n\n    isComplete: function() {\n      var me = this;\n      return me.data.isComplete;\n    },\n\n    isCompletable: function() {\n      return true;\n    },\n\n    translationPreprocess: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n\n      var assetId = rawData.strID;\n      var countTopic = 0;\n\n      me.translatedThumbnailSrc = '';\n\n      if (gomo.translationManager.topicsData) {\n        // Check each topic\n        while (countTopic < gomo.translationManager.topicsData.length) {\n          if (\n            gomo.translationManager.topicsData[countTopic].topic &&\n            gomo.translationManager.topicsData[countTopic].topic.screens\n          ) {\n            var assets = gomo.translationManager.findAllAssets(\n              gomo.translationManager.topicsData[countTopic].topic.screens\n            );\n            var found = _.findWhere(assets, {id: assetId});\n\n            if (found) {\n              if (found.objVideoData &&\n                  found.objVideoData.strSrc &&\n                  me.translatedSrc !== gomo.utility.getSrcPath(found.objVideoData.strSrc) +\n                  found.objVideoData.strSrc\n              ) {\n                me.translatedSrc = gomo.utility.getSrcPath(found.objVideoData.strSrc) +\n                found.objVideoData.strSrc;\n                me.setTranslatedSrc();\n              }\n              if (found.objThumbnailData &&\n                found.objThumbnailData.strSrc &&\n                me.translatedThumbnailSrc !==\n                gomo.utility.getSrcPath(found.objThumbnailData.strSrc) +\n                found.objThumbnailData.strSrc\n              ) {\n                me.translatedThumbnailSrc = gomo.utility.getSrcPath(found.objThumbnailData.strSrc) +\n                found.objThumbnailData.strSrc;\n                me.setTranslatedThumbnailSrc();\n              }\n              break;\n            }\n          }\n          countTopic++;\n        }\n      }\n    },\n\n    /** ******************\n     ** END\n     ********************/\n\n    /** ******************\n     ** BUILD videos\n     ********************/\n    globalVideoId: 'gomoVideo2El',\n    thumbnailClass: 'videoThumbInPageC',\n\n    initVideo: function() {\n      var me = this;\n\n      // Build videoJs object\n      if (me.data.videoJsMode && !me.videoJsSet) {\n        me.buildVideoJsObject();\n      } else if (me.data.objRawData.thumbnailMode) {\n        me.createGlobalVideoElement();\n      }\n\n      // We will need to set the listener each time we repurpose the video element\n      if (!me.data.objRawData.thumbnailMode && !me.videoInitialised) {\n        // Set event listeners\n        me.setVideoElementEventListeners();\n      }\n\n      // Set video control display options\n      me.setVideoControlDisplayOptions();\n\n      me.videoInitialised = true;\n    },\n\n    buildVideoJsObject: function() {\n      var me = this;\n      // for all desktop devices, let videoJs take over the style, even on touch devices/laptops\n      var nativeControls = false;\n      var controlBar = {};\n\n      // Disable pip, could be added to the control options in future if we find a use for it.\n      me.data.objRawData.objControlDisplayOptions.pictureInPictureToggle = false;\n\n      if (me.data.objRawData.objControlDisplayOptions) {\n        _.each(me.data.objRawData.objControlDisplayOptions, function(\n          optionValue,\n          optionName\n        ) {\n          var controlBarValue = true;\n          // sanitise option values so we have only true or false\n          try {\n            controlBarValue = gomo.utility.sanitiseBoolean(optionValue);\n          } catch (err) {\n            console.log(err);\n          }\n          // Older versions of this asset use volumeMenuButton, latest version uses volumePanel.\n          if (optionName === 'volumeMenuButton') {\n            optionName = 'volumePanel';\n          }\n          controlBar[optionName] = controlBarValue;\n        });\n      }\n\n      var videoJsOptions = {\n        techOrder: ['html5'],\n        customControlsOnMobile: true,\n        nativeControlsForTouch: nativeControls,\n        controlBar: controlBar\n      };\n\n      // Try and build the videoJs object, sometimes this will fail for various reasons\n      try {\n        me.videoJs = videojs_7_10_2(me.$el.find('video')[0], videoJsOptions);\n\n        if (!me.isFullscreenMode()) {\n          /*\n          * If VideoJS has disabled fullscreen mode\n          * we need to set new event listeners and enable the button\n          */\n          var fullscreenButton = me.$el.find('.vjs-fullscreen-control');\n          if (fullscreenButton.prop('disabled')) {\n            fullscreenButton.click(function(e) {\n              me.toggleFullscreenOverride(me);\n            } );\n            fullscreenButton.prop('disabled', false);\n            fullscreenButton.prop('aria-disabled', false);\n            fullscreenButton.removeClass('vjs-disabled');\n          }\n          me.videoJs.requestFullscreen = this.requestFullscreenVideoJsOverride;\n          me.videoJs.exitFullscreen = this.exitFullscreenVideoJsOverride;\n        }\n      } catch (err) {\n        if (global.LogManager) {\n          global.LogManager.add('ERROR', err);\n        } else {\n          console.log(err);\n        }\n        return;\n      }\n\n      // Only set the VideoJs Objects once\n      me.videoJsSet = true;\n    },\n\n    toggleFullscreenOverride: function(assetInstance) {\n      var me = assetInstance;\n      if (!me.videoJs.isFullscreen()) {\n        me.videoJs.requestFullscreen();\n      } else {\n        me.videoJs.exitFullscreen();\n      }\n    },\n\n    requestFullscreenVideoJsOverride: function() {\n      var videoJsInstance = this;\n      videoJsInstance.isFullscreen(true);\n      // fullscreen isn't supported so we'll just stretch the video element to\n      // fill the viewport\n      videoJsInstance.enterFullWindow();\n      videoJsInstance.trigger('fullWindowChange');\n      return videoJsInstance;\n    },\n\n    exitFullscreenVideoJsOverride: function() {\n      var videoJsInstance = this;\n      videoJsInstance.isFullscreen(false);\n      // fullscreen isn't supported so we'll just stretch the video element to\n      // fill the viewport\n      videoJsInstance.exitFullWindow();\n      videoJsInstance.trigger('fullWindowChange');\n      return videoJsInstance;\n    },\n\n    getVideoSrc: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n\n      var videoSrc = '';\n      var uniqueUrlSuffix = me.uniqueUrlSuffix();\n\n      videoSrc =\n        gomo.utility.getSrcPath(rawData.objVideoData.strSrc) +\n        decodeURIComponent(rawData.objVideoData.strSrc) +\n        uniqueUrlSuffix;\n\n      return videoSrc;\n    },\n\n    uniqueUrlSuffix: function() {\n      /* Chrome has issues destroying videos from memory when the page hasn't refreshed. This will\n    mean revisiting videos that\n    have been destroyed previously, will result in a stream error which never stops buffering.*/\n      var uniqueUrlSuffix = '';\n      if (gomo.outputChecker.browserTypeClass == 'chromeC') {\n        uniqueUrlSuffix = '?' + new Date().getTime();\n      }\n\n      return uniqueUrlSuffix;\n    },\n\n    setVideoElementEventListeners: function() {\n      var me = this;\n\n      // Add event listeners to video object\n      if (me.data.videoJsMode) {\n        me.videoJs.on('ended', function() {\n          me.videoFinished();\n        });\n        me.videoJs.on('play', function() {\n          // Switch the subtitles on if they've be switched on previously\n          var tracks = me.videoJs.textTracks();\n          if (tracks) {\n            me.setSubtitleEventListeners(tracks);\n          }\n          me.videoPlaying();\n        });\n\n        me.videoJs.on('fullWindowChange', function() {\n          if (me.videoJs.isFullscreen()) {\n            me.enterFullScreenVideoTriggered();\n            me.videoJs.el_.focus();\n          } else {\n            me.exitFullScreenVideoTriggered();\n          }\n        });\n      } else {\n        var videoElement = me.$el.find('.gomoVideoElement');\n        // Remove previous events as we don't want to play/end all instances of videos\n        // To-do this needs to be made more specific to only switch off the handlers added below\n        if (me.data.objRawData.thumbnailMode) {\n          videoElement.off();\n        }\n        videoElement.on('ended', function() {\n          me.videoFinished();\n        });\n        videoElement.on('play', function() {\n          // Switch the subtitles on if they've be switched on previously\n          var tracks = me.$el.find('video')[0].textTracks;\n          if (tracks) {\n            me.setSubtitleEventListeners(tracks);\n          }\n          me.videoPlaying();\n        });\n        videoElement.on('pause', function() {\n          me.setSubtitleStatus();\n        });\n\n        // Add fullscreen triggers to html5 video asset\n        videoElement.bind(\n          'webkitfullscreenchange mozfullscreenchange fullscreenchange',\n          function(e) {\n            var state =\n              document.fullScreen ||\n              document.mozFullScreen ||\n              document.webkitIsFullScreen;\n            var eventName = state ? 'FullscreenOn' : 'FullscreenOff';\n\n            if (eventName == 'FullscreenOn') {\n              me.enterFullScreenVideoTriggered();\n            } else {\n              me.exitFullScreenVideoTriggered();\n            }\n          }\n        );\n      }\n    },\n\n    setSubtitleEventListeners: function(tracks) {\n      var me = this;\n      var subtitleElPath = 'video track';\n      var eventType = 'cuechange';\n      if (me.data.videoJsMode) {\n        subtitleElPath = '.vjs-subs-caps-button .vjs-menu-item';\n        eventType = 'click';\n      }\n      var disableActiveTextTracks = function(tracks) {\n        for (var i = 0; i < tracks.length; i++) {\n          var track = tracks[i];\n          if (track.mode === 'showing') {\n            track.mode = 'disabled';\n            break;\n          }\n        }\n      };\n      // Sanitise video options if it's changed elsewhere\n      disableActiveTextTracks(tracks);\n\n      var setTrackListeners = function(me, tracks) {\n        me.$el.find(subtitleElPath).on(eventType, function(e) {\n          me.setSubtitleGlobal(tracks);\n        });\n      };\n      // Create listeners for subtitle triggers\n      setTrackListeners(me, tracks);\n      if (\n        gomo.config.autoSubtitles.enabled &&\n        gomo.config.autoSubtitles.language\n      ) {\n        // Enable subtitles if previously set\n        for (var i = 0; i < tracks.length; i++) {\n          var track = tracks[i];\n          if (\n            track.language &&\n            track.language === gomo.config.autoSubtitles.language\n          ) {\n            disableActiveTextTracks(tracks);\n            track.mode = 'showing';\n            break;\n          }\n        }\n      }\n    },\n\n    setSubtitleStatus: function() {\n      var me = this;\n      var tracks = null;\n      if (me.data.videoJsMode) {\n        tracks = me.videoJs.textTracks();\n      } else {\n        var videoEls = me.$el.find('video');\n        if (videoEls && videoEls.length > 0) {\n          tracks = me.$el.find('video')[0].textTracks;\n        }\n      }\n\n      if (tracks) {\n        me.setSubtitleGlobal(tracks);\n      }\n    },\n\n    setSubtitleGlobal: function(tracks) {\n      var shownTrackFound = false;\n      for (var i = 0; i < tracks.length; i++) {\n        var track = tracks[i];\n        // Check if a new or current selection is made\n        if (track.mode == 'showing') {\n          shownTrackFound = true;\n        }\n        // If a new lang, set the new autoSub\n        if (\n          track.mode === 'showing' &&\n          gomo.config.autoSubtitles.language !== track.language\n        ) {\n          gomo.config.autoSubtitles.enabled = true;\n          gomo.config.autoSubtitles.language = track.language;\n          console.log('Subtitles set to ' + track.language);\n        }\n      }\n      // Disable autoSub if no track is 'showing'\n      if (!shownTrackFound) {\n        gomo.config.autoSubtitles.enabled = false;\n        gomo.config.autoSubtitles.language = null;\n      }\n    },\n\n    setVideoControlDisplayOptions: function() {\n      var me = this;\n      if (me.data.objRawData.objControlDisplayOptions) {\n        var videoWrapperId = '#video2Asset_YY' + me.id + 'YY_WrapperL';\n        _.each(me.data.objRawData.objControlDisplayOptions, function(\n          value,\n          name\n        ) {\n          if (value === false) $(videoWrapperId).addClass(name + 'Hidden');\n        });\n      }\n    },\n\n    createGlobalVideoElement: function() {\n      var me = this;\n      var videoEl = $('#' + me.globalVideoId);\n\n      if (videoEl.length > 0) {\n        // Video already exists\n        return;\n      } else {\n        videoEl = document.createElement('video');\n        videoEl.id = me.globalVideoId;\n        videoEl.className = 'gomoVideoElement';\n\n        videoEl.style.display = 'none';\n        videoEl.style.opacity = '0';\n        document.getElementById('pageWrapperL').appendChild(videoEl);\n      }\n    },\n\n    createGlobalVideoSource: function(videoEl) {\n      var me = this;\n\n      // Remove existing source\n      $(videoEl).empty();\n\n      var videoSource = document.createElement('source');\n      videoSource.type = 'video/mp4';\n      videoSource.src = me.getVideoSrc();\n      // eslint-disable-next-line max-len\n      if (me.isProgressDisabledAndIOS()) {\n        videoEl.setAttribute('playsinline', '');\n        videoEl.removeAttribute('controls');\n      } else {\n        videoEl.removeAttribute('playsinline');\n        videoEl.setAttribute('controls', 'controls');\n      }\n      videoEl.appendChild(videoSource);\n    },\n\n    createGlobalVideoClosedCaptions: function(videoEl) {\n      var me = this;\n      var rawData = me.data.objRawData;\n      var videoTrack;\n\n      // if only a single caption\n      if (rawData.hasSingleSubtitle) {\n        videoTrack = document.createElement('track');\n        videoTrack.kind = 'subtitles';\n        videoTrack.srclang = me.cleanupLanguageCode(\n          rawData.currentLanguageCode\n        );\n        videoTrack.label = rawData.currentLanguageTitle;\n        rawData.subtitlesSrc = rawData.subtitlesSrc;\n        videoEl.appendChild(videoTrack);\n      } else if (rawData.hasLanguageSubtitles) {\n        // If multiple captions\n        var currentSubtitle;\n        for (currentSubtitle in rawData.objLanguageSubtitles) {\n          // Does the subtitle exist for this language?\n          if (\n            rawData.objLanguageSubtitles[currentSubtitle].subTitlesSrcExists\n          ) {\n            videoTrack = document.createElement('track');\n            videoTrack.kind = 'subtitles';\n            videoTrack.srclang = me.cleanupLanguageCode(\n              rawData.objLanguageSubtitles[currentSubtitle].languageCode\n            );\n            videoTrack.label =\n              rawData.objLanguageSubtitles[currentSubtitle].languageTitle;\n            videoTrack.src = rawData.objLanguageSubtitles[currentSubtitle].subTitlesSrc;\n            videoEl.appendChild(videoTrack);\n          }\n        }\n      }\n    },\n\n    /** ******************\n     ** END\n     ********************/\n\n    /** ******************\n     ** VIDEO interactions\n     ********************/\n    hideDuration: 300,\n    // The timer is divided by two as we're going to animate in the video and the thumbnail,\n    // linearly\n    thumbnailHideDuration: 150,\n\n    resetVideo: function(animate) {\n      var me = this;\n      var animateEls = typeof animate != 'undefined' ? animate : true;\n      me.isShown = false;\n\n      if (me.videoJs) {\n        // Save the current time and replace the video with a blank small video to let browsers\n        // free up connections\n        setTimeout(function() {\n          if (me.isVideoFinished) {\n            me.isVideoFinished = false;\n            me.gomoCurrentTime = 0;\n          } else {\n            me.gomoCurrentTime = me.videoJs.currentTime();\n          }\n          me.videoJs.currentTime(0);\n          me.videoJs.pause();\n          me.previousVideoSrc = me.videoJs.currentSrc();\n          // Reset the src to prevent videos hogging the 8 http connection limit\n          me.videoJs.src('/frameworks/player/video-js-2/blankvideo.mp4');\n        }, me.hideDuration);\n      } else {\n        me.pauseVideo();\n        me.setBlankVideo();\n      }\n\n      // Turn the thumbnail back on and hide the video, as the video is no longer active for this\n      // asset\n      if (\n        me.data.objRawData.thumbnailMode &&\n        $(me.el).find('#' + me.globalVideoId).length\n      ) {\n        if (animateEls) {\n          me.hideThumbnailVideo();\n          setTimeout(function() {\n            me.showThumbnail();\n            var videoEl = $('#' + me.globalVideoId);\n            videoEl.appendTo('#pageWrapperL');\n          }, me.thumbnailHideDuration);\n        } else {\n          me.hideThumbnailVideo(animateEls);\n          me.showThumbnail(animateEls);\n          var videoEl = $('#' + me.globalVideoId);\n          videoEl.appendTo('#pageWrapperL');\n        }\n      }\n    },\n\n    showVideo: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n\n      me.$el.animate({opacity: 1}, 500);\n\n      // Re-add the src after we reset it to prevent videos hogging the 8 http connection limit\n      if (me.videoJs && typeof me.previousVideoSrc !== 'undefined') {\n        me.videoJs.src(me.previousVideoSrc);\n        if (me.gomoCurrentTime) {\n          me.videoJs.currentTime(me.gomoCurrentTime);\n          me.videoJs.play();\n          // Play needs to run to get the thumbnail update, now we need to pause if it's not\n          // autoplay\n          if (\n            !(\n              me.data.objRawData.objVideoData.booAutoplay &&\n              BOO_ALLOW_AUTOPLAY_VIDEOS\n            )\n          ) {\n            me.videoJs.pause();\n          }\n        }\n      } else {\n        // If we reset the video src with blank we need to reset it.\n        me.pauseVideo();\n        var videoSourceElement = me.$el.find('source');\n        if (videoSourceElement.length > 0) {\n          var videoSrc = rawData.videoSrc;\n          if (me.translatedSrc && me.translatedSrc.length > 0) {\n            videoSrc = me.translatedSrc;\n          }\n          videoSourceElement.attr('src', videoSrc);\n          me.$el.find('video').load();\n          me.isShown = true;\n        }\n      }\n    },\n\n    setBlankVideo: function() {\n      var me = this;\n      var videoSource = me.$el.find('source');\n      if (\n        videoSource.length > 0 &&\n        videoSource.attr('src') !==\n          '/frameworks/player/video-js-2/blankvideo.mp4'\n      ) {\n        videoSource.attr('src', '/frameworks/player/video-js-2/blankvideo.mp4');\n        me.$el.find('video').load();\n      }\n    },\n\n    hideVideo: function(animate) {\n      var me = this;\n      var animationDuration = me.hideDuration;\n      if (animate == false) {\n        animationDuration = 0;\n      }\n      me.$el.animate({opacity: 0}, animationDuration);\n    },\n\n    hideThumbnailVideo: function(animate) {\n      var me = this;\n      var animateEls = true;\n      var animationDuration = me.thumbnailHideDuration;\n\n      if (animate == false) {\n        animateEls = false;\n        animationDuration = 0;\n      }\n      $('#' + me.globalVideoId).animate({opacity: 0}, animationDuration);\n\n      if (animateEls) {\n        setTimeout(function() {\n          $('#' + me.globalVideoId).css('display', 'none');\n        }, me.thumbnailHideDuration);\n      } else {\n        $('#' + me.globalVideoId).css('display', 'none');\n      }\n    },\n\n    hideThumbnail: function() {\n      var me = this;\n      me.$el\n        .find('.' + me.thumbnailClass)\n        .animate({opacity: 0}, me.thumbnailHideDuration);\n      setTimeout(function() {\n        me.$el.find('.' + me.thumbnailClass).css('display', 'none');\n      }, me.thumbnailHideDuration);\n    },\n\n    showThumbnail: function(animate) {\n      var me = this;\n      var animationDuration = me.thumbnailHideDuration;\n\n      if (animate == false) {\n        animationDuration = 0;\n      }\n\n      me.$el.find('.' + me.thumbnailClass).css('display', 'block');\n      me.$el\n        .find('.' + me.thumbnailClass)\n        .animate({opacity: 1}, animationDuration);\n    },\n\n    showThumbnailVideo: function() {\n      var me = this;\n\n      try {\n        var globalVideo = $('#' + me.globalVideoId);\n        var globalVideoElement = globalVideo[0];\n        me.createGlobalVideoSource(globalVideoElement);\n        me.createGlobalVideoClosedCaptions(globalVideoElement);\n        // Reload the video object after setting video and captions source\n        globalVideoElement.load();\n        globalVideo.prependTo(me.$el.find('.videoAssetWrapperC'));\n        globalVideo.css('display', 'block');\n        globalVideo.animate({opacity: 1}, me.thumbnailHideDuration);\n        me.setVideoElementEventListeners();\n        me.playVideo();\n      } catch (err) {\n        if (global.LogManager) {\n          global.LogManager.add('ERROR', err);\n        } else {\n          console.log(err);\n        }\n        return;\n      }\n    },\n\n    playVideo: function() {\n      var me = this;\n\n      // We may be in videoJs mode but not have built the videoJs object yet\n      if (me.data.videoJsMode) {\n        if (me.videoJs && me.videoJs.paused()) {\n          me.videoJs.play();\n        }\n      } else if (BOO_APP_VERSION) {\n        gomo.eventManager.legacy('appVideoPlay', me.getVideoSrc());\n      } else {\n        // We can't always assume that a video exist as we offer thumbnail replacments\n        try {\n          if (\n            me.$el.find('video').length > 0 &&\n            typeof me.$el.find('video')[0].play !== 'undefined'\n          ) {\n            me.$el.find('video')[0].play();\n          }\n        } catch (err) {\n          if (global.LogManager) {\n            global.LogManager.add('ERROR', err);\n          } else {\n            console.log(err);\n          }\n          return;\n        }\n      }\n    },\n\n    pauseVideo: function() {\n      var me = this;\n\n      // We can't always assume that a video exist as we offer thumbnail replacments\n      try {\n        // Pause videoJs if it isn't already paused\n        if (me.data.videoJsMode) {\n          if (me.videoJs && !me.videoJs.paused()) {\n            me.videoJs.pause();\n          }\n        } else {\n          if (\n            me.$el.find('video').length > 0 &&\n            typeof me.$el.find('video')[0].pause !== 'undefined'\n          ) {\n            me.$el.find('video')[0].pause();\n          }\n        }\n      } catch (err) {\n        if (global.LogManager) {\n          global.LogManager.add('ERROR', err);\n        } else {\n          console.log(err);\n        }\n        return;\n      }\n    },\n\n    toggleTranscript: function(e) {\n      var me = this;\n      var buttonElement = e.currentTarget;\n      var domTranscript = gomo.getElementsByClassName(\n        me.el,\n        'videoTranscriptC'\n      )[0];\n\n      if (\n        gomo.outputChecker.currentMode == 'tabletC' ||\n        gomo.outputChecker.currentMode == 'smartphoneC'\n      ) {\n        gomo.scrollManager.recycleScroller(domTranscript);\n        gomo.scrollManager.parseChildElements(domTranscript, true);\n      }\n\n      if (domTranscript.className.indexOf('hiddenVideoTranscriptC') > -1) {\n        // Change aria hidden attribute to false so transcript is available to screen readers\n        $(domTranscript).attr('aria-hidden', 'false');\n        domTranscript.className = domTranscript.className.replace(\n          'hiddenVideoTranscriptC',\n          'shownVideoTranscriptC'\n        );\n        $(buttonElement).attr('aria-expanded', true);\n      } else {\n        // Change aria hidden attribute to true so transcript is not available to screen readers\n        $(domTranscript).attr('aria-hidden', 'true');\n        domTranscript.className = domTranscript.className.replace(\n          'shownVideoTranscriptC',\n          'hiddenVideoTranscriptC'\n        );\n        $(buttonElement).attr('aria-expanded', false);\n      }\n      // REFACTOR NOTE : this is allowing for CSS transition to happen. We need a 'transition\n      // ended' fix in here for when people change the CSS value.\n      setTimeout(function() {\n        gomo.scrollManager.refreshScrollers();\n      }, 500);\n    },\n\n    /**\n     * @function thumbnailSelected\n     * @description - This function will use cordova to run android app playback,\n     * or use on video element to hotswap thumbnail images with a dynamic src attribute\n     */\n    thumbnailSelected: function() {\n      var me = this;\n\n      if (me.isAppVideoMode()) {\n        try {\n          var videoSource =\n            gomo.outputChecker.appDirFilePrefix + me.getVideoSrc();\n          cordova.exec(null, null, 'VideoPlayer', 'playVideo', [videoSource]);\n        } catch (err) {\n          if (global.LogManager) {\n            global.LogManager.add('ERROR', err);\n          } else {\n            console.log(err);\n          }\n          return;\n        }\n      } else {\n        /**\n         * Everything that's not an app uses this method.\n         * That include iOS which currently only allows 16 video objects in one browser session\n         */\n\n        // Firstly we need to stop any other instance of the globalVideoElement being used and free\n        // it up\n        gomo.eventManager.raise('gomoVideoThumbnailSelected');\n        // Next hide the current thumbnail\n        me.hideThumbnail();\n        /*\n         * Finally show the video - move to current assets wrapper, set the src and fade in\n         * Use a timeout to give the previous video time to hide\n         */\n        setTimeout(function() {\n          me.showThumbnailVideo();\n        }, me.thumbnailHideDuration);\n\n        // Refresh the scroller after all the animations have happened\n        setTimeout(function() {\n          gomo.scrollManager.refreshScrollers();\n        }, me.hideDuration);\n      }\n    },\n\n    /** ******************\n     ** END\n     ********************/\n\n    /** ******************\n     ** VIDEO events\n     ********************/\n\n    videoFinished: function() {\n      var me = this;\n      var rawData = me.data.objRawData;\n\n      me.data.isComplete = true;\n      me.isVideoFinished = true;\n      gomo.eventManager.legacy('screenAssetInteracting', me.data);\n\n      if (me.isProgressDisabledAndIOS()) {\n        var vid = me.$el.find('video')[0];\n        vid.setAttribute('controls', '');\n        vid.removeAttribute('playsinline');\n      }\n\n      if (rawData.completionActions && rawData.completionActions.length) {\n        // Exit fullscren before triggering any actions\n        if (\n          me.videoJs &&\n          me.videoJs.isFullscreen &&\n          me.videoJs.exitFullscreen &&\n          me.videoJs.isFullscreen()\n        ) {\n          me.videoJs.exitFullscreen();\n        } else if (\n          me.$el.find('video')[0] &&\n          me.$el.find('video')[0].webkitExitFullScreen\n        ) {\n          me.$el.find('video')[0].webkitExitFullScreen();\n        }\n\n        var actions = {\n          objActions: rawData.completionActions,\n          objOptionalExtraData: me.data\n        };\n        actions.objOptionalExtraData.strAssetID = me.id;\n        gomo.eventManager.legacy('processActions', actions);\n      }\n\n      if (\n        BOO_DYNAMIC_CONTINUOUS_SCROLLING &&\n        gomo.outputChecker.isAndroidDevice() &&\n        me.currentTime != 0\n      ) {\n        me.currentTime = 0;\n      }\n    },\n\n    videoPlaying: function() {\n      var me = this;\n      gomo.eventManager.raise('gomoVideoPlaying', me.data.objRawData);\n      gomo.eventManager.legacy('screenAssetInteracting', me.data);\n    },\n\n    eventVideoPlaying: function(evt) {\n      var me = this;\n      if (evt.strID == me.data.objRawData.strID) {\n        if (\n          BOO_DYNAMIC_CONTINUOUS_SCROLLING &&\n          gomo.outputChecker.isAndroidDevice() &&\n          me.currentTime\n        ) {\n          me.$el.find('video')[0].currentTime = me.currentTime;\n        }\n        return;\n      } else {\n        if (\n          BOO_DYNAMIC_CONTINUOUS_SCROLLING &&\n          gomo.outputChecker.isAndroidDevice() &&\n          me.$el.find('video')[0].currentTime != 0\n        ) {\n          me.currentTime = me.$el.find('video')[0].currentTime;\n          me.showVideo();\n        } else {\n          me.pauseVideo();\n        }\n      }\n    },\n\n    eventVideoThumbnailSelected: function() {\n      var me = this;\n\n      // If thumbnailMode and has thumbnail, release it for other asset to use\n      if (me.data.objRawData.thumbnailMode) {\n        var videoEl = me.$el.find('video');\n        if (videoEl.length > 0) {\n          // pause, clean up src, move to pageWrapper, ready for new src etc..\n          me.resetVideo();\n        }\n      }\n    },\n\n    enterFullScreenVideoTriggered: function() {\n      // Full screen video affect the screen scrolling so we need to switch it off\n      gomo.scrollManager.disableScreenSwitchFromScrolling();\n    },\n\n    exitFullScreenVideoTriggered: function() {\n      // Re-enable the screen loading\n      gomo.scrollManager.enableScreenSwitchFromScrolling();\n      gomo.scrollManager.restoreScrollPosition();\n    },\n\n    /** ******************\n     ** END\n     ********************/\n\n    /** ******************\n     ** Helpers\n     ********************/\n\n    showFallbackVideo: function() {\n      // All iOS and lower than 4.0 android, can't support soft subs\n      if (gomo.outputChecker.isIOSDevice()) {\n        return true;\n      } else if (gomo.outputChecker.isAndroidDevice()) {\n        if (gomo.outputChecker.getAndroidVersion() < 4.3) {\n          return true;\n        }\n      } else {\n        return false;\n      }\n    },\n\n    isFullscreenMode: function() {\n      if (\n        typeof VIDEO_FULLWINDOW_MODE !== 'undefined' &&\n        VIDEO_FULLWINDOW_MODE === 'screen'\n      ) {\n        return true;\n      }\n      return false;\n    },\n\n    isThumbnailMode: function() {\n      var me = this;\n\n      // Currently iOS is the only device which requires thumbnails. It has a 16 video limit where\n      // the 17th in a course will fail.\n      // PhantomJs also doesn't support the rendering of videos so show a thumbnail for those\n      if (\n        gomo.outputChecker.isIOSDevice() ||\n        me.isAppVideoMode() ||\n        window['callPhantom']\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    isAppVideoMode: function() {\n      if (BOO_APP_VERSION && gomo.outputChecker.isAndroidDevice()) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    isVideoJsCompatible: function() {\n      var me = this;\n      if (\n        BOO_APP_VERSION ||\n        gomo.outputChecker.isIOSDevice() ||\n        gomo.outputChecker.isWindowsPhone() ||\n        gomo.outputChecker.isAndroidDevice() ||\n        me.data.objRawData.thumbnailMode\n      ) {\n        return false;\n      } else {\n        return true;\n      }\n    },\n\n    isFlashMode: function() {\n      var me = this;\n      if (typeof me.el.getElementsByTagName('object')[0] != 'undefined') {\n        return true;\n      }\n      return false;\n    },\n\n    isProgressDisabledAndIOS: function() {\n      var me = this;\n\n      if (me.data.objRawData.objControlDisplayOptions) {\n        return (\n          me.data.objRawData.objControlDisplayOptions['progressControl'] ===\n            false && gomo.outputChecker.isIOSDevice()\n        );\n      }\n      return false;\n    },\n\n    getAccessibleElements: function() {\n      // Note: the video player changes tabindex anyway so we just need to add anything we add.\n      var accessibleElements = [\n        '.showTranscriptButtonC'\n      ];\n      return accessibleElements;\n    },\n\n    reset: function(forceReset) {\n      var me = this;\n\n      if (forceReset && gomo.outputChecker.isAndroidDevice()) {\n        me.resetVideo(false);\n      }\n    }\n\n    /** ******************\n     ** END\n     ********************/\n  });\n\n  // Register the new asset definition...\n  gomo.assetManager.register('video2', Video);\n})();\n"},function(t,e,n){n(0)(n(105))},function(t,e){t.exports="/**\n* @title\t\tAccessible Mode Toggle Button\n* @description\tThis object will toggle the button for accessible mode.\n*\n* @author\t\tJames Hough\n* @version\t\t2.0 14/03/24\n*/\n\nvar ACCESSIBLE_TOGGLE =\n{\n\tstrObjID : \"Accessible toggle button\",\n\tstrObjDescription : \"Toggle the Accessible Extra mode button.\",\n\n\t_objCurrDOM : null,\n\n\thandleEvent_primeDOMReferences : function (_objWhatContentDOM)\n\t{\n\t\tthis._objCurrDOM = _objWhatContentDOM;\n\t},\n\n\thandleEvent_navigationRendered : function (){\n\t\tthis.updateAccessibleButtonState();\n\t},\n\n\tupdateAccessibleButtonState: function(){\n\t\tvar _domAccessibleButton = ACCESSIBLE_TOGGLE._objCurrDOM.getElementById('accessibleVersionL');\n\t\tvar _domGraphicalButton = ACCESSIBLE_TOGGLE._objCurrDOM.getElementById('graphicalVersionL');\n\n\t\tif (_domGraphicalButton && _domAccessibleButton)\n\t\t{\n\t\t\tvar _strVisible = 'visibleC';\n\t\t\tvar _strHidden = 'hiddenC';\n\n\t\t\tif (OUTPUT_MODE_CHECKER.strCurrentMode == 'accessibleC')\n\t\t\t{\n\t\t\t\t_domAccessibleButton.className = _domGraphicalButton.className.replace(_strVisible, _strHidden);\n\t\t\t\t_domGraphicalButton.className = _domGraphicalButton.className.replace(_strHidden, _strVisible);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_domAccessibleButton.className = _domGraphicalButton.className.replace(_strHidden, _strVisible);\n\t\t\t\t_domGraphicalButton.className = _domGraphicalButton.className.replace(_strVisible, _strHidden);\n\t\t\t}\n\t\t}\n\t}\n}\n\nEM.register(ACCESSIBLE_TOGGLE);"},function(t,e,n){n(0)(n(107))},function(t,e){t.exports="/**\n* @title Animator Interface\n* @description animator_interface is used to add a layer between animation calls and animation APIs\n*\tCurrently Animtor_interface uses animator.js or move.js depending on the devices CSS capabilities.\n*\n* @author JamesH\n* @version 1.0 10-12-12\n* @version 2.0 20-12-12 - James Hough - Refresh CSS 'if statement' added to _preprocessMove for off screen elements not\n* rendering when animated on screen.\n* @REFACTOR NOTE: Genricise animate_interface to work with all animation types and directions through move and animate.\n* @REFACTOR NOTE: JC Could do to break aaprt functions, some are getting rather long!\n*/\n\nvar ANIMATOR_INTERFACE =\n{\n\t/************************** PLACEHOLDERS **************************/\n\tbooCSSCapable : null,\n\t_domCurrentElement : null,\n\t_arrAnimations : null,\n\t_strType : null,\n\t_objHashtableAnimations : {},\n\t_objHashtableStates : {},\n\n\t/************************* HANDLE EVENTS *************************/\n\thandleEvent_primeDOMReferences : function (_objWhatDOM)\n\t{\n\t\tif (!this._objCurrDOM)\n\t\t{\n\t\t\tthis._objCurrDOM = _objWhatDOM;\n\t\t}\n\t},\n\n\t/************************* PUBLIC METHODS *************************/\n\t/* Currently accpeted arguments\n\t * _strType: play() || seekTo(1) || seekTo(0) || reverse()\n\t * _strTransition : bounce || elastic || easeIn || easeInOut\n\t * _arrAnimations : left || top || bottom || right\n\t */\n\tobjAnimate : function (_strType, _domCurrentElement, _arrAnimations, _intAnimateDuration, _strTransition, _OnComplete, _strAnimationAsset, _objOptionalCallbackData)\n\t{\n\t\tvar _objAnimateData = {domCurrentElement:_domCurrentElement,\n\t\t\t    arrAnimations : _arrAnimations,\n\t\t\t    strType : _strType,\n\t\t\t    intAnimateDuration : _intAnimateDuration,\n\t\t\t    strTransition : _strTransition,\n\t\t\t    strAnimationAsset : _strAnimationAsset,\n\t\t\t    objOptionalCallbackData : _objOptionalCallbackData };\n\t\tif (typeof _OnComplete == \"string\")\n\t\t{\n\t\t\t_objAnimateData.strOnComplete = _OnComplete;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_objAnimateData.objOnComplete = _OnComplete;\n\t\t}\n\n\t\treturn _objAnimateData;\n\t},\n\n\tanimate : function (_objAnimateData)\n\t{\n\t\t//WBI.log(\"ANIMATOR_INTERFACE.animate() - About to start pre-processing animation code.\");\n\t\tif (this._isCSSCapable() && !BOO_FORCE_ANIMATE_API && OUTPUT_MODE_CHECKER.canHandleHardwareAnimation(_objAnimateData.strAnimationAsset))\n\t\t{\n\t\t\t//WBI.log(\"ANIMATOR_INTERFACE.animate() - Move choosen\");\n\t\t\tthis._preprocessMove(_objAnimateData);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//WBI.log(\"ANIMATOR_INTERFACE.animate() - Animator choosen\");\n\t\t\tthis._preprocessAnimator(_objAnimateData);\n\t\t}\n\t\t//WBI.log(\"ANIMATOR_INTERFACE.animate() - Finished pre-processing animation code.\");\n\t},\n\n\tstop : function (_domCurrentElementID)\n\t{\n\t\tif (this._isCSSCapable())\n\t\t{\n\t\t\t// REFACTOR NOTE: no out-fo-the-box 'stop' solution for move.js\tas CCS animations don't offer it\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._stopAnimator(_domCurrentElementID);\n\t\t}\n\t},\n\n\tgetState : function (_domCurrentElementID)\n\t{\n\t\tif (this._isCSSCapable())\n\t\t{\n\t\t\treturn this._objHashtableStates[_domCurrentElementID];\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this._objHashtableAnimations[_domCurrentElementID].state;\n\t\t}\n\t},\n\n\tresetElementForAnimation : function (_objAnimateData)\n\t{\n\t\tif (this._isCSSCapable() && OUTPUT_MODE_CHECKER.canHandleHardwareAnimation(_objAnimateData.strAnimationAsset))\n\t\t{\n\t\t\t_objAnimateData.domCurrentElement.style.webkitTransform = 'translate3d(0px, '+_objAnimateData.arrAnimations[0].value+'px, 0px)';\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (_objAnimateData.arrAnimations[0].style == 'top')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.top = _objAnimateData.arrAnimations[0].value + \"px\";\n\t\t\t}\n\t\t\telse if (_objAnimateData.arrAnimations[0].style == 'bottom')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.bottom = _objAnimateData.arrAnimations[0].value + \"px\";\n\t\t\t}\n\t\t\telse if (_objAnimateData.arrAnimations[0].style == 'margin-left')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.marginLeft = _objAnimateData.arrAnimations[0].value + \"px\";\n\t\t\t}\n\t\t}\n\t},\n\n\t/************************ PRIVATE METHODS *************************/\n\n\t/*********** MOVE METHODS ************/\n\n\t_preprocessMove : function (_objAnimateData)\n\t{\n\t\t// REFACTOR NOTE: change to switch case with error if type doesn't exist\n\t\t// TODO NOTE: Add .stop method.\n\n\t\tthis._performMoveAnimation(_objAnimateData);\n\n\t\t//update hashtable for animation handles later\n\t\tif (this._objHashtableStates[_objAnimateData.domCurrentElement.id] && this._objHashtableStates[_objAnimateData.domCurrentElement.id] == 1)\n\t\t{\n\t\t\tthis._objHashtableStates[_objAnimateData.domCurrentElement.id] = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._objHashtableStates[_objAnimateData.domCurrentElement.id] = 1;\n\t\t}\n\n\t\t/* CSS Refresh fix.\n\t\t* Some browsers (see OUTPUT_MODE_CHECK.cssDomRefreshFix for full list) aren't refreshing DOM's being 'transformed' from\n\t\t* off screen, on screen. The interval setting of a border on and off reminds the browser to render the div and fixes the fault.\n\t\t*/\n\t\tif ( OUTPUT_MODE_CHECKER.hasDomRefreshError() )\n\t\t{\n\t\t\tvar _strClass = 'border-top-color';\n\t\t\tvar _stringStyle = _objAnimateData.domCurrentElement.style[_strClass];\n\t\t\tif(!_stringStyle)\n\t\t\t{\n\t\t\t\tvar _objDefaultView = this._objCurrDOM.defaultView || window;\n\t\t\t\tif(_objDefaultView.getComputedStyle)\n\t\t\t\t{\n\t\t\t\t\t_stringStyle = _objDefaultView.getComputedStyle(_objAnimateData.domCurrentElement,'').getPropertyValue(_strClass);\n\t\t\t\t}\n\t\t\t\telse if(_objAnimateData.domCurrentElement.currentStyle)\n\t\t\t\t{\n\t\t\t\t\t_stringStyle = _objAnimateData.domCurrentElement.currentStyle[_strClass];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//console.log('Animator_interface.js is overriding ' + _objAnimateData.domCurrentElement.className + '\\'s CSS border in _preProcessMove().'); //'\n\n\t\t\t// REFACTOR NOTE: JC, Need to make sure this is cleaned up onunload!\n\t\t\tvar _funAndroidRefreshFix = setInterval(function()\n\t\t\t\t{\n\t\t\t\t\t_objAnimateData.domCurrentElement.style.cssText += ';border:solid red 1px';\n\t\t\t\t\t_objAnimateData.domCurrentElement.offsetHeight;\n\t\t\t\t\t_objAnimateData.domCurrentElement.style.cssText += ';border:none';\n\t\t\t\t}, 100);\n\n\t\t\tsetTimeout(function()\n\t\t\t\t{\n\t\t\t\t\tclearInterval(_funAndroidRefreshFix);\n\t\t\t\t}, 1000);\n\t\t}\n\t},\n\n\t_performMoveAnimation : function (_objAnimateData)\n\t{\n\t\tif (_objAnimateData.strType == \"play()\" || _objAnimateData.strMoveType == \"reverse()\")\n\t\t{\n\t\t\tthis._moveAnimateToDirection(_objAnimateData);\n\t\t}\n\t\telse if (_objAnimateData.strType == \"seekTo(1)\" || _objAnimateData.strType == \"seekTo(0)\")\n\t\t{\n\t\t\tthis._moveAnimateFromToDirection(_objAnimateData);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// TO LOCALISE\n\t\t\talert(\"ERROR: Unknown type of '\" + _objAnimateData.strType + \"' found in ANIMATOR_INTERFACE._performMoveAnimation(), animator_interface.js\")\n\t\t}\n\t},\n\n\t_moveAnimateToDirection : function (_objAnimateData)\n\t{\n\t\tvar intMoveDirectionFrom = null;\n\t\tvar intMoveDirectionTo = null;\n\n\t\tif (_objAnimateData.strType == \"play()\")\n\t\t{\n\t\t\tintMoveDirectionFrom = 0;\n\t\t\tintMoveDirectionTo = 1;\n\t\t}\n\t\telse if (_objAnimateData.strType == \"reverse()\")\n\t\t{\n\t\t\tintMoveDirectionFrom = 1;\n\t\t\tintMoveDirectionTo = 0;\n\t\t}\n\n\t\tif (_objAnimateData.arrAnimations[0].style == 'left' || _objAnimateData.arrAnimations[0].style == 'margin-left' || _objAnimateData.arrAnimations[0].style == 'right')\n\t\t{\n\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t.ease('in-out')\n\t\t\t\t.x(_objAnimateData.arrAnimations[intMoveDirectionTo].value)\n\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)});\n\t\t}\n\t\telse if (_objAnimateData.arrAnimations[0].style == 'top' || _objAnimateData.arrAnimations[0].style == 'bottom')\n\t\t{\n\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t.ease('in-out')\n\t\t\t\t.y(_objAnimateData.arrAnimations[intMoveDirectionTo].value)\n\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t.ease('in-out')\n\t\t\t\t.set(_objAnimateData.arrAnimations[0].style, _objAnimateData.arrAnimations[intMoveDirectionFrom].value + \"px\")\n\t\t\t\t.set(_objAnimateData.arrAnimations[1].style, _objAnimateData.arrAnimations[intMoveDirectionTo].value + \"px\")\n\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)});\n\t\t}\n\t},\n\n\t_moveAnimateFromToDirection : function (_objAnimateData)\n\t{\n\t\t/* Clear CSS top override to force subscreens off screen for flicker affect when\n\t\t * display:none removed by asset_interface */\n\t\t if(typeof _objAnimateData.preservePositions == 'undefined' ||\n       _objAnimateData.preservePositions !== true){ \n\t\t\tif (_objAnimateData.arrAnimations[0].style == 'left')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.left = '0px';\n\t\t\t}\n\t\t\tif (_objAnimateData.arrAnimations[0].style == 'right')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.right = '0px';\n\t\t\t}\n\t\t\tif (_objAnimateData.arrAnimations[0].style == 'top')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.top = '0px';\n\t\t\t}\n\t\t\tif (_objAnimateData.arrAnimations[0].style == 'bottom')\n\t\t\t{\n\t\t\t\t_objAnimateData.domCurrentElement.style.bottom = '0px';\n\t\t\t}\n\t\t}\n\n\t\tvar intMoveDirectionFrom = null;\n\t\tvar intMoveDirectionTo = null;\n\n\t\tif (_objAnimateData.strType == \"seekTo(1)\")\n\t\t{\n\t\t\tintMoveDirectionFrom = 0;\n\t\t\tintMoveDirectionTo = 1;\n\t\t}\n\t\telse if (_objAnimateData.strType == \"seekTo(0)\")\n\t\t{\n\t\t\tintMoveDirectionFrom = 1;\n\t\t\tintMoveDirectionTo = 0;\n\t\t}\n\n\t\t_objAnimateData = this._moveConvertValues(_objAnimateData);\n\n\t\tif (_objAnimateData.arrAnimations[0].style == 'left' || _objAnimateData.arrAnimations[0].style == 'margin-left' || _objAnimateData.arrAnimations[0].style == 'right')\n\t\t\t{\n\t\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t\t.ease('in-out')\n\t\t\t\t\t.x(_objAnimateData.arrAnimations[intMoveDirectionFrom].value)\n\t\t\t\t\t.duration(0)\n\t\t\t\t\t.end(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t\t\t.ease('in-out')\n\t\t\t\t\t\t.x(_objAnimateData.arrAnimations[intMoveDirectionTo].value)\n\t\t\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)})\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse if (_objAnimateData.arrAnimations[0].style == 'top' || _objAnimateData.arrAnimations[0].style == 'bottom')\n\t\t\t{\n\t\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t\t.ease('in-out')\n\t\t\t\t\t.y(_objAnimateData.arrAnimations[intMoveDirectionFrom].value)\n\t\t\t\t\t.duration(0)\n\t\t\t\t\t.end(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t\t\t.ease('in-out')\n\t\t\t\t\t\t.y(_objAnimateData.arrAnimations[intMoveDirectionTo].value)\n\t\t\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)})\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmove(_objAnimateData.domCurrentElement.id)\n\t\t\t\t\t.ease('in-out')\n\t\t\t\t\t.set(_objAnimateData.arrAnimations[0].style, _objAnimateData.arrAnimations[intMoveDirectionFrom].value + \"px\")\n\t\t\t\t\t.set(_objAnimateData.arrAnimations[1].style, _objAnimateData.arrAnimations[intMoveDirectionTo].value + \"px\")\n\t\t\t\t\t.duration(_objAnimateData.intAnimateDuration)\n\t\t\t\t\t.end( function (){ANIMATOR_INTERFACE._moveEndFunction(_objAnimateData)});\n\t\t\t}\n\t},\n\n\t_moveConvertValues : function (_objAnimateData)\n\t{\n\t\tif (_objAnimateData.arrAnimations[0].style == 'right' || _objAnimateData.arrAnimations[0].style == \"bottom\")\n\t\t{\n\t\t\t_objAnimateData.arrAnimations[0].value = Math.abs(_objAnimateData.arrAnimations[0].value);\n\t\t\t_objAnimateData.arrAnimations[1].value = Math.abs(_objAnimateData.arrAnimations[1].value);\n\t\t\treturn _objAnimateData;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn _objAnimateData;\n\t\t}\n\t},\n\n\t// May be called externally via Move.js or Animate.js as this. object is passed through to these.\n\t_moveEndFunction : function (_objAnimateData)\n\t{\n\t\tif (_objAnimateData.strOnComplete)\n\t\t{\n\t\t\tvar _objOptions = {strWhatSubScreenElementID : _objAnimateData.domCurrentElement.id, _arrAnimations : _objAnimateData.arrAnimations};\n\t\t\tif (_objAnimateData.objOptionalCallbackData != null)\n\t\t\t{\n\t\t\t\t_objOptions.objOptionalCallbackData = _objAnimateData.objOptionalCallbackData;\n\t\t\t}\n\t\t\tEM.trigger(_objAnimateData.strOnComplete, _objOptions);\n\t\t}\n\t\telse if (_objAnimateData.objOnComplete)\n\t\t{\n\t\t\t_objAnimateData.objOnComplete();\n\t\t}\n\t},\n\n\t/*********** ANIMATOR METHODS ************/\n\t_preprocessAnimator : function (_objAnimateData)\n\t{\n\n\t\tif (_objAnimateData.strOnComplete)\n\t\t{\n\t\t\tvar _objOptions = {strWhatSubScreenElementID : _objAnimateData.domCurrentElement.id, _arrAnimations : _objAnimateData.arrAnimations};\n\t\t\tif (_objAnimateData.objOptionalCallbackData != null)\n\t\t\t{\n\t\t\t\t_objOptions.objOptionalCallbackData = _objAnimateData.objOptionalCallbackData;\n\t\t\t}\n\t\t\tvar funOnComplete = function (){ EM.trigger(_objAnimateData.strOnComplete, _objOptions)};\n\t\t}\n\t\telse if (_objAnimateData.objOnComplete)\n\t\t{\n\t\t\tvar funOnComplete = _objAnimateData.objOnComplete;\n\t\t}\n\n\t\t// REFACTOR NOTE: change to switch case with error if type doesn't exist\n\t\tif (_objAnimateData.strTransition == 'bounce')\n\t\t{\n\t\t\t_objAnimateData.objAnimatorTransition = {transition: Animator.makeBounce(0.75),duration: _objAnimateData.intAnimateDuration, onComplete : function (){funOnComplete()} };\n\t\t}\n\t\telse if (_objAnimateData.strTransition == 'elastic')\n\t\t{\n\t\t\t_objAnimateData.objAnimatorTransition = {transition: Animator.makeElastic(0.75),duration: _objAnimateData.intAnimateDuration, onComplete : function (){funOnComplete()} };\n\t\t}\n\t\telse if (_objAnimateData.strTransition == 'easeIn')\n\t\t{\n\t\t\t_objAnimateData.objAnimatorTransition = {transition: Animator.makeEaseIn(0.75),duration: _objAnimateData.intAnimateDuration, onComplete : function (){funOnComplete()} };\n\t\t}\n\t\telse if (_objAnimateData.strTransition == 'easeInOut')\n\t\t{\n\t\t\t_objAnimateData.objAnimatorTransition = {transition: Animator.makeEaseOut(0.75),duration: _objAnimateData.intAnimateDuration, onComplete : function (){funOnComplete()} };\n\t\t}\n\n\t\tif (this._objHashtableAnimations[_objAnimateData.domCurrentElement.id])\n\t\t{\n\t\t\tthis._stopAnimator(_objAnimateData.domCurrentElement.id);\n\t\t\tdelete this._objHashtableAnimations[_objAnimateData.domCurrentElement.id];\n\t\t}\n\n\t\tthis._performAnimatorAnimation(_objAnimateData);\n\t},\n\n\t_performAnimatorAnimation : function (_objAnimateData)\n\t{\n\t\tthis._objHashtableAnimations[_objAnimateData.domCurrentElement.id] = new Animator(_objAnimateData.objAnimatorTransition);\n\t\tvar objAnimator = this._objHashtableAnimations[_objAnimateData.domCurrentElement.id];\n\t\tvar objNumericalStyle = new NumericalStyleSubject(\n\t\t\t\t\t_objAnimateData.domCurrentElement.id,\n\t\t\t\t\t_objAnimateData.arrAnimations[0].style,\n\t\t\t\t\t_objAnimateData.arrAnimations[0].value + \"px\",\n\t\t\t\t\t_objAnimateData.arrAnimations[1].value + \"px\");\n\n\t\t/* REFACTOR NOTE: This only allows for values to move one axis and with numbers.\n\t\t* Need to add transition control (another new()) object\n\t\t*/\n\t\tif (_objAnimateData.strType == 'play()')\n\t\t{\n\t\t\tobjAnimator.addSubject(objNumericalStyle).play();\n\t\t}\n\t\telse if (_objAnimateData.strType == 'reverse()')\n\t\t{\n\t\t\tobjAnimator.addSubject(objNumericalStyle).reverse();\n\t\t}\n\t\telse if (_objAnimateData.strType == 'seekTo(1)')\n\t\t{\n\t\t\tobjAnimator.addSubject(objNumericalStyle).seekTo(1);\n\t\t}\n\t\telse if (_objAnimateData.strType == 'seekTo(0)')\n\t\t{\n\t\t\tobjAnimator.addSubject(objNumericalStyle).seekFromTo(1,0);\n\t\t}\n\t},\n\n\t_stopAnimator : function (domCurrentElementId)\n\t{\n\t\tthis._objHashtableAnimations[domCurrentElementId].stop();\n\t},\n\n\t/**\n\t * Currently just testing if in Smartphone or Tablet version\n\t */\n\t_isCSSCapable : function ()\n\t{\n\t\t// If this._booCSSCapable has already been set, there's no point in checking again.\n\t\tif (this.booCSSCapable == null)\n\t\t{\n\t\t\tif ((OUTPUT_MODE_CHECKER.strCurrentMode == 'smartphoneC' || OUTPUT_MODE_CHECKER.strCurrentMode == 'tabletC')\n\t\t\t    && (OUTPUT_MODE_CHECKER.booIsIE() == false))\n\t\t\t{\n\t\t\t\tthis.booCSSCapable = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.booCSSCapable = false;\n\t\t\t}\n\t\t}\n\t\treturn this.booCSSCapable;\n\t}\n}\nEM.register(ANIMATOR_INTERFACE);\n"},function(t,e,n){n(0)(n(109))},function(t,e){t.exports='/* globals OUTPUT_MODE_CHECKER, $, EM */\n/* eslint new-cap: 0 */\n\n/**\n * @title Animator Interface\n * @description animator_interface is used to add a layer between animation calls and animation APIs\n *  Currently Animtor_interface uses animator.js or move.js depending on the devices CSS\n *  capabilities.\n *\n * @author JamesH\n * @version 1.0 10-12-12\n * @version 2.0 20-12-12 - James Hough - Refresh CSS \'if statement\' added to _preprocessMove for off\n * screen elements not rendering when animated on screen.\n * @REFACTOR NOTE: Genricise animate_interface to work with all animation types and directions\n * through move and animate.\n * @REFACTOR NOTE: JC Could do to break aaprt functions, some are getting rather long!\n */\n\nvar ANIMATOR_INTERFACE_2 = {\n  // _whatScreenElement can be dom or id\n  assignRegisteredAnimation: function(_whatScreenElement, _strAnimation, _objAnimationOptions) {\n    if (OUTPUT_MODE_CHECKER.booIsIE8() || OUTPUT_MODE_CHECKER.booIE8CompatibilityMode()) {\n      // Check for IE8 version\n      if ($.Velocity.Sequences[_strAnimation + \'IE8\']) {\n        _strAnimation = _strAnimation + \'IE8\';\n      }\n    }\n\n    var intDelay = null;\n    var intDuration = null;\n    var funComplete = null;\n\n    if (_objAnimationOptions) {\n      // Validate animation delay\n      if (_objAnimationOptions.delay) {\n        if (_objAnimationOptions.delay > 0 && _objAnimationOptions.delay < 201) {\n          _objAnimationOptions.delay = _objAnimationOptions.delay * 1000;\n        }\n        intDelay = _objAnimationOptions.delay;\n      }\n      // Validate animation duration!\n      if (_objAnimationOptions.duration) {\n        if (_objAnimationOptions.duration > 0 && _objAnimationOptions.duration < 201) {\n          _objAnimationOptions.duration = _objAnimationOptions.duration * 1000;\n        }\n        intDuration = _objAnimationOptions.duration;\n      }\n      // Animation complete method!\n      if (_objAnimationOptions.complete) {\n        funComplete = _objAnimationOptions.complete;\n      }\n    }\n\n    intDelay = intDelay == null ? 0 : intDelay;\n    intDuration = intDuration == null ? 100 : intDuration;\n    $(_whatScreenElement).velocity(_strAnimation, {\n      delay: intDelay,\n      duration: intDuration,\n      complete: funComplete\n    });\n  },\n\n  // ----------- START Gomo Custom Animations -----------------\n  // _whatScreenElement can be dom or id\n  applyOpacityToElement: function(_whatScreenElement, _objAnimationOptions) {\n    var intOpacity = 0;\n    var intDelay = 0;\n    var intDuration = 0;\n    var funComplete = null;\n\n    if (_objAnimationOptions) {\n      if (_objAnimationOptions.opacity) {\n        intOpacity = _objAnimationOptions.opacity;\n      }\n      if (_objAnimationOptions.delay) {\n        intDelay = _objAnimationOptions.delay;\n      }\n      if (_objAnimationOptions.duration) {\n        intDuration = _objAnimationOptions.duration;\n      }\n      if (_objAnimationOptions.complete) {\n        funComplete = _objAnimationOptions.complete;\n      }\n    }\n\n    $(_whatScreenElement).velocity(\n      {\n        opacity: intOpacity\n      },\n      {\n        delay: intDelay,\n        duration: intDuration,\n        complete: funComplete\n      }\n    );\n  },\n\n  animateHorizontalSide: function(_whatScreenElement, _objAnimationOptions) {\n    var intStartPoint = 0;\n    var intEndPoint = 0;\n    var intDelay = 0;\n    var intDuration = 0;\n    var funComplete = null;\n\n    if (_objAnimationOptions) {\n      if (_objAnimationOptions.startPoint) {\n        intStartPoint = _objAnimationOptions.startPoint;\n      }\n      if (_objAnimationOptions.endPoint) {\n        intEndPoint = _objAnimationOptions.endPoint;\n      }\n      if (_objAnimationOptions.delay) {\n        intDelay = _objAnimationOptions.delay;\n      }\n      if (_objAnimationOptions.duration) {\n        intDuration = _objAnimationOptions.duration;\n      }\n      if (_objAnimationOptions.complete) {\n        funComplete = _objAnimationOptions.complete;\n      }\n    }\n\n    $(_whatScreenElement).velocity(\n      {\n        translateY: 0\n      },\n      {\n        delay: 0,\n        duration: 0\n      }\n    );\n    $(_whatScreenElement).velocity(\n      {\n        translateX: [intEndPoint, intStartPoint]\n      },\n      {\n        delay: intDelay,\n        duration: intDuration,\n        complete: funComplete\n      }\n    );\n  },\n\n  addVerticalSlideCss: function(domElement) {\n    $(domElement).css({\n      \'height\': \'100vh\',\n      \'overflow-y\': \'hidden\'\n    });\n    if (!$(\'#contentWrapperL\').hasClass(\'continousScrolling\')) {\n      $(\'#contentWrapperL\').css({\'overflow-y\': \'hidden\'});\n    }\n  },\n\n  removeVerticalSlideCss: function(domElement) {\n    $(domElement).css({\n      \'height\': \'\',\n      \'overflow-y\': \'\'\n    });\n    // Auto offers fallback for older browser that don\'t support overlay\n    if (!$(\'#contentWrapperL\').hasClass(\'continousScrolling\')) {\n      $(\'#contentWrapperL\').css({\'overflow-y\': \'auto\'});\n      $(\'#contentWrapperL\').css({\'overflow-y\': \'overlay\'});\n    }\n  },\n\n  // ----------- END Gomo Custom Animations -----------------\n\n  setAnimationRegisters: function() {\n    var _screenWidth = $(window).width();\n    var _screenHeight = $(window).height();\n    var popupYpos = _screenHeight;\n\n    // For devices that can change orientation always use the largest dimension to avoid popups\n    // remaining on screen after orientation changes from landscape to portrait.\n    if (!gomo.outputChecker.isDesktop()) {\n      popupYpos = _screenWidth > _screenHeight ? _screenWidth : _screenHeight;\n    }\n\n    // gomo Core animations\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideShowNormal\', {\n      defaultDuration: 800,\n      calls: [[{translateX: [0, _screenWidth], translateY: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideHideNormal\', {\n      defaultDuration: 800,\n      calls: [[{translateX: [-_screenWidth, 0], translateY: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideShowReverse\', {\n      defaultDuration: 800,\n      calls: [[{translateX: [0, -_screenWidth], translateY: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideHideReverse\', {\n      defaultDuration: 800,\n      calls: [[{translateX: [_screenWidth, 0], translateY: 0, translateZ: 0}]]\n    });\n\n    $.Velocity.RegisterUI(\'gomo.verticalSlideShowNormal\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [0, _screenHeight], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideShowReverse\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [0, -_screenHeight], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideHideNormal\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [-_screenHeight, 0], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideHideReverse\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [_screenHeight, 0], translateX: 0, translateZ: 0}]]\n    });\n\n    $.Velocity.RegisterUI(\'gomo.verticalPopupSlideShowNormal\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], translateY: [0, popupYpos], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalPopupSlideShowReverse\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], translateY: [0, -popupYpos], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalPopupSlideHideNormal\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [-popupYpos, 0], translateX: 0, translateZ: 0}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalPopupSlideHideReverse\', {\n      defaultDuration: 800,\n      calls: [[{translateY: [popupYpos, 0], translateX: 0, translateZ: 0}]]\n    });\n\n    // IE8 gomo Core animations\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideShowNormalIE8\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], left: [0, _screenWidth]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideShowReverseIE8\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], left: [0, -_screenWidth]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideHideNormalIE8\', {\n      defaultDuration: 800,\n      calls: [[{left: [-_screenWidth, 0]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.horizontalSlideHideReverseIE8\', {\n      defaultDuration: 800,\n      calls: [[{left: [_screenWidth, 0]}]]\n    });\n\n    $.Velocity.RegisterUI(\'gomo.verticalSlideShowNormalIE8\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], top: [0, _screenHeight]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideShowReverseIE8\', {\n      defaultDuration: 800,\n      calls: [[{opacity: [1, 0], top: [0, -_screenHeight]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideHideNormalIE8\', {\n      defaultDuration: 800,\n      calls: [[{top: [-_screenHeight, 0]}]]\n    });\n    $.Velocity.RegisterUI(\'gomo.verticalSlideHideReverseIE8\', {\n      defaultDuration: 800,\n      calls: [[{top: [_screenHeight, 0]}]]\n    });\n\n    // overriden with opacity\n    $.Velocity.RegisterUI(\'callout.bounce\', {\n      defaultDuration: 550,\n      calls: [\n        [{opacity: [1, 0]}],\n        [{translateY: -30}, 0.25],\n        [{translateY: 0}, 0.125],\n        [{translateY: -15}, 0.125],\n        [{translateY: 0}, 0.25]\n      ]\n    });\n    // overriden with opacity\n    $.Velocity.RegisterUI(\'callout.shake\', {\n      defaultDuration: 800,\n      calls: [\n        [{opacity: [1, 0]}],\n        [{translateX: -11}, 0.125],\n        [{translateX: 11}, 0.125],\n        [{translateX: -11}, 0.125],\n        [{translateX: 11}, 0.125],\n        [{translateX: -11}, 0.125],\n        [{translateX: 11}, 0.125],\n        [{translateX: -11}, 0.125],\n        [{translateX: 0}, 0.125]\n      ]\n    });\n    /* Animate.css\n            "callout.flash": {\n                defaultDuration: 1100,\n                calls: [\n                    [ { opacity: [ 0, "easeInOutQuad", 1 ] }, 0.25 ],\n                    [ { opacity: [ 1, "easeInOutQuad" ] }, 0.25 ],\n                    [ { opacity: [ 0, "easeInOutQuad" ] }, 0.25 ],\n                    [ { opacity: [ 1, "easeInOutQuad" ] }, 0.25 ]\n                ]\n            },*/\n\n    // overriden with opacity\n    $.Velocity.RegisterUI(\'callout.pulse\', {\n      defaultDuration: 825,\n      calls: [[{opacity: [1, 0]}], [{scaleX: 1.1}, 0.5], [{scaleX: 1}, 0.5]]\n    });\n\n    // overriden with opacity\n    $.Velocity.RegisterUI(\'callout.swing\', {\n      defaultDuration: 950,\n      calls: [\n        [{opacity: [1, 0]}],\n        [{rotateZ: 15}, 0.2],\n        [{rotateZ: -10}, 0.2],\n        [{rotateZ: 5}, 0.2],\n        [{rotateZ: -5}, 0.2],\n        [{rotateZ: 0}, 0.2]\n      ]\n    });\n\n    // overriden with opacity\n    $.Velocity.RegisterUI(\'callout.tada\', {\n      defaultDuration: 1000,\n      calls: [\n        [{opacity: [1, 0]}],\n        [{scaleX: 0.9, scaleY: 0.9, rotateZ: -3}, 0.1],\n        [{scaleX: 1.1, scaleY: 1.1, rotateZ: 3}, 0.1],\n        [{scaleX: 1.1, scaleY: 1.1, rotateZ: -3}, 0.1],\n        [\'reverse\', 0.125],\n        [\'reverse\', 0.125],\n        [\'reverse\', 0.125],\n        [\'reverse\', 0.125],\n        [\'reverse\', 0.125],\n        [{scaleX: 1, scaleY: 1, rotateZ: 0}, 0.2]\n      ]\n    });\n\n    // Built in velocity animations which we don\'t use but could be in future.\n    // "transition.fadeIn": {\n    //     defaultDuration: 500,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ] } ]\n    //     ]\n    // },\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.flipXIn": {\n    //     defaultDuration: 700,\n    //     calls: [\n    //         [ {\n    //           opacity: [ 1, 0 ],\n    //           transformPerspective: [ 800, 800 ],\n    //           rotateY: [ 0, -55 ]\n    //         } ]\n    //     ],\n    //     reset: { transformPerspective: 0 }\n    // },\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.flipYIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ {\n    //           opacity: [ 1, 0 ], transformPerspective: [ 800, 800 ], rotateX: [ 0, -45 ]\n    //         } ]\n    //     ],\n    //     reset: { transformPerspective: 0 }\n    // },\n    // /* Animate.css */\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.flipBounceXIn": {\n    //     defaultDuration: 900,\n    //     calls: [\n    //         [ {\n    //           opacity: [ 0.725, 0 ],\n    //           transformPerspective: [ 400, 400 ],\n    //           rotateY: [ -10, 90 ]\n    //         }, 0.50 ],\n    //         [ { opacity: 0.80, rotateY: 10 }, 0.25 ],\n    //         [ { opacity: 1, rotateY: 0 }, 0.25 ]\n    //     ],\n    //     reset: { transformPerspective: 0 }\n    // },\n    // /* Animate.css */\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only).*/\n    // "transition.flipBounceYIn": {\n    //     defaultDuration: 850,\n    //     calls: [\n    //         [ {\n    //           opacity: [ 0.725, 0 ],\n    //           transformPerspective: [ 400, 400 ],\n    //           rotateX: [ -10, 90 ]\n    //         }, 0.50 ],\n    //         [ { opacity: 0.80, rotateX: 10 }, 0.25 ],\n    //         [ { opacity: 1, rotateX: 0 }, 0.25 ]\n    //     ],\n    //     reset: { transformPerspective: 0 }\n    // },\n    // /* Magic.css */\n    // "transition.swoopIn": {\n    //     defaultDuration: 850,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], transformOriginX: [ "100%", "50%" ],\n    //            transformOriginY: [ "100%", "100%" ], scaleX: [ 1, 0 ],\n    //            scaleY: [ 1, 0 ], translateX: [ 0, -700 ], translateZ: 0\n  //            } ]\n    //     ],\n    //     reset: { transformOriginX: "50%", transformOriginY: "50%" }\n    // },\n    // /* Magic.css */\n    // /* Support: Loses rotation in IE9/Android 2.3. (Fades and scales only.) */\n    // "transition.whirlIn": {\n    //     defaultDuration: 900,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], transformOriginX: [ "50%", "50%" ],\n  //              transformOriginY: [ "50%", "50%" ], scaleX: [ 1, 0 ],\n  //              scaleY: [ 1, 0 ], rotateY: [ 0, 160 ]\n  //              } ]\n    //     ]\n    // },\n\n    // "transition.shrinkIn": {\n    //     defaultDuration: 700,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], transformOriginX: [ "50%", "50%" ],\n    //            transformOriginY: [ "50%", "50%" ], scaleX: [ 1, 1.5 ],\n    //            scaleY: [ 1, 1.5 ], translateZ: 0\n    //          } ]\n    //     ]\n    // },\n\n    // "transition.expandIn": {\n    //     defaultDuration: 700,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], transformOriginX: [ "50%", "50%" ],\n    //            transformOriginY: [ "50%", "50%" ],\n    //            scaleX: [ 1, 0.625 ],\n    //            scaleY: [ 1, 0.625 ],\n    //            translateZ: 0\n    //          } ]\n    //     ]\n    // },\n    // /* Animate.css */\n    // "transition.bounceIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], scaleX: [ 1.05, 0.3 ], scaleY: [ 1.05, 0.3 ] }, 0.40 ],\n    //         [ { scaleX: 0.9, scaleY: 0.9, translateZ: 0 }, 0.20 ],\n    //         [ { scaleX: 1, scaleY: 1 }, 0.50 ]\n    //     ]\n    // },\n    // /* Animate.css */\n    // "transition.bounceUpIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ {\n    //          opacity: [ 1, 0 ],\n    //          translateY: [ -30, 1000 ] },\n    //          0.60, { easing: "easeOutCirc" }\n    //          }],\n    //         [ { translateY: 10 }, 0.20 ],\n    //         [ { translateY: 0 }, 0.20 ]\n    //     ]\n    // },\n    // /* Animate.css */\n    // "transition.bounceDownIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ {\n    //           opacity: [ 1, 0 ],\n    //           translateY: [ 30, -1000 ] },\n    //           0.60, { easing: "easeOutCirc" }\n    //          } ],\n    //         [ { translateY: -10 }, 0.20 ],\n    //         [ { translateY: 0 }, 0.20 ]\n    //     ]\n    // },\n    // /* Animate.css */\n    // "transition.bounceLeftIn": {\n    //     defaultDuration: 750,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            translateX: [ 30, -1250 ] },\n    //            0.60, { easing: "easeOutCirc" }\n  //            }],\n    //         [ { translateX: -10 }, 0.20 ],\n    //         [ { translateX: 0 }, 0.20 ]\n    //     ]\n    // },\n    // /* Animate.css */\n    // "transition.bounceRightIn": {\n    //     defaultDuration: 750,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            translateX: [ -30, 1250 ] },\n    //            0.60, { easing: "easeOutCirc" }\n  //            } ],\n    //         [ { translateX: 10 }, 0.20 ],\n    //         [ { translateX: 0 }, 0.20 ]\n    //     ]\n    // },\n\n    // "transition.slideUpIn": {\n    //     defaultDuration: 900,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateY: [ 0, 20 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideDownIn": {\n    //     defaultDuration: 900,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateY: [ 0, -20 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideLeftIn": {\n    //     defaultDuration: 1000,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateX: [ 0, -20 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideRightIn": {\n    //     defaultDuration: 1000,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateX: [ 0, 20 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideUpBigIn": {\n    //     defaultDuration: 850,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateY: [ 0, 75 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideDownBigIn": {\n    //     defaultDuration: 850,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateY: [ 0, -75 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideLeftBigIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateX: [ 0, -75 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // "transition.slideRightBigIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ { opacity: [ 1, 0 ], translateX: [ 0, 75 ], translateZ: 0 } ]\n    //     ]\n    // },\n    // /* Magic.css */\n    // "transition.perspectiveUpIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            transformPerspective: [ 800, 800 ],\n    //            transformOriginX: [ 0, 0 ],\n    //            transformOriginY: [ "100%", "100%" ],\n    //            rotateX: [ 0, -180 ]\n  //            } ]\n    //     ],\n    //     reset: { transformPerspective: 0, transformOriginX: "50%", transformOriginY: "50%" }\n    // },\n    // /* Magic.css */\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.perspectiveDownIn": {\n    //     defaultDuration: 800,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            transformPerspective: [ 800, 800 ],\n    //            transformOriginX: [ 0, 0 ],\n    //            transformOriginY: [ 0, 0 ],\n    //            rotateX: [ 0, 180 ]\n  //            } ]\n    //     ],\n    //     reset: { transformPerspective: 0, transformOriginX: "50%", transformOriginY: "50%" }\n    // },\n    // /* Magic.css */\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.perspectiveLeftIn": {\n    //     defaultDuration: 950,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            transformPerspective: [ 2000, 2000 ],\n    //            transformOriginX: [ 0, 0 ],\n    //            transformOriginY: [ 0, 0 ],\n    //            rotateY: [ 0, -180 ]\n  //            } ]\n    //     ],\n    //     reset: { transformPerspective: 0, transformOriginX: "50%", transformOriginY: "50%" }\n    // },\n    // /* Magic.css */\n    // /* Support: Loses rotation in IE9/Android 2.3 (fades only). */\n    // "transition.perspectiveRightIn": {\n    //     defaultDuration: 950,\n    //     calls: [\n    //         [ {\n    //            opacity: [ 1, 0 ],\n    //            transformPerspective: [ 2000, 2000 ],\n    //            transformOriginX: [ "100%", "100%" ],\n    //            transformOriginY: [ 0, 0 ],\n    //            rotateY: [ 0, 180 ]\n  //              } ]\n    //     ],\n    //     reset: { transformPerspective: 0, transformOriginX: "50%", transformOriginY: "50%" }\n    // },\n  }\n};\nEM.register(ANIMATOR_INTERFACE_2);\n'},function(t,e,n){n(0)(n(111))},function(t,e){t.exports="/**\n* BACK Extra\n* ---\n* @author GoMo\n*/\n\nvar global = this;\n\nif(global.Mustache === undefined){\n\tconsole.log('ERROR: Mustache not found!');\n}\n\nvar BACK_EXTRA =\n{\n\tstrObjID : \"The back button extra\",\n\tstrObjDescription : \"The extra responsible for display of the back button.\",\n\n\t_strManifestID : \"backExtra\",\n\t_objCurrDOM : null,\n\t_domCurrInsertionNode : null,\n\t_booDebug : false,\n\n\thandleEvent_primeDOMReferences : function (_objWhatDOM){\n\t\tthis._objCurrDOM = _objWhatDOM;\n\t},\n\n\thandleEvent_outputModeChanged : function (_objOutputChangeData){\n\t},\n\n\thandleEvent_screenSizeChanged : function (_objOutputChangeData){\n\t},\n\n\t// Debug message\n\t_debug : function (_strMessage){\n\t\tif ((window['console']) && (window.console.log) && (this._booDebug)){\n\t\t\tconsole.log(_strManifestID + ' : ' + _strMessage);\n\t\t}\n\t}\n}\n\nEM.register(BACK_EXTRA);"},function(t,e,n){n(0)(n(113))},function(t,e){t.exports="/* globals CORE, DEBUG, EM, INTERACTIVE_BLANKER, $, POPUP_MANANGER, SUB_SCREEN_INTERACTIONS */\n/**\n * @title The blanking layer object\n * @description This object shows and hides the blanking layer upon request.\n *\n * @author JohnC\n * @version 2.0 01/12/10\n */\n\nvar BLANKER = {\n  strObjID: 'The blanking layer object',\n\n  _objBlankLayer: null,\n  _objCurrDOM: null,\n\n  _strBlankingLayerClassKey: 'blankingLayerC',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    if (!this._objCurrDOM) {\n      this._objCurrDOM = _objWhatDOM;\n    }\n  },\n\n  handleEvent_toggleBlanking: function(_objParams) {\n    if (_objParams['objWhatDOM']) {\n      this._objBlankLayer = CORE.getElementsByClassName(\n        _objParams['objWhatDOM'],\n        this._strBlankingLayerClassKey\n      )[0];\n    } else {\n      this._objBlankLayer = CORE.getElementsByClassName(\n        this._objCurrDOM,\n        this._strBlankingLayerClassKey\n      )[0];\n    }\n\n    var strState = _objParams['strState'];\n    var _intNewZIndex = false;\n\n    if (_objParams['intNewZIndex']) {\n      _intNewZIndex = _objParams['intNewZIndex'];\n    }\n\n    if (this._objBlankLayer) {\n      // Hide blanking layer\n      if (strState == 'OFF') {\n        if (this._objBlankLayer.intOldZIndex) {\n          this._objBlankLayer.style.zIndex = this._objBlankLayer.intOldZIndex;\n        }\n        this._objBlankLayer.className = this._objBlankLayer.className.replace(\n          'blankOnC',\n          'blankOffC'\n        );\n        if (typeof INTERACTIVE_BLANKER !== 'undefined' && INTERACTIVE_BLANKER) {\n          // Remove any click events on the blanking layer and remove the styling.\n          $(this._objBlankLayer).off('click');\n          $('html').removeClass('interactiveBlanker');\n        }\n      } else {\n        // Show blanking layer\n        if (_intNewZIndex) {\n          this._objBlankLayer.intOldZIndex = this._objBlankLayer.style.zIndex;\n          this._objBlankLayer.style.zIndex = _intNewZIndex;\n        }\n        this._objBlankLayer.className = this._objBlankLayer.className.replace(\n          'blankOffC',\n          'blankOnC'\n        );\n        // If we want to close modals with a click on the blanking layer, add a click\n        // event to the blanking layer to close all subscreens and popups\n        if (typeof INTERACTIVE_BLANKER !== 'undefined' && INTERACTIVE_BLANKER) {\n          // Add class to help blanker styling.\n          $('html').addClass('interactiveBlanker');\n          // Add event listener to the blanking layer\n          $(this._objBlankLayer)\n            .on('click', function() {\n              // Check for any animating subscreens and do not close/hide all popups/subscreens\n              // if there are.\n              if (!SUB_SCREEN_INTERACTIONS.isSubscreenAnimating()) {\n                POPUP_MANANGER.closeAllPopups();\n                SUB_SCREEN_INTERACTIONS.hideSubScreens(true);\n              }\n            });\n        }\n      }\n    } else {\n      console.log('BLANKER_LAYER_MISSING_ERROR');\n    }\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  }\n};\n\nEM.register(BLANKER);\n"},function(t,e,n){n(0)(n(115))},function(t,e){t.exports="/* global POLL_CONNECTION, $ */\n/**\n * Connection checker extra responsible for warning on dropped internet connection.\n *\n * @author J.Hough\n */\ngomo.connectionChecker = (function() {\n  var maxRetryCount = 3;\n  var currentRetryCount = 0;\n  var pollingFrequency = 5; // in seconds\n  var pollingPaused = false;\n  var connectionInterval = null;\n  var activeConnection = null; // unknown\n\n  // Set Event listener to trigger polling\n  $( document ).on( 'gomoLoaded', function() {\n    gomo.connectionChecker.pollForConnection();\n  });\n\n  return {\n    /**\n     * Set polling for a connection\n     */\n    pollForConnection: function() {\n      // Only run on supported browsers\n      if (typeof navigator.onLine !== 'boolean') {\n        console.log('Warning - Connection-checker Extra not supported.');\n        return;\n      }\n      if (!POLL_CONNECTION) {\n        return;\n      }\n\n      // Convert seconds to milliseconds\n      pollingFrequency = pollingFrequency * 1000;\n\n      connectionInterval = setInterval(function() {\n        var maxRetryCount = gomo.connectionChecker.getMaxRetryCount();\n        var currentRetryCount = gomo.connectionChecker.getCurrentRetryCount();\n\n        // If paused then don't continue\n        if (pollingPaused) {\n          return;\n        }\n\n        if (navigator.onLine) {\n          gomo.connectionChecker.setActiveConnection(true);\n          gomo.connectionChecker.setCurrentRetryCount(0);\n        } else {\n          if (maxRetryCount <= currentRetryCount) {\n            gomo.connectionChecker.setActiveConnection(false);\n            // Show warning\n            // To-do - double check we don't have a popup lib. If not then find one to use\n            var alertType = 'warning';\n            var message = gomo.localiser.get('CONNECTION_CHECKER_WARNING');\n            var buttons = [\n              {\n                label: gomo.localiser.get('CONNECTION_CHECKER_IGNORE'),\n                type: 'secondary',\n                action: gomo.connectionChecker.stopPolling\n              },\n              {\n                label: gomo.localiser.get('CONNECTION_CHECKER_CONTINUE'),\n                type: 'primary',\n                action: gomo.connectionChecker.startPolling\n              }\n            ];\n            gomo.alertManager.create(alertType, false, message, buttons);\n            gomo.connectionChecker.setCurrentRetryCount(0);\n            gomo.connectionChecker.pausePolling();\n          } else {\n            // Increment currentRetryCount\n            gomo.connectionChecker.setCurrentRetryCount(currentRetryCount + 1);\n          }\n        }\n      }, pollingFrequency);\n    },\n\n    /**\n     * Set Active connection status\n     * @param {boolean} status\n     */\n    setActiveConnection: function(status) {\n      activeConnection = status;\n    },\n\n    /**\n     * Get Active connection status\n     * @return {boolean}\n     */\n    isConnectionActive: function() {\n      return activeConnection;\n    },\n\n    /**\n     * Get the max retry count\n     * @return {number}\n     */\n    getMaxRetryCount: function() {\n      return maxRetryCount;\n    },\n\n    /**\n     * Get current retry count\n     * @return {number}\n     */\n    getCurrentRetryCount: function() {\n      return currentRetryCount;\n    },\n\n    /**\n     * Set current retry count\n     * @param {number} value\n     */\n    setCurrentRetryCount: function(value) {\n      currentRetryCount = value;\n    },\n\n    /**\n     * Pause polling\n     */\n    pausePolling: function() {\n      pollingPaused = true;\n    },\n\n    /**\n     * Start polling\n     */\n    startPolling: function() {\n      pollingPaused = false;\n    },\n\n    /**\n     * Stop polling\n     */\n    stopPolling: function() {\n      if (connectionInterval) {\n        clearInterval(connectionInterval);\n      }\n    }\n  };\n})();\n"},function(t,e,n){n(0)(n(117))},function(t,e){t.exports="/**\n* BACK Extra\n* ---\n* @author GoMo\n*/\n\nvar global = this;\n\nif(global.Mustache === undefined){\n\tconsole.log('ERROR: Mustache not found!');\n}\n\nvar BACK_EXTRA =\n{\n\tstrObjID : \"The back button extra\",\n\tstrObjDescription : \"The extra responsible for display of the back button.\",\n\n\t_strManifestID : \"backExtra\",\n\t_objCurrDOM : null,\n\t_domCurrInsertionNode : null,\n\t_booDebug : false,\n\n\thandleEvent_primeDOMReferences : function (_objWhatDOM){\n\t\tthis._objCurrDOM = _objWhatDOM;\n\t},\n\n\thandleEvent_outputModeChanged : function (_objOutputChangeData){\n\t},\n\n\thandleEvent_screenSizeChanged : function (_objOutputChangeData){\n\t},\n\n\t// Debug message\n\t_debug : function (_strMessage){\n\t\tif ((window['console']) && (window.console.log) && (this._booDebug)){\n\t\t\tconsole.log(_strManifestID + ' : ' + _strMessage);\n\t\t}\n\t}\n}\n\nEM.register(BACK_EXTRA);"},function(t,e,n){n(0)(n(119))},function(t,e){t.exports="/* global EM, OUTPUT_MODE_CHECKER, SCROLLING_MANAGER, CORE, LOCALISER, IScroll */\n/* global $, BOO_DYNAMIC_CONTINUOUS_SCROLLING, SCREEN_INTERACTIONS */\n/**\n * @title    iScroll Interface\n * @description  This object will add the iScroll component to DOM objects where required.\n *                Objects should have the attribute rel='checkScrolling' added to them in\n *                order to be detected.\n *\n * @author    Chris Tebbit\n * @version    1.0 12/07/11\n * @version    2.0 14/05/12 - JC: Reworked to remove the existing scrolling code in favour\n *             of iScroll and to act as a generic interface for tracking and destroying iScrolls.\n */\n\nvar ISCROLL_INTERFACE = {\n  strObjID: 'Overflow Scroll',\n  strObjDescription: 'Adds scroll buttons to DOM objects where overflow is accessed via scrolling.',\n\n  _objCurrDOM: null,\n\n  _objIScrollReferences: {},\n\n  _strPendingID: '',\n  _arrPendingDOMObjectsToInspect: [],\n  _objTimeoutRef: null,\n\n  _booDebug: false,\n\n  handleEvent_primeDOMReferences: function(_objWhatContentDOM) {\n    this._objCurrDOM = _objWhatContentDOM;\n  },\n\n  handleEvent_screenSizeChanged: function() {\n    /** This might be the only way to force iscroll on desktop small/medium mode,\n     * but it will kill off other iscroll within the document (could set to screen dom level).\n     * this.parseChildDOMElements(document, false, false);\n     */\n  },\n\n  handleEvent_imageLoadCompleted: function() {\n    this.refreshIScrolls();\n  },\n\n  handleEvent_disableParentIScrollInstaces: function() {\n    for (var _strKeyID in this._objIScrollReferences) {\n      if (this._objIScrollReferences.hasOwnProperty(_strKeyID)) {\n        var _objCurrIScrollInstance = this._objIScrollReferences[_strKeyID];\n        var _booIsChildIscroll = _objCurrIScrollInstance.options.booIsChildIscroll;\n        if (!_booIsChildIscroll) {\n          _objCurrIScrollInstance.disable();\n        }\n      }\n    }\n  },\n\n  handleEvent_enableParentIScrollInstaces: function() {\n    for (var _strKeyID in this._objIScrollReferences) {\n      if (this._objIScrollReferences.hasOwnProperty(_strKeyID)) {\n        var _objCurrIScrollInstance = this._objIScrollReferences[_strKeyID];\n        var _booIsChildIscroll = _objCurrIScrollInstance.options.booIsChildIscroll;\n        if (!_booIsChildIscroll) {\n          _objCurrIScrollInstance.enable();\n        }\n      }\n    }\n  },\n\n  parseForContinuousScrollContentWrapper: function() {\n    // Blackberry's wouldn't cope with the iScroll so they get long scrolling\n    // pages, other modes should use the native scrollbar.\n    if (!OUTPUT_MODE_CHECKER.applyScrolling()) {\n      return;\n    }\n\n    // If we're in BOO_DYNAMIC_CONTINUOUS_SCROLLING mode then we need to use\n    // a hardcoded element to scroll\n    window.setTimeout(function() {\n      var contentWrapper = $('#contentWrapperL')[0];\n      ISCROLL_INTERFACE._applyIscroll(contentWrapper, false, true, false, false);\n    }, 0);\n  },\n\n  // Adds the elements to a queue array to be applied after a timeout to allow the DOM to catch up.\n  parseChildDOMElements: function(\n    _domWhatElement,\n    _booIsChildIScroll,\n    _objSurpressDirections,\n    _booAddPinchZoom\n  ) {\n    // Blackberry's wouldn't cope with the iScroll so they get long scrolling\n    // pages, other modes should use the native scrollbar.\n    if (!OUTPUT_MODE_CHECKER.applyScrolling()) {\n      return;\n    }\n\n    this._debug('ISCROLL_INTERFACE.parseChildDOMElements()');\n\n    this._arrPendingDOMObjectsToInspect.push({\n      domElement: _domWhatElement,\n      booIsChildIScroll: _booIsChildIScroll,\n      objSurpressDirections: _objSurpressDirections,\n      booAddPinchZoom: _booAddPinchZoom\n    });\n\n    // If there is a timeout set to go on the next 'frame', cancel it so we don't have multiple\n    // timeouts.\n    if (this._objTimeoutRef) {\n      window.clearTimeout(this._objTimeoutRef);\n    }\n\n    window.setTimeout(function() {\n      ISCROLL_INTERFACE._doQueuedParseElements();\n    }, 0);\n  },\n\n  recycleScroller: function(_domWhatElement) {\n    if (_domWhatElement) {\n      // Check that we're looking in the parent element of the one static single ID we\n      // use for continuous scrolling\n      if (typeof BOO_DYNAMIC_CONTINUOUS_SCROLLING !== 'undefined') {\n        if (BOO_DYNAMIC_CONTINUOUS_SCROLLING) {\n          var domScrollingElement = $(_domWhatElement).find('#contentWrapperL')[0];\n          if (domScrollingElement) {\n            this._recycleScroller(domScrollingElement.id);\n          }\n        }\n      }\n\n      // Check for all other instances\n      var _arrHTMLtags = _domWhatElement.getElementsByTagName('*');\n      var count = 0;\n      while (count < _arrHTMLtags.length) {\n        var _domCurrTag = _arrHTMLtags[count];\n        if (\n          _domCurrTag.className &&\n          _domCurrTag.className['indexOf'] &&\n          _domCurrTag.className.indexOf('checkScrollingC') > -1\n        ) {\n          this._recycleScroller(_domCurrTag.id);\n          break;\n        }\n        count++;\n      }\n      _arrHTMLtags = null;\n\n      if (\n        _domWhatElement.className &&\n        _domWhatElement.className['indexOf'] &&\n        _domWhatElement.className.indexOf('checkScrollingC') > -1\n      ) {\n        this._recycleScroller(_domWhatElement.id);\n      }\n    }\n  },\n\n  getCurrScrollPos: function(elementId) {\n    var currScrollPos = {};\n    currScrollPos.x = ISCROLL_INTERFACE._objIScrollReferences[elementId].x;\n    currScrollPos.y = ISCROLL_INTERFACE._objIScrollReferences[elementId].y;\n    return currScrollPos;\n  },\n\n  scrollToPosition: function(elementId, xPosition, yPosition, duration) {\n    if (ISCROLL_INTERFACE._objIScrollReferences[elementId]) {\n      ISCROLL_INTERFACE._objIScrollReferences[elementId].scrollTo(xPosition, yPosition, duration);\n    }\n  },\n\n  disableMomentum: function() {\n    for (var elementIds in this._objIScrollReferences) {\n      if (this._objIScrollReferences.hasOwnProperty(elementIds)) {\n        this._objIScrollReferences[elementIds].options.momentum = false;\n      }\n    }\n  },\n\n  enableMomentum: function() {\n    for (var elementIds in this._objIScrollReferences) {\n      if (this._objIScrollReferences.hasOwnProperty(elementIds)) {\n        this._objIScrollReferences[elementIds].options.momentum = true;\n      }\n    }\n  },\n\n  refreshIScrolls: function() {\n    for (var _strCurrID in ISCROLL_INTERFACE._objIScrollReferences) {\n      if (ISCROLL_INTERFACE._objIScrollReferences.hasOwnProperty(_strCurrID)) {\n        ISCROLL_INTERFACE._objIScrollReferences[_strCurrID].refresh();\n        this._debug('ISCROLL_INTERFACE::refreshIScrolls: ' + _strCurrID);\n      }\n    }\n  },\n\n  disableScroller: function(_domWhatElement) {\n    this._debug(\n      'ISCROLL_INTERFACE.disableScroller(_domWhatElement.id: ' + _domWhatElement.id + ')'\n    );\n    var _arrHTMLtags = _domWhatElement.getElementsByTagName('*');\n\n    var count = 0;\n    while (count < _arrHTMLtags.length) {\n      var _domCurrTag = _arrHTMLtags[count];\n      if (\n        _domCurrTag.className &&\n        _domCurrTag.className['indexOf'] &&\n        _domCurrTag.className.indexOf('checkScrollingC') > -1\n      ) {\n        this._disableScroller(_domCurrTag.id);\n        break;\n      }\n      count++;\n    }\n    _arrHTMLtags = null;\n\n    if (\n      _domWhatElement.className &&\n      _domWhatElement.className['indexOf'] &&\n      _domWhatElement.className.indexOf('checkScrollingC') > -1\n    ) {\n      this._disableScroller(_domWhatElement.id);\n    }\n  },\n\n  enableScroller: function(_domWhatElement) {\n    var _arrHTMLtags = _domWhatElement.getElementsByTagName('*');\n\n    var count = 0;\n    while (count < _arrHTMLtags.length) {\n      var _domCurrTag = _arrHTMLtags[count];\n      if (\n        _domCurrTag.className &&\n        _domCurrTag.className['indexOf'] &&\n        _domCurrTag.className.indexOf('checkScrollingC') > -1\n      ) {\n        this._enableScroller(_domCurrTag.id);\n        break;\n      }\n      count++;\n    }\n    _arrHTMLtags = null;\n\n    if (\n      _domWhatElement.className &&\n      _domWhatElement.className['indexOf'] &&\n      _domWhatElement.className.indexOf('checkScrollingC') > -1\n    ) {\n      this._enableScroller(_domWhatElement.id);\n    }\n  },\n\n  // Called by iScroll on the _start internal method\n  hideScrollMarker: function(_iscrollObject) {\n    var _domOverflowLayer = _iscrollObject.wrapper;\n    var _arrScrollMarkers = CORE.getElementsByClassName(_domOverflowLayer, 'scrollMarkerC');\n    if (_arrScrollMarkers.length > 0) {\n      // On occasions something is passed to this that can't be removed\n      // even though it appears to be a valid DOM element. As there is no\n      // scroll marker visible at the time, suppression is the order of\n      // the day\n      try {\n        _domOverflowLayer.removeChild(_arrScrollMarkers[0]);\n      } catch (_strErr) {\n        this._debug(_strErr);\n      }\n    }\n  },\n\n  // This function is used to prevent the iScroll from triggering on any elements with the\n  // class attached. This can be used to prevent the bug whereby the iScroll causes an onclick\n  // and ontouch to be triggered, resulting in a button being selected then unselected\n  // (Android tabelt).\n  checkForiScrollInhibitingClass: function(_domWhatEventTarget) {\n    if (\n      _domWhatEventTarget &&\n      _domWhatEventTarget.className &&\n      (_domWhatEventTarget.className.indexOf('inhibitIScrollForAndroidC') > -1 ||\n        _domWhatEventTarget.className.indexOf('buttonTextC') > -1)\n    ) {\n      if (OUTPUT_MODE_CHECKER.isAndroidDevice()) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  // This is used to temporarily remove the iScroll whilst fixing the scroll element in place\n  // so that it doesn't shift. It is currently used by the matching pairs to prevent a rendering\n  // glitch that occured whilst drawing the lines using Rapheal whilst an iScroll was present.\n  pauseScroller: function(_domWhatElement) {\n    if (this._objIScrollReferences[_domWhatElement.id]) {\n      var _domScroller = CORE.getElementsByClassName(_domWhatElement, 'scrollWrapperC')[0];\n\n      // Store the offesets\n      var _intYPos = this._objIScrollReferences[_domWhatElement.id].y;\n      var _intXPos = this._objIScrollReferences[_domWhatElement.id].x;\n\n      // Remove the iScroll\n      this.recycleScroller(_domWhatElement);\n\n      // Set the scroll element to those CO_ORDS.\n      _domScroller.style.top = _intYPos + 'px';\n      _domScroller.style.left = _intXPos + 'px';\n    }\n  },\n\n  // This is used to restore the iScroll from a pauseScroller command. It will pre-set the iScroll\n  // with the positions set on the scrolling element and should result in no shifting.\n  resumeScroller: function(_domWhatElement) {\n    var _domScroller = CORE.getElementsByClassName(_domWhatElement, 'scrollWrapperC')[0];\n\n    // Capture the current positions\n    var _objOffsets = {\n      intTop: parseInt(_domScroller.style.top),\n      intLeft: parseInt(_domScroller.style.left)\n    };\n\n    // Reset them to prevent doubling of the offsets\n    _domScroller.style.top = 'auto';\n    _domScroller.style.left = 'auto';\n\n    // Apply the iScroll, passing in the stored CO_ORDS.\n    this._applyIscroll(_domWhatElement, false, false, _objOffsets, false);\n  },\n\n  _doQueuedParseElements: function() {\n    var count = 0;\n    while (count < this._arrPendingDOMObjectsToInspect.length) {\n      this._parseElementAndChildren(this._arrPendingDOMObjectsToInspect[count]);\n      count++;\n    }\n    this._arrPendingDOMObjectsToInspect = [];\n    this._objTimeoutRef = null;\n  },\n\n  _parseElementAndChildren: function(_objWhatElementInfo) {\n    var _domWhatElement = _objWhatElementInfo['domElement'];\n    var _booIsChildIScroll = _objWhatElementInfo['booIsChildIScroll'];\n    var _objSurpressDirections = _objWhatElementInfo['objSurpressDirections'];\n    var _booAddPinchZoom = _objWhatElementInfo['booAddPinchZoom'];\n\n    if (!_domWhatElement) {\n      return;\n    }\n    // Finds all elements with 'checkScrollingC' in the classname property\n    var _arrHTMLtags = _domWhatElement.getElementsByTagName('*');\n\n    var count = 0;\n    while (count < _arrHTMLtags.length) {\n      var _domCurrTag = _arrHTMLtags[count];\n      if (\n        _domCurrTag.className &&\n        _domCurrTag.className['indexOf'] &&\n        _domCurrTag.className.indexOf('checkScrollingC') > -1\n      ) {\n        this._checkForScrolling(\n          _domCurrTag,\n          _booIsChildIScroll,\n          false,\n          _objSurpressDirections,\n          _booAddPinchZoom\n        );\n        break;\n      }\n      count++;\n    }\n    _arrHTMLtags = null;\n\n    if (\n      _domWhatElement.className &&\n      _domWhatElement.className['indexOf'] &&\n      _domWhatElement.className.indexOf('checkScrollingC') > -1\n    ) {\n      this._checkForScrolling(\n        _domWhatElement,\n        _booIsChildIScroll,\n        false,\n        _objSurpressDirections,\n        _booAddPinchZoom\n      );\n    }\n  },\n\n  getFirstScrollerChild: function(domId) {\n    var returnId = false;\n    var childScroller = $('#' + domId + ' .checkScrollingC').first();\n    if (childScroller.length > 0) {\n      returnId = childScroller[0].id;\n    }\n    return returnId;\n  },\n\n  setMaxScrollY: function(elementId, newMaxYPosition) {\n    if (ISCROLL_INTERFACE._objIScrollReferences[elementId]) {\n      ISCROLL_INTERFACE._objIScrollReferences[elementId].maxScrollY = newMaxYPosition;\n    }\n  },\n\n  getMaxScrollY: function(elementId) {\n    if (ISCROLL_INTERFACE._objIScrollReferences[elementId]) {\n      return ISCROLL_INTERFACE._objIScrollReferences[elementId].maxScrollY;\n    }\n    return false;\n  },\n\n  _checkForScrolling: function(\n    _domItemToCheck,\n    _booIsChildIScroll,\n    _booDebug,\n    _objSurpressDirections,\n    _booAddPinchZoom\n  ) {\n    // Detects whether this element needs scrolling\n    if (_domItemToCheck) {\n      if (\n        (_objSurpressDirections && !_objSurpressDirections['booHorizontal']) ||\n        !_objSurpressDirections\n      ) {\n        var _booIsWider = _domItemToCheck.scrollWidth > _domItemToCheck.offsetWidth;\n      }\n      if (\n        (_objSurpressDirections && !_objSurpressDirections['booVertical']) ||\n        !_objSurpressDirections\n      ) {\n        var _booIsHigher = _domItemToCheck.scrollHeight > _domItemToCheck.offsetHeight;\n      }\n\n      this._debug(\n        '_domItemToCheck.id: \\'' +\n          _domItemToCheck.id +\n          '\\' _booIsWider: ' +\n          _booIsWider +\n          ' _booIsHigher: ' +\n          _booIsHigher\n      );\n\n      if ((_booIsWider || _booIsHigher) && _domItemToCheck.lastChild.className != 'scrollWrapper') {\n        if (_booDebug) {\n          LOCALISER.l_alert('ISCROLL_INTERFACE_DEBUG_ADD_SCROLLING_MESSAGE');\n        }\n        this._debug('Adding iScroll with marker to ID: ' + _domItemToCheck.id);\n\n        // Filmstrip subscreens are built differently to normal subscreens. They do not have the\n        // checkscrollingC class where the _checkForParentIScrollInstances() function expects it to\n        // be so here we check if we are filmstrip subscreen and force _booIsChildIscroll to true.\n        var isFilmstripSubscreen =\n          _domItemToCheck.parentElement.parentElement.className.indexOf(\n            'filmstripStepWrapperC'\n          ) > -1;\n        if (isFilmstripSubscreen) {\n          _booIsChildIScroll = true;\n        } else {\n          _booIsChildIScroll = this._checkForParentIScrollInstances(_domItemToCheck);\n        }\n        this._applyIscroll(_domItemToCheck, _booIsChildIScroll, true, false, _booAddPinchZoom);\n      } else {\n        this._debug('Adding iScroll with NO marker to ID: ' + _domItemToCheck.id);\n        _booIsChildIScroll = this._checkForParentIScrollInstances(_domItemToCheck);\n        this._applyIscroll(_domItemToCheck, _booIsChildIScroll, false, false, _booAddPinchZoom);\n\n        if (_booDebug) {\n          LOCALISER.l_alert('ISCROLL_INTERFACE_DEBUG_NO_SCROLLING_MESSAGE');\n        }\n      }\n    }\n  },\n\n  _checkForParentIScrollInstances: function(_domItemToCheck) {\n    var _domCurrNode = _domItemToCheck.parentElement;\n    // Sometimes we pass in an element without a parent\n    if (_domCurrNode !== null) {\n      if (_domCurrNode.tagName && _domCurrNode.tagName.toLowerCase) {\n        while (_domCurrNode.tagName.toLowerCase() != 'body') {\n          if (\n            _domCurrNode.className &&\n            _domCurrNode.className['indexOf'] &&\n            _domCurrNode.className.indexOf('checkScrollingC') > -1\n          ) {\n            return true;\n          }\n          _domCurrNode = _domCurrNode.parentElement;\n          /* We're at the top of the dom tree without finding a checkScrolingC class.\n           * This can happen when we navigate away from a screen and change display\n           * conditions at the same time.\n           */\n          if (_domCurrNode !== null) {\n            break;\n          }\n        }\n      }\n    }\n    return false;\n  },\n\n  _applyIscroll: function(\n    _domOverflowLayer,\n    _booIsChildIScroll,\n    _booAddMarkerImage,\n    _objInitialOffsets,\n    _booAddPinchZoom\n  ) {\n    if (!_domOverflowLayer.id) {\n      this._addRandomID(_domOverflowLayer);\n    }\n\n    if (!this._objIScrollReferences[_domOverflowLayer.id]) {\n      var _arrScrollWrappers = false;\n      if (BOO_DYNAMIC_CONTINUOUS_SCROLLING) {\n        _arrScrollWrappers = [$('#contentWrapperInnerL')[0]];\n      } else {\n        _arrScrollWrappers = CORE.getElementsByClassName(_domOverflowLayer, 'scrollWrapperC');\n      }\n      var _intNonWhitespaceChildCount = this._getNonWhitespaceAndCommentChildCount(\n        _domOverflowLayer\n      );\n\n      if (_arrScrollWrappers.length == 0 && _intNonWhitespaceChildCount > 1) {\n        this._addScrollWrapper(_domOverflowLayer);\n      }\n\n      if (_booAddMarkerImage) {\n        this._addScrollMarker(_domOverflowLayer);\n      }\n\n      this._strPendingID = _domOverflowLayer.id;\n      this._addIScroll(_domOverflowLayer, _booIsChildIScroll, _objInitialOffsets, _booAddPinchZoom);\n    } else {\n      if (_booAddMarkerImage) {\n        this._addScrollMarker(_domOverflowLayer);\n      }\n      this._objIScrollReferences[_domOverflowLayer.id].enable();\n      this._objIScrollReferences[_domOverflowLayer.id].refresh();\n    }\n  },\n\n  _getNonWhitespaceAndCommentChildCount: function(_domOverflowLayer) {\n    var _arrChildNodes = _domOverflowLayer.childNodes;\n    var _arrNonTextChildNodes = [];\n    var count = 0;\n    while (count < _arrChildNodes.length) {\n      var _domCurrChild = _arrChildNodes[count];\n      if (_domCurrChild.nodeType != 3 && _domCurrChild.nodeType != 8) {\n        _arrNonTextChildNodes.push(_domCurrChild);\n      }\n      count++;\n    }\n    return _arrNonTextChildNodes.length;\n  },\n\n  _addScrollWrapper: function(_domOverflowLayer) {\n    _domOverflowLayer.innerHTML =\n      '<div class=\"scrollWrapperC\">' + _domOverflowLayer.innerHTML + '</div>';\n  },\n\n  _addRandomID: function(_domOverflowLayer) {\n    var _intDateString = new Date().getTime();\n    var _intRandomNumber = Math.ceil(Math.random() * 100000000);\n    var _strNewID = 'randomID_' + _intDateString + _intRandomNumber + 'L';\n    _domOverflowLayer.id = _strNewID;\n  },\n\n  _addIScroll: function(\n    _domOverflowLayer,\n    _booIsChildIScroll,\n    _objInitialOffsets,\n    _booAddPinchZoom\n  ) {\n    this._debug(\n      '_addIScroll(_domOverflowLayer.id: ' +\n        _domOverflowLayer.id +\n        ', _booIsChildIScroll: ' +\n        _booIsChildIScroll +\n        ', _objInitialOffsets: ' +\n        _objInitialOffsets +\n        ')'\n    );\n    if (this._objIScrollReferences[this._strPendingID]) {\n      this._debug('_addIScroll()::Recycling past instance...');\n      this._recycleScroller(this._strPendingID);\n    }\n\n    // Should prevent the propogation of events up to parent iScroll elements. Used\n    // for Filmstrip amougst others.\n    var _objConfigData = {};\n\n    _objConfigData['booIsChildIscroll'] = _booIsChildIScroll;\n    _objConfigData['hideScrollbar'] = true;\n    _objConfigData['fadeScrollbar'] = true;\n    _objConfigData['click'] = true;\n\n    if (_booAddPinchZoom) {\n      _objConfigData['zoom'] = true;\n      _objConfigData['zoomMin'] = 0.25;\n      _objConfigData['zoomMax'] = 8;\n      _objConfigData['zoomStart'] = 1;\n      _objConfigData['mouseWheel'] = true;\n      _objConfigData['wheelAction'] = 'zoom';\n      _objConfigData['freeScroll'] = true;\n    }\n\n    _objConfigData['freeScroll'] = true;\n    _objConfigData['scrollX'] = true;\n\n    _objConfigData['preventDefaultException'] = {\n      tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\n    };\n\n    _objConfigData['unscrollableElements'] = {\n      tagName: /^(TEXTAREA|VIDEO)$/\n    };\n\n    if (_objInitialOffsets) {\n      _objConfigData['x'] = _objInitialOffsets['intLeft'];\n      _objConfigData['y'] = _objInitialOffsets['intTop'];\n    }\n\n    var _funBeforeScrollStartHanlder = function(_objEventData) {\n      // PLEASE NOTE: 'booIsChildIscroll' is a config option we're adding an build time.\n      if (this.options.booIsChildIscroll) {\n        ISCROLL_INTERFACE._debug(\n          'onBeforeScrollStart()::_booIsChildIScroll = true, default prevented...'\n        );\n        EM.trigger('disableParentIScrollInstaces');\n      }\n    };\n\n    var _funScrollEndHanlder = function(_objEventData) {\n      if (this.options.booIsChildIscroll) {\n        ISCROLL_INTERFACE._debug(\n          'onBeforeScrollStart()::_booIsChildIScroll = true, default prevented...'\n        );\n        EM.trigger('enableParentIScrollInstaces');\n      }\n      SCROLLING_MANAGER.pollIscrollScrolling(this.y);\n    };\n\n    var _funScrollStartHandler = function(_objEventData) {\n      // Remove focus from any text areas to stop the stuck cursor issue.\n      var currScreenId = SCREEN_INTERACTIONS.getCurrentScreenData().strObjID;\n      if ( $('#screenWrapper_' + currScreenId + 'L').find('textarea').length ) {\n        $('#screenWrapper_' + currScreenId + 'L').find('textarea').blur();\n      }\n    };\n\n    this._objIScrollReferences[this._strPendingID] = new IScroll(_domOverflowLayer, _objConfigData);\n    this._objIScrollReferences[this._strPendingID].on(\n      'beforeScrollStart',\n      _funBeforeScrollStartHanlder\n    );\n    this._objIScrollReferences[this._strPendingID].on(\n      'scrollStart',\n      _funScrollStartHandler\n    );\n    this._objIScrollReferences[this._strPendingID].on('beforeScrollStart', function() {\n      ISCROLL_INTERFACE.hideScrollMarker(this);\n    });\n    this._objIScrollReferences[this._strPendingID].on('scrollEnd', _funScrollEndHanlder);\n\n    this._debug('_addIScroll()::iScroll added for element \\'' + this._strPendingID + '\\'');\n    this._debug('ISCROLL_INTERFACE::_addIScroll: ' + this._strPendingID);\n  },\n\n  _addScrollMarker: function(_domOverflowLayer) {\n    var _arrScrollMarkers = CORE.getElementsByClassName(_domOverflowLayer, 'scrollMarkerC');\n    if (_arrScrollMarkers.length == 0) {\n      var _domMarkerDiv = this._objCurrDOM.createElement('div');\n      _domMarkerDiv.className = 'scrollMarkerC';\n      var _domScrollMarkSprite = this._objCurrDOM.createElement('div');\n      _domMarkerDiv.appendChild(_domScrollMarkSprite);\n      _domOverflowLayer.appendChild(_domMarkerDiv);\n    }\n  },\n\n  _recycleScroller: function(_strWhatID) {\n    if (this._objIScrollReferences[_strWhatID]) {\n      this._objIScrollReferences[_strWhatID]['destroy']();\n      delete this._objIScrollReferences[_strWhatID];\n      this._debug('ISCROLL_INTERFACE::_recycleScroller: ' + _strWhatID);\n    }\n  },\n\n  _disableScroller: function(_strWhatID) {\n    this._debug('ISCROLL_INTERFACE._disableScroller');\n    if (this._objIScrollReferences[_strWhatID]) {\n      this._objIScrollReferences[_strWhatID]['disable']();\n      this._debug('ISCROLL_INTERFACE::_disableScroller: ' + _strWhatID);\n    }\n  },\n\n  _enableScroller: function(_strWhatID) {\n    if (this._objIScrollReferences[_strWhatID]) {\n      this._objIScrollReferences[_strWhatID]['enable']();\n      this._debug('ISCROLL_INTERFACE::_enableScroller: ' + _strWhatID);\n    }\n  },\n\n  // Only called by iScroll\n  allowTransformsOnElements: function(_domLayerToCheck) {\n    // Check for audio/video/other possible AV tags.\n    var _intNumberOfVideoTagChildren = _domLayerToCheck.getElementsByTagName('video').length;\n\n    // Issue has only been reported for video so far.\n    if (_intNumberOfVideoTagChildren > 0) {\n      // Detects the iOS version\n      var _booUseTransform = OUTPUT_MODE_CHECKER.useTransformForScrollingWithVideoAssets();\n      return _booUseTransform;\n    }\n\n    return true;\n  },\n\n  _debug: function(_strMessage) {\n    if (window['console'] && window.console.log && this._booDebug) {\n      console.log('ISCROLL_INTERFACE: ' + _strMessage);\n    }\n  }\n};\n\nEM.register(ISCROLL_INTERFACE);\n"},function(t,e,n){n(0)(n(121))},function(t,e){t.exports="/* eslint-disable */\n/* ! iScroll v5.1.2 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */\n// Added a CORE.pollIscrollScrolling call from the event handler - J.Hough\n\n(function(window, document, Math) {\n  var rAF =\n    window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function(callback) {\n      window.setTimeout(callback, 1000 / 60);\n    };\n\n  var utils = (function() {\n    var me = {};\n\n    var _elementStyle = document.createElement('div').style;\n    var _vendor = (function() {\n      var vendors = ['t', 'webkitT', 'MozT', 'msT', 'OT'],\n        transform,\n        i = 0,\n        l = vendors.length;\n\n      for (; i < l; i++) {\n        transform = vendors[i] + 'ransform';\n        if (transform in _elementStyle) return vendors[i].substr(0, vendors[i].length - 1);\n      }\n\n      return false;\n    })();\n\n    function _prefixStyle(style) {\n      if (_vendor === false) return false;\n      if (_vendor === '') return style;\n      return _vendor + style.charAt(0).toUpperCase() + style.substr(1);\n    }\n\n    me.getTime =\n      Date.now ||\n      function getTime() {\n        return new Date().getTime();\n      };\n\n    me.extend = function(target, obj) {\n      for (var i in obj) {\n        target[i] = obj[i];\n      }\n    };\n\n    me.addEvent = function(el, type, fn, capture) {\n      el.addEventListener(type, fn, !!capture);\n    };\n\n    me.removeEvent = function(el, type, fn, capture) {\n      el.removeEventListener(type, fn, !!capture);\n    };\n\n    me.prefixPointerEvent = function(pointerEvent) {\n      return window.MSPointerEvent\n        ? 'MSPointer' + pointerEvent.charAt(9).toUpperCase() + pointerEvent.substr(10)\n        : pointerEvent;\n    };\n\n    me.momentum = function(current, start, time, lowerMargin, wrapperSize, deceleration) {\n      var distance = current - start,\n        speed = Math.abs(distance) / time,\n        destination,\n        duration;\n\n      deceleration = deceleration === undefined ? 0.0006 : deceleration;\n\n      destination = current + ((speed * speed) / (2 * deceleration)) * (distance < 0 ? -1 : 1);\n      duration = speed / deceleration;\n\n      if (destination < lowerMargin) {\n        destination = wrapperSize ? lowerMargin - (wrapperSize / 2.5) * (speed / 8) : lowerMargin;\n        distance = Math.abs(destination - current);\n        duration = distance / speed;\n      } else if (destination > 0) {\n        destination = wrapperSize ? (wrapperSize / 2.5) * (speed / 8) : 0;\n        distance = Math.abs(current) + destination;\n        duration = distance / speed;\n      }\n\n      return {\n        destination: Math.round(destination),\n        duration: duration\n      };\n    };\n\n    var _transform = _prefixStyle('transform');\n\n    me.extend(me, {\n      hasTransform: _transform !== false,\n      hasPerspective: _prefixStyle('perspective') in _elementStyle,\n      hasTouch: 'ontouchstart' in window,\n      hasPointer: window.PointerEvent || window.MSPointerEvent, // IE10 is prefixed\n      hasTransition: _prefixStyle('transition') in _elementStyle\n    });\n\n    // This should find all Android browsers lower than build 535.19 (both stock browser and webview)\n    me.isBadAndroid =\n      /Android /.test(window.navigator.appVersion) &&\n      !/Chrome\\/\\d/.test(window.navigator.appVersion);\n\n    me.extend((me.style = {}), {\n      transform: _transform,\n      transitionTimingFunction: _prefixStyle('transitionTimingFunction'),\n      transitionDuration: _prefixStyle('transitionDuration'),\n      transitionDelay: _prefixStyle('transitionDelay'),\n      transformOrigin: _prefixStyle('transformOrigin')\n    });\n\n    me.hasClass = function(e, c) {\n      var re = new RegExp('(^|\\\\s)' + c + '(\\\\s|$)');\n      return re.test(e.className);\n    };\n\n    me.addClass = function(e, c) {\n      if (me.hasClass(e, c)) {\n        return;\n      }\n\n      var newclass = e.className.split(' ');\n      newclass.push(c);\n      e.className = newclass.join(' ');\n    };\n\n    me.removeClass = function(e, c) {\n      if (!me.hasClass(e, c)) {\n        return;\n      }\n\n      var re = new RegExp('(^|\\\\s)' + c + '(\\\\s|$)', 'g');\n      e.className = e.className.replace(re, ' ');\n    };\n\n    me.offset = function(el) {\n      var left = -el.offsetLeft,\n        top = -el.offsetTop;\n\n      // jshint -W084\n      while ((el = el.offsetParent)) {\n        left -= el.offsetLeft;\n        top -= el.offsetTop;\n      }\n      // jshint +W084\n\n      return {\n        left: left,\n        top: top\n      };\n    };\n\n    me.preventDefaultException = function(el, exceptions) {\n      for (var i in exceptions) {\n        if (exceptions[i].test(el[i])) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    me.extend((me.eventType = {}), {\n      touchstart: 1,\n      touchmove: 1,\n      touchend: 1,\n\n      mousedown: 2,\n      mousemove: 2,\n      mouseup: 2,\n\n      pointerdown: 3,\n      pointermove: 3,\n      pointerup: 3,\n\n      MSPointerDown: 3,\n      MSPointerMove: 3,\n      MSPointerUp: 3\n    });\n\n    me.extend((me.ease = {}), {\n      quadratic: {\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n        fn: function(k) {\n          return k * (2 - k);\n        }\n      },\n      circular: {\n        style: 'cubic-bezier(0.1, 0.57, 0.1, 1)', // Not properly \"circular\" but this looks better, it should be (0.075, 0.82, 0.165, 1)\n        fn: function(k) {\n          return Math.sqrt(1 - --k * k);\n        }\n      },\n      back: {\n        style: 'cubic-bezier(0.175, 0.885, 0.32, 1.275)',\n        fn: function(k) {\n          var b = 4;\n          return (k = k - 1) * k * ((b + 1) * k + b) + 1;\n        }\n      },\n      bounce: {\n        style: '',\n        fn: function(k) {\n          if ((k /= 1) < 1 / 2.75) {\n            return 7.5625 * k * k;\n          } else if (k < 2 / 2.75) {\n            return 7.5625 * (k -= 1.5 / 2.75) * k + 0.75;\n          } else if (k < 2.5 / 2.75) {\n            return 7.5625 * (k -= 2.25 / 2.75) * k + 0.9375;\n          } else {\n            return 7.5625 * (k -= 2.625 / 2.75) * k + 0.984375;\n          }\n        }\n      },\n      elastic: {\n        style: '',\n        fn: function(k) {\n          var f = 0.22,\n            e = 0.4;\n\n          if (k === 0) {\n            return 0;\n          }\n          if (k == 1) {\n            return 1;\n          }\n\n          return e * Math.pow(2, -10 * k) * Math.sin(((k - f / 4) * (2 * Math.PI)) / f) + 1;\n        }\n      }\n    });\n\n    me.tap = function(e, eventName) {\n      var ev = document.createEvent('Event');\n      ev.initEvent(eventName, true, true);\n      ev.pageX = e.pageX;\n      ev.pageY = e.pageY;\n      e.target.dispatchEvent(ev);\n    };\n\n    me.click = function(e) {\n      var target = e.target,\n        ev;\n\n      if (!/(SELECT|INPUT|TEXTAREA)/i.test(target.tagName)) {\n        ev = document.createEvent('MouseEvents');\n        ev.initMouseEvent(\n          'click',\n          true,\n          true,\n          e.view,\n          1,\n          target.screenX,\n          target.screenY,\n          target.clientX,\n          target.clientY,\n          e.ctrlKey,\n          e.altKey,\n          e.shiftKey,\n          e.metaKey,\n          0,\n          null\n        );\n\n        ev._constructed = true;\n        target.dispatchEvent(ev);\n      }\n    };\n\n    return me;\n  })();\n\n  function IScroll(el, options) {\n    this.wrapper = typeof el == 'string' ? document.querySelector(el) : el;\n    this.scroller = this.wrapper.children[0];\n    this.scrollerStyle = this.scroller.style; // cache style for better performance\n\n    this.options = {\n      zoomMin: 1,\n      zoomMax: 4,\n      startZoom: 1,\n\n      resizeScrollbars: true,\n\n      mouseWheelSpeed: 20,\n\n      snapThreshold: 0.334,\n\n      // INSERT POINT: OPTIONS\n\n      startX: 0,\n      startY: 0,\n      scrollY: true,\n      directionLockThreshold: 5,\n      momentum: true,\n\n      bounce: true,\n      bounceTime: 600,\n      bounceEasing: '',\n\n      preventDefault: true,\n      preventDefaultException: {tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT)$/},\n\n      HWCompositing: true,\n      useTransition: true,\n      useTransform: true\n    };\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    // Normalize options\n    this.translateZ = this.options.HWCompositing && utils.hasPerspective ? ' translateZ(0)' : '';\n\n    this.options.useTransition = utils.hasTransition && this.options.useTransition;\n    this.options.useTransform = utils.hasTransform && this.options.useTransform;\n\n    this.options.eventPassthrough =\n      this.options.eventPassthrough === true ? 'vertical' : this.options.eventPassthrough;\n    this.options.preventDefault = !this.options.eventPassthrough && this.options.preventDefault;\n\n    // If you want eventPassthrough I have to lock one of the axes\n    this.options.scrollY =\n      this.options.eventPassthrough == 'vertical' ? false : this.options.scrollY;\n    this.options.scrollX =\n      this.options.eventPassthrough == 'horizontal' ? false : this.options.scrollX;\n\n    // With eventPassthrough we also need lockDirection mechanism\n    this.options.freeScroll = this.options.freeScroll && !this.options.eventPassthrough;\n    this.options.directionLockThreshold = this.options.eventPassthrough\n      ? 0\n      : this.options.directionLockThreshold;\n\n    this.options.bounceEasing =\n      typeof this.options.bounceEasing == 'string'\n        ? utils.ease[this.options.bounceEasing] || utils.ease.circular\n        : this.options.bounceEasing;\n\n    this.options.resizePolling =\n      this.options.resizePolling === undefined ? 60 : this.options.resizePolling;\n\n    if (this.options.tap === true) {\n      this.options.tap = 'tap';\n    }\n\n    if (this.options.shrinkScrollbars == 'scale') {\n      this.options.useTransition = false;\n    }\n\n    this.options.invertWheelDirection = this.options.invertWheelDirection ? -1 : 1;\n\n    // INSERT POINT: NORMALIZATION\n\n    // Some defaults\n    this.x = 0;\n    this.y = 0;\n    this.directionX = 0;\n    this.directionY = 0;\n    this._events = {};\n\n    this.scale = Math.min(\n      Math.max(this.options.startZoom, this.options.zoomMin),\n      this.options.zoomMax\n    );\n\n    // INSERT POINT: DEFAULTS\n\n    this._init();\n    this.refresh();\n\n    this.scrollTo(this.options.startX, this.options.startY);\n    this.enable();\n  }\n\n  IScroll.prototype = {\n    version: '5.1.2',\n\n    _init: function() {\n      this._initEvents();\n\n      if (this.options.zoom) {\n        this._initZoom();\n      }\n\n      if (this.options.scrollbars || this.options.indicators) {\n        this._initIndicators();\n      }\n\n      if (this.options.mouseWheel) {\n        this._initWheel();\n      }\n\n      if (this.options.snap) {\n        this._initSnap();\n      }\n\n      if (this.options.keyBindings) {\n        this._initKeys();\n      }\n\n      // INSERT POINT: _init\n    },\n\n    destroy: function() {\n      this._initEvents(true);\n\n      this._execEvent('destroy');\n    },\n\n    _transitionEnd: function(e) {\n      if (e.target != this.scroller || !this.isInTransition) {\n        return;\n      }\n\n      this._transitionTime();\n      if (!this.resetPosition(this.options.bounceTime)) {\n        this.isInTransition = false;\n        this._execEvent('scrollEnd');\n      }\n    },\n\n    // Certain elements shouldn't be scrollable because they cause lots of issues when they are\n    testForUnscrollableElements: function(e) {\n      if (typeof e.target !== 'undefined' && typeof e.target.tagName !== 'undefined') {\n        for (var i in this.options.unscrollableElements) {\n          if (this.options.unscrollableElements[i].test(e.target[i])) {\n            return true;\n          }\n        }\n      }\n      return false;\n    },\n\n    _start: function(e) {\n      // React to left mouse button only\n      if (utils.eventType[e.type] != 1) {\n        if (e.button !== 0) {\n          return;\n        }\n      }\n\n      if (!this.enabled || (this.initiated && utils.eventType[e.type] !== this.initiated)) {\n        return;\n      }\n\n      // If ipad video element\n      if (this.testForUnscrollableElements(e)) {\n        return;\n      }\n\n      if (\n        this.options.preventDefault &&\n        !utils.isBadAndroid &&\n        !utils.preventDefaultException(e.target, this.options.preventDefaultException)\n      ) {\n        e.preventDefault();\n      }\n\n      var point = e.touches ? e.touches[0] : e,\n        pos;\n\n      this.initiated = utils.eventType[e.type];\n      this.moved = false;\n      this.distX = 0;\n      this.distY = 0;\n      this.directionX = 0;\n      this.directionY = 0;\n      this.directionLocked = 0;\n\n      this._transitionTime();\n\n      this.startTime = utils.getTime();\n\n      if (this.options.useTransition && this.isInTransition) {\n        this.isInTransition = false;\n        pos = this.getComputedPosition();\n        this._translate(Math.round(pos.x), Math.round(pos.y));\n        this._execEvent('scrollEnd');\n      } else if (!this.options.useTransition && this.isAnimating) {\n        this.isAnimating = false;\n        this._execEvent('scrollEnd');\n      }\n\n      this.startX = this.x;\n      this.startY = this.y;\n      this.absStartX = this.x;\n      this.absStartY = this.y;\n      this.pointX = point.pageX;\n      this.pointY = point.pageY;\n\n      this._execEvent('beforeScrollStart');\n    },\n\n    _move: function(e) {\n      if (!this.enabled || utils.eventType[e.type] !== this.initiated) {\n        return;\n      }\n\n      // If ipad video element\n      if (this.testForUnscrollableElements(e)) {\n        return;\n      }\n\n      if (this.options.preventDefault) {\n        // increases performance on Android? TODO: check!\n        e.preventDefault();\n      }\n\n      var point = e.touches ? e.touches[0] : e,\n        deltaX = point.pageX - this.pointX,\n        deltaY = point.pageY - this.pointY,\n        timestamp = utils.getTime(),\n        newX,\n        newY,\n        absDistX,\n        absDistY;\n\n      this.pointX = point.pageX;\n      this.pointY = point.pageY;\n\n      this.distX += deltaX;\n      this.distY += deltaY;\n      absDistX = Math.abs(this.distX);\n      absDistY = Math.abs(this.distY);\n\n      // We need to move at least 10 pixels for the scrolling to initiate\n      if (timestamp - this.endTime > 300 && (absDistX < 10 && absDistY < 10)) {\n        return;\n      }\n\n      // If you are scrolling in one direction lock the other\n      if (!this.directionLocked && !this.options.freeScroll) {\n        if (absDistX > absDistY + this.options.directionLockThreshold) {\n          this.directionLocked = 'h'; // lock horizontally\n        } else if (absDistY >= absDistX + this.options.directionLockThreshold) {\n          this.directionLocked = 'v'; // lock vertically\n        } else {\n          this.directionLocked = 'n'; // no lock\n        }\n      }\n\n      if (this.directionLocked == 'h') {\n        if (this.options.eventPassthrough == 'vertical') {\n          e.preventDefault();\n        } else if (this.options.eventPassthrough == 'horizontal') {\n          this.initiated = false;\n          return;\n        }\n\n        deltaY = 0;\n      } else if (this.directionLocked == 'v') {\n        if (this.options.eventPassthrough == 'horizontal') {\n          e.preventDefault();\n        } else if (this.options.eventPassthrough == 'vertical') {\n          this.initiated = false;\n          return;\n        }\n\n        deltaX = 0;\n      }\n\n      deltaX = this.hasHorizontalScroll ? deltaX : 0;\n      deltaY = this.hasVerticalScroll ? deltaY : 0;\n\n      newX = this.x + deltaX;\n      newY = this.y + deltaY;\n\n      // Slow down if outside of the boundaries\n      if (newX > 0 || newX < this.maxScrollX) {\n        newX = this.options.bounce ? this.x + deltaX / 3 : newX > 0 ? 0 : this.maxScrollX;\n      }\n      if (newY > 0 || newY < this.maxScrollY) {\n        newY = this.options.bounce ? this.y + deltaY / 3 : newY > 0 ? 0 : this.maxScrollY;\n      }\n\n      this.directionX = deltaX > 0 ? -1 : deltaX < 0 ? 1 : 0;\n      this.directionY = deltaY > 0 ? -1 : deltaY < 0 ? 1 : 0;\n\n      if (!this.moved) {\n        this._execEvent('scrollStart');\n      }\n\n      this.moved = true;\n\n      this._translate(newX, newY);\n\n      /* REPLACE START: _move */\n\n      if (timestamp - this.startTime > 300) {\n        this.startTime = timestamp;\n        this.startX = this.x;\n        this.startY = this.y;\n      }\n\n      /* REPLACE END: _move */\n    },\n\n    _end: function(e) {\n      if (!this.enabled || utils.eventType[e.type] !== this.initiated) {\n        return;\n      }\n\n      // If ipad video element\n      if (this.testForUnscrollableElements(e)) {\n        return;\n      }\n\n      if (\n        this.options.preventDefault &&\n        !utils.preventDefaultException(e.target, this.options.preventDefaultException)\n      ) {\n        e.preventDefault();\n      }\n\n      var point = e.changedTouches ? e.changedTouches[0] : e,\n        momentumX,\n        momentumY,\n        duration = utils.getTime() - this.startTime,\n        newX = Math.round(this.x),\n        newY = Math.round(this.y),\n        distanceX = Math.abs(newX - this.startX),\n        distanceY = Math.abs(newY - this.startY),\n        time = 0,\n        easing = '';\n\n      this.isInTransition = 0;\n      this.initiated = 0;\n      this.endTime = utils.getTime();\n\n      // reset if we are outside of the boundaries\n      if (this.resetPosition(this.options.bounceTime)) {\n        return;\n      }\n\n      this.scrollTo(newX, newY); // ensures that the last position is rounded\n\n      // we scrolled less than 10 pixels\n      if (!this.moved) {\n        if (this.options.tap) {\n          utils.tap(e, this.options.tap);\n        }\n\n        if (this.options.click) {\n          utils.click(e);\n        }\n\n        this._execEvent('scrollCancel');\n        return;\n      }\n\n      if (this._events.flick && duration < 200 && distanceX < 100 && distanceY < 100) {\n        this._execEvent('flick');\n        return;\n      }\n\n      // start momentum animation if needed\n      if (this.options.momentum && duration < 300) {\n        momentumX = this.hasHorizontalScroll\n          ? utils.momentum(\n            this.x,\n            this.startX,\n            duration,\n            this.maxScrollX,\n            this.options.bounce ? this.wrapperWidth : 0,\n            this.options.deceleration\n          )\n          : {destination: newX, duration: 0};\n        momentumY = this.hasVerticalScroll\n          ? utils.momentum(\n            this.y,\n            this.startY,\n            duration,\n            this.maxScrollY,\n            this.options.bounce ? this.wrapperHeight : 0,\n            this.options.deceleration\n          )\n          : {destination: newY, duration: 0};\n        newX = momentumX.destination;\n        newY = momentumY.destination;\n        time = Math.max(momentumX.duration, momentumY.duration);\n        this.isInTransition = 1;\n\n        // JH - gomo function to run 10 updates to the scrollmanager while the final animation renders\n        var animationPoll = setInterval(function() {\n          SCROLLING_MANAGER.pollIscrollScrolling();\n          $('#contentWrapperInnerL').trigger('iscroll');\n        }, time / 60);\n\n        setTimeout(function() {\n          clearInterval(animationPoll);\n        }, time);\n      }\n\n      if (this.options.snap) {\n        var snap = this._nearestSnap(newX, newY);\n        this.currentPage = snap;\n        time =\n          this.options.snapSpeed ||\n          Math.max(\n            Math.max(\n              Math.min(Math.abs(newX - snap.x), 1000),\n              Math.min(Math.abs(newY - snap.y), 1000)\n            ),\n            300\n          );\n        newX = snap.x;\n        newY = snap.y;\n\n        this.directionX = 0;\n        this.directionY = 0;\n        easing = this.options.bounceEasing;\n      }\n\n      // INSERT POINT: _end\n\n      if (newX != this.x || newY != this.y) {\n        // change easing function when scroller goes out of the boundaries\n        if (newX > 0 || newX < this.maxScrollX || newY > 0 || newY < this.maxScrollY) {\n          easing = utils.ease.quadratic;\n        }\n\n        this.scrollTo(newX, newY, time, easing);\n        return;\n      }\n\n      this._execEvent('scrollEnd');\n    },\n\n    _resize: function() {\n      var that = this;\n\n      clearTimeout(this.resizeTimeout);\n\n      this.resizeTimeout = setTimeout(function() {\n        that.refresh();\n      }, this.options.resizePolling);\n    },\n\n    resetPosition: function(time) {\n      var x = this.x,\n        y = this.y;\n\n      time = time || 0;\n\n      if (!this.hasHorizontalScroll || this.x > 0) {\n        x = 0;\n      } else if (this.x < this.maxScrollX) {\n        x = this.maxScrollX;\n      }\n\n      if (!this.hasVerticalScroll || this.y > 0) {\n        y = 0;\n      } else if (this.y < this.maxScrollY) {\n        y = this.maxScrollY;\n      }\n\n      if (x == this.x && y == this.y) {\n        return false;\n      }\n\n      this.scrollTo(x, y, time, this.options.bounceEasing);\n\n      return true;\n    },\n\n    disable: function() {\n      this.enabled = false;\n    },\n\n    enable: function() {\n      this.enabled = true;\n    },\n\n    refresh: function() {\n      var rf = this.wrapper.offsetHeight; // Force reflow\n\n      this.wrapperWidth = this.wrapper.clientWidth;\n      this.wrapperHeight = this.wrapper.clientHeight;\n\n      /* REPLACE START: refresh */\n      this.scrollerWidth = Math.round(this.scroller.offsetWidth * this.scale);\n      this.scrollerHeight = Math.round(this.scroller.offsetHeight * this.scale);\n\n      this.maxScrollX = this.wrapperWidth - this.scrollerWidth;\n      this.maxScrollY = this.wrapperHeight - this.scrollerHeight;\n      /* REPLACE END: refresh */\n\n      this.hasHorizontalScroll = this.options.scrollX && this.maxScrollX < 0;\n      this.hasVerticalScroll = this.options.scrollY && this.maxScrollY < 0;\n\n      if (!this.hasHorizontalScroll) {\n        this.maxScrollX = 0;\n        this.scrollerWidth = this.wrapperWidth;\n      }\n\n      if (!this.hasVerticalScroll) {\n        this.maxScrollY = 0;\n        this.scrollerHeight = this.wrapperHeight;\n      }\n\n      this.endTime = 0;\n      this.directionX = 0;\n      this.directionY = 0;\n\n      this.wrapperOffset = utils.offset(this.wrapper);\n\n      this._execEvent('refresh');\n\n      this.resetPosition();\n\n      // INSERT POINT: _refresh\n    },\n\n    on: function(type, fn) {\n      if (!this._events[type]) {\n        this._events[type] = [];\n      }\n\n      this._events[type].push(fn);\n    },\n\n    off: function(type, fn) {\n      if (!this._events[type]) {\n        return;\n      }\n\n      var index = this._events[type].indexOf(fn);\n\n      if (index > -1) {\n        this._events[type].splice(index, 1);\n      }\n    },\n\n    _execEvent: function(type) {\n      if (!this._events[type]) {\n        return;\n      }\n\n      var i = 0,\n        l = this._events[type].length;\n\n      if (!l) {\n        return;\n      }\n\n      for (; i < l; i++) {\n        this._events[type][i].apply(this, [].slice.call(arguments, 1));\n      }\n    },\n\n    scrollBy: function(x, y, time, easing) {\n      x = this.x + x;\n      y = this.y + y;\n      time = time || 0;\n\n      this.scrollTo(x, y, time, easing);\n    },\n\n    scrollTo: function(x, y, time, easing) {\n      easing = easing || utils.ease.circular;\n\n      this.isInTransition = this.options.useTransition && time > 0;\n\n      if (!time || (this.options.useTransition && easing.style)) {\n        this._transitionTimingFunction(easing.style);\n        this._transitionTime(time);\n        this._translate(x, y);\n      } else {\n        this._animate(x, y, time, easing.fn);\n      }\n    },\n\n    scrollToElement: function(el, time, offsetX, offsetY, easing) {\n      el = el.nodeType ? el : this.scroller.querySelector(el);\n\n      if (!el) {\n        return;\n      }\n\n      var pos = utils.offset(el);\n\n      pos.left -= this.wrapperOffset.left;\n      pos.top -= this.wrapperOffset.top;\n\n      // if offsetX/Y are true we center the element to the screen\n      if (offsetX === true) {\n        offsetX = Math.round(el.offsetWidth / 2 - this.wrapper.offsetWidth / 2);\n      }\n      if (offsetY === true) {\n        offsetY = Math.round(el.offsetHeight / 2 - this.wrapper.offsetHeight / 2);\n      }\n\n      pos.left -= offsetX || 0;\n      pos.top -= offsetY || 0;\n\n      pos.left = pos.left > 0 ? 0 : pos.left < this.maxScrollX ? this.maxScrollX : pos.left;\n      pos.top = pos.top > 0 ? 0 : pos.top < this.maxScrollY ? this.maxScrollY : pos.top;\n\n      time =\n        time === undefined || time === null || time === 'auto'\n          ? Math.max(Math.abs(this.x - pos.left), Math.abs(this.y - pos.top))\n          : time;\n\n      this.scrollTo(pos.left, pos.top, time, easing);\n    },\n\n    _transitionTime: function(time) {\n      time = time || 0;\n\n      this.scrollerStyle[utils.style.transitionDuration] = time + 'ms';\n\n      if (!time && utils.isBadAndroid) {\n        this.scrollerStyle[utils.style.transitionDuration] = '0.001s';\n      }\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--; ) {\n          this.indicators[i].transitionTime(time);\n        }\n      }\n\n      // INSERT POINT: _transitionTime\n    },\n\n    _transitionTimingFunction: function(easing) {\n      this.scrollerStyle[utils.style.transitionTimingFunction] = easing;\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--; ) {\n          this.indicators[i].transitionTimingFunction(easing);\n        }\n      }\n\n      // INSERT POINT: _transitionTimingFunction\n    },\n\n    _translate: function(x, y) {\n      if (this.options.useTransform) {\n        /* REPLACE START: _translate */ this.scrollerStyle[utils.style.transform] =\n          'translate(' +\n          x +\n          'px,' +\n          y +\n          'px) scale(' +\n          this.scale +\n          ') ' +\n          this.translateZ; /* REPLACE END: _translate */\n      } else {\n        x = Math.round(x);\n        y = Math.round(y);\n        this.scrollerStyle.left = x + 'px';\n        this.scrollerStyle.top = y + 'px';\n      }\n\n      this.x = x;\n      this.y = y;\n\n      if (this.indicators) {\n        for (var i = this.indicators.length; i--; ) {\n          this.indicators[i].updatePosition();\n        }\n      }\n\n      // INSERT POINT: _translate\n    },\n\n    _initEvents: function(remove) {\n      var eventType = remove ? utils.removeEvent : utils.addEvent,\n        target = this.options.bindToWrapper ? this.wrapper : window;\n\n      eventType(window, 'orientationchange', this);\n      eventType(window, 'resize', this);\n\n      if (this.options.click) {\n        eventType(this.wrapper, 'click', this, true);\n      }\n\n      if (!this.options.disableMouse) {\n        eventType(this.wrapper, 'mousedown', this);\n        eventType(target, 'mousemove', this);\n        eventType(target, 'mousecancel', this);\n        eventType(target, 'mouseup', this);\n      }\n\n      if (utils.hasPointer && !this.options.disablePointer) {\n        eventType(this.wrapper, utils.prefixPointerEvent('pointerdown'), this);\n        eventType(target, utils.prefixPointerEvent('pointermove'), this);\n        eventType(target, utils.prefixPointerEvent('pointercancel'), this);\n        eventType(target, utils.prefixPointerEvent('pointerup'), this);\n      }\n\n      if (utils.hasTouch && !this.options.disableTouch) {\n        eventType(this.wrapper, 'touchstart', this);\n        eventType(target, 'touchmove', this);\n        eventType(target, 'touchcancel', this);\n        eventType(target, 'touchend', this);\n      }\n\n      eventType(this.scroller, 'transitionend', this);\n      eventType(this.scroller, 'webkitTransitionEnd', this);\n      eventType(this.scroller, 'oTransitionEnd', this);\n      eventType(this.scroller, 'MSTransitionEnd', this);\n    },\n\n    getComputedPosition: function() {\n      var matrix = window.getComputedStyle(this.scroller, null),\n        x,\n        y;\n\n      if (this.options.useTransform) {\n        matrix = matrix[utils.style.transform].split(')')[0].split(', ');\n        x = +(matrix[12] || matrix[4]);\n        y = +(matrix[13] || matrix[5]);\n      } else {\n        x = +matrix.left.replace(/[^-\\d.]/g, '');\n        y = +matrix.top.replace(/[^-\\d.]/g, '');\n      }\n\n      return {x: x, y: y};\n    },\n\n    _initIndicators: function() {\n      var interactive = this.options.interactiveScrollbars,\n        customStyle = typeof this.options.scrollbars != 'string',\n        indicators = [],\n        indicator;\n\n      var that = this;\n\n      this.indicators = [];\n\n      if (this.options.scrollbars) {\n        // Vertical scrollbar\n        if (this.options.scrollY) {\n          indicator = {\n            el: createDefaultScrollbar('v', interactive, this.options.scrollbars),\n            interactive: interactive,\n            defaultScrollbars: true,\n            customStyle: customStyle,\n            resize: this.options.resizeScrollbars,\n            shrink: this.options.shrinkScrollbars,\n            fade: this.options.fadeScrollbars,\n            listenX: false\n          };\n\n          this.wrapper.appendChild(indicator.el);\n          indicators.push(indicator);\n        }\n\n        // Horizontal scrollbar\n        if (this.options.scrollX) {\n          indicator = {\n            el: createDefaultScrollbar('h', interactive, this.options.scrollbars),\n            interactive: interactive,\n            defaultScrollbars: true,\n            customStyle: customStyle,\n            resize: this.options.resizeScrollbars,\n            shrink: this.options.shrinkScrollbars,\n            fade: this.options.fadeScrollbars,\n            listenY: false\n          };\n\n          this.wrapper.appendChild(indicator.el);\n          indicators.push(indicator);\n        }\n      }\n\n      if (this.options.indicators) {\n        // TODO: check concat compatibility\n        indicators = indicators.concat(this.options.indicators);\n      }\n\n      for (var i = indicators.length; i--; ) {\n        this.indicators.push(new Indicator(this, indicators[i]));\n      }\n\n      // TODO: check if we can use array.map (wide compatibility and performance issues)\n      function _indicatorsMap(fn) {\n        for (var i = that.indicators.length; i--; ) {\n          fn.call(that.indicators[i]);\n        }\n      }\n\n      if (this.options.fadeScrollbars) {\n        this.on('scrollEnd', function() {\n          _indicatorsMap(function() {\n            this.fade();\n          });\n        });\n\n        this.on('scrollCancel', function() {\n          _indicatorsMap(function() {\n            this.fade();\n          });\n        });\n\n        this.on('scrollStart', function() {\n          _indicatorsMap(function() {\n            this.fade(1);\n          });\n        });\n\n        this.on('beforeScrollStart', function() {\n          _indicatorsMap(function() {\n            this.fade(1, true);\n          });\n        });\n      }\n\n      this.on('refresh', function() {\n        _indicatorsMap(function() {\n          this.refresh();\n        });\n      });\n\n      this.on('destroy', function() {\n        _indicatorsMap(function() {\n          this.destroy();\n        });\n\n        delete this.indicators;\n      });\n    },\n\n    _initZoom: function() {\n      this.scrollerStyle[utils.style.transformOrigin] = '0 0';\n    },\n\n    _zoomStart: function(e) {\n      var c1 = Math.abs(e.touches[0].pageX - e.touches[1].pageX),\n        c2 = Math.abs(e.touches[0].pageY - e.touches[1].pageY);\n\n      this.touchesDistanceStart = Math.sqrt(c1 * c1 + c2 * c2);\n      this.startScale = this.scale;\n\n      this.originX =\n        Math.abs(e.touches[0].pageX + e.touches[1].pageX) / 2 + this.wrapperOffset.left - this.x;\n      this.originY =\n        Math.abs(e.touches[0].pageY + e.touches[1].pageY) / 2 + this.wrapperOffset.top - this.y;\n\n      this._execEvent('zoomStart');\n    },\n\n    _zoom: function(e) {\n      if (!this.enabled || utils.eventType[e.type] !== this.initiated) {\n        return;\n      }\n\n      if (this.options.preventDefault) {\n        e.preventDefault();\n      }\n\n      var c1 = Math.abs(e.touches[0].pageX - e.touches[1].pageX),\n        c2 = Math.abs(e.touches[0].pageY - e.touches[1].pageY),\n        distance = Math.sqrt(c1 * c1 + c2 * c2),\n        scale = (1 / this.touchesDistanceStart) * distance * this.startScale,\n        lastScale,\n        x,\n        y;\n\n      this.scaled = true;\n\n      if (scale < this.options.zoomMin) {\n        scale = 0.5 * this.options.zoomMin * Math.pow(2.0, scale / this.options.zoomMin);\n      } else if (scale > this.options.zoomMax) {\n        scale = 2.0 * this.options.zoomMax * Math.pow(0.5, this.options.zoomMax / scale);\n      }\n\n      lastScale = scale / this.startScale;\n      x = this.originX - this.originX * lastScale + this.startX;\n      y = this.originY - this.originY * lastScale + this.startY;\n\n      this.scale = scale;\n\n      this.scrollTo(x, y, 0);\n    },\n\n    _zoomEnd: function(e) {\n      if (!this.enabled || utils.eventType[e.type] !== this.initiated) {\n        return;\n      }\n\n      if (this.options.preventDefault) {\n        e.preventDefault();\n      }\n\n      var newX, newY, lastScale;\n\n      this.isInTransition = 0;\n      this.initiated = 0;\n\n      if (this.scale > this.options.zoomMax) {\n        this.scale = this.options.zoomMax;\n      } else if (this.scale < this.options.zoomMin) {\n        this.scale = this.options.zoomMin;\n      }\n\n      // Update boundaries\n      this.refresh();\n\n      lastScale = this.scale / this.startScale;\n\n      newX = this.originX - this.originX * lastScale + this.startX;\n      newY = this.originY - this.originY * lastScale + this.startY;\n\n      if (newX > 0) {\n        newX = 0;\n      } else if (newX < this.maxScrollX) {\n        newX = this.maxScrollX;\n      }\n\n      if (newY > 0) {\n        newY = 0;\n      } else if (newY < this.maxScrollY) {\n        newY = this.maxScrollY;\n      }\n\n      if (this.x != newX || this.y != newY) {\n        this.scrollTo(newX, newY, this.options.bounceTime);\n      }\n\n      this.scaled = false;\n\n      this._execEvent('zoomEnd');\n    },\n\n    zoom: function(scale, x, y, time) {\n      if (scale < this.options.zoomMin) {\n        scale = this.options.zoomMin;\n      } else if (scale > this.options.zoomMax) {\n        scale = this.options.zoomMax;\n      }\n\n      if (scale == this.scale) {\n        return;\n      }\n\n      var relScale = scale / this.scale;\n\n      x = x === undefined ? this.wrapperWidth / 2 : x;\n      y = y === undefined ? this.wrapperHeight / 2 : y;\n      time = time === undefined ? 300 : time;\n\n      x = x + this.wrapperOffset.left - this.x;\n      y = y + this.wrapperOffset.top - this.y;\n\n      x = x - x * relScale + this.x;\n      y = y - y * relScale + this.y;\n\n      this.scale = scale;\n\n      this.refresh(); // update boundaries\n\n      if (x > 0) {\n        x = 0;\n      } else if (x < this.maxScrollX) {\n        x = this.maxScrollX;\n      }\n\n      if (y > 0) {\n        y = 0;\n      } else if (y < this.maxScrollY) {\n        y = this.maxScrollY;\n      }\n\n      this.scrollTo(x, y, time);\n    },\n\n    _wheelZoom: function(e) {\n      var wheelDeltaY,\n        deltaScale,\n        that = this;\n\n      // Execute the zoomEnd event after 400ms the wheel stopped scrolling\n      clearTimeout(this.wheelTimeout);\n      this.wheelTimeout = setTimeout(function() {\n        that._execEvent('zoomEnd');\n      }, 400);\n\n      if ('deltaX' in e) {\n        wheelDeltaY = -e.deltaY / Math.abs(e.deltaY);\n      } else if ('wheelDeltaX' in e) {\n        wheelDeltaY = e.wheelDeltaY / Math.abs(e.wheelDeltaY);\n      } else if ('wheelDelta' in e) {\n        wheelDeltaY = e.wheelDelta / Math.abs(e.wheelDelta);\n      } else if ('detail' in e) {\n        wheelDeltaY = -e.detail / Math.abs(e.wheelDelta);\n      } else {\n        return;\n      }\n\n      deltaScale = this.scale + wheelDeltaY / 5;\n\n      this.zoom(deltaScale, e.pageX, e.pageY, 0);\n    },\n\n    _initWheel: function() {\n      utils.addEvent(this.wrapper, 'wheel', this);\n      utils.addEvent(this.wrapper, 'mousewheel', this);\n      utils.addEvent(this.wrapper, 'DOMMouseScroll', this);\n\n      this.on('destroy', function() {\n        utils.removeEvent(this.wrapper, 'wheel', this);\n        utils.removeEvent(this.wrapper, 'mousewheel', this);\n        utils.removeEvent(this.wrapper, 'DOMMouseScroll', this);\n      });\n    },\n\n    _wheel: function(e) {\n      if (!this.enabled) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      var wheelDeltaX,\n        wheelDeltaY,\n        newX,\n        newY,\n        that = this;\n\n      if (this.wheelTimeout === undefined) {\n        that._execEvent('scrollStart');\n      }\n\n      // Execute the scrollEnd event after 400ms the wheel stopped scrolling\n      clearTimeout(this.wheelTimeout);\n      this.wheelTimeout = setTimeout(function() {\n        that._execEvent('scrollEnd');\n        that.wheelTimeout = undefined;\n      }, 400);\n\n      if ('deltaX' in e) {\n        wheelDeltaX = -e.deltaX;\n        wheelDeltaY = -e.deltaY;\n      } else if ('wheelDeltaX' in e) {\n        wheelDeltaX = (e.wheelDeltaX / 120) * this.options.mouseWheelSpeed;\n        wheelDeltaY = (e.wheelDeltaY / 120) * this.options.mouseWheelSpeed;\n      } else if ('wheelDelta' in e) {\n        wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * this.options.mouseWheelSpeed;\n      } else if ('detail' in e) {\n        wheelDeltaX = wheelDeltaY = (-e.detail / 3) * this.options.mouseWheelSpeed;\n      } else {\n        return;\n      }\n\n      wheelDeltaX *= this.options.invertWheelDirection;\n      wheelDeltaY *= this.options.invertWheelDirection;\n\n      if (!this.hasVerticalScroll) {\n        wheelDeltaX = wheelDeltaY;\n        wheelDeltaY = 0;\n      }\n\n      if (this.options.snap) {\n        newX = this.currentPage.pageX;\n        newY = this.currentPage.pageY;\n\n        if (wheelDeltaX > 0) {\n          newX--;\n        } else if (wheelDeltaX < 0) {\n          newX++;\n        }\n\n        if (wheelDeltaY > 0) {\n          newY--;\n        } else if (wheelDeltaY < 0) {\n          newY++;\n        }\n\n        this.goToPage(newX, newY);\n\n        return;\n      }\n\n      newX = this.x + Math.round(this.hasHorizontalScroll ? wheelDeltaX : 0);\n      newY = this.y + Math.round(this.hasVerticalScroll ? wheelDeltaY : 0);\n\n      if (newX > 0) {\n        newX = 0;\n      } else if (newX < this.maxScrollX) {\n        newX = this.maxScrollX;\n      }\n\n      if (newY > 0) {\n        newY = 0;\n      } else if (newY < this.maxScrollY) {\n        newY = this.maxScrollY;\n      }\n\n      this.scrollTo(newX, newY, 0);\n\n      // INSERT POINT: _wheel\n    },\n\n    _initSnap: function() {\n      this.currentPage = {};\n\n      if (typeof this.options.snap == 'string') {\n        this.options.snap = this.scroller.querySelectorAll(this.options.snap);\n      }\n\n      this.on('refresh', function() {\n        var i = 0,\n          l,\n          m = 0,\n          n,\n          cx,\n          cy,\n          x = 0,\n          y,\n          stepX = this.options.snapStepX || this.wrapperWidth,\n          stepY = this.options.snapStepY || this.wrapperHeight,\n          el;\n\n        this.pages = [];\n\n        if (\n          !this.wrapperWidth ||\n          !this.wrapperHeight ||\n          !this.scrollerWidth ||\n          !this.scrollerHeight\n        ) {\n          return;\n        }\n\n        if (this.options.snap === true) {\n          cx = Math.round(stepX / 2);\n          cy = Math.round(stepY / 2);\n\n          while (x > -this.scrollerWidth) {\n            this.pages[i] = [];\n            l = 0;\n            y = 0;\n\n            while (y > -this.scrollerHeight) {\n              this.pages[i][l] = {\n                x: Math.max(x, this.maxScrollX),\n                y: Math.max(y, this.maxScrollY),\n                width: stepX,\n                height: stepY,\n                cx: x - cx,\n                cy: y - cy\n              };\n\n              y -= stepY;\n              l++;\n            }\n\n            x -= stepX;\n            i++;\n          }\n        } else {\n          el = this.options.snap;\n          l = el.length;\n          n = -1;\n\n          for (; i < l; i++) {\n            if (i === 0 || el[i].offsetLeft <= el[i - 1].offsetLeft) {\n              m = 0;\n              n++;\n            }\n\n            if (!this.pages[m]) {\n              this.pages[m] = [];\n            }\n\n            x = Math.max(-el[i].offsetLeft, this.maxScrollX);\n            y = Math.max(-el[i].offsetTop, this.maxScrollY);\n            cx = x - Math.round(el[i].offsetWidth / 2);\n            cy = y - Math.round(el[i].offsetHeight / 2);\n\n            this.pages[m][n] = {\n              x: x,\n              y: y,\n              width: el[i].offsetWidth,\n              height: el[i].offsetHeight,\n              cx: cx,\n              cy: cy\n            };\n\n            if (x > this.maxScrollX) {\n              m++;\n            }\n          }\n        }\n\n        this.goToPage(this.currentPage.pageX || 0, this.currentPage.pageY || 0, 0);\n\n        // Update snap threshold if needed\n        if (this.options.snapThreshold % 1 === 0) {\n          this.snapThresholdX = this.options.snapThreshold;\n          this.snapThresholdY = this.options.snapThreshold;\n        } else {\n          this.snapThresholdX = Math.round(\n            this.pages[this.currentPage.pageX][this.currentPage.pageY].width *\n              this.options.snapThreshold\n          );\n          this.snapThresholdY = Math.round(\n            this.pages[this.currentPage.pageX][this.currentPage.pageY].height *\n              this.options.snapThreshold\n          );\n        }\n      });\n\n      this.on('flick', function() {\n        var time =\n          this.options.snapSpeed ||\n          Math.max(\n            Math.max(\n              Math.min(Math.abs(this.x - this.startX), 1000),\n              Math.min(Math.abs(this.y - this.startY), 1000)\n            ),\n            300\n          );\n\n        this.goToPage(\n          this.currentPage.pageX + this.directionX,\n          this.currentPage.pageY + this.directionY,\n          time\n        );\n      });\n    },\n\n    _nearestSnap: function(x, y) {\n      if (!this.pages.length) {\n        return {x: 0, y: 0, pageX: 0, pageY: 0};\n      }\n\n      var i = 0,\n        l = this.pages.length,\n        m = 0;\n\n      // Check if we exceeded the snap threshold\n      if (\n        Math.abs(x - this.absStartX) < this.snapThresholdX &&\n        Math.abs(y - this.absStartY) < this.snapThresholdY\n      ) {\n        return this.currentPage;\n      }\n\n      if (x > 0) {\n        x = 0;\n      } else if (x < this.maxScrollX) {\n        x = this.maxScrollX;\n      }\n\n      if (y > 0) {\n        y = 0;\n      } else if (y < this.maxScrollY) {\n        y = this.maxScrollY;\n      }\n\n      for (; i < l; i++) {\n        if (x >= this.pages[i][0].cx) {\n          x = this.pages[i][0].x;\n          break;\n        }\n      }\n\n      l = this.pages[i].length;\n\n      for (; m < l; m++) {\n        if (y >= this.pages[0][m].cy) {\n          y = this.pages[0][m].y;\n          break;\n        }\n      }\n\n      if (i == this.currentPage.pageX) {\n        i += this.directionX;\n\n        if (i < 0) {\n          i = 0;\n        } else if (i >= this.pages.length) {\n          i = this.pages.length - 1;\n        }\n\n        x = this.pages[i][0].x;\n      }\n\n      if (m == this.currentPage.pageY) {\n        m += this.directionY;\n\n        if (m < 0) {\n          m = 0;\n        } else if (m >= this.pages[0].length) {\n          m = this.pages[0].length - 1;\n        }\n\n        y = this.pages[0][m].y;\n      }\n\n      return {\n        x: x,\n        y: y,\n        pageX: i,\n        pageY: m\n      };\n    },\n\n    goToPage: function(x, y, time, easing) {\n      easing = easing || this.options.bounceEasing;\n\n      if (x >= this.pages.length) {\n        x = this.pages.length - 1;\n      } else if (x < 0) {\n        x = 0;\n      }\n\n      if (y >= this.pages[x].length) {\n        y = this.pages[x].length - 1;\n      } else if (y < 0) {\n        y = 0;\n      }\n\n      var posX = this.pages[x][y].x,\n        posY = this.pages[x][y].y;\n\n      time =\n        time === undefined\n          ? this.options.snapSpeed ||\n            Math.max(\n              Math.max(\n                Math.min(Math.abs(posX - this.x), 1000),\n                Math.min(Math.abs(posY - this.y), 1000)\n              ),\n              300\n            )\n          : time;\n\n      this.currentPage = {\n        x: posX,\n        y: posY,\n        pageX: x,\n        pageY: y\n      };\n\n      this.scrollTo(posX, posY, time, easing);\n    },\n\n    next: function(time, easing) {\n      var x = this.currentPage.pageX,\n        y = this.currentPage.pageY;\n\n      x++;\n\n      if (x >= this.pages.length && this.hasVerticalScroll) {\n        x = 0;\n        y++;\n      }\n\n      this.goToPage(x, y, time, easing);\n    },\n\n    prev: function(time, easing) {\n      var x = this.currentPage.pageX,\n        y = this.currentPage.pageY;\n\n      x--;\n\n      if (x < 0 && this.hasVerticalScroll) {\n        x = 0;\n        y--;\n      }\n\n      this.goToPage(x, y, time, easing);\n    },\n\n    _initKeys: function(e) {\n      // default key bindings\n      var keys = {\n        pageUp: 33,\n        pageDown: 34,\n        end: 35,\n        home: 36,\n        left: 37,\n        up: 38,\n        right: 39,\n        down: 40\n      };\n      var i;\n\n      // if you give me characters I give you keycode\n      if (typeof this.options.keyBindings == 'object') {\n        for (i in this.options.keyBindings) {\n          if (typeof this.options.keyBindings[i] == 'string') {\n            this.options.keyBindings[i] = this.options.keyBindings[i].toUpperCase().charCodeAt(0);\n          }\n        }\n      } else {\n        this.options.keyBindings = {};\n      }\n\n      for (i in keys) {\n        this.options.keyBindings[i] = this.options.keyBindings[i] || keys[i];\n      }\n\n      utils.addEvent(window, 'keydown', this);\n\n      this.on('destroy', function() {\n        utils.removeEvent(window, 'keydown', this);\n      });\n    },\n\n    _key: function(e) {\n      if (!this.enabled) {\n        return;\n      }\n\n      var snap = this.options.snap, // we are using this alot, better to cache it\n        newX = snap ? this.currentPage.pageX : this.x,\n        newY = snap ? this.currentPage.pageY : this.y,\n        now = utils.getTime(),\n        prevTime = this.keyTime || 0,\n        acceleration = 0.25,\n        pos;\n\n      if (this.options.useTransition && this.isInTransition) {\n        pos = this.getComputedPosition();\n\n        this._translate(Math.round(pos.x), Math.round(pos.y));\n        this.isInTransition = false;\n      }\n\n      this.keyAcceleration =\n        now - prevTime < 200 ? Math.min(this.keyAcceleration + acceleration, 50) : 0;\n\n      switch (e.keyCode) {\n        case this.options.keyBindings.pageUp:\n          if (this.hasHorizontalScroll && !this.hasVerticalScroll) {\n            newX += snap ? 1 : this.wrapperWidth;\n          } else {\n            newY += snap ? 1 : this.wrapperHeight;\n          }\n          break;\n        case this.options.keyBindings.pageDown:\n          if (this.hasHorizontalScroll && !this.hasVerticalScroll) {\n            newX -= snap ? 1 : this.wrapperWidth;\n          } else {\n            newY -= snap ? 1 : this.wrapperHeight;\n          }\n          break;\n        case this.options.keyBindings.end:\n          newX = snap ? this.pages.length - 1 : this.maxScrollX;\n          newY = snap ? this.pages[0].length - 1 : this.maxScrollY;\n          break;\n        case this.options.keyBindings.home:\n          newX = 0;\n          newY = 0;\n          break;\n        case this.options.keyBindings.left:\n          newX += snap ? -1 : (5 + this.keyAcceleration) >> 0;\n          break;\n        case this.options.keyBindings.up:\n          newY += snap ? 1 : (5 + this.keyAcceleration) >> 0;\n          break;\n        case this.options.keyBindings.right:\n          newX -= snap ? -1 : (5 + this.keyAcceleration) >> 0;\n          break;\n        case this.options.keyBindings.down:\n          newY -= snap ? 1 : (5 + this.keyAcceleration) >> 0;\n          break;\n        default:\n          return;\n      }\n\n      if (snap) {\n        this.goToPage(newX, newY);\n        return;\n      }\n\n      if (newX > 0) {\n        newX = 0;\n        this.keyAcceleration = 0;\n      } else if (newX < this.maxScrollX) {\n        newX = this.maxScrollX;\n        this.keyAcceleration = 0;\n      }\n\n      if (newY > 0) {\n        newY = 0;\n        this.keyAcceleration = 0;\n      } else if (newY < this.maxScrollY) {\n        newY = this.maxScrollY;\n        this.keyAcceleration = 0;\n      }\n\n      this.scrollTo(newX, newY, 0);\n\n      this.keyTime = now;\n    },\n\n    _animate: function(destX, destY, duration, easingFn) {\n      var that = this,\n        startX = this.x,\n        startY = this.y,\n        startTime = utils.getTime(),\n        destTime = startTime + duration;\n\n      function step() {\n        var now = utils.getTime(),\n          newX,\n          newY,\n          easing;\n\n        if (now >= destTime) {\n          that.isAnimating = false;\n          that._translate(destX, destY);\n\n          if (!that.resetPosition(that.options.bounceTime)) {\n            that._execEvent('scrollEnd');\n          }\n\n          return;\n        }\n\n        now = (now - startTime) / duration;\n        easing = easingFn(now);\n        newX = (destX - startX) * easing + startX;\n        newY = (destY - startY) * easing + startY;\n        that._translate(newX, newY);\n\n        if (that.isAnimating) {\n          rAF(step);\n        }\n      }\n\n      this.isAnimating = true;\n      step();\n    },\n    handleEvent: function(e) {\n      switch (e.type) {\n        case 'touchstart':\n        // Removed due to android double click bug where chrome introduced pointerdown and touchstart to all anchor events. GA-2044\n        // case 'pointerdown':\n        case 'MSPointerDown':\n        case 'mousedown':\n          this._start(e);\n\n          if (this.options.zoom && e.touches && e.touches.length > 1) {\n            this._zoomStart(e);\n          }\n          break;\n        case 'touchmove':\n        case 'pointermove':\n        case 'MSPointerMove':\n        case 'mousemove':\n          if (this.options.zoom && e.touches && e.touches[1]) {\n            this._zoom(e);\n            return;\n          }\n          this._move(e);\n          SCROLLING_MANAGER.pollIscrollScrolling(this.y);\n          $('#contentWrapperInnerL').trigger('iscroll');\n          break;\n        case 'touchend':\n        // Removed due to android double click bug where chrome introduced pointerdown and touchstart to all anchor events. GA-2044\n        // case 'pointerup':\n        case 'MSPointerUp':\n        case 'mouseup':\n        case 'touchcancel':\n        case 'pointercancel':\n        case 'MSPointerCancel':\n        case 'mousecancel':\n          if (this.scaled) {\n            this._zoomEnd(e);\n            return;\n          }\n          this._end(e);\n          break;\n        case 'orientationchange':\n        case 'resize':\n          this._resize();\n          break;\n        case 'transitionend':\n        case 'webkitTransitionEnd':\n        case 'oTransitionEnd':\n        case 'MSTransitionEnd':\n          this._transitionEnd(e);\n          break;\n        case 'wheel':\n        case 'DOMMouseScroll':\n        case 'mousewheel':\n          if (this.options.wheelAction == 'zoom') {\n            this._wheelZoom(e);\n            return;\n          }\n          this._wheel(e);\n          break;\n        case 'keydown':\n          this._key(e);\n          break;\n      }\n    }\n  };\n  function createDefaultScrollbar(direction, interactive, type) {\n    var scrollbar = document.createElement('div'),\n      indicator = document.createElement('div');\n\n    if (type === true) {\n      scrollbar.style.cssText = 'position:absolute;z-index:9999';\n      indicator.style.cssText =\n        '-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px';\n    }\n\n    indicator.className = 'iScrollIndicator';\n\n    if (direction == 'h') {\n      if (type === true) {\n        scrollbar.style.cssText += ';height:7px;left:2px;right:2px;bottom:0';\n        indicator.style.height = '100%';\n      }\n      scrollbar.className = 'iScrollHorizontalScrollbar';\n    } else {\n      if (type === true) {\n        scrollbar.style.cssText += ';width:7px;bottom:2px;top:2px;right:1px';\n        indicator.style.width = '100%';\n      }\n      scrollbar.className = 'iScrollVerticalScrollbar';\n    }\n\n    scrollbar.style.cssText += ';overflow:hidden';\n\n    if (!interactive) {\n      scrollbar.style.pointerEvents = 'none';\n    }\n\n    scrollbar.appendChild(indicator);\n\n    return scrollbar;\n  }\n\n  function Indicator(scroller, options) {\n    this.wrapper = typeof options.el == 'string' ? document.querySelector(options.el) : options.el;\n    this.wrapperStyle = this.wrapper.style;\n    this.indicator = this.wrapper.children[0];\n    this.indicatorStyle = this.indicator.style;\n    this.scroller = scroller;\n\n    this.options = {\n      listenX: true,\n      listenY: true,\n      interactive: false,\n      resize: true,\n      defaultScrollbars: false,\n      shrink: false,\n      fade: false,\n      speedRatioX: 0,\n      speedRatioY: 0\n    };\n\n    for (var i in options) {\n      this.options[i] = options[i];\n    }\n\n    this.sizeRatioX = 1;\n    this.sizeRatioY = 1;\n    this.maxPosX = 0;\n    this.maxPosY = 0;\n\n    if (this.options.interactive) {\n      if (!this.options.disableTouch) {\n        utils.addEvent(this.indicator, 'touchstart', this);\n        utils.addEvent(window, 'touchend', this);\n      }\n      if (!this.options.disablePointer) {\n        utils.addEvent(this.indicator, utils.prefixPointerEvent('pointerdown'), this);\n        utils.addEvent(window, utils.prefixPointerEvent('pointerup'), this);\n      }\n      if (!this.options.disableMouse) {\n        utils.addEvent(this.indicator, 'mousedown', this);\n        utils.addEvent(window, 'mouseup', this);\n      }\n    }\n\n    if (this.options.fade) {\n      this.wrapperStyle[utils.style.transform] = this.scroller.translateZ;\n      this.wrapperStyle[utils.style.transitionDuration] = utils.isBadAndroid ? '0.001s' : '0ms';\n      this.wrapperStyle.opacity = '0';\n    }\n  }\n\n  Indicator.prototype = {\n    handleEvent: function(e) {\n      switch (e.type) {\n        case 'touchstart':\n        case 'pointerdown':\n        case 'MSPointerDown':\n        case 'mousedown':\n          this._start(e);\n          break;\n        case 'touchmove':\n        case 'pointermove':\n        case 'MSPointerMove':\n        case 'mousemove':\n          this._move(e);\n          break;\n        case 'touchend':\n        case 'pointerup':\n        case 'MSPointerUp':\n        case 'mouseup':\n        case 'touchcancel':\n        case 'pointercancel':\n        case 'MSPointerCancel':\n        case 'mousecancel':\n          this._end(e);\n          break;\n      }\n    },\n\n    destroy: function() {\n      if (this.options.interactive) {\n        utils.removeEvent(this.indicator, 'touchstart', this);\n        utils.removeEvent(this.indicator, utils.prefixPointerEvent('pointerdown'), this);\n        utils.removeEvent(this.indicator, 'mousedown', this);\n\n        utils.removeEvent(window, 'touchmove', this);\n        utils.removeEvent(window, utils.prefixPointerEvent('pointermove'), this);\n        utils.removeEvent(window, 'mousemove', this);\n\n        utils.removeEvent(window, 'touchend', this);\n        utils.removeEvent(window, utils.prefixPointerEvent('pointerup'), this);\n        utils.removeEvent(window, 'mouseup', this);\n      }\n\n      if (this.options.defaultScrollbars) {\n        this.wrapper.parentNode.removeChild(this.wrapper);\n      }\n    },\n\n    _start: function(e) {\n      var point = e.touches ? e.touches[0] : e;\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.transitionTime();\n\n      this.initiated = true;\n      this.moved = false;\n      this.lastPointX = point.pageX;\n      this.lastPointY = point.pageY;\n\n      this.startTime = utils.getTime();\n\n      if (!this.options.disableTouch) {\n        utils.addEvent(window, 'touchmove', this);\n      }\n      if (!this.options.disablePointer) {\n        utils.addEvent(window, utils.prefixPointerEvent('pointermove'), this);\n      }\n      if (!this.options.disableMouse) {\n        utils.addEvent(window, 'mousemove', this);\n      }\n\n      this.scroller._execEvent('beforeScrollStart');\n    },\n\n    _move: function(e) {\n      var point = e.touches ? e.touches[0] : e,\n        deltaX,\n        deltaY,\n        newX,\n        newY,\n        timestamp = utils.getTime();\n\n      if (!this.moved) {\n        this.scroller._execEvent('scrollStart');\n      }\n\n      this.moved = true;\n\n      deltaX = point.pageX - this.lastPointX;\n      this.lastPointX = point.pageX;\n\n      deltaY = point.pageY - this.lastPointY;\n      this.lastPointY = point.pageY;\n\n      newX = this.x + deltaX;\n      newY = this.y + deltaY;\n\n      this._pos(newX, newY);\n\n      // INSERT POINT: indicator._move\n\n      e.preventDefault();\n      e.stopPropagation();\n    },\n\n    _end: function(e) {\n      if (!this.initiated) {\n        return;\n      }\n\n      this.initiated = false;\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      utils.removeEvent(window, 'touchmove', this);\n      utils.removeEvent(window, utils.prefixPointerEvent('pointermove'), this);\n      utils.removeEvent(window, 'mousemove', this);\n\n      if (this.scroller.options.snap) {\n        var snap = this.scroller._nearestSnap(this.scroller.x, this.scroller.y);\n\n        var time =\n          this.options.snapSpeed ||\n          Math.max(\n            Math.max(\n              Math.min(Math.abs(this.scroller.x - snap.x), 1000),\n              Math.min(Math.abs(this.scroller.y - snap.y), 1000)\n            ),\n            300\n          );\n\n        if (this.scroller.x != snap.x || this.scroller.y != snap.y) {\n          this.scroller.directionX = 0;\n          this.scroller.directionY = 0;\n          this.scroller.currentPage = snap;\n          this.scroller.scrollTo(snap.x, snap.y, time, this.scroller.options.bounceEasing);\n        }\n      }\n\n      if (this.moved) {\n        this.scroller._execEvent('scrollEnd');\n      }\n    },\n\n    transitionTime: function(time) {\n      time = time || 0;\n      this.indicatorStyle[utils.style.transitionDuration] = time + 'ms';\n\n      if (!time && utils.isBadAndroid) {\n        this.indicatorStyle[utils.style.transitionDuration] = '0.001s';\n      }\n    },\n\n    transitionTimingFunction: function(easing) {\n      this.indicatorStyle[utils.style.transitionTimingFunction] = easing;\n    },\n\n    refresh: function() {\n      this.transitionTime();\n\n      if (this.options.listenX && !this.options.listenY) {\n        this.indicatorStyle.display = this.scroller.hasHorizontalScroll ? 'block' : 'none';\n      } else if (this.options.listenY && !this.options.listenX) {\n        this.indicatorStyle.display = this.scroller.hasVerticalScroll ? 'block' : 'none';\n      } else {\n        this.indicatorStyle.display =\n          this.scroller.hasHorizontalScroll || this.scroller.hasVerticalScroll ? 'block' : 'none';\n      }\n\n      if (this.scroller.hasHorizontalScroll && this.scroller.hasVerticalScroll) {\n        utils.addClass(this.wrapper, 'iScrollBothScrollbars');\n        utils.removeClass(this.wrapper, 'iScrollLoneScrollbar');\n\n        if (this.options.defaultScrollbars && this.options.customStyle) {\n          if (this.options.listenX) {\n            this.wrapper.style.right = '8px';\n          } else {\n            this.wrapper.style.bottom = '8px';\n          }\n        }\n      } else {\n        utils.removeClass(this.wrapper, 'iScrollBothScrollbars');\n        utils.addClass(this.wrapper, 'iScrollLoneScrollbar');\n\n        if (this.options.defaultScrollbars && this.options.customStyle) {\n          if (this.options.listenX) {\n            this.wrapper.style.right = '2px';\n          } else {\n            this.wrapper.style.bottom = '2px';\n          }\n        }\n      }\n\n      var r = this.wrapper.offsetHeight; // force refresh\n\n      if (this.options.listenX) {\n        this.wrapperWidth = this.wrapper.clientWidth;\n        if (this.options.resize) {\n          this.indicatorWidth = Math.max(\n            Math.round(\n              (this.wrapperWidth * this.wrapperWidth) /\n                (this.scroller.scrollerWidth || this.wrapperWidth || 1)\n            ),\n            8\n          );\n          this.indicatorStyle.width = this.indicatorWidth + 'px';\n        } else {\n          this.indicatorWidth = this.indicator.clientWidth;\n        }\n\n        this.maxPosX = this.wrapperWidth - this.indicatorWidth;\n\n        if (this.options.shrink == 'clip') {\n          this.minBoundaryX = -this.indicatorWidth + 8;\n          this.maxBoundaryX = this.wrapperWidth - 8;\n        } else {\n          this.minBoundaryX = 0;\n          this.maxBoundaryX = this.maxPosX;\n        }\n\n        this.sizeRatioX =\n          this.options.speedRatioX ||\n          (this.scroller.maxScrollX && this.maxPosX / this.scroller.maxScrollX);\n      }\n\n      if (this.options.listenY) {\n        this.wrapperHeight = this.wrapper.clientHeight;\n        if (this.options.resize) {\n          this.indicatorHeight = Math.max(\n            Math.round(\n              (this.wrapperHeight * this.wrapperHeight) /\n                (this.scroller.scrollerHeight || this.wrapperHeight || 1)\n            ),\n            8\n          );\n          this.indicatorStyle.height = this.indicatorHeight + 'px';\n        } else {\n          this.indicatorHeight = this.indicator.clientHeight;\n        }\n\n        this.maxPosY = this.wrapperHeight - this.indicatorHeight;\n\n        if (this.options.shrink == 'clip') {\n          this.minBoundaryY = -this.indicatorHeight + 8;\n          this.maxBoundaryY = this.wrapperHeight - 8;\n        } else {\n          this.minBoundaryY = 0;\n          this.maxBoundaryY = this.maxPosY;\n        }\n\n        this.maxPosY = this.wrapperHeight - this.indicatorHeight;\n        this.sizeRatioY =\n          this.options.speedRatioY ||\n          (this.scroller.maxScrollY && this.maxPosY / this.scroller.maxScrollY);\n      }\n\n      this.updatePosition();\n    },\n\n    updatePosition: function() {\n      var x = (this.options.listenX && Math.round(this.sizeRatioX * this.scroller.x)) || 0,\n        y = (this.options.listenY && Math.round(this.sizeRatioY * this.scroller.y)) || 0;\n\n      if (!this.options.ignoreBoundaries) {\n        if (x < this.minBoundaryX) {\n          if (this.options.shrink == 'scale') {\n            this.width = Math.max(this.indicatorWidth + x, 8);\n            this.indicatorStyle.width = this.width + 'px';\n          }\n          x = this.minBoundaryX;\n        } else if (x > this.maxBoundaryX) {\n          if (this.options.shrink == 'scale') {\n            this.width = Math.max(this.indicatorWidth - (x - this.maxPosX), 8);\n            this.indicatorStyle.width = this.width + 'px';\n            x = this.maxPosX + this.indicatorWidth - this.width;\n          } else {\n            x = this.maxBoundaryX;\n          }\n        } else if (this.options.shrink == 'scale' && this.width != this.indicatorWidth) {\n          this.width = this.indicatorWidth;\n          this.indicatorStyle.width = this.width + 'px';\n        }\n\n        if (y < this.minBoundaryY) {\n          if (this.options.shrink == 'scale') {\n            this.height = Math.max(this.indicatorHeight + y * 3, 8);\n            this.indicatorStyle.height = this.height + 'px';\n          }\n          y = this.minBoundaryY;\n        } else if (y > this.maxBoundaryY) {\n          if (this.options.shrink == 'scale') {\n            this.height = Math.max(this.indicatorHeight - (y - this.maxPosY) * 3, 8);\n            this.indicatorStyle.height = this.height + 'px';\n            y = this.maxPosY + this.indicatorHeight - this.height;\n          } else {\n            y = this.maxBoundaryY;\n          }\n        } else if (this.options.shrink == 'scale' && this.height != this.indicatorHeight) {\n          this.height = this.indicatorHeight;\n          this.indicatorStyle.height = this.height + 'px';\n        }\n      }\n\n      this.x = x;\n      this.y = y;\n\n      if (this.scroller.options.useTransform) {\n        this.indicatorStyle[utils.style.transform] =\n          'translate(' + x + 'px,' + y + 'px)' + this.scroller.translateZ;\n      } else {\n        this.indicatorStyle.left = x + 'px';\n        this.indicatorStyle.top = y + 'px';\n      }\n    },\n\n    _pos: function(x, y) {\n      if (x < 0) {\n        x = 0;\n      } else if (x > this.maxPosX) {\n        x = this.maxPosX;\n      }\n\n      if (y < 0) {\n        y = 0;\n      } else if (y > this.maxPosY) {\n        y = this.maxPosY;\n      }\n\n      x = this.options.listenX ? Math.round(x / this.sizeRatioX) : this.scroller.x;\n      y = this.options.listenY ? Math.round(y / this.sizeRatioY) : this.scroller.y;\n\n      this.scroller.scrollTo(x, y);\n    },\n\n    fade: function(val, hold) {\n      if (hold && !this.visible) {\n        return;\n      }\n\n      clearTimeout(this.fadeTimeout);\n      this.fadeTimeout = null;\n\n      var time = val ? 250 : 500,\n        delay = val ? 0 : 300;\n\n      val = val ? '1' : '0';\n\n      this.wrapperStyle[utils.style.transitionDuration] = time + 'ms';\n\n      this.fadeTimeout = setTimeout(\n        function(val) {\n          this.wrapperStyle.opacity = val;\n          this.visible = +val;\n        }.bind(this, val),\n        delay\n      );\n    }\n  };\n\n  IScroll.utils = utils;\n\n  if (typeof module != 'undefined' && module.exports) {\n    module.exports = IScroll;\n  } else {\n    window.IScroll = IScroll;\n  }\n})(window, document, Math);\n"},function(t,e,n){n(0)(n(123))},function(t,e){t.exports="/* globals $, POPUP_MANANGER, EM, OUTPUT_MODE_CHECKER, SETTINGS_EXTRA, ANIMATOR_INTERFACE_2,\nINT_TRANSITION_TIMER, ISCROLL_INTERFACE, TOPIC_MANAGER, TEMPLATE_MANANGER, ASSET_RENDERER, OBJ_REF\nLOCALISER, CORE, DEBUG */\n\n/**\n * @title Last Page Visited\n * @description To be described.\n *\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\nvar LAST_PAGE_VISITIED_EXTRA = {\n  strObjID: 'The last page visitied extra',\n  strObjDescription: 'The extra responsible for showing the last page visited as set by the LMS',\n\n  _objCurrDOM: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _strCurrHelpLocation: null,\n\n  _strPopupTemplateID: 'lastPageVisitedPopupC',\n  _strCloseButtonID: 'closeLastPageVisitedPopupL',\n  _strContentWrapperID: 'lastPageVisitedContentWrapperL',\n\n  _htmBaseLastPageVisitedTemplate: null,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  _domAssetReturnFocusItemElement: '',\n  _domCurrInsertionNode: '',\n\n  _objCurrLocationData: null,\n\n  popupLocaleTitle: 'LAST_PAGE_POPUP_TITLE',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n  },\n\n  handleEvent_popupAnimationComplete: function() {\n    // Generic function for all Extras tidyup call\n  },\n\n  popupAnimationComplete: function(lastPageDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(lastPageDomElement, '#lastPageVisitedPopupHolderL');\n    }\n  },\n\n  handleEvent_gotoLastLocation: function() {\n    EM.trigger('closePopup', {strPopupID: 'lastPageVisited'});\n\n    if (this._bookmarkedScreenIsLocked()) {\n      // Warn users when linking to locked screen\n      gomo.alertManager.create(\n        'warning',\n        false,\n        gomo.localiser.get('NAVIGATION_HIDDEN_SCREEN_WARNING'),\n        [{label: gomo.localiser.get('NAVIGATION_ERROR_CLOSE'), type: 'secondary', action: null}]\n      );\n      return;\n    }\n\n    EM.trigger('prepForTopicExit');\n    EM.trigger('preLoadTopicObject', {\n      strTopicID: this._objCurrLocationData['topicId'],\n      strScreenID: this._objCurrLocationData['pageId']\n    });\n    EM.trigger('loadTopicObject', {\n      strTopicID: this._objCurrLocationData['topicId'],\n      strScreenID: this._objCurrLocationData['pageId'],\n      _objActionData: {}\n    });\n    EM.trigger('postLoadTopicObject', {\n      strTopicID: this._objCurrLocationData['topicId'],\n      strScreenID: this._objCurrLocationData['pageId']\n    });\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objPopupData) {\n    this._getTemplateHTML();\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n    this._objCurrLocationData = _objPopupData['objLocationData'];\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      _domWhatNodeToInsertInto.style.display = 'block';\n    }\n\n    var _htmLastPagePopup = this._createLastPagePopupHTML();\n\n    if (window['SETTINGS_EXTRA']) {\n      _htmLastPagePopup = SETTINGS_EXTRA.parseForSettingsClasses(_htmLastPagePopup);\n    }\n\n    this._domCurrInsertionNode.innerHTML = _htmLastPagePopup;\n\n    EM.trigger('disableSwiping');\n\n    /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n     * a global object in config. Then place an object at the top of this class\n     * with overrides. These overrides can then be altered per project with a\n     * config_override.js\n     **/\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      $(this._domCurrInsertionNode).velocity(\n        {\n          translateY: '9999px'\n        },\n        {\n          delay: 0,\n          duration: 0\n        }\n      );\n\n      this._booPopupVisible = true;\n\n      var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n      var lastPageDomElement = this._domCurrInsertionNode;\n      var funComplete = function() {\n        LAST_PAGE_VISITIED_EXTRA.popupAnimationComplete(lastPageDomElement);\n      };\n      ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n        duration: INT_TRANSITION_TIMER,\n        complete: funComplete\n      });\n    }\n\n    this.booPopupShown = true;\n  },\n\n  hidePopup: function() {\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          LAST_PAGE_VISITIED_EXTRA.popupAnimationComplete();\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    } else {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableSwipe');\n  },\n\n  _cleanUpAndHide: function() {\n    if (this._domCurrInsertionNode) {\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n      }\n      this._domCurrInsertionNode.innerHTML = '';\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n    }\n  },\n\n  _getTemplateHTML: function() {\n    this._htmBaseLastPageVisitedTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strPopupTemplateID\n    ).htmData;\n  },\n\n  _createLastPagePopupHTML: function() {\n    var _htmLastPagePopup = this._htmBaseLastPageVisitedTemplate;\n    var _htmLastPageDetails = this._generateLastPagePopupMessage();\n    _htmLastPagePopup = _htmLastPagePopup.replace(\n      'XX_LAST_PAGE_LOCATION_XX',\n      ASSET_RENDERER.insertFormattedHtml(_htmLastPageDetails)\n    );\n    return _htmLastPagePopup;\n  },\n\n  _generateLastPagePopupMessage: function() {\n    var _strCourseObjectID = this._objCurrLocationData['topicId'];\n    var _strTopicTitle = this._objCurrLocationData['topicTitle'] ||\n    this._getBookmarkedTopicTitle(_strCourseObjectID);\n    var _strScreenTitle = this._objCurrLocationData['pageTitle'];\n\n    return (\n      '<p class=\"last-page-modal__topic-wrapper\">' +\n      '<b class=\\'last-page-modal__section-title\\'>' +\n      LOCALISER.get('LAST_PAGE_VISITIED_TOPIC_TITLE') +\n      ' </b>' +\n      '<span class=\\'lastPageVisitedLocationC last-page-modal__section-name\\'>' +\n      unescape(_strTopicTitle) +\n      '</span>' +\n      '</p>' +\n      '<p class=\"last-page-modal__screen-wrapper\">' +\n      '<b class=\\'last-page-modal__section-title\\'>' +\n      LOCALISER.get('LAST_PAGE_VISITIED_PAGE_TITLE') +\n      ' </b>' +\n      '<span class=\\'lastPageVisitedLocationC last-page-modal__section-name\\'>' +\n      unescape(_strScreenTitle) +\n      '</span>' +\n      '</p>'\n    );\n  },\n\n  _getBookmarkedTopicTitle: function(_strCourseObjectID) {\n    var _objTheTopic = CORE.objCourseData.findTopic(_strCourseObjectID);\n    if (_objTheTopic) {\n      // REFACTOR NOTE: this needs to be updated when we have dynamic\n      // loading from server in the Player\n      if (_objTheTopic.booTopicLoaded == false) {\n        var objTopicData = TOPIC_MANAGER.getTopicDataFromUnloadedTopic(_objTheTopic);\n        if (\n          typeof objTopicData != 'undefined' &&\n          typeof objTopicData.topic != 'undefined' &&\n          typeof objTopicData.topic.strTitle != 'undefined'\n        ) {\n          return objTopicData.topic.strTitle;\n        }\n      }\n      return _objTheTopic.strTitle;\n    }\n    return '';\n  },\n\n  _bookmarkedScreenIsLocked: function() {\n    TOPIC_MANAGER.silentlyLoadTopicObject({strTopicID: this._objCurrLocationData['topicId']});\n    var targetObject = OBJ_REF.get(this._objCurrLocationData['pageId']);\n    return !targetObject.booIsDisplayed;\n  },\n\n  _focusPopup: function() {\n    if (!OUTPUT_MODE_CHECKER.isIOSDevice()) {\n      this._objCurrDOM.getElementById(this._strCloseButtonID).focus();\n    } else {\n      var _domContentWrapper = this._objCurrDOM.getElementById(this._strContentWrapperID);\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.parseChildDOMElements(_domContentWrapper);\n      }\n    }\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  }\n};\n\nEM.register(LAST_PAGE_VISITIED_EXTRA);\nPOPUP_MANANGER.registerPopup('lastPageVisited', LAST_PAGE_VISITIED_EXTRA);\n"},function(t,e,n){n(0)(n(125))},function(t,e){t.exports='/**\n* @title Local Storage Interface\n* @description Simple cla$$ to make sure that we have control over all local storage and clean \n* up anything we don\'t need.\n*\n* There is a _clearTemporaryLocalStorage() function that gets run by core on starting \n* and ending course interation.\n* This removes the temporary files. To keep a file in browser storage, \n* set the _booPermanent argument to true when setting data setValue(_strKey, _strValue, _booPermanent).\n*\n* @author James Hough\n* @version 1.0 14/05/13\n*/\n\nvar LOCAL_STORAGE_INTERFACE =\n{\n\tbooLocalStorageSupported : null,\n\t_strStorageKeySeperator : "|=|",\n\t_objLocalStorageData : {},\n\t_strStorageLocation : null,\n\t\n\tinit : function()\n\t{\n\t\tif (!this.booLocalStorageSupported)\n\t\t{\n\t\t\tthis.booLocalStorageSupported = this._isStorageSupported();\n\t\t}\n\t\tthis._strStorageLocation = this._getStorageLocation();\n\t},\n\t\n\tsetValue : function( _strKey, _strValue, _booPermanent )\n\t{\n\t\t//If required a storage request can be made permanent to prevent cleanup of temp files on exit.\n\t\tif(_booPermanent == null || _booPermanent == false)\n\t\t{\n\t\t\tvar _strPermanent = "permanent=false";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar _strPermanent = "permanent=true";\n\t\t}\n\t\t\n\t\tif(this._objLocalStorageData == null || this._objLocalStorageData[_strKey] == null)\n\t\t{\n\t\t\tthis._objLocalStorageData[_strKey] = new LocalStorageData();\n\t\t}\n\t\t\t\t\n\t\tif (BOO_HTML_LOCAL_STORAGE)\n\t\t{\n\t\t\tif (BOO_HTML_LOCAL_STORAGE)\n\t\t\t{\n\t\t\t\tthis._setLocalStorage(_strKey, _strValue, _strPermanent);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//console.log( "Local Storage is switched off in \\nFile: config.js \\nVariable: BOO_HTML_LOCAL_STORAGE " );\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_setLocalStorage : function (_strKey, _strValue, _strPermanent)\n\t{\n\t\tif (this.booLocalStorageSupported)\n\t\t{\t\n\t\t\tvar _strDateString = new Date().getTime().toString();\n\t\t\t\t\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis._removePreviousDataForKey(_strKey);\n\t\t\t\twindow.localStorage[this._strStorageLocation + this._strStorageKeySeperator + _strKey + this._strStorageKeySeperator + _strDateString + this._strStorageKeySeperator + _strPermanent] = _strValue;\n\t\t\t\tthis._objLocalStorageData[_strKey] = _strValue;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcatch (_objError)\n\t\t\t{\n\t\t\t\tvar _booResult = window.confirm(LOCALISER.get("LOCAL_STORAGE_SAVE_ERROR"));\n\t\t\t\tif (_booResult)\n\t\t\t\t{\n\t\t\t\t\tthis._clearAllLocalStorage();\n\t\t\t\t\tthis._setLocalStorage(_strKey, _strValue);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\tgetLocalStorage : function (_strKey)\n\t{\n\t\tvar _arrMatchingDatestamps = [];\n\t\tvar _arrStorageObjKeys = []; \n\t\t\n\t\tfor (var _strCurrKey in window.localStorage)\n\t\t{\n\t\t\tvar _strCurrKeyLocationSplit = _strCurrKey.split(this._strStorageKeySeperator)[0];\n\t\t\tvar _strCurrKeyStorageKeySplit = _strCurrKey.split(this._strStorageKeySeperator)[1];\n\t\t\tvar _strCurrKeyDateStampSplit = _strCurrKey.split(this._strStorageKeySeperator)[2];\n\t\t\t\n\t\t\tif (_strCurrKeyLocationSplit == this._strStorageLocation && _strCurrKeyStorageKeySplit == _strKey)\n\t\t\t{\n\t\t\t\t_arrMatchingDatestamps.push(_strCurrKeyDateStampSplit);\n\t\t\t\t_arrStorageObjKeys[_strCurrKeyDateStampSplit] = _strCurrKey;\n\t\t\t}\t\t\t\n\t\t}\n\t\t\n\t\tvar _strLatestStorageDate = Math.max.apply( Math, _arrMatchingDatestamps );\n\t\tvar _strLatestStorage = window.localStorage.getItem(_arrStorageObjKeys[_strLatestStorageDate]);\n\t\t\t\t\t\t\n\t\treturn _strLatestStorage;\n\t},\n\t\n\t_isStorageSupported : function()\n\t{\n\t\tif ( typeof(Storage) !== "undefined" )\n\t\t{\n\t\t\tif(OUTPUT_MODE_CHECKER.isRunningFromFile() && navigator.appVersion.indexOf("MSIE") > -1)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//console.log("WARNING: Browser Local Storage is not supported. Warning message created in TRACKING_BACKUP._isStorageSupported(), tracking_local_backup.js");\n\t\t\treturn false;\n\t\t}\n\t},\n\t\n\t_removePreviousDataForKey : function(_strKey)\n\t{\n\t\tfor (var _strCurrKey in window.localStorage)\n\t\t{\n\t\t\tvar _strCurrKeyLocationSplit = _strCurrKey.split(this._strStorageKeySeperator)[0];\n\t\t\tvar _strCurrKeyStorageKeySplit = _strCurrKey.split(this._strStorageKeySeperator)[1];\n\t\t\tif (_strCurrKeyLocationSplit == this._strStorageLocation && _strCurrKeyStorageKeySplit == _strKey)\n\t\t\t{\n\t\t\t\twindow.localStorage.removeItem(_strCurrKey);\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_clearTemporaryLocalStorage : function ()\n\t{\n\t\tfor (var _strCurrKey in window.localStorage)\n\t\t{\n\t\t\tvar _strCurrKeyLocationSplit = _strCurrKey.split(this._strStorageKeySeperator)[0];\n\t\t\tvar _strCurrKeyStrPermanent = _strCurrKey.split(this._strStorageKeySeperator)[3];\n\t\t\tif(_strCurrKeyLocationSplit == this._strStorageLocation && _strCurrKeyStrPermanent == "permanent=false")\n\t\t\t{\n\t\t\t\twindow.localStorage.removeItem(_strCurrKey);\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_clearAllLocalStorage : function ()\n\t{\n\t\tfor (var _strCurrKey in window.localStorage)\n\t\t{\n\t\t\twindow.localStorage.removeItem(_strCurrKey);\n\t\t}\n\t},\n\t\n\t_getStorageLocation : function ()\n\t{\n\t\t//get the url without the screen_size_manager.htm or index.htm appended so the data can be used across the project\n\t\t\tvar _strStorageLocation = escape(document.location);\n\t\t\tvar _arrLocationPath = document.location.pathname.split( \'/\' );\n\t\t\tvar _strLocationPage = _arrLocationPath[_arrLocationPath.length - 1];\t\t\t\n\t\t\t_strStorageLocation = _strStorageLocation.replace(_strLocationPage, \'\');\n\t\t\t\n\t\t\treturn _strStorageLocation;\n\t}\n\t\n};\n\nfunction LocalStorageData()\n{\n    this.strStatus = null;\n    this.strData = null;\n    this.intDateStamp = null;\n};\n\nLOCAL_STORAGE_INTERFACE.init();'},function(t,e,n){n(0)(n(127))},function(t,e){t.exports="/* global CURRENT_LOCALISED_DATA, BOO_PRODUCE_ALL_ZZZ, PREVIEW_DATA */\n/**\n * @title Localiser\n * @description To be described.\n *\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\nvar LOCALISER = {\n  strObjID: 'The Localiser',\n  strObjDescription:\n    'This object parses template fragments strings in need of localising' +\n    ' and serves up resolved localised string or alerts.',\n\n  _regHTMLLanguageMarkupPattern: /LL_[\\w-]+_LL/g,\n  _regVariableTokenPattern: /\\{\\d+\\}/g,\n\n  _booMissingLocalisationDataErrorShown: false,\n\n  localiseCoreHTML: function() {\n    var _domOuterMostCoreElement = document.getElementById('operatingSystemL');\n    var _htmOuterMostCoreElementContent = _domOuterMostCoreElement.innerHTML;\n    _htmOuterMostCoreElementContent = this.parseForLocalisableMarkup(\n      _htmOuterMostCoreElementContent\n    );\n    _domOuterMostCoreElement.innerHTML = _htmOuterMostCoreElementContent;\n  },\n\n  parseForLocalisableMarkup: function(_htmWhatFragment) {\n    var _arrMatches = _htmWhatFragment.match(this._regHTMLLanguageMarkupPattern);\n    if (_arrMatches) {\n      var count = 0;\n      while (count < _arrMatches.length) {\n        var _strCurrMatch = _arrMatches[count].replace('LL_', '').replace('_LL', '');\n        var _strLocalisedString = this._getLocalString(_strCurrMatch);\n        if (_strLocalisedString || _strLocalisedString === '') {\n          _htmWhatFragment = _htmWhatFragment.replace(_arrMatches[count], _strLocalisedString);\n        }\n        count++;\n      }\n    }\n    return _htmWhatFragment;\n  },\n\n  get: function(_strWhatStringKey, _arrWhatVariables) {\n    var _strLocalisedString = this._getLocalString(_strWhatStringKey);\n    if (_strLocalisedString) {\n      _strLocalisedString = this._replaceTokens(_strLocalisedString, _arrWhatVariables);\n      return _strLocalisedString;\n    }\n    return '';\n  },\n\n  l_alert: function(_strWhatStringKey, _arrWhatVariables) {\n    var _strLocalisedString = this._getLocalString(_strWhatStringKey);\n    if (_strLocalisedString) {\n      var _strAlertString = this._replaceTokens(_strLocalisedString, _arrWhatVariables);\n      if (PREVIEW_DATA && PREVIEW_DATA.editorMode) {\n        console.log(_strAlertString);\n      } else {\n        alert(_strAlertString);\n      }\n    }\n  },\n\n  _replaceTokens: function(_strWhatText, _arrWhatVariables) {\n    var _intVariableCount = 0;\n    if (_arrWhatVariables) {\n      _intVariableCount = _arrWhatVariables.length;\n    }\n\n    var _intTokenCount = this._getTokenCount(_strWhatText);\n\n    if (_intVariableCount != _intTokenCount) {\n      LOCALISER.l_alert('LOCALISER_MISMATCHED_VARIABLE_TOKEN_ERROR', [\n        _intVariableCount,\n        _intTokenCount,\n        _strWhatText\n      ]);\n    }\n\n    var _arrMatches = _strWhatText.match(this._regVariableTokenPattern);\n\n    if (_arrMatches) {\n      var count = 0;\n      while (count < _arrMatches.length) {\n        _strWhatText = _strWhatText.replace(_arrMatches[count], _arrWhatVariables[count]);\n        count++;\n      }\n    }\n\n    return _strWhatText;\n  },\n\n  _getTokenCount: function(_strWhatText) {\n    var _arrMatches = _strWhatText.match(this._regVariableTokenPattern);\n    if (_arrMatches) {\n      return _arrMatches.length;\n    }\n    return 0;\n  },\n\n  _getLocalString: function(_strLocalisationKey) {\n    if (\n      CURRENT_LOCALISED_DATA[_strLocalisationKey] ||\n      CURRENT_LOCALISED_DATA[_strLocalisationKey] === ''\n    ) {\n      var _strLocalString = CURRENT_LOCALISED_DATA[_strLocalisationKey];\n      if (BOO_PRODUCE_ALL_ZZZ) {\n        _strLocalString = this._produceZZZString(_strLocalString);\n      }\n      return _strLocalString;\n    } else {\n      if (!this._booMissingLocalisationDataErrorShown) {\n        console.log('ERROR: Localisation data missing. LOCALISER._getLocalString(), localiser.js');\n        this._booMissingLocalisationDataErrorShown = true;\n      }\n      return false;\n    }\n  },\n\n  _produceZZZString: function(_strWhatSourceString) {\n    _strWhatSourceString = _strWhatSourceString.replace(/[a-zA-Z]/g, 'Z');\n    return _strWhatSourceString;\n  }\n};\n"},function(t,e,n){n(0)(n(129))},function(t,e){t.exports="/**\n* Menu Extra\n* ---\n* @author GoMo\n*/\n\nvar global = this;\n\nif(global.Mustache === undefined){\n\tconsole.log('ERROR: Mustache not found!');\n}\n\nvar MENU_EXTRA =\n{\n\tstrObjID : \"The menu button extra\",\n\tstrObjDescription : \"The extra responsible for display of the menu button.\",\n\n\t_strManifestID : \"menuExtra\",\n\t_objCurrDOM : null,\n\t_domCurrInsertionNode : null,\n\t_booDebug : false,\n\n\thandleEvent_primeDOMReferences : function (_objWhatDOM){\n\t\tthis._objCurrDOM = _objWhatDOM;\n\t},\n\n\thandleEvent_outputModeChanged : function (_objOutputChangeData){\n\t},\n\n\thandleEvent_screenSizeChanged : function (_objOutputChangeData){\n\t},\n\n\t// Debug message\n\t_debug : function (_strMessage){\n\t\tif ((window['console']) && (window.console.log) && (this._booDebug)){\n\t\t\tconsole.log(_strManifestID + ' : ' + _strMessage);\n\t\t}\n\t}\n}\n\nEM.register(MENU_EXTRA);"},function(t,e,n){n(0)(n(131))},function(t,e){t.exports="/**\n* Next Extra\n* ---\n* @author GoMo\n*/\n\nvar global = this;\n\nif(global.Mustache === undefined){\n\tconsole.log('ERROR: Mustache not found!');\n}\n\nvar NEXT_EXTRA =\n{\n\tstrObjID : \"The next button extra\",\n\tstrObjDescription : \"The extra responsible for display of the next button.\",\n\n\t_strManifestID : \"nextExtra\",\n\t_objCurrDOM : null,\n\t_domCurrInsertionNode : null,\n\t_booDebug : false,\n\n\thandleEvent_primeDOMReferences : function (_objWhatDOM){\n\t\tthis._objCurrDOM = _objWhatDOM;\n\t},\n\n\thandleEvent_outputModeChanged : function (_objOutputChangeData){\n\t},\n\n\thandleEvent_screenSizeChanged : function (_objOutputChangeData){\n\t},\n\n\t// Debug message\n\t_debug : function (_strMessage){\n\t\tif ((window['console']) && (window.console.log) && (this._booDebug)){\n\t\t\tconsole.log(_strManifestID + ' : ' + _strMessage);\n\t\t}\n\t}\n}\n\nEM.register(NEXT_EXTRA);"},function(t,e,n){n(0)(n(133))},function(t,e){t.exports="/* globals NavigationManager, $, SCREEN_INTERACTIONS, BOO_GRAPHICAL_PAGE_COUNT, TEMPLATE_MANANGER,\nSTR_PAGE_SEPERATOR, EM, Mustache, PAGE_COUNT_WITH_NAVIGATION */\n\n/**\n * Progress Bar Extra\n * ---\n * @author GoMo\n */\n\nvar global = this;\n\nif (global.Mustache === undefined) {\n  console.log('ERROR: Mustache not found!');\n}\n\n// Set a global max progress dots count to offer theme overrides\nvar MAX_PROGRESS_DOTS_COUNT = 4;\nvar PROGRESS_BAR = {\n  strObjID: 'The progress bar extra',\n  strObjDescription: 'The extra responsible for display of the progress.',\n\n  _strManifestID: 'progressBarExtra',\n  _objCurrDOM: null,\n  _domCurrInsertionNode: null,\n  _booDebug: false,\n\n  progressBarId: 'pageNumberL',\n  progressBarClass: 'gomoProgressBar',\n  activeDotClass: 'activePaginationLinkC',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {},\n\n  handleEvent_screenSizeChanged: function(_objOutputChangeData) {},\n\n  /**\n  * Update the progress everytime the nav is rebuilt\n  * @param {object} courseData\n  */\n  handleEvent_rebuiltNavMenu: function(courseData) {\n    var me = this;\n    me.updateProgress(courseData);\n  },\n\n  updateProgress: function(courseData, options) {\n    var me = this;\n    var holder = $('#' + me.progressBarId);\n    options = options === undefined ? {} : options;\n\n    // Check if progress is set to be displayed in the screen!\n    var screenNav = NavigationManager.getNavigationGroupById('screen');\n    var progressControl =\n      screenNav && screenNav.getControlsByType ? screenNav.getControlsByType('progress') : [];\n    var $currentScreen = $(\n      SCREEN_INTERACTIONS.getScreenWrapper(SCREEN_INTERACTIONS.strCurrentScreenId)\n    );\n\n    if (progressControl.length) {\n      // Use dots if requested.\n      options.useDots = BOO_GRAPHICAL_PAGE_COUNT;\n      // If so we will have to add the holder\n      if ($currentScreen.length) {\n        var pHolder = $currentScreen.find('#' + me.progressBarId);\n        if (!pHolder.length) {\n          $currentScreen\n            .find('.screenContentC')\n            .prepend(\n              '<div class=\"pageNumberScreenC\"><div class=\"pageNumberInnerC\">' +\n                screenNav.renderControlsByType('progress') +\n                '</div></div>'\n            );\n          holder = $currentScreen.find('#' + me.progressBarId);\n        } else {\n          holder = pHolder;\n        }\n      }\n    } else {\n      // If progress bar is not @ screen level\n      // then conditional dots should be used...\n      options.conditionalDots = BOO_GRAPHICAL_PAGE_COUNT;\n      holder = $('#' + me.progressBarId);\n    }\n\n    if (holder && holder.length) {\n      holder.html(me.renderProgress(courseData, options));\n\n      // When page count is shown with screen nav, do not show it if there is only one screen, this\n      // is because the screen nav will not be shown.\n      var displayClass = '';\n      if (\n        PAGE_COUNT_WITH_NAVIGATION\n      ) {\n        displayClass =\n          courseData.arrScreens.length > 1 ? 'progress-bar--visible' : 'progress-bar--hidden';\n      }\n      holder.addClass(displayClass);\n      $(holder).parent().addClass(displayClass);\n      // Set aira label for page count.\n      $(holder).attr(\n        'aria-label',\n        gomo.localiser.get('PROGRESS_BAR_PAGE_LABEL') + ' ' +\n        (courseData.intNavigationIndex + 1) + ' ' +\n        gomo.localiser.get('PROGRESS_BAR_SEPERATOR_LABEL') + ' ' +\n        courseData.arrScreens.length\n      );\n    }\n  },\n\n  renderProgress: function(courseData, options) {\n    var me = this;\n    var data = {};\n    var html = '';\n\n    options = options || {};\n    options.useDots = options.useDots == undefined ? false : options.useDots;\n    options.conditionalDots =\n      options.conditionalDots == undefined ? false : options.conditionalDots;\n    options.pageOverride = options.pageOverride || null;\n\n    // Have we exceeded the maximum number of dots? If so use the numbers!\n    if (options.conditionalDots && courseData.arrScreens.length > MAX_PROGRESS_DOTS_COUNT) {\n      options.useDots = false;\n    } else if (options.conditionalDots) {\n      options.useDots = true;\n    }\n\n    if (options.useDots) {\n      data.dots = [];\n      // Loop the screens and add a dot for each!\n      for (var i = 0; i < courseData.arrScreens.length; i++) {\n        // If we have a page index override and currently on that\n        // or if we have just found the current active index according to courseData\n        var active =\n          (options.pageOverride && options.pageOverride == i) ||\n          (!options.pageOverride && i == courseData.intNavigationIndex);\n        // Add a new dot\n        var dot = {\n          active: active,\n          style: active ? me.activeDotClass : '',\n          title: courseData.arrScreens[i].strTitle,\n          link: courseData.arrScreens[i].strObjID\n        };\n        data.dots.push(dot);\n      }\n      // Get the html\n      html = me.render(\n        TEMPLATE_MANANGER.getTemplate('progressDots_generalTemplateC').htmData,\n        data\n      );\n    } else {\n      data = {\n        seperator: STR_PAGE_SEPERATOR,\n        pageNo: courseData.intNavigationIndex + 1,\n        pageOf: courseData.arrScreens.length\n      };\n      html = me.render(\n        TEMPLATE_MANANGER.getTemplate('progressNumber_generalTemplateC').htmData,\n        data\n      );\n    }\n    return html;\n  },\n\n  render: function(partial, data) {\n    return Mustache.render(partial, data);\n  },\n\n  // Debug message\n  _debug: function(_strMessage) {\n    var me = this;\n    if (window['console'] && window.console.log && this._booDebug) {\n      console.log(me._strManifestID + ' : ' + _strMessage);\n    }\n  }\n};\n\nEM.register(PROGRESS_BAR);\n"},function(t,e,n){n(0)(n(135))},function(t,e){t.exports='/**\n* @title Swipe Control\n* @description The object detects and interprets swipe motions with\n* either touch or mouse gestures.  Can be disabled entirely by setting\n* the BOO_ENABLE_SWIPE constant to false in config.js, and similarly,\n* just the menu swiping can be disabled by changing the value of BOO_ENABLE_SWIPE_MENU.\n*\n* @author ChrisTeb\n* @version 2.0 18-04-12\n*/\n\nvar SWIPE_CONTROL =\n{\n\tstrObjID : "Swipe Control",\n\tstrObjDescription : "Handles navigation from page to page with a swipe motion",\n\n\t_intMouseSwipeStartX : 0,\n\t_intMouseSwipeStartY : 0,\n\n\t_objWhatDOM : null,\n\n\t// ************* Start Configuration *************\n\n\t// The minimum proportion of the page that should be swiped across to activate the navigation (decimal)\n\t_decRequiredMoveAmount : 1 / 3,\n\n\t// The maximum angle (0-90, against the baseline) that should register as a horizontal swipe, if this function is expanded in the future to handle vertical events, this will become redundant as it will have to default to 45 degrees\n\t_intHorizontalBoundaryAngle : 30,\n\t_intVerticalBoundaryAngle : 60,\n\n\t// Button IDs\n\t_strSkipButton : \'skipButtonL\',\n\t_strPageWrapper : \'pageWrapperL\',\n\t_strMenuId : \'menuItemsL\',\n\n\t// [id] is the portion of the menu link\'s ID that is substituted with the topic ID\n\t_strMenuItem : \'menuItem[id]L\',\n\t_intTrackingStateComplete : INT_COMPLETED,\n\n\t_strDisabledClass : \'disabled\',\n\n\t_strCurrTopicModel : "",\n\n\t// Used to remove the swipe functionality temporarly. (JC 30-04-2012)\n\t_booSwipeEnabled : true,\n\n\t//Blacklists certain elements from being the target element of a swipe gesture.\n\t_objBlackListedTargetElements :\n\t{\n\t\t"textarea" : true,\n\t\t"select": true,\n\t\t"option": true,\n\t\t"video" : true\n\t},\n\n\t_objBlackListedElementIds : {},\n\n\t_objBlackListedElementClassnames : {},\n\n\thandleEvent_primeDOMReferences : function(_objWhatDOM)\n\t{\n\t\tthis._objWhatDOM = _objWhatDOM;\n\t},\n\n\thandleEvent_setTopicModelType : function (_strWhatTopicModel)\n\t{\n\t\tthis._strCurrTopicModel = _strWhatTopicModel;\n\t},\n\n\thandleEvent_menuButtonClicked : function ()\n\t{\n\t\tthis._strCurrTopicModel = "";\n\t},\n\n\thandleEvent_disableSwiping : function()\n\t{\n\t\tthis._booSwipeEnabled = false;\n\t},\n\n\thandleEvent_enableSwipe : function()\n\t{\n\t\tthis._booSwipeEnabled = true;\n\t},\n\n\tdisableSwipingOnElementId : function(_strElementId)\n\t{\n\t\tthis._objBlackListedElementIds[_strElementId] = true;\n\t},\n\n\tdisableSwipingOnElementClassname : function(_strElementClassname)\n\t{\n\t\tthis._objBlackListedElementClassnames[_strElementClassname] = true;\n\t},\n\n\t// Nothing else should need to be edited on a project to project basis from here on in...\n\n\t// ************* Start Public Methods *************\n\n\t// Function called as mouse is depressed or finger first touches screen, stores initial scrolling positions\n\t// May be called from the CORE._addAdditionalEvents() bindings OR the ISCROLL_INTERFACE._addIScroll() onBeforeScrollStart override\n\t//\n\t// Accepts 1 parameter:\n\t//  - The event object\n\t//\n\t// Returns: Nothing\n\t// Proceeds to: Nothing\n\tstartSwipeGesture : function (e)\n\t{\n\t\t//WBI.log("SWIPE_CONTROL.startSwipeGesture()");\n\t\tif ((this[\'strObjID\']) && (this[\'strObjID\'] == "strObjID"))\n\t\t{\n\t\t\tvar _objThis = this;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar _objThis = SWIPE_CONTROL;\n\t\t}\n\n\t\t//console.log("Swipe test start...");\n\t\tif(!_objThis._checkBlackListedElements(e))\n\t\t{\n\t\t\t_objThis._intMouseSwipeStartX = _objThis._getPosition(e, \'X\');\n\t\t\t_objThis._intMouseSwipeStartY = _objThis._getPosition(e, \'Y\');\n\t\t}\n\t},\n\n\t// Function called as mouse is released or finger leaves the screen to calculate distance, direction and angle\n\t// May be called from the CORE._addAdditionalEvents() bindings OR the ISCROLL_INTERFACE._addIScroll() onBeforeScrollStart override\n\t//\n\t// Accepts 1 parameter:\n\t//  - The event object\n\t//\n\t// Returns: Nothing\n\t// Proceeds to: this._handleSwipe()\n\tendSwipeGesture : function (e)\n\t{\n\t\t//WBI.log("SWIPE_CONTROL.endSwipeGesture() - START");\n\t\tif ((this[\'strObjID\']) && (this[\'strObjID\'] == "strObjID"))\n\t\t{\n\t\t\tvar _objThis = this;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar _objThis = SWIPE_CONTROL;\n\t\t}\n\t\t//WBI.log("SWIPE_CONTROL.endSwipeGesture() - ABOUT TO CHECK");\n\n\t\t//this._invokeDOM();\n\t\tif(!_objThis._checkBlackListedElements(e))\n\t\t{\n\t\t\t// Compare start and finish positions\n\t\t\tvar _intMouseSwipeEndX = _objThis._getPosition(e, \'X\');\n\t\t\tvar _intMouseSwipeEndY = _objThis._getPosition(e, \'Y\');\n\n\t\t\t//console.log("_objThis._intMouseSwipeStartX: " + _objThis._intMouseSwipeStartX + "\\n_objThis._intMouseSwipeStartY: " + _objThis._intMouseSwipeStartY + "\\n_intMouseSwipeEndX: " + _intMouseSwipeEndX + "\\n_intMouseSwipeEndY: " + _intMouseSwipeEndY);\n\n\t\t\tvar _intDiffX = _intMouseSwipeEndX - _objThis._intMouseSwipeStartX;\n\t\t\tvar _intDiffY = _intMouseSwipeEndY - _objThis._intMouseSwipeStartY;\n\n\t\t\t// Calculate the angle of the swipe against the baseline, this could probably be done without so much trigonometry, but at least it\'s accurate\n\t\t\tvar _decAngle = Math.atan2(Math.abs(_intDiffY), Math.abs(_intDiffX));\n\t\t\t_decAngle *= 180 / Math.PI;\n\n\t\t\t// Calculate the proportion of the page the swipe went across\n\t\t\tvar _intPageWidth = _objThis._getWindowSize("Width");\n\t\t\tvar _decHowFarMovedX = Math.abs(_intDiffX) / _intPageWidth;\n\t\t\tvar _intPageHeight = _objThis._getWindowSize("Height");\n\t\t\tvar _decHowFarMovedY = Math.abs(_intDiffY) / _intPageHeight;\n\n\t\t\t//WBI.log("Guestimated page width: " + _intPageWidth + "\\n_decHowFarMoved: " + _decHowFarMoved);\n\t\t\tvar _intScreenSizerWidth = _objThis._getWindowSize("Width");\n\t\t\t//alert("Guestimated page width: " + _intPageWidth + "\\n_decHowFarMoved: " + _decHowFarMoved + "\\n_intScreenSizerWidth: " + _intScreenSizerWidth);\n\n\t\t\t_objThis._handleSwipe(_decAngle, _decHowFarMovedX, _decHowFarMovedY, _intDiffX, _intDiffY);\n\t\t}\n\t\t//WBI.log("SWIPE_CONTROL.endSwipeGesture() - ALL COMPLETE?");\n\t},\n\n\t// ************* Start Private Methods *************\n\n\t// Function to get X or Y position of the mouse cursor or touch event.  This function can be expanded with further options if we come across any devices with inconsistent data for these events.  Use object detection, rather that checking against navigator.userAgent for this.\n\t//\n\t// Accepts 2 parameters:\n\t//  - The event object\n\t//  - The axis required\n\t//\n\t// Returns: Single axis position of the touch or mouse event, or 0 if the object does not contain the expected data\n\t// Proceeds to: Nothing\n\n\t_getWindowSize : function(_strWhatAxis)\n\t{\n\t\tvar _intWinSize = 0;\n\n\t\tif (typeof(window.innerWidth) == \'number\')\n\t\t{\n\t\t\t//alert("window.innerWidth")\n\t\t\t//Non-IE\n\t\t\t_intWinSize = window["inner" + _strWhatAxis];\n\t\t}\n\t\telse if ((document.documentElement) && (document.documentElement.clientHeight))\n\t\t{\n\t\t\t//alert("document.documentElement.clientHeight")\n\t\t\t//IE 6+ in \'standards compliant mode\'\n\t\t\t_intWinSize = document.documentElement["client" + _strWhatAxis];\n\t\t}\n\t\telse if ((document.body) && (document.body.clientHeight))\n\t\t{\n\t\t\t//alert("document.body.clientHeight")\n\t\t\t//IE 4 compatible\n\t\t\t_intWinSize = document.body["client" + _strWhatAxis];\n \t\t}\n \t\treturn _intWinSize;\n\t},\n\n\t_getPosition : function(e, axis)\n\t{\n\t\tif (typeof(e.changedTouches) != \'undefined\')\n\t\t{\n\t\t\treturn e.changedTouches[0][\'page\' + axis];\n\t\t}\n\t\telse if (typeof(e.clientY) != \'undefined\')\n\t\t{\n\t\t\treturn e[\'client\' + axis];\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\n\t// Handles swipe events based on supplied criteria after it has been calculated by endSwipeGesture()\n\t//\n\t// Accepts 4 parameters:\n\t//  - The angle of the swipe relative to the baseline (always positive from 0-90, 0 = baseline, 90 = vertical)\n\t//  - The proportion of the swipe relative to the width of the learning\n\t//  - The distance moved across the X axis\n\t//  - The distance moved across the Y axis (currently unused, included for possible future use)\n\t//\n\t// Returns: Nothing\n\t// Proceeds to: this._activateButton()\n\n\t_handleSwipe : function (_decAngle, _decHowFarMovedX, _decHowFarMovedY, _intDiffX, _intDiffY)\n\t{\n\t\tif (BOO_ENABLE_SWIPE && this._booSwipeEnabled)\n\t\t{\n\t\t\t// Have the thresholds been met?\n\t\t\tif (_decAngle < this._intHorizontalBoundaryAngle && _decHowFarMovedX > this._decRequiredMoveAmount)\n\t\t\t{\n\t\t\t\tif (_intDiffX > 0)\n\t\t\t\t{\n\t\t\t\t\tEM.trigger(\'swipeRight\');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tEM.trigger(\'swipeLeft\');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (_decAngle > this._intVerticalBoundaryAngle && _decHowFarMovedY > this._decRequiredMoveAmount)\n\t\t\t{\n\t\t\t\tif (_intDiffY < 0)\n\t\t\t\t{\n\t\t\t\t\tEM.trigger(\'swipeUp\');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tEM.trigger(\'swipeDown\');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\t\n\n\t_checkBlackListedElements : function (_domElement)\n\t{\n\t\tvar _booReturn = false;\n\n\t\tif (this._checkTargetInBlackListedTargetElements(_domElement))\n\t\t{\n\t\t\t_booReturn = true;\n\t\t};\n\t\tif (this._checkTargetInBlackListedElementIds(_domElement))\n\t\t{\n\t\t\t_booReturn = true;\n\t\t};\n\t\tif (this._checkTargetInBlackListedElementClassnames(_domElement))\n\t\t{\n\t\t\t_booReturn = true;\n\t\t};\n\n\t\treturn _booReturn;\n\t},\n\n\t// Checks if the target element of the event has been blacklisted.\n\t//\n\t// Accepts 1 parameter:\n\t//  - The event\n\t//\n\t// Returns: Boolean\n\t_checkTargetInBlackListedTargetElements : function(_domElement)\n\t{\n\t\t_objTarget = _domElement.target;\n\t\tif(!_objTarget)\n\t\t{\n\t\t\t_objTarget = _domElement.srcElement;\n\t\t}\n\t\tif(_objTarget.nodeType == 3)\n\t\t{\n\t\t\t_objTarget = _objTarget.parentNode;\n\t\t}\n\t\tif (this._objBlackListedTargetElements[_objTarget.tagName.toLowerCase()])\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_checkTargetInBlackListedElementIds : function(_domElement)\n\t{\n\t\t_objTarget = _domElement.target;\n\t\tif(!_objTarget)\n\t\t{\n\t\t\t_objTarget = _domElement.srcElement;\n\t\t}\n\t\tif (this._objBlackListedElementIds[_objTarget.id])\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_checkTargetInBlackListedElementClassnames : function(_domElement)\n\t{\n\t\t_objTarget = _domElement.target;\n\t\tif(!_objTarget)\n\t\t{\n\t\t\t_objTarget = _domElement.srcElement;\n\t\t}\n\t\tif (this._objBlackListedElementClassnames[_objTarget.className])\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n};\n\nEM.register(SWIPE_CONTROL);\n\n// Event listeners are not used in favour of attaching onmouseup, onmousedown, ontouchstart and ontouchend events to the <body> tag, as the event object does not appear to be parsed into the functions otherwise.'},function(t,e,n){n(0)(n(137))},function(t,e){t.exports="/* global $, SCREEN_INTERACTIONS, ASSET_INTERACTIONS, POPUP_MANANGER, EM, TOPIC_MANAGER, _ */\n\n/**\n * Tab manager extra responsible for setting and managing tab indexes within a course.\n *\n * @author J.Gowen\n */\ngomo.tabManager = (function() {\n  var screenFocusedElement = '';\n  var initialised = false;\n  var isUserTabbing = false;\n  var tabIndexRange = [];\n  var openModalElement = false;\n  var reverseTabDirection = false;\n\n  return {\n    /**\n     * Listeners to add and remove the focus css class which will show focus outlines.\n     */\n    addTabKeyListener: function() {\n      var me = this;\n      $(document).on('keyup', function(e) {\n        if (e.keyCode === 16) {\n          reverseTabDirection = false;\n        }\n      });\n      $(document).on('keydown', function(e) {\n        if (e.keyCode === 16) {\n          reverseTabDirection = true;\n        }\n        if (e.keyCode === 9) {\n          $('body').addClass('show-focus-outlines');\n          isUserTabbing = true;\n          me.checkTabRange(e);\n        }\n      });\n      $(document).on('mousemove', function(e) {\n        $('body').removeClass('show-focus-outlines');\n        isUserTabbing = false;\n      });\n    },\n\n    /**\n     * Gets all items that should be accessible and applies a tab index to them.\n     */\n    processContent: function() {\n      var me = this;\n      var accessibleItems = [];\n      var tabIndexValue = 0;\n\n      // screen and all assets on it\n      accessibleItems = accessibleItems.concat(me.getScreenContent());\n      // nav items\n      accessibleItems = accessibleItems.concat(me.getNavigationItems());\n      // top strap items\n      accessibleItems = accessibleItems.concat(me.getTopStrapItems());\n      // bottom strap items\n      accessibleItems = accessibleItems.concat(me.getBottomStrapItems());\n\n      // set tab indexes\n      $.each(accessibleItems, function(index, val) {\n        $(val).attr('tabindex', tabIndexValue);\n      });\n    },\n\n    /**\n     * Set tab indexes on the subscreen elements.\n     * @param {String} subscreenId - The subscreen data.\n     */\n    processSubscreen: function(subscreenId) {\n      var me = this;\n      var count = 0;\n      var subscreenElements = me.getSubscreenElements(subscreenId);\n\n      // set all tab indexes\n      while (count < subscreenElements.length) {\n        $(subscreenElements[count]).attr('tabindex', 0);\n        count++;\n      }\n    },\n\n    /**\n     * Set tab index on the popup elements\n     */\n    processPopup: function() {\n      var me = this;\n      var count = 0;\n      var popupElements = me.getPopupElements();\n\n      // set all tab indexes\n      if (popupElements) {\n        while (count < popupElements.length) {\n          $(popupElements[count]).attr('tabindex', 0);\n          count++;\n        }\n      }\n    },\n\n    /**\n     * Returns a list of elements to apply tabbing to from the current screen or all screens\n     * within the topic depending on whether the topic is continuous scrolling or not\n     * @return {Array} screenAccessibleElements - The accessible screen and asset elements\n     */\n    getScreenContent: function() {\n      var me = this;\n      var screenAccessibleElements = [];\n      if (gomo.topicManager.isContinuousScrollEnabled()) {\n        var topicScreens = TOPIC_MANAGER.getCurrentTopic().arrScreens;\n        for (var i = 0; i < topicScreens.length; i++) {\n          screenAccessibleElements.push(\n            SCREEN_INTERACTIONS.getScreenWrapper(topicScreens[i].strObjID)\n          );\n          screenAccessibleElements = screenAccessibleElements.concat(\n            me.getScreenContentItems(topicScreens[i])\n          );\n        }\n      } else {\n        screenAccessibleElements.push(SCREEN_INTERACTIONS._getCurrentPage());\n        screenAccessibleElements = screenAccessibleElements.concat(\n          me.getScreenContentItems(SCREEN_INTERACTIONS.getCurrentScreenData())\n        );\n      }\n      return screenAccessibleElements;\n    },\n\n    /**\n     * Gets the accessible elements for each asset as defined in each asset.\n     *\n     * @param {Object} screenData - The current screen data.\n     * @return {Array} accessibleScreenItems - The elements to apply tab indexes to.\n     */\n    getScreenContentItems: function(screenData) {\n      var me = this;\n      var accessibleScreenItems = [];\n      if (\n        screenData &&\n        screenData.strObjID &&\n        screenData.arrAssets &&\n        screenData.arrAssets.length > 0\n      ) {\n        var domScreen = $('#screenWrapper_' + screenData.strObjID + 'L');\n        accessibleScreenItems = me.getAccessibElementsInScreen(domScreen);\n      }\n      return accessibleScreenItems;\n    },\n\n    /**\n     * Sets focus to the first screen element after a navigation action\n     * unless it's the first time we're calling this function/on course load\n     * and some navigation elements are present.\n     * */\n    setFocusToCurrentScreen: function() {\n      if (!initialised) {\n        initialised = true;\n        if ($('.header__controls .control[aria-hidden=false]').length) {\n          return;\n        }\n      }\n      var currentScreen = SCREEN_INTERACTIONS._getCurrentScreen();\n      $('#screenWrapper_' + currentScreen.strObjID + 'L')\n        .attr('tabindex', '-1')[0]\n        .focus();\n    },\n\n    /**\n     * Gets a list of accessible elements from each asset on screen.\n     * @param {Object} assetData - The current asset data.\n     * @return {Array} accessibleAssetElements - The accessible asset elements.\n     */\n    getAccessibleTabElementsForAsset: function(assetData) {\n      var assetElements = [];\n      var asset = ASSET_INTERACTIONS.getNewAsset(assetData);\n      var count = 0;\n      var accessibleAssetElements = [];\n      var assetElement;\n\n      // get classnames/id's from each asset.\n      if (asset) {\n        if (typeof asset.getAccessibleElements !== 'undefined') {\n          assetElements = asset.getAccessibleElements(assetData);\n        }\n      } else {\n        if (ASSET_INTERACTIONS['getAccessibleElements_' + assetData.strAssetType]) {\n          assetElements = ASSET_INTERACTIONS['getAccessibleElements_' + assetData.strAssetType](\n            assetData\n          );\n        } else if (ASSET_INTERACTIONS['getAccessibleElements_' + assetData.objRawData.strGroup]) {\n          assetElements = ASSET_INTERACTIONS[\n            'getAccessibleElements_' + assetData.objRawData.strGroup\n          ](assetData);\n        }\n      }\n\n      // get asset from dom.\n      assetElement = $(\n        '#' + assetData.strAssetType + 'Asset_YY' + assetData.strObjID + 'YY_WrapperL'\n      );\n\n      // convert to jquery objects for ease of use later.\n      while (count < assetElements.length) {\n        var elem = $(assetElement).find(assetElements[count]);\n        if (elem.length > 1) {\n          var elemIndex = 0;\n          while (elemIndex < elem.length) {\n            accessibleAssetElements.push($(elem[elemIndex]));\n            elemIndex++;\n          }\n        } else if (elem.length === 1) {\n          accessibleAssetElements.push(elem);\n        }\n        count++;\n      }\n      return accessibleAssetElements;\n    },\n\n    /**\n     * Gets the accessible nav items, currently just back and next.\n     * @return {Array} accessibleNavElements - The accessible nav elements.\n     */\n    getNavigationItems: function() {\n      var accessibleNavElements = [];\n\n      if ($('#nextButtonL').hasClass('activeButtonC')) {\n        accessibleNavElements.push($('#nextButtonL'));\n      }\n\n      if ($('#backButtonL').hasClass('activeButtonC')) {\n        accessibleNavElements.push($('#backButtonL'));\n      }\n\n      return accessibleNavElements;\n    },\n\n    /**\n     * Gets the accessible top strap items\n     * @return {Array} accessibleTopStrapElements - The accessible top strap elements.\n     */\n    getTopStrapItems: function() {\n      var accessibleTopStrapElements = [];\n      var topStrapItems = $('#topStrapL > .strapControls > .control > a.activeButtonC').not(\n        '.hiddenC'\n      );\n\n      if (topStrapItems.length == 0) {\n        topStrapItems = $('#topStrapL > section > .strapControls > .control > a.activeButtonC').not(\n          '.hiddenC'\n        );\n      }\n      for (var i = 0; i < topStrapItems.length; i++) {\n        accessibleTopStrapElements.push($(topStrapItems[i]));\n      }\n      return accessibleTopStrapElements;\n    },\n\n    /**\n     * Gets the accessible bottom strap items\n     * @return {Array} accessibleBottomStrapElements - The accessible bottom strap elements.\n     */\n    getBottomStrapItems: function() {\n      var accessibleBottomStrapElements = [];\n      var bottomStrapItems = $('#navWrapperL  a');\n      for (var i = 0; i < bottomStrapItems.length; i++) {\n        accessibleBottomStrapElements.push($(bottomStrapItems[i]));\n      }\n      return accessibleBottomStrapElements;\n    },\n\n    /**\n     * Gets the accessible items within any active popups. ie. help, glossary etc.\n     * @return {Array} accessiblePopupElements - The accessible popup elements.\n     */\n    getPopupElements: function() {\n      var accessiblePopupElements = [];\n      var popupElements = POPUP_MANANGER.getAccessibleItems();\n      var count = 0;\n\n      if (popupElements) {\n        while (count < popupElements.length) {\n          if ($(popupElements[count]).length == 1) {\n            accessiblePopupElements.push($(popupElements[count]));\n          } else if ($(popupElements[count]).length > 1) {\n            $(popupElements[count]).each(function() {\n              accessiblePopupElements.push($(this));\n            });\n          }\n          count++;\n        }\n      }\n\n      return accessiblePopupElements;\n    },\n\n    /**\n     * Gets the accessible items within any active subscreens.\n     * @param {string} subscreenId - The subscreen data.\n     * @return {Array} accessiblePopupElements - The accessible subscreen elements.\n     */\n    getSubscreenElements: function(subscreenId) {\n      var me = this;\n      var subscreenElements = [];\n      var subscreen;\n\n      // get subscreen data\n      for (var i = 0; i < SCREEN_INTERACTIONS.getCurrentScreenData().arrSubScreens.length; i++) {\n        if (\n          SCREEN_INTERACTIONS.getCurrentScreenData().arrSubScreens[i].strObjID ==\n          subscreenId\n        ) {\n          subscreen = SCREEN_INTERACTIONS.getCurrentScreenData().arrSubScreens[i];\n          break;\n        }\n      }\n\n      // get all subscreen assets\n      // content wrapper\n      var domSubscreen = $('#subScreenContent_' + subscreenId + 'L');\n      // subscreen assets\n      if (\n        domSubscreen.length &&\n        subscreen &&\n        subscreen.arrAssets &&\n        subscreen.arrAssets.length > 0\n      ) {\n        subscreenElements = subscreenElements.concat(\n          me.getAccessibElementsInScreen(domSubscreen)\n        );\n      }\n      // close button\n      var subscreenCloseButton = $('#subScreenWrapper_' + subscreenId + 'L .subScreenCloseButtonC');\n      if ($(subscreenCloseButton).length) {\n        subscreenElements.push($(subscreenCloseButton));\n      }\n      return subscreenElements;\n    },\n\n    /**\n     * Returns all accessible elements in a given screen.\n     * @param {object} screenElement\n     * @return {array} accessibleScreenItems\n     */\n    getAccessibElementsInScreen: function(screenElement) {\n      var me = this;\n      var accessibleScreenItems = [];\n\n      // Find all assets inside the given screen.\n      var domAssets = $(screenElement).find('.genericAssetWrapperC');\n      if (domAssets.length === 0) return [];\n\n      // For each asset in the screen find the elements that can have a tabindex applied.\n      _.each(domAssets, function(asset) {\n        var assetId = asset.id.split('YY')[1]; // assetWrapperFor_YYp45i01s02a01YY_L\n        var assetData = ASSET_INTERACTIONS.getAssetData(assetId);\n        if (!_.isUndefined(assetData)) {\n          accessibleScreenItems = accessibleScreenItems.concat(\n            me.getAccessibleTabElementsForAsset(assetData)\n          );\n        }\n      });\n\n      return accessibleScreenItems;\n    },\n\n    /**\n     * Removes any current tab indexes, processes new ones and focuses the first element.\n     */\n    applyTabIndexes: function() {\n      var me = this;\n      me.processContent();\n    },\n\n    /**\n     * Keeps tabbing within a range, used to restict tabbing within a subscreen or popup.\n     * @param {Object} e - Default tab keypress event which we will ignore if out of range.\n     */\n    checkTabRange: function(e) {\n      if (tabIndexRange.length > 0) {\n        var activeElem = document.activeElement;\n        // if the currently focused element is the last in the range and we are tabbing forwards,\n        // move focus to the first element.\n        if (!reverseTabDirection && activeElem === tabIndexRange[tabIndexRange.length - 1]) {\n          e.preventDefault();\n          tabIndexRange[0].focus();\n        }\n        // if the currently focused element is the first in the range and we are tabbing backwards,\n        // move focus to the last element.\n        if (reverseTabDirection && activeElem === tabIndexRange[0]) {\n          e.preventDefault();\n          tabIndexRange[tabIndexRange.length - 1].focus();\n        }\n      }\n    },\n\n    /**\n     * Apply tab indexes when a page has animated into view.\n     */\n    handleEvent_screenAnimationComplete: function() {\n      var me = this;\n      me.applyTabIndexes();\n      me.setFocusToCurrentScreen();\n    },\n\n    /**\n     * Focus the first element in the active modal.\n     * @param {string} modalElement\n     * @param {object} firstFocusItem HTML element or string to find.\n     */\n    focusModalContent: function(modalElement, firstFocusItem) {\n      var me = this;\n      if (gomo.outputChecker.isIOSDevice()) return;\n\n      // store open modal for updating tab range if required\n      openModalElement = modalElement;\n\n      // get all elements in the popup with a tab index and focus the first.\n      if (modalElement) {\n        me.setTabRange(openModalElement);\n        if (firstFocusItem) {\n          // firstFocusItem could be an element but if its a string go find it.\n          if (typeof(firstFocusItem) === 'string') {\n            firstFocusItem = $(modalElement).find(firstFocusItem)[0];\n          }\n        } else {\n          firstFocusItem = tabIndexRange.length ? tabIndexRange[0] : false;\n        }\n      }\n\n      if (firstFocusItem) {\n        firstFocusItem.focus({preventScroll: true});\n      }\n    },\n\n    /**\n     * Gathers all elements within a modal with a tab index, used to limit tabbing range.\n     * @param {Object} modalElement\n     */\n    setTabRange: function(modalElement) {\n      if (!modalElement) return;\n      var modalFocusItems = false;\n      modalFocusItems = $(modalElement).find('*[tabindex=\\'0\\'], button, a');\n      if (modalFocusItems) {\n        tabIndexRange = Array.prototype.slice.call(modalFocusItems);\n      }\n    },\n\n    /**\n     * Apply tab indexes to elements within a popup when it is opened if required.\n     */\n    handleEvent_showPopup: function() {\n      var me = this;\n      me.setActiveFocus();\n      me.processPopup();\n    },\n\n    /**\n     * Store id or the element of the currently focused element so focus can be returned to it.\n     */\n    setActiveFocus: function() {\n      if (!document.activeElement.id) {\n        screenFocusedElement = document.activeElement;\n      } else {\n        screenFocusedElement = document.activeElement.id;\n      }\n    },\n\n    /**\n     * Focus the last active screen element when a popup or subscreen has been closed.\n     */\n    focusLastScreenElement: function() {\n      tabIndexRange = [];\n      if (isUserTabbing && screenFocusedElement) {\n        if (typeof(screenFocusedElement) === 'object') {\n          $(screenFocusedElement.focus());\n        }\n        if (typeof(screenFocusedElement) === 'string') {\n          $('#'+ screenFocusedElement)[0].focus();\n        }\n        screenFocusedElement = '';\n      }\n    },\n\n    /**\n     * Refresh tab indexes when content changes, currently used for search results and display\n     * conditions.\n     * @param {String} type - The type of content that has changed.\n     * @param {Object} elements - The dom element to check for range. Used for popups.\n     */\n    refreshTabIndexes: function(type, elements) {\n      var me = this;\n\n      if (type === 'popup') {\n        // Apply a tab indexes to the popup content.\n        me.processPopup();\n        // Setup the range limiting.\n        me.setTabRange(elements);\n      }\n\n      // Apply tab index to items shown with a display condition and update the tab range if element\n      // is in a subscreen.\n      if (type === 'displayConditions' && elements && elements.length) {\n        // Apply tab indexes to elements now visible after a display condition changes.\n        var elemCount = 0;\n        while (elemCount < elements.length) {\n          if (\n            elements[elemCount].objParent &&\n            elements[elemCount].objParent.strObjType === 'subscreen' &&\n            elements[elemCount].objParent.strObjID\n          ) {\n            me.processSubscreen(elements[elemCount].objParent.strObjID);\n          } else {\n            me.applyTabIndexes();\n          }\n          elemCount++;\n        }\n        me.setTabRange(openModalElement);\n      }\n    },\n\n    /**\n     * Move the focus of a question asset to the previous or next option\n     * @param {object} elem\n     * @param {number} charCode\n     */\n    questionOptionNav: function(elem, charCode) {\n      var currentElementId = $(elem).attr('id');\n      var nextElement;\n      if (charCode === 38) {\n        // Move up\n        nextElement = $('#' + currentElementId).prev();\n      } else if (charCode === 40) {\n        // Move down\n        nextElement = $('#' + currentElementId).next();\n      }\n      if (nextElement !== undefined) {\n        $(nextElement).focus();\n      }\n    }\n  };\n})();\n\ngomo.tabManager.addTabKeyListener();\n\nEM.register(gomo.tabManager);\n"},function(t,e,n){n(0)(n(139))},function(t,e){t.exports='/**\r\n* @title User Registration Extra\r\n* @description To be described.\r\n*\r\n*\r\n* @author GoMo\r\n* @version 2.0 13/02/18\r\n*/\r\n\r\nvar USER_REGISTRATION_EXTRA =\r\n{\r\n\tstrObjID : "User registration extra",\r\n\tstrObjDescription : "The extra blocks the content until the user has given credentials to send off to the LMS",\r\n\ttranslationId : "userRegistrationTranslation",\r\n\r\n\t_objCurrDOM : null,\r\n\t_strCurrOutputModeClass : "graphicalC",\r\n\t_strContentWrapperID : "lastPageVisitedContentWrapperL",\r\n\t_strTemplateID : \'userRegistrationPopupC\',\r\n\r\n\t_htmBaseLastPageVisitedTemplate : null,\r\n\r\n\tbooPopupShown : false,\r\n\t_booPopupVisible : false,\r\n\r\n\t_domAssetReturnFocusItemElement : "",\r\n\t_domCurrInsertionNode : "",\r\n\r\n\t_objCurrLocationData : null,\r\n\r\n\thandleEvent_primeDOMReferences : function (_objWhatDOM)\r\n\t{\r\n\t\tthis._objCurrDOM = _objWhatDOM;\r\n\t},\r\n\r\n\thandleEvent_outputModeChanged : function (_objOutputChangeData)\r\n\t{\r\n\t\tthis._strCurrOutputModeClass = _objOutputChangeData[\'strNewOutputMode\'];\r\n\t},\r\n\r\n\tpreCourseLoad : function ()\r\n\t{\r\n\t\tvar deferred = new $.Deferred();\r\n\r\n\t\tthis.registrationDefer = deferred;\r\n\t\tthis.showUserRegistration();\r\n\r\n\t\treturn deferred.promise();\r\n\t},\r\n\r\n\tpreCourseLoadChecks : function ()\r\n\t{\r\n\t\t//Change this check depending on what data is actually sent\r\n\t\tif(trackingData && trackingData.userRegistration){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\r\n\tsubmitUserRegistration : function ()\r\n\t{\r\n\t\tvar emailValue = $("#userRegistrationContainer input[name=\'email\']")[0].value;\r\n\t\tvar firstnameValue = $("#userRegistrationContainer input[name=\'firstname\']")[0].value;\r\n\t\tvar surnameValue = $("#userRegistrationContainer input[name=\'surname\']")[0].value;\r\n\r\n\t\tvar registrationValid = true;\r\n\t\tvar validationFeedback = "";\r\n\r\n\t\tif(this.validateEmail(emailValue) == false){\r\n\t\t\tregistrationValid = false;\r\n\t\t\tvalidationFeedback += LOCALISER.get("USER_REG_POPUP_INVAID_ENTRY")+" Email<br/>";\r\n\t\t}\r\n\t\tif(this.validateExists(emailValue) == false){\r\n\t\t\tregistrationValid = false;\r\n\t\t\tvalidationFeedback += LOCALISER.get("USER_REG_POPUP_MISSING_REQUIRED_FIELD")+" Email<br/>";\r\n\t\t}\r\n\t\tif(this.validateExists(firstnameValue) == false){\r\n\t\t\tregistrationValid = false;\r\n\t\t\tvalidationFeedback += LOCALISER.get("USER_REG_POPUP_MISSING_REQUIRED_FIELD")+" Firstname<br/>";\r\n\t\t}\r\n\t\tif(this.validateExists(surnameValue) == false){\r\n\t\t\tregistrationValid = false;\r\n\t\t\tvalidationFeedback += LOCALISER.get("USER_REG_POPUP_MISSING_REQUIRED_FIELD")+" Surname<br/>";\r\n\t\t}\r\n\r\n\t\t//Success\r\n\t\tif(registrationValid == true){\r\n\t\t\t$(\'#userRegistrationModal\').modal(\'hide\');\r\n\t\t\tthis.registrationDefer.resolve({\'email\':emailValue,\'firstname\':firstnameValue,\'surname\':surnameValue});\r\n\t\t}\r\n\t\t//failure\r\n\t\telse{\r\n\t\t\t$("#userRegistrationContainer .feedback").html(validationFeedback);\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tvalidateEmail : function (email)\r\n\t{\r\n    var re = /^[a-zA-Z0-9.!#$%&\'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\r\n    return re.test(String(email).toLowerCase());\r\n\t},\r\n\r\n\tvalidateExists : function (fieldString)\r\n\t{\r\n\t\tif(typeof fieldString == "undefined" || fieldString == null || fieldString == "" || fieldString == " "){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t},\r\n\r\n\tshowUserRegistration : function ()\r\n\t{\r\n\t\t// Do this to allow all other events to propogate before re-rendering.\r\n\t\tif(gomo.translationManager){\r\n\t\t\tgomo.translationManager.resetTopicData();\r\n\t\t}\r\n\r\n\t\tvar htmlTemplate = this._getTemplateHTML();\r\n\t\t$(\'<div id="userRegistrationContainer"></div>\').appendTo(\'body\');\r\n\t\t$(\'#userRegistrationContainer\').html(htmlTemplate);\r\n\t\tvar registrationContainerDom = $(\'#userRegistrationContainer\')[0];\r\n\t\tgomo.translationManager.translateLocalisations(registrationContainerDom, this.translationId, {\'group\':\'popup\'});\r\n\t\tvar options = {\'show\':true, \'keyboard\':false, \'backdrop\':"static"};\r\n\t\t$(\'#userRegistrationModal\').modal(options);\r\n\r\n\t\t//Destroy the modal after it\'s hidden\r\n\t\t$("#userRegistrationModal").on(\'hidden.bs.modal\', function () {\r\n\t    var element = document.getElementById("userRegistrationModal");\r\n\t\t\telement.parentNode.removeChild(element);\r\n\t\t});\r\n\t},\r\n\r\n\t_getTemplateHTML : function ()\r\n\t{\r\n\t\treturn TEMPLATE_MANANGER.getTemplate(this._strTemplateID).htmData;\r\n\t},\r\n\r\n\tdebug : function (strMessage, intPriority, objCallerObject, booCalleeChain)\r\n\t{\r\n\t\tif (DEBUG)\r\n\t\t{\r\n\t\t\tDEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nEM.register(USER_REGISTRATION_EXTRA);\r\nPOPUP_MANANGER.registerPopup("userRegistrationPopup", USER_REGISTRATION_EXTRA);\r\n'},function(t,e,n){n(0)(n(141))},function(t,e){t.exports="/* globals EM, LogManager, DISPLAY_CONDITIONS_INTERACTIONS, CONTENT_TRACKING, TEMPLATE_MANANGER,\nTOPIC_INTERACTIONS, CORE, $, _, PREVIEW_DATA, SUB_SCREEN_INTERACTIONS */\n/**\n * @title The variables holder\n * @description An object to recieve, store, parse objects for and store references to runtime\n *              variables\n *\n * @author JohnC\n * @version 1.0 7/6/13\n */\n\nvar VARIABLES_HOLDER = {\n  strObjID: 'The variables holder',\n  strObjDescription:\n    'An object to recieve, store, parse objects for and store references too runtime variables',\n\n  _objCurrDOM: null,\n\n  _arrRawVariables: null,\n  _objSourceVariablesHash: {},\n  _objVariablesHash: {},\n  _objAssetVariables: {},\n\n  _objSystemVariablesHash: {\n    gomo_accessibility_state: 'false',\n    gomo_device_type: 'desktop',\n    gomo_course_completion_percentage: '0',\n    gomo_course_completion: 'null',\n    gomo_course_score: 'null'\n  },\n  // object containing persisted variables and callback functions\n  _objPersistedVariables: {\n    gomo_active_language: 'applyActiveLanguageAsTranslation'\n  },\n\n  _strGroupVariablesRenderArtifactID: 'groupVariablesRenderArtifactC',\n  _strVariableInsertPrefix: '{{',\n  _strVariableInsertSuffix: '}}',\n\n  _strVariableEntityClassNamePrefix: 'groupVar_',\n  _strVariableEntityClassNameSuffix: '_C',\n\n  _strImagePathVariablePrefix: '?variable_image_path_',\n  _strBaseImageFilenamePrefix: 'baseFilename=',\n\n  _strDynamicVariableKey1: 'DYNAMIC_VARIABLE_',\n  _strDynamicVariableKey2: 'DYNAMIC_VALUE_',\n  _strCurrDynamicVariableSuffix: 'AR',\n\n  _strInteractedAssetStatePrefix: 'gomo_asset_interacted',\n  _strQuestionAssetStatePrefix: 'gomo_asset_correct',\n  _strCompletedAssetStatePrefix: 'gomo_asset_completed',\n\n  _strTopicIncorrectQuestionsStatePrefix: 'gomo_topic_incorrect_questions',\n  _strTopicCorrectQuestionsStatePrefix: 'gomo_topic_score',\n  _strTopicScoreAsPercentStatePrefix: 'gomo_topic_score_as_percent',\n  _strTopicCompletionPrefix: 'gomo_topic_completion',\n\n  _strScreenStatusPrefix: 'gomo_screen_status',\n  _strScreenCorrectPrefix: 'gomo_screen_correct',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    if (!this._objCurrDOM) {\n      this._objCurrDOM = _objWhatDOM;\n    }\n  },\n\n  updateCourseCompletionPercentage: function(_floNewPercentage) {\n    var _strVariableName = 'gomo_course_completion_percentage';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _floNewPercentage.toString(),\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  // If an asset has been hidden by display conditions we may need to update everything as it's\n  // not had previous updates\n  updateAllVariablesForAnElement: function(domId) {\n    for (var variable in this._objVariablesHash) {\n      if (Object.prototype.hasOwnProperty.call(this._objVariablesHash, variable)) {\n        this._updateHTMLEntities(variable, domId);\n      }\n    }\n  },\n\n  updateCourseScore: function(_intWhatScore) {\n    var _strVariableName = 'gomo_course_score';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _intWhatScore.toString(),\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  setAssetVariables: function(variableData) {\n    var initialisingVar = false;\n    if (variableData.initialise) {\n      initialisingVar = true;\n      delete variableData.initialise;\n    }\n    for (var variable in variableData.variables) {\n      if (Object.prototype.hasOwnProperty.call(variableData.variables, variable)) {\n        var currentVarData = variableData.variables[variable];\n        var _strVariableValue = currentVarData;\n        var assetId = variableData.assetId;\n        // If we're initialising the var and it already exists, skip to the next\n        if (initialisingVar && this._objAssetVariables[assetId]\n          && typeof this._objAssetVariables[assetId]._strVariableName !== 'undefined') {\n          continue;\n        }\n        this._objAssetVariables[assetId] = {_strVariableName: _strVariableValue};\n      }\n    }\n\n    this._objVariablesHash['asset_variable.' + assetId] = variableData.variablesStringify;\n  },\n\n  updateAssetDomValue: function(assetId) {\n    var _strVariableName = 'asset_variable.' + assetId;\n\n    // Update the DOM elements\n    this._updateImages(_strVariableName);\n    this._updateHTMLEntities(_strVariableName);\n  },\n\n  setCoursePassFail: function(passed) {\n    var _strVariableName = 'gomo_course_completion';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: passed ? 'passed' : 'failed',\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  setCourseCompleted: function() {\n    var _strVariableName = 'gomo_course_completion';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: 'completed',\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  setCourseStarted: function() {\n    var _strVariableName = 'gomo_course_completion';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: 'incomplete',\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  setActiveLanguage: function(language) {\n    var _strVariableName = 'gomo_active_language';\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: language,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  handleEvent_applyActiveLanguageAsTranslation: function() {\n    if (gomo && gomo.translationManager) {\n      var callbackFun = function() {};\n      gomo.translationManager.setTranslation(\n        this._objVariablesHash['gomo_active_language'], true, callbackFun\n      );\n    }\n  },\n\n  addItemCallback: function(item) {\n    if (this._objPersistedVariables.hasOwnProperty(item.strVariableName)) {\n      item.strCallbackEvent = this._objPersistedVariables[item.strVariableName];\n    }\n    return item;\n  },\n\n  handleEvent_assetCreated: function(_objEventData) {\n    var _objAssetData = _objEventData.objAssetData;\n\n    if (_objAssetData.objRawData.booInteractive) {\n      this._addInteractiveAssetVariables(_objAssetData);\n      this._addCompletedAssetVariables(_objAssetData);\n    }\n\n    if (_objAssetData.strAssetGroup == 'question') {\n      this._addQuestionAssetVariables(_objAssetData);\n    }\n  },\n\n  handleEvent_screenCreated: function(screenData) {\n    this._addScreenStatus(screenData);\n  },\n\n  handleEvent_topicCreated: function(_objEventData) {\n    var _objTopicData = _objEventData.objTopicData;\n    this._addTopicScoreVariables(_objTopicData);\n    this._addTopicCompletion(_objTopicData);\n  },\n\n  handleEvent_outputModeChanged: function(_objEventData) {\n    var _strNewOutputMode = _objEventData['strNewOutputMode'];\n    var _strCurrAccessibilityState = this.getVariableValue('gomo_accessibility_state');\n    var _strCurrDeviceType = this.getVariableValue('gomo_device_type');\n    var _arrChangedVariables = [];\n\n    switch (_strNewOutputMode) {\n      case 'graphicalC':\n        if (_strCurrAccessibilityState == 'true') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_accessibility_state',\n            strVariableValue: 'false',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_accessibility_state');\n        }\n        if (_strCurrDeviceType != 'desktop') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_device_type',\n            strVariableValue: 'desktop',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_device_type');\n        }\n        break;\n      case 'accessibleC':\n        if (_strCurrAccessibilityState == 'false') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_accessibility_state',\n            strVariableValue: 'true',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_accessibility_state');\n        }\n        if (_strCurrDeviceType != 'desktop') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_device_type',\n            strVariableValue: 'desktop',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_device_type');\n        }\n        break;\n      case 'smartphoneC':\n        if (_strCurrAccessibilityState == 'true') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_accessibility_state',\n            strVariableValue: 'false',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_accessibility_state');\n        }\n        if (_strCurrDeviceType != 'smartphoneC') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_device_type',\n            strVariableValue: 'smartphone',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_device_type');\n        }\n        break;\n      case 'tabletC':\n        if (_strCurrAccessibilityState == 'true') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_accessibility_state',\n            strVariableValue: 'false',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_accessibility_state');\n        }\n        if (_strCurrDeviceType != 'tabletC') {\n          EM.trigger('updateVariableValue', {\n            strVariableName: 'gomo_device_type',\n            strVariableValue: 'tablet',\n            strCallbackEvent: false,\n            booIsSystemVariable: true\n          });\n          _arrChangedVariables.push('gomo_device_type');\n        }\n        break;\n      default:\n        gomo.utility.alert(\n          'ERROR: Unknown output mode of \\'' +\n            _strNewOutputMode +\n            '\\' found in handleEvent_outputModeChanged, variables_holder.js'\n        );\n        break;\n    }\n\n    if (_arrChangedVariables.length > 0) {\n      // We need to suppress updates to the dom, as we've stopped tracking bindings in translations\n      // but haven't yet reset the content Dom so we would get a multiple binding error\n      EM.trigger('systemVariablesChanged', {\n        arrChangedSystemVariables: _arrChangedVariables,\n        suppressDomUpdates: true\n      });\n    }\n  },\n\n  handleEvent_questionAssetAnswered: function(_objWhatAssetData) {\n    var _strVariableValue;\n\n    var _strVariableName =\n      this._strQuestionAssetStatePrefix +\n      '.' +\n      (_objWhatAssetData.strObjID || _objWhatAssetData.strID);\n\n    if (_objWhatAssetData.booIsCorrect) {\n      _strVariableValue = 'true';\n    } else {\n      _strVariableValue = 'false';\n    }\n\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strVariableValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n\n    this._updateTopicScoreVariables(_objWhatAssetData);\n  },\n\n  checkTopicCompletion: function(objTopicData) {\n    if (objTopicData.intTrackingState == 2) {\n      var _strVariableName = this._strTopicCompletionPrefix + '.' + objTopicData.strObjID;\n      var _strVariableValue = 'true';\n\n      var _objEventData = {\n        strVariableName: _strVariableName,\n        strVariableValue: _strVariableValue,\n        strCallbackEvent: false,\n        booIsSystemVariable: true\n      };\n\n      EM.trigger('updateVariableValue', _objEventData);\n      EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n    }\n  },\n\n  screenAssetInteractingUpdated: function(_objWhatAssetData) {\n    this.interactingAssetState(_objWhatAssetData);\n    this.completedAssetState(_objWhatAssetData);\n    this.assetValueCheck();\n  },\n\n  handleEvent_postLoadTopicObject: function() {\n    this.assetValueCheck();\n  },\n\n  interactingAssetState: function(_objWhatAssetData) {\n    if (typeof _objWhatAssetData == 'undefined') {\n      var errorMessage = 'Error : Missing asset data';\n      var opts = {includeStack: true};\n      if (typeof LogManager !== 'undefined') {\n        LogManager.add('TEXT', errorMessage, opts);\n      } else {\n        console.log(errorMessage);\n      }\n      return;\n    }\n\n    var assetId = _objWhatAssetData.strObjID || _objWhatAssetData.strID;\n\n    // If the asset belongs to a cloned subscreen then use the original asset id.\n    if (\n      _objWhatAssetData &&\n      _objWhatAssetData.objParent &&\n      _objWhatAssetData.objParent.strObjType === 'subscreen' &&\n      _objWhatAssetData.objParent.strObjID\n    ) {\n      var originalSubscreenId =\n        SUB_SCREEN_INTERACTIONS.getOriginalSubscreenId(_objWhatAssetData.objParent.strObjID);\n      if (originalSubscreenId) {\n        assetId = assetId.replace(_objWhatAssetData.objParent.strObjID, originalSubscreenId);\n      }\n    }\n\n    var _strVariableName =\n      this._strInteractedAssetStatePrefix +\n      '.' +\n      assetId;\n    var _strVariableValue = 'true';\n\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strVariableValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  completedAssetState: function(_objWhatAssetData) {\n    if (typeof _objWhatAssetData == 'undefined') {\n      var errorMessage = 'Error : Missing asset data';\n      var opts = {includeStack: true};\n      if (typeof LogManager !== 'undefined') {\n        LogManager.add('TEXT', errorMessage, opts);\n      } else {\n        console.log(errorMessage);\n      }\n      return;\n    }\n\n    var assetId = _objWhatAssetData.strObjID || _objWhatAssetData.strID;\n\n    // If the asset belongs to a cloned subscreen then use the original asset id.\n    if (\n      _objWhatAssetData &&\n      _objWhatAssetData.objParent &&\n      _objWhatAssetData.objParent.strObjType === 'subscreen' &&\n      _objWhatAssetData.objParent.strObjID\n    ) {\n      var originalSubscreenId =\n        SUB_SCREEN_INTERACTIONS.getOriginalSubscreenId(_objWhatAssetData.objParent.strObjID);\n      if (originalSubscreenId) {\n        assetId = assetId.replace(_objWhatAssetData.objParent.strObjID, originalSubscreenId);\n      }\n    }\n\n    var _strVariableName =\n      this._strCompletedAssetStatePrefix +\n      '.' +\n      assetId;\n    var _strVariableValue = 'false';\n    if (_objWhatAssetData.booComplete) {\n      _strVariableValue = 'true';\n    }\n\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strVariableValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  assetValueCheck: function() {\n    var variableObjects = DISPLAY_CONDITIONS_INTERACTIONS.getRegisteredVariableObjects();\n    if (variableObjects.asset_variable !== undefined) {\n      var count = 0;\n      while (count < variableObjects.asset_variable.length) {\n        if (\n          variableObjects.asset_variable[count].objRawData &&\n          variableObjects.asset_variable[count].objRawData.arrDisplayConditions &&\n          variableObjects.asset_variable[count].objRawData.arrDisplayConditions[0]\n        ) {\n          var displayCondition =\n            variableObjects.asset_variable[count].objRawData.arrDisplayConditions[0];\n        }\n        DISPLAY_CONDITIONS_INTERACTIONS._checkCondition_customVariableDisplayCondition(\n          displayCondition\n        );\n        count++;\n      }\n    }\n  },\n\n  // Collects the loaded data from CORE and parses into the reference and current HASH tables.\n  handleEvent_broadcastGroupVariablesData: function(_objWhatJSON) {\n    if (_objWhatJSON) {\n      if (_objWhatJSON['arrVariables']) {\n        this._arrRawVariables = _objWhatJSON['arrVariables'];\n        this._parseIntoHashTable();\n      } else {\n        this._arrRawVariables = [];\n      }\n    }\n  },\n\n  // This is used for Instant Preview which can extend the list of vars\n  updateVariable: function(newVariables) {\n    _(newVariables).each(function(newVariable, i) {\n      var foundVar = _.find(VARIABLES_HOLDER._arrRawVariables, function(rawVar) {\n        return rawVar.strName === newVariable.strName;\n      });\n      if (foundVar) {\n        // If the variable exits then replace the value in case it's new\n        foundVar.strValue = newVariable.strValue;\n      } else {\n        // If the variable doesn't exit then add it\n        VARIABLES_HOLDER._arrRawVariables.push(newVariable);\n      }\n    });\n    this._parseIntoHashTable();\n  },\n\n  // Not currently supported but this is a mechanism for having multiple values for a given\n  // variable, in the case of the initial VWG 12144 implamentation, based on user type.\n  handleEvent_setDynamicVariableSuffix: function(_strWhatSuffix) {\n    this._strCurrDynamicVariableSuffix = _strWhatSuffix;\n  },\n\n  handleEvent_updateVariableValue: function(_objEventData) {\n    var _strVariableName = _objEventData['strVariableName'];\n    var _strVariableValue = _objEventData['strVariableValue'];\n    var _strCallbackEvent = _objEventData['strCallbackEvent'];\n    var _booIsSystemVariable = _objEventData['booIsSystemVariable'];\n\n    this._objVariablesHash[_strVariableName] = _strVariableValue;\n\n    // Update the DOM elements\n    this._updateImages(_strVariableName);\n    this._updateHTMLEntities(_strVariableName);\n\n    if (!_booIsSystemVariable) {\n      // Update anything else that may require a more specific update\n      EM.trigger('groupVariableUpdated', _objEventData);\n    } else {\n      this._objSystemVariablesHash[_strVariableName] = _strVariableValue;\n    }\n    var variablePersists = this.getVariablePersistence(_strVariableName);\n    // If variable persistance is enabled store it.\n    if (variablePersists) {\n      CONTENT_TRACKING.saveVariable(_objEventData);\n    }\n\n    if (_strCallbackEvent) {\n      EM.trigger(_strCallbackEvent);\n    }\n  },\n\n  // Currently not used, this will reset the variables to the stored initial state.\n  // Useful to allow a user to retake a topic and return it to the base state.\n  // REFACTOR NOTE: It would be useful to extend this to allow a more selective reset\n  // and preserve some variables whilst resetting others.\n  handleEvent_resetGroupVariables: function() {\n    for (var _strCurrName in this._objVariablesHash) {\n      if (this._objVariablesHash[_strCurrName] != this._objSourceVariablesHash[_strCurrName]) {\n        var _objEventData = {\n          strVariableName: _strCurrName,\n          strVariableValue: this._objSourceVariablesHash[_strCurrName],\n          strCallbackEvent: false\n        };\n\n        EM.trigger('updateVariableValue', _objEventData);\n      }\n    }\n  },\n\n  // Retrieves the value for a given variable, will recurse in the case of nested variables\n  // and selects the relevant dynamic variable value if required.\n  getVariableValue: function(_strWhatVariableName) {\n    if (\n      this._objVariablesHash[_strWhatVariableName] ||\n      this._objVariablesHash[_strWhatVariableName] == '' ||\n      this._objVariablesHash[_strWhatVariableName] == 0\n    ) {\n      var _strVariableValue = this._objVariablesHash[_strWhatVariableName];\n\n      if (\n        _strVariableValue.indexOf(this._strDynamicVariableKey1) > -1 ||\n        _strVariableValue.indexOf(this._strDynamicVariableKey2) > -1\n      ) {\n        _strVariableValue = this._resolveDynamicVariableValue(_strVariableValue);\n      }\n\n      if (\n        _strVariableValue &&\n        _strVariableValue.indexOf &&\n        _strVariableValue.indexOf(this._strVariableInsertPrefix) != -1\n      ) {\n        var _objItemsToInsert = {};\n        // eslint-disable-next-line no-useless-escape\n        var _regVariableInsert = /\\{\\{([^\\}\\}])+\\}\\}/g;\n        var _objExecResult;\n        while ((_objExecResult = _regVariableInsert.exec(_strVariableValue)) != null) {\n          var _strMatch = _objExecResult[0];\n          _objItemsToInsert[_strMatch] = this.getVariableValue(_strMatch);\n        }\n\n        for (var _strCurrMatch in _objItemsToInsert) {\n          if (Object.prototype.hasOwnProperty.call(_objItemsToInsert, _strCurrMatch)) {\n            _strVariableValue = _strVariableValue\n              .split(_strCurrMatch)\n              .join(_objItemsToInsert[_strCurrMatch]);\n          }\n        }\n      }\n\n      return _strVariableValue;\n    } else if (_strWhatVariableName.indexOf('asset_variable') == -1) {\n      gomo.utility.alert('ERROR: I was asked for a variable name of \\'' +\n      _strWhatVariableName +\n      '\\', but I don\\'t seem to have a variable of that name. ' +\n      'VARIABLES_HOLDER.getVariableValue(), variables_holder.js');\n    }\n    return false;\n  },\n\n  getVariablePersistence: function(variableName) {\n    var persists = false;\n    var variable = _.find(this._arrRawVariables, function(variable) {\n      return variable.strName === variableName;\n    });\n    if (variable && variable.booPersist\n      || this._objPersistedVariables.hasOwnProperty(variableName)) {\n      persists = true;\n    }\n    return persists;\n  },\n\n  // Resolves the image path for any variables to allow retrieval of image\n  // meta data.\n  getFilenameForMetaDataCheck: function(_strWhatFilename) {\n    if (\n      _strWhatFilename &&\n      _strWhatFilename.indexOf &&\n      _strWhatFilename.indexOf(this._strVariableInsertPrefix) != -1\n    ) {\n      // eslint-disable-next-line no-useless-escape\n      var _regVariableInsert = /\\{\\{([^\\}\\}])+\\}\\}/g;\n\n      var _arrMatchs = _strWhatFilename.match(_regVariableInsert);\n\n      if (_arrMatchs.length > 1) {\n        gomo.utility.alert(\n          'ERROR: Mutliple variables for images are not supported. ' +\n          'VARIABLES_HOLDER.parseImagePathForVariableMarkup(), variables_holder.js'\n        );\n        return _strWhatFilename;\n      }\n\n      _strWhatFilename = _strWhatFilename.replace(\n        _arrMatchs[0],\n        this.getVariableValue(_arrMatchs[0])\n      );\n    }\n    return _strWhatFilename;\n  },\n\n  // Replaces the {{VARIABLE_NAME}} markup with the relevent value wrapped in an\n  // HTML entity for later updating.\n  parseHTMLForVariableMarkup: function(_htmWhatContent, _booVariableValueOnly) {\n    if (\n      _htmWhatContent &&\n      _htmWhatContent.indexOf &&\n      _htmWhatContent.indexOf(this._strVariableInsertPrefix) != -1\n    ) {\n      var _objItemsToInsert = {};\n      // Matches the {{VARIABLE_NAME}} syntax.\n      // eslint-disable-next-line no-useless-escape\n      var _regVariableInsert = /\\{\\{([^\\}\\}])+\\}\\}/g;\n      var _objExecResult;\n      while ((_objExecResult = _regVariableInsert.exec(_htmWhatContent)) != null) {\n        var _strMatch = _objExecResult[0];\n\n        if (!_booVariableValueOnly) {\n          _objItemsToInsert[_strMatch] = this._generateHTMLVariableRenderArtifact(_strMatch);\n        } else {\n          var _strCleanVariableName = _strMatch.replace(/\\{\\{/g, '').replace(/\\}\\}/g, '');\n          _objItemsToInsert[_strMatch] = this.getVariableValue(_strCleanVariableName);\n        }\n      }\n\n      for (var _strCurrMatch in _objItemsToInsert) {\n        if (Object.prototype.hasOwnProperty.call(_objItemsToInsert, _strCurrMatch)) {\n          _htmWhatContent = _htmWhatContent\n            .split(_strCurrMatch)\n            .join(_objItemsToInsert[_strCurrMatch]);\n        }\n      }\n    }\n    return _htmWhatContent;\n  },\n\n  // Resolves any variable markup inside an image path and sets a query string param to\n  // allow updating.\n  parseImagePathForVariableMarkup: function(_strWhatPath) {\n    if (\n      _strWhatPath &&\n      _strWhatPath.indexOf &&\n      _strWhatPath.indexOf(this._strVariableInsertPrefix) != -1\n    ) {\n      // eslint-disable-next-line no-useless-escape\n      var _regVariableInsert = /\\{\\{([^\\}\\}])+\\}\\}/g;\n\n      var _arrMatchs = _strWhatPath.match(_regVariableInsert);\n\n      if (_arrMatchs.length > 1) {\n        gomo.utility.alert(\n          'ERROR: Mutliple variables for images are not supported. ' +\n          'VARIABLES_HOLDER.parseImagePathForVariableMarkup(), variables_holder.js'\n        );\n        return _strWhatPath;\n      }\n\n      var _strModifiedPath = this._resolvePathForImage(_strWhatPath, _arrMatchs[0]);\n      return _strModifiedPath;\n    }\n    return _strWhatPath;\n  },\n\n  // Checks the base value and appends the relevent dynamic suffix to reference the correct\n  // dynamic variable.\n  //\n  // Not currently supported but this is a mechanism for having multiple values for a given\n  // variable, in the case of the initial VWG 12144 implamentation, based on user type.\n  _resolveDynamicVariableValue: function(_strWhatValue) {\n    var _objItemsToInsert = {};\n    // eslint-disable-next-line no-useless-escape\n    var _regVariableInsert = /\\{\\{([^\\}\\}])+\\}\\}/g;\n    var _objExecResult;\n    while ((_objExecResult = _regVariableInsert.exec(_strWhatValue)) != null) {\n      var _strMatch = _objExecResult[0];\n      _objItemsToInsert[_strMatch] = this.getVariableValue(\n        _strMatch.replace('}}', '_' + this._strCurrDynamicVariableSuffix + '}}')\n      );\n    }\n\n    for (var _strCurrMatch in _objItemsToInsert) {\n      if (Object.prototype.hasOwnProperty.call(_objItemsToInsert, _strCurrMatch)) {\n        _strWhatValue = _strWhatValue.split(_strCurrMatch).join(_objItemsToInsert[_strCurrMatch]);\n      }\n    }\n    return _strWhatValue;\n  },\n\n  // Generates the HTML to wrap around the variable value to allow updating of\n  // values.\n  _generateHTMLVariableRenderArtifact: function(_strWhatName) {\n    var _htmRenderArtifact = TEMPLATE_MANANGER.getTemplate(this._strGroupVariablesRenderArtifactID)\n      .htmData;\n    var _strFirstParseVariableName = _strWhatName.replace(/\\{\\{/g, '').replace(/\\}\\}/g, '');\n    var _strCleanVariableName = this._tidyUpSystemVariables(_strFirstParseVariableName);\n    _htmRenderArtifact = _htmRenderArtifact.replace(/XX_VARIABLE_NAME_XX/g, _strCleanVariableName);\n    _htmRenderArtifact = _htmRenderArtifact.replace(\n      /XX_VARIABLE_NAME_AS_CLASS_XX/g,\n      this._strVariableEntityClassNamePrefix +\n        _strCleanVariableName +\n        this._strVariableEntityClassNameSuffix\n    );\n\n    if (\n      this._objVariablesHash[_strCleanVariableName] ||\n      this._objVariablesHash[_strCleanVariableName] == '' ||\n      this._objVariablesHash[_strCleanVariableName] == 0 ||\n      this._objVariablesHash[_strFirstParseVariableName]\n    ) {\n      var _strVariableValue;\n      // get the variable value using the correct string\n      if (this._objVariablesHash[_strFirstParseVariableName]) {\n        _strVariableValue = this._objVariablesHash[_strFirstParseVariableName];\n      } else {\n        _strVariableValue = this.getVariableValue(_strCleanVariableName);\n      }\n\n      if (_strVariableValue == null || _strVariableValue == 'null') {\n        // JC Temporarily hard coded whilst awaiting portal manifest/localisation fix\n        // _strVariableValue = LOCALISER.get(\"UNSET_VARIABLE_VALUE\");\n        _strVariableValue = 'Value not set.';\n      }\n\n      _htmRenderArtifact = _htmRenderArtifact.replace(/XX_VARIABLE_VALUE_XX/g, _strVariableValue);\n    } else {\n      _htmRenderArtifact = _htmRenderArtifact.replace(/XX_VARIABLE_VALUE_XX/g, '');\n    }\n    return _htmRenderArtifact;\n  },\n\n  // Populates the _objVariablesHash and the _objSourceVariablesHash properties.\n  _parseIntoHashTable: function() {\n    var count = 0;\n    while (count < this._arrRawVariables.length) {\n      var _objCurrVariablePair = this._arrRawVariables[count];\n      // If a value is already set from suspend data then do not overwrite it\n      if (this._objVariablesHash[_objCurrVariablePair['strName']] === undefined) {\n        this._objVariablesHash[_objCurrVariablePair['strName']] = _objCurrVariablePair['strValue'];\n      }\n\n      // Create a source variable link also, to allow for resetting.\n      this._objSourceVariablesHash[_objCurrVariablePair['strName']] =\n        _objCurrVariablePair['strValue'];\n      count++;\n    }\n\n    // Add in the system variables\n    for (var _strCurrName in this._objSystemVariablesHash) {\n      if (Object.prototype.hasOwnProperty.call(this._objSystemVariablesHash, _strCurrName)) {\n        this._objSourceVariablesHash[_strCurrName] = this._objSystemVariablesHash[_strCurrName];\n        this._objVariablesHash[_strCurrName] = this._objSystemVariablesHash[_strCurrName];\n      }\n    }\n  },\n\n  _addInteractiveAssetVariables: function(_objWhatAssetData) {\n    var _strVariableName =\n      this._strInteractedAssetStatePrefix +\n      '.' +\n      (_objWhatAssetData.strObjID || _objWhatAssetData.strID);\n    var _strVariableValue = 'false';\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  _addCompletedAssetVariables: function(_objWhatAssetData) {\n    var _strVariableName =\n      this._strCompletedAssetStatePrefix +\n      '.' +\n      (_objWhatAssetData.strObjID || _objWhatAssetData.strID);\n    var _strVariableValue = 'false';\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  _addQuestionAssetVariables: function(_objWhatAssetData) {\n    var _strVariableName =\n      this._strQuestionAssetStatePrefix +\n      '.' +\n      (_objWhatAssetData.strObjID || _objWhatAssetData.strID);\n    var _strVariableValue = 'null';\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  _addScreenStatus: function(screenData) {\n    var _strVariableName = this._strScreenStatusPrefix + '.' + screenData.strObjID;\n    var _strVariableValue = '0';\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  handleEvent_reportScreenInteractedStatus: function(screenData) {\n    var _strVariableName = this._strScreenStatusPrefix + '.' + screenData.strObjID;\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: screenData.screenInteractedState.toString(),\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  handleEvent_reportScreenCorrectStatus: function(screenData) {\n    var _strVariableName = this._strScreenCorrectPrefix + '.' + screenData.strObjID;\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: screenData.screenCorrectState.toString(),\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  _addTopicCompletion: function(_objWhatTopicData) {\n    var _strVariableName =\n      this._strTopicCompletionPrefix +\n      '.' +\n      (_objWhatTopicData.strObjID || _objWhatTopicData.strID);\n    var _strVariableValue = 'false';\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  _addTopicScoreVariables: function(_objWhatTopicData) {\n    var _strVariableValue = 'null';\n    var _strVariableName =\n      this._strTopicIncorrectQuestionsStatePrefix +\n      '.' +\n      (_objWhatTopicData.strObjID || _objWhatTopicData.strID);\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n\n    _strVariableName =\n      this._strTopicCorrectQuestionsStatePrefix +\n      '.' +\n      (_objWhatTopicData.strObjID || _objWhatTopicData.strID);\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n\n    _strVariableName =\n      this._strTopicScoreAsPercentStatePrefix +\n      '.' +\n      (_objWhatTopicData.strObjID || _objWhatTopicData.strID);\n    this._addVariableToHashTables(_strVariableName, _strVariableValue, true);\n  },\n\n  _updateTopicScoreVariables: function(_objWhatAssetData) {\n    var _objParentTopic;\n    if (_objWhatAssetData.objParent.strObjType == 'screen') {\n      _objParentTopic = _objWhatAssetData.objParent.objParent;\n    } else {\n      _objParentTopic = _objWhatAssetData.objParent.objParent.objParent;\n    }\n    var _strParentTopicID = _objParentTopic.strObjID;\n\n    var _objAnsweredQuestionAssets = TOPIC_INTERACTIONS.getAnsweredQuestionAssets();\n\n    var _objScoreData = {\n      intPercentage: 0,\n      intTotal: 0,\n      intCorrect: 0,\n      intWrong: 0\n    };\n\n    for (var _strCurrAssetID in _objAnsweredQuestionAssets) {\n      if (Object.prototype.hasOwnProperty.call(_objAnsweredQuestionAssets, _strCurrAssetID)) {\n        var _objCurrAsset = _objAnsweredQuestionAssets[_strCurrAssetID];\n        if (_objCurrAsset.booIsCorrect === true) {\n          _objScoreData['intCorrect']++;\n        } else if (_objCurrAsset.booIsCorrect === false) {\n          _objScoreData['intWrong']++;\n        }\n        _objScoreData['intTotal']++;\n      }\n    }\n    _objScoreData['intPercentage'] = parseInt(\n      (_objScoreData['intCorrect'] / _objScoreData['intTotal']) * 100\n    );\n\n    this._updateTopicIncorrect(_strParentTopicID, _objScoreData['intWrong'].toString());\n    this._updateTopicCorrect(_strParentTopicID, _objScoreData['intCorrect'].toString());\n    this._updateTopicPercentage(_strParentTopicID, _objScoreData['intPercentage'].toString());\n  },\n\n  _updateTopicIncorrect: function(_strParentTopicID, _strNewValue) {\n    var _strVariableName = this._strTopicIncorrectQuestionsStatePrefix + '.' + _strParentTopicID;\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strNewValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  _updateTopicCorrect: function(_strParentTopicID, _strNewValue) {\n    var _strVariableName = this._strTopicCorrectQuestionsStatePrefix + '.' + _strParentTopicID;\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strNewValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  _updateTopicPercentage: function(_strParentTopicID, _strNewValue) {\n    var _strVariableName = this._strTopicScoreAsPercentStatePrefix + '.' + _strParentTopicID;\n    var _objEventData = {\n      strVariableName: _strVariableName,\n      strVariableValue: _strNewValue,\n      strCallbackEvent: false,\n      booIsSystemVariable: true\n    };\n\n    EM.trigger('updateVariableValue', _objEventData);\n    EM.trigger('systemVariablesChanged', {arrChangedSystemVariables: [_strVariableName]});\n  },\n\n  _addVariableToHashTables: function(_strVariableName, _strVariableValue, _booIsSystemVariable) {\n    if (PREVIEW_DATA && PREVIEW_DATA.editorMode\n      && typeof this._objSourceVariablesHash[_strVariableName] !== 'undefined') {\n      return;\n    }\n    this._objSourceVariablesHash[_strVariableName] = _strVariableValue;\n    this._objVariablesHash[_strVariableName] = _strVariableValue;\n\n    if (_booIsSystemVariable) {\n      this._objSystemVariablesHash[_strVariableName] = _strVariableValue;\n    }\n  },\n\n  // Updates the path with the relevant variable value and appends the\n  // initial path as a query string param.\n  // REFACTOR NOTE: This should double check that a query string already exists\n  // rather than assuming it will (which it currently should)\n  _resolvePathForImage: function(_strWhatPath, _strWhatVariableName) {\n    var _strNewPath = _strWhatPath;\n\n    _strNewPath = _strNewPath.replace(\n      _strWhatVariableName,\n      this.getVariableValue(_strWhatVariableName)\n    );\n    _strNewPath +=\n      this._strImagePathVariablePrefix +\n      _strWhatVariableName\n        .replace(this._strVariableInsertPrefix, '')\n        .replace(this._strVariableInsertSuffix, '');\n\n    var _strBaseFilename = '&' + this._strBaseImageFilenamePrefix + escape(_strWhatPath);\n\n    _strNewPath += _strBaseFilename;\n\n    return _strNewPath;\n  },\n\n  // Retrieves all images in the current DOM and checks them for the query string markup\n  // that denotes a variable based image. It then updates as required.\n  _updateImages: function(_strWhatVariableName) {\n    if (this._objCurrDOM) {\n      var _arrImages = this._objCurrDOM.getElementsByTagName('img');\n      var count = 0;\n      while (count < _arrImages.length) {\n        var _domCurrImage = _arrImages[count];\n        if (\n          _domCurrImage.src.indexOf(this._strImagePathVariablePrefix) > -1 &&\n          _domCurrImage.src.indexOf(\n            _strWhatVariableName\n              .replace(this._strVariableInsertPrefix, '')\n              .replace(this._strVariableInsertSuffix, '')\n          ) > -1\n        ) {\n          var _strInitialFilename = this._getBaseFilenameQueryVariableValue(_domCurrImage.src);\n\n          var _strNewPath = this._resolvePathForImage(_strInitialFilename, _strWhatVariableName);\n\n          var _arrFolderPathSplit = _domCurrImage.src.split('/');\n          _arrFolderPathSplit.pop();\n          var _strFolderPath = _arrFolderPathSplit.join('/') + '/';\n\n          _domCurrImage.src = _strFolderPath + _strNewPath;\n        }\n        count++;\n      }\n    }\n  },\n\n  // Retrieves the variable name from the query string and returns it's value\n  _getBaseFilenameQueryVariableValue: function(_strWhatPath) {\n    var _strQueryString = _strWhatPath.slice(_strWhatPath.indexOf('?'), _strWhatPath.length);\n    var _arrQueryStringSplit = _strQueryString.split('&');\n    var count = 0;\n    while (count < _arrQueryStringSplit.length) {\n      var _strCurrSplitItem = _arrQueryStringSplit[count];\n      if (_strCurrSplitItem.indexOf(this._strBaseImageFilenamePrefix) > -1) {\n        var _arrBasePathSplit = _strCurrSplitItem.split('=');\n        var _strBasePath = unescape(_arrBasePathSplit[1]);\n        return _strBasePath;\n      }\n      count++;\n    }\n    gomo.utility.alert(\n      'ERROR: Unable to find base path variable in filepath of \\'' +\n        _strWhatPath +\n        '\\'. VARIABLES_HOLDER._getBasePathQueryVariableValue(), variables_holder.js'\n    );\n    return '';\n  },\n\n  // Updates all the HTML entities variable values.\n  _updateHTMLEntities: function(_strWhatName, optionalDomId) {\n    var _strClassNameToMatch =\n      this._strVariableEntityClassNamePrefix +\n      _strWhatName.replace(/\\{\\{/g, '').replace(/\\}\\}/g, '') +\n      this._strVariableEntityClassNameSuffix;\n    _strClassNameToMatch = this._tidyUpSystemVariables(_strClassNameToMatch);\n    var elementToUpdate = this._objCurrDOM;\n    if (optionalDomId) {\n      elementToUpdate = $('#' + optionalDomId)[0];\n    }\n    var _arrCurrentVariableEntities = CORE.getElementsByClassName(\n      elementToUpdate,\n      _strClassNameToMatch\n    );\n\n    var count = 0;\n    while (count < _arrCurrentVariableEntities.length) {\n      var _domCurrEntity = _arrCurrentVariableEntities[count];\n      _domCurrEntity.innerHTML = gomo.utility.formatHTML(this.getVariableValue(_strWhatName));\n      count++;\n    }\n  },\n\n  _tidyUpSystemVariables: function(_strWhatVariableName) {\n    _strWhatVariableName = _strWhatVariableName.replace(/\\./g, '_');\n    return _strWhatVariableName;\n  },\n\n  booTerminal: true\n};\n\nEM.register(VARIABLES_HOLDER);\n"},function(t,e,n){n(0)(n(143))},function(t,e){t.exports="/* globals LOCALISER, POPUP_MANANGER, SETTINGS_EXTRA, ISCROLL_INTERFACE, EM, Mustache,\nMETA_SCREEN_INTERACTIONS, OUTPUT_MODE_CHECKER, ANIMATOR_INTERFACE_2, SIMPLE_GLOSSARY_LAYOUT,\nINT_TRANSITION_TIMER, SCREEN_RENDERER, TEMPLATE_MANANGER, he, global, _, $,\nMOBILE_INTERACTIVE_GLOSSARY, PANEL_GLOSSARY_LAYOUT */\n\n/**\n * @title Glossary\n * @description To be described.\n *\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\nvar GLOSSARY_EXTRA = {\n  strObjID: 'The glossary extra',\n  _strManifestID: 'glossaryExtra',\n  strObjDescription:\n    'The extra responsible for display glossary data in the various required formats.',\n\n  _objCurrDOM: null,\n  _domCurrInsertionNode: null,\n  _strCurrOutputModeClass: 'graphicalC',\n  _strCurrGeneralScreenSizeCatergory: null,\n\n  _strPopupTemplateID: 'glossaryPopupC',\n  _strContentWrapperID: 'glossaryPopupHolderL',\n  _strButtonID: 'glossaryL',\n  simpleGlossaryTemplate: 'simpleGlossary',\n  _strLetterTemplateID: 'glossaryLetterC',\n  _strDisabledLetterTemplateID: 'glossaryDisabledLetterC',\n\n  _strLetterTitleID: 'glossaryLetterTitleC',\n\n  _strTermTemplateID: 'glossaryTermC',\n  _strDefinitionTemplateID: 'glossaryDefinitionC',\n  _strTermAndDefinitionTemplateID: 'glossaryTermAndDefinitionC',\n  _strNoDefinitionTemplateID: 'glossaryNoDefinitionC',\n\n  _strLetterIDPrefix: 'glossaryItem',\n  _strLetterIDSuffix: 'L',\n  _strTermIDPrefix: 'glossaryTerm',\n  _strTermIDSuffix: 'L',\n\n  _strSelectedLetterClass: 'highlightedLetterC',\n  _strUnselectedLetterClass: 'unselectedLetterC',\n  _strFirstLetterClass: 'firstLetterC',\n  _strLastLetterClass: 'lastLetterC',\n  _strSelectedTermClass: 'highlightedTermC',\n  _strUnselectedTermClass: 'unselectedTermC',\n  _strLastTermClass: 'lastTermC',\n\n  _strTermsID: 'glossaryTermsL',\n  _strDefinitionID: 'glossaryDefinitionL',\n\n  _strGlossaryTermsWrapperID: 'glossaryTermsWrapperL',\n  _strGlossaryDefinitionWrapperID: 'glossaryDefinitionWrapperL',\n\n  _strAnimationAsset: 'glossary',\n\n  _htmPopupTemplate: '',\n  _htmLetterTemplate: '',\n  _htmDisabledLetterTemplate: '',\n  _htmLetterTitleTemplate: '',\n  _htmTermTemplate: '',\n  _htmDefinitionTemplate: '',\n  _htmNoDefinitionTemplate: '',\n  mobileGlossaryTemplate: '',\n\n  _strAllTerm: LOCALISER.get('GLOSSARY_ALL').toLowerCase(),\n  _strCurrSelectedLetter: LOCALISER.get('GLOSSARY_ALL').toLowerCase(),\n  _strCurrSelectedTerm: '',\n  _arrGlossaryLetters: [],\n  _objSortedGlossaryTermsHash: {},\n  _objGlobalGlossaryTermsHash: {},\n  _objRawGlossaryData: false,\n  _localCode: '',\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n  _domAssetReturnFocusItemElement: false,\n\n  _booDebug: true,\n\n  firstFocusItem: '#glossaryPopupHolderL',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this._objRawGlossaryData) {\n      this._objSortedGlossaryTermsHash = this._parseDataIntoHash(this._objRawGlossaryData);\n    }\n    if (this.booPopupShown) {\n      this.hidePopup();\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strContentWrapperID);\n  },\n\n  handleEvent_screenSizeChanged: function(_objOutputChangeData) {\n    if (!MOBILE_INTERACTIVE_GLOSSARY && !PANEL_GLOSSARY_LAYOUT) {\n      this._strCurrGeneralScreenSizeCatergory = _objOutputChangeData['strUpdatedScreenSize'];\n\n      if (this.booPopupShown) {\n        var _htmGlossary = this._createGlossaryHTML();\n        if (window['SETTINGS_EXTRA']) {\n          _htmGlossary = SETTINGS_EXTRA.parseForSettingsClasses(_htmGlossary);\n        }\n\n        // Remove scrolling items for elements we're about to remove\n        var _domTermsWrapper = this._objCurrDOM.getElementById(this._strGlossaryTermsWrapperID);\n        if (_domTermsWrapper && this._applyIScroll()) {\n          ISCROLL_INTERFACE.recycleScroller(_domTermsWrapper);\n        }\n\n        if (_domTermsWrapper && this._applyIScroll()) {\n          ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n        }\n\n        this._domCurrInsertionNode.innerHTML = _htmGlossary;\n        gomo.dataBinding.unregisterGroup('popup');\n        gomo.translationManager.translateLocalisations(POPUP_MANANGER._domPopupLayer, 'glossary', {\n          group: 'popup'\n        });\n\n        this._setGlossaryScrolling();\n      }\n    }\n\n    this.collapseOpenPanelGlossaryElements();\n  },\n\n  handleEvent_filterGlossaryTerms: function(_strWhatLetter) {\n    var _domTermsHolder;\n    var _booAddLetterTitles;\n    var _htmTermsContent;\n\n    this._highlightLetter(_strWhatLetter);\n    this._strCurrSelectedLetter = _strWhatLetter.toLowerCase();\n    _domTermsHolder = this._objCurrDOM.getElementById(this._strTermsID);\n\n    _htmTermsContent = this._createGlossaryTerms();\n    if (this._strCurrOutputModeClass == 'smartphoneC') {\n      this._debug('Filtering for small size.');\n      _domTermsHolder = this._objCurrDOM.getElementById(this._strTermsID);\n      if (_strWhatLetter.toLowerCase() == this._strAllTerm.toLowerCase()) {\n        _booAddLetterTitles = true;\n      } else {\n        _booAddLetterTitles = false;\n      }\n\n      _domTermsHolder.innerHTML = this._createListBasedTerms(\n        _booAddLetterTitles,\n        this._strCurrSelectedLetter\n      );\n    } else {\n      this._debug('Filtering medium/large size.');\n      if (this._applyIScroll()) {\n        ISCROLL_INTERFACE.recycleScroller(_domTermsHolder);\n      }\n      _domTermsHolder.innerHTML = _htmTermsContent;\n\n      var _objFirstTerm = this._getFirstTermInList();\n      // _objFirstTerm['@termtitle'];\n\n      EM.trigger('showGlossaryTerm', _objFirstTerm['screenId']);\n    }\n\n    if (this._applyIScroll()) {\n      this._debug('Refreshing iscroll.');\n      window.setTimeout(function() {\n        ISCROLL_INTERFACE.refreshIScrolls();\n      }, 200);\n    }\n\n    gomo.tabManager.refreshTabIndexes('popup', $('#glossaryPopupHolderL'));\n  },\n\n  handleEvent_showGlossaryTerm: function(_strWhatTerm) {\n    this._strCurrSelectedTerm = _strWhatTerm;\n    this._highlightTerm(_strWhatTerm);\n    var _domDefinitionHolder = this._objCurrDOM.getElementById(this._strDefinitionID);\n\n    var _domDefinitionsWrapper = this._objCurrDOM.getElementById(\n      this._strGlossaryDefinitionWrapperID\n    );\n    if (_domDefinitionsWrapper && this._applyIScroll()) {\n      ISCROLL_INTERFACE.recycleScroller(_domDefinitionsWrapper);\n    }\n\n    _domDefinitionHolder.innerHTML = this._getCurrentDefinition();\n    this._focusDefinition();\n\n    META_SCREEN_INTERACTIONS.switchToMetaScreen(\n      this._objGlobalGlossaryTermsHash[_strWhatTerm].screenId\n    );\n\n    gomo.tabManager.refreshTabIndexes('popup', $('#glossaryPopupHolderL'));\n  },\n\n  handleEvent_popupAnimationComplete: function() {\n    // Generic function for all Extras tidyup call\n  },\n\n  popupAnimationComplete: function(glossaryDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      this._setGlossaryScrolling();\n      gomo.tabManager.focusModalContent(glossaryDomElement, this.firstFocusItem);\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objParams) {\n    EM.trigger('disableSwiping');\n\n    this._strAllTerm = LOCALISER.get('GLOSSARY_ALL').toLowerCase();\n    this._strCurrSelectedLetter = LOCALISER.get('GLOSSARY_ALL').toLowerCase();\n    this._setLangCode();\n    this._getTemplateHTML();\n    this._objRawGlossaryData = this._setGlossaryData(_objParams);\n    this._objSortedGlossaryTermsHash = this._parseDataIntoHash(this._objRawGlossaryData);\n    this._setArrGlossary();\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      _domWhatNodeToInsertInto.style.display = 'block';\n    }\n\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n    if (_objParams['strTermToSearchFor']) {\n      this._strCurrSelectedTerm = _objParams['strTermToSearchFor'];\n    }\n\n    var _htmGlossary = '';\n\n    if (PANEL_GLOSSARY_LAYOUT) {\n      _htmGlossary = this.renderPanelGlossary();\n      // Set the element we wish to apply focus to when the glossary is shown.\n      this.firstFocusItem = '.panel-glossary__terms-list button:first';\n    } else if (MOBILE_INTERACTIVE_GLOSSARY && gomo.outputChecker.isSmartPhone()) {\n      _htmGlossary = this.renderMobileGlossary();\n    } else {\n      _htmGlossary = this._createGlossaryHTML();\n    }\n\n    if (window['SETTINGS_EXTRA']) {\n      _htmGlossary = SETTINGS_EXTRA.parseForSettingsClasses(_htmGlossary);\n    }\n\n    this._domCurrInsertionNode.innerHTML = _htmGlossary;\n\n    /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n    * a global object in config. Then place an object at the top of this class\n    * with overrides. These overrides can then be altered per project with a\n    * config_override.js\n    */\n    if (\n      gomo.outputChecker.animationEnabled &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      this._booPopupVisible = true;\n\n      var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n      var glossaryDomElement = this._domCurrInsertionNode;\n      var funComplete = function() {\n        GLOSSARY_EXTRA.popupAnimationComplete(glossaryDomElement);\n      };\n      ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n        duration: INT_TRANSITION_TIMER,\n        complete: funComplete\n      });\n    }\n\n    this.initPanelGlossary();\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  initPanelGlossary: function() {\n    if (!PANEL_GLOSSARY_LAYOUT) return;\n    $('.panel-glossary__letter-button--selected').attr('aria-current', true);\n    $('.panel-glossary__term').find('.panel-glossary__definition')\n      .off('show.bs.collapse')\n      .on('show.bs.collapse', function(e) {\n        if ($(this).is(e.target)) {\n          $(this).closest('.panel-glossary__definition').css('display', 'block');\n          $(this)\n            .closest('.panel-glossary__definition')\n            .find('.metaScreenWrapperC')\n            .height(\n              $(this).closest('.panel-glossary__definition').find('.scrollWrapperC').height()\n            );\n          $(this).closest('.panel-glossary__definition').css('display', '');\n          $(this)\n            .parent()\n            .find('.panel-heading')\n            .addClass('panel-heading__selected')\n            .find('.panel-glossary__term-heading')\n            .attr('aria-expanded', true);\n        }\n      }).off('hide.bs.collapse')\n      .on('hide.bs.collapse', function(e) {\n        if ($(this).is(e.target)) {\n          $(this).parent().find('.panel-heading').removeClass('panel-heading__selected')\n            .find('.panel-glossary__term-heading')\n            .attr('aria-expanded', false);\n        }\n      });\n  },\n\n  collapseOpenPanelGlossaryElements: function() {\n    if (!PANEL_GLOSSARY_LAYOUT) return;\n    $('.panel-glossary__definition:visible')\n      .collapse('hide')\n      .parent()\n      .find('.panel-heading')\n      .removeClass('panel-heading__selected')\n      .find('.panel-glossary__term-heading')\n      .attr('aria-expanded', false);\n  },\n\n  hidePopup: function() {\n    if (\n      gomo.outputChecker.animationEnabled &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          GLOSSARY_EXTRA.popupAnimationComplete();\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    } else {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableSwipe');\n  },\n\n  _setLangCode: function() {\n    if (gomo.translationManager.getCurrentLangCodeAndTitle()) {\n      this._localeCode = gomo.translationManager.getCurrentLangCodeAndTitle().id;\n      this._localeCode = this._localeCode.replace('_', '-');\n    } else {\n      if (global.LogManager) {\n        global.LogManager.add(\n          'TEXT',\n          'Warning : Glossary failed to find a language code. '\n        );\n      }\n    }\n  },\n\n  _setGlossaryData: function(_objParams) {\n    var _intScreenIndex = 0;\n    var _intCount = 0;\n    var _objGlossaryTerms = {};\n    _objGlossaryTerms.terms = [];\n    while (_intCount < _objParams._metaTopic.arrScreens.length) {\n      var _objScreen = _objParams._metaTopic.arrScreens[_intCount];\n\n      var _htmMetaScreenContent = SCREEN_RENDERER.renderScreen(_objScreen, _intScreenIndex);\n      _htmMetaScreenContent = _htmMetaScreenContent.replace(/hiddenScreenC/g, '');\n      _htmMetaScreenContent = _htmMetaScreenContent.replace(/notStartedScreenStateC/g, '');\n\n      var _objTerm = {\n        '@termtitle': _objScreen.objRawData.strTitle,\n        'decodedTermtitle': he.decode(_objScreen.objRawData.strTitle),\n        'screenId': _objScreen.strObjID,\n        'definition': _htmMetaScreenContent,\n        'htmDefinition': _htmMetaScreenContent,\n        'synonyms': null\n      };\n\n      _objGlossaryTerms.terms.push(_objTerm);\n\n      _intCount++;\n    }\n\n    return _objGlossaryTerms;\n  },\n\n  _setGlossaryScrolling: function() {\n    if (this._applyIScroll() && !PANEL_GLOSSARY_LAYOUT) {\n      ISCROLL_INTERFACE.parseChildDOMElements(this._domCurrInsertionNode);\n    }\n  },\n\n  _forceGlossaryScreensAndAssetsPostprocess: function(_objParams) {\n    var _intCount = 0;\n    while (_intCount < _objParams._metaTopic.arrScreens.length) {\n      var _objScreen = _objParams._metaTopic.arrScreens[_intCount];\n      META_SCREEN_INTERACTIONS.switchToMetaScreen(_objScreen.strObjID);\n\n      _intCount++;\n    }\n  },\n\n  _setArrGlossary: function() {\n    this._arrGlossaryLetters = [];\n    for (var letter in this._objSortedGlossaryTermsHash) {\n      if (Object.prototype.hasOwnProperty.call(this._objSortedGlossaryTermsHash, letter)) {\n        this._arrGlossaryLetters.push(letter);\n      }\n    }\n    // remove 'all'\n    this._arrGlossaryLetters = _.without(this._arrGlossaryLetters, this._strAllTerm);\n    // sort\n    this._arrGlossaryLetters.sort(this._sortLetterArray);\n    // reinstate all\n    this._arrGlossaryLetters.unshift(this._strAllTerm);\n  },\n\n  _cleanUpAndHide: function() {\n    if (this._domCurrInsertionNode) {\n      var _domDefinitionsWrapper = this._objCurrDOM.getElementById(\n        this._strGlossaryDefinitionWrapperID\n      );\n      if (_domDefinitionsWrapper && this._applyIScroll()) {\n        ISCROLL_INTERFACE.recycleScroller(_domDefinitionsWrapper);\n      }\n\n      var _domTermsWrapper = this._objCurrDOM.getElementById(this._strGlossaryTermsWrapperID);\n      if (_domTermsWrapper && this._applyIScroll()) {\n        ISCROLL_INTERFACE.recycleScroller(_domTermsWrapper);\n      }\n\n      if (_domTermsWrapper && this._applyIScroll()) {\n        ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n      }\n\n      this._strCurrSelectedTerm = '';\n      this._strCurrSelectedLetter = LOCALISER.get('GLOSSARY_ALL').toLowerCase();\n      this._domCurrInsertionNode.innerHTML = '';\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n    }\n  },\n\n  _getTemplateHTML: function() {\n    var templateId = this._strPopupTemplateID;\n    if (SIMPLE_GLOSSARY_LAYOUT) {\n      templateId = 'simpleGlossary';\n    }\n    if (PANEL_GLOSSARY_LAYOUT) {\n      templateId = 'panelGlossary';\n    }\n    this._htmPopupTemplate = TEMPLATE_MANANGER.getTemplate(templateId).htmData;\n\n    this._htmLetterTemplate = TEMPLATE_MANANGER.getTemplate(this._strLetterTemplateID).htmData;\n    this._htmDisabledLetterTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strDisabledLetterTemplateID\n    ).htmData;\n    this._htmLetterTitleTemplate = TEMPLATE_MANANGER.getTemplate(this._strLetterTitleID).htmData;\n    this._htmTermTemplate = TEMPLATE_MANANGER.getTemplate(this._strTermTemplateID).htmData;\n    this._htmDefinitionTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strDefinitionTemplateID\n    ).htmData;\n    this._htmNoDefinitionTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strNoDefinitionTemplateID\n    ).htmData;\n  },\n\n  _parseDataIntoHash: function(_objWhatRawGlossaryData) {\n    var _objGlossaryHash = {};\n    _objGlossaryHash[this._strAllTerm] = [];\n    var _arrTerms = _objWhatRawGlossaryData['terms'];\n    var count = 0;\n    while (count < _arrTerms.length) {\n      var _objCurrTerm = _arrTerms[count];\n      var _chaFirstLetter = this._getFirstLetter(_objCurrTerm['decodedTermtitle']);\n      if (!_objGlossaryHash[_chaFirstLetter]) {\n        _objGlossaryHash[_chaFirstLetter] = [];\n      }\n      _objCurrTerm['htmDefinition'] = this._createGlossaryDefinition(_objCurrTerm);\n      _objCurrTerm['letter'] = _chaFirstLetter;\n      _objGlossaryHash[_chaFirstLetter].push(_objCurrTerm);\n      _objGlossaryHash[this._strAllTerm].push(_objCurrTerm);\n      this._objGlobalGlossaryTermsHash[_objCurrTerm['screenId']] = _objCurrTerm;\n      count++;\n    }\n    for (var _strCurrLetter in _objGlossaryHash) {\n      if (Object.prototype.hasOwnProperty.call(_objGlossaryHash, _strCurrLetter)) {\n        var _arrCurrTermListing = _objGlossaryHash[_strCurrLetter];\n        _arrCurrTermListing = _arrCurrTermListing.sort(this._sortTermArray);\n      }\n    }\n    return _objGlossaryHash;\n  },\n\n  _getFirstLetter: function(_strWhatTerm) {\n    return _strWhatTerm.charAt(0).toLowerCase();\n  },\n\n  _createGlossaryDefinition: function(_objWhatData) {\n    var _htmDefinition = this._htmDefinitionTemplate;\n    _htmDefinition = _htmDefinition.replace(/XX_GLOSSARY_TERM_XX/g, _objWhatData['@termtitle']);\n    _htmDefinition = _htmDefinition.replace(\n      /XX_GLOSSARY_DEFINITION_XX/g,\n      _objWhatData['definition']\n    );\n    return _htmDefinition;\n  },\n\n  _sortTermArray: function(a, b) {\n    return a['decodedTermtitle'].localeCompare(b['decodedTermtitle'], this._localeCode);\n  },\n\n  _sortLetterArray: function(a, b) {\n    return a.localeCompare(b, this._localeCode);\n  },\n\n  _createGlossaryHTML: function() {\n    var _htmGlossary = this._htmPopupTemplate;\n\n    var _htmLetterContent = this._createGlossaryLetters();\n    var _htmTermsContent = this._createGlossaryTerms();\n    var _htmDefinitionContent = this._getCurrentDefinition();\n\n    _htmGlossary = _htmGlossary.replace(/XX_GLOSSARY_LETTERS_XX/g, _htmLetterContent);\n    _htmGlossary = _htmGlossary.replace(/XX_GLOSSARY_TERMS_XX/g, _htmTermsContent);\n    _htmGlossary = _htmGlossary.replace(/XX_GLOSSARY_DEFINITION_XX/g, _htmDefinitionContent);\n\n    return _htmGlossary;\n  },\n\n  _createGlossaryLetters: function() {\n    var _htmLetters = '';\n    var count = 0;\n    var _strStateClass;\n    var _strLetterSelected;\n    var _htmCurrLetter;\n\n    while (count < this._arrGlossaryLetters.length) {\n      var _strCurrLetter = this._arrGlossaryLetters[count];\n      _htmCurrLetter = this._htmLetterTemplate;\n      _strLetterSelected = 'false';\n      if (this._strCurrSelectedLetter == _strCurrLetter) {\n        _strStateClass = this._strSelectedLetterClass;\n        _strLetterSelected = 'true';\n      } else {\n        _strStateClass = this._strUnselectedLetterClass;\n      }\n\n      if (count == 0) {\n        _strStateClass += ' ' + this._strFirstLetterClass;\n      }\n      if (count == this._arrGlossaryLetters.length - 1) {\n        _strStateClass += ' ' + this._strLastLetterClass;\n      }\n\n      _htmCurrLetter = _htmCurrLetter.replace(/XX_LETTER_STATE_CLASS_XX/g, _strStateClass);\n      _htmCurrLetter = _htmCurrLetter.replace(/XX_LETTER_SELECTED_XX/g, _strLetterSelected);\n      _htmCurrLetter = _htmCurrLetter.replace(\n        /XX_GLOSSARY_LETTER_XX/g,\n        he.encode(_strCurrLetter.toUpperCase())\n      );\n      _htmLetters += _htmCurrLetter;\n      count++;\n    }\n    return _htmLetters;\n  },\n\n  _createGlossaryTerms: function() {\n    this._debug('Creating terms.');\n    if (this._strCurrOutputModeClass != 'smartphoneC') {\n      this._debug('Creating graphical terms.');\n      return this._createGraphicalTerms();\n    } else {\n      this._debug('Creating list terms.');\n      return this._createListBasedTerms(true, false);\n    }\n  },\n\n  _getFirstTermInList: function() {\n    var _arrCurrTerms = this._objSortedGlossaryTermsHash[this._strCurrSelectedLetter];\n    return _arrCurrTerms[0];\n  },\n\n  _createGraphicalTerms: function() {\n    var _arrTermFragments = [];\n    var _arrCurrTerms = this._objSortedGlossaryTermsHash[this._strCurrSelectedLetter];\n    var count = 0;\n    var _strStateClass;\n    var _htmTerms;\n\n    while (count < _arrCurrTerms.length) {\n      var _objCurrTerm = _arrCurrTerms[count];\n      var _htmTermTemplate = this._htmTermTemplate;\n      if (this._strCurrSelectedTerm == _objCurrTerm['@termtitle']) {\n        _strStateClass = this._strSelectedTermClass;\n      } else {\n        _strStateClass = this._strUnselectedTermClass;\n      }\n\n      _htmTermTemplate = _htmTermTemplate.replace(/XX_TERM_STATE_CLASS_XX/g, _strStateClass);\n      _htmTermTemplate = _htmTermTemplate.replace(\n        /XX_GLOSSARY_TERM_XX/g,\n        _objCurrTerm['@termtitle']\n      );\n      _htmTermTemplate = _htmTermTemplate.replace(\n        /XX_GLOSSARY_TERM_ID_XX/g,\n        _objCurrTerm['screenId']\n      );\n\n      _arrTermFragments.push(_htmTermTemplate);\n      count++;\n    }\n    _htmTerms = _arrTermFragments.join('');\n    return _htmTerms;\n  },\n\n  _createListBasedTerms: function(_booAddHeaderLetters, _chaOptionalLetterFilter) {\n    var _chaLastFirstLetter = '-';\n    var _htmTermsList = '';\n    var _arrCurrTerms;\n\n    if (!_chaOptionalLetterFilter) {\n      _arrCurrTerms = this._objSortedGlossaryTermsHash[this._strAllTerm];\n    } else {\n      _arrCurrTerms = this._objSortedGlossaryTermsHash[_chaOptionalLetterFilter];\n    }\n\n    var count = 0;\n    while (count < _arrCurrTerms.length) {\n      var _objCurrTerm = _arrCurrTerms[count];\n      var _chaFirstLetter = this._getFirstLetter(_objCurrTerm['@termtitle']);\n      if (_chaFirstLetter != _chaLastFirstLetter && _booAddHeaderLetters) {\n        _htmTermsList += this._createLetterTitle(_chaFirstLetter);\n      }\n\n      _htmTermsList += _objCurrTerm['htmDefinition'];\n\n      // this._htmLetterTitleTemplate\n      _chaLastFirstLetter = _chaFirstLetter;\n      count++;\n    }\n    return _htmTermsList;\n  },\n\n  _createLetterTitle: function(_chaWhatLetter) {\n    return this._htmLetterTitleTemplate.replace(\n      /XX_GLOSSARY_LETTER_XX/g,\n      _chaWhatLetter.toUpperCase()\n    );\n  },\n\n  _getCurrentDefinition: function() {\n    this._debug('Getting current definition.');\n    var _strScrollWrapperPrefixHTML;\n    var _strScrollWrapperSuffixHTML;\n\n    if (this._strCurrOutputModeClass == 'tabletC') {\n      _strScrollWrapperPrefixHTML = '<div class=\\'scrollWrapperC\\'>';\n      _strScrollWrapperSuffixHTML = '</div>';\n    } else {\n      _strScrollWrapperPrefixHTML = '';\n      _strScrollWrapperSuffixHTML = '';\n    }\n\n    if (this._strCurrSelectedTerm == '') {\n      return (\n        _strScrollWrapperPrefixHTML + this._htmNoDefinitionTemplate + _strScrollWrapperSuffixHTML\n      );\n    } else {\n      return (\n        _strScrollWrapperPrefixHTML +\n        this._objGlobalGlossaryTermsHash[this._strCurrSelectedTerm]['htmDefinition'] +\n        _strScrollWrapperSuffixHTML\n      );\n    }\n  },\n\n  _highlightLetter: function(_strWhatLetter) {\n    $(this._objCurrDOM)\n      .find('.' + this._strSelectedLetterClass)\n      .removeClass(this._strSelectedLetterClass)\n      .addClass(this._strUnSelectedLetterClass)\n      .attr('aria-selected', false);\n    $(this._objCurrDOM)\n      .find('#' + this._strLetterIDPrefix + _strWhatLetter + this._strLetterIDSuffix)\n      .removeClass(this._strUnselectedLetterClass)\n      .addClass(this._strSelectedLetterClass)\n      .attr('aria-selected', true);\n  },\n\n  _highlightTerm: function(_strWhatTerm) {\n    $(this._objCurrDOM)\n      .find('.' + this._strSelectedTermClass)\n      .removeClass(this._strSelectedTermClass)\n      .addClass(this._strUnSelectedTermClass)\n      .attr('aria-selected', false);\n    $(this._objCurrDOM)\n      .find('#' + this._strTermIDPrefix + _strWhatTerm + this._strTermIDSuffix)\n      .addClass(this._strSelectedTermClass)\n      .attr('aria-selected', true);\n  },\n\n  _focusDefinition: function() {\n    var _domDefinitionsWrapper = this._objCurrDOM.getElementById(\n      this._strGlossaryDefinitionWrapperID\n    );\n    if (_domDefinitionsWrapper && this._applyIScroll()) {\n      ISCROLL_INTERFACE.parseChildDOMElements(_domDefinitionsWrapper);\n      window.setTimeout(function() {\n        ISCROLL_INTERFACE.refreshIScrolls();\n      }, 200);\n    }\n  },\n\n  _applyIScroll: function() {\n    if (\n      window['ISCROLL_INTERFACE'] &&\n      (this._strCurrOutputModeClass == 'smartphoneC' || this._strCurrOutputModeClass == 'tabletC')\n    ) {\n      return true;\n    }\n    return false;\n  },\n\n  _debug: function(_strMessage) {\n    if (window['console'] && window.console.log && this._booDebug) {\n      console.log('GLOSSARY: ' + _strMessage);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = false;\n    if (!PANEL_GLOSSARY_LAYOUT) {\n      accessibleElements = [\n        '.glossaryLetterC',\n        '.glossaryTermC',\n        '#closeGlossaryPopupL'\n      ];\n    }\n    return accessibleElements;\n  },\n\n  /**\n   * Build the interactive mobile glossary html.\n   * @return {string}\n   */\n  renderMobileGlossary: function() {\n    var glossaryHtml = '';\n    var renderData = this.buildMobileGlossaryData();\n    var glossaryTemplate = gomo.templateManager.getTemplate('mobileGlossary').htmData;\n    glossaryHtml = Mustache.render(glossaryTemplate, renderData);\n    return glossaryHtml;\n  },\n\n  /**\n   * Build the panel glossary html.\n   * @return {string}\n   */\n  renderPanelGlossary: function() {\n    var glossaryHtml = '';\n    var renderData = this.buildMobileGlossaryData();\n    var glossaryTemplate = gomo.templateManager.getTemplate('panelGlossary').htmData;\n    glossaryHtml = Mustache.render(glossaryTemplate, renderData);\n    return glossaryHtml;\n  },\n\n  /**\n   * Builds a data object that can be used to render the mobile glossary.\n   * @return {object}\n   */\n  buildMobileGlossaryData: function() {\n    var me = this;\n    var letters = [];\n    _.each(me._objSortedGlossaryTermsHash, function(termData, letter) {\n      var letterData = {\n        letter: letter,\n        state: 'active'\n      };\n      if (letter === me._strCurrSelectedLetter) {\n        letterData.state = 'selected';\n      }\n      letters.push(letterData);\n    });\n    var glossaryData = {\n      letters: letters,\n      terms: this._objSortedGlossaryTermsHash[this._strCurrSelectedLetter]\n    };\n    return glossaryData;\n  },\n\n  /**\n   * Shows the terms for the selected letter.\n   * @param {object} letterData\n   */\n  handleEvent_showTerms: function(letterData) {\n    var glossaryType = PANEL_GLOSSARY_LAYOUT ? 'panel' : 'mobile';\n    var glossaryTermClass = glossaryType + '-glossary__term';\n    this.closeDefinition();\n\n    // Show terms for selected letter.\n    if (letterData.letter === 'all') {\n      $('.' + glossaryTermClass).show();\n    } else {\n      $('.' + glossaryTermClass).hide();\n      $('[data-letter=' + letterData.letter +']').show();\n    }\n\n    // Reset display states.\n    var selectedLetterClass = glossaryType + '-glossary__letter-button--selected';\n    var activeLetterClass = glossaryType + '-glossary__letter-button--active';\n    $('.' + selectedLetterClass)\n      .removeClass(selectedLetterClass)\n      .addClass(activeLetterClass)\n      .attr('aria-current', false);\n    $(letterData.el)\n      .removeClass(activeLetterClass)\n      .addClass(selectedLetterClass)\n      .attr('aria-current', true);\n  },\n\n  /**\n   * Shows the defintion for the selected term.\n   * @param {object} termData\n   */\n  handleEvent_showDefinition: function(termData) {\n    var definitionHtml = '';\n\n    // Get definition html.\n    _.each(this._objSortedGlossaryTermsHash[termData.letter], function(term) {\n      if (term.decodedTermtitle === termData.term) {\n        definitionHtml = term.htmDefinition;\n      }\n    });\n\n    // Reset display states.\n    var selectedTermClass = 'mobile-glossary__term--selected';\n    var definitionTermClass = 'mobile-glossary__definition-term';\n    var definitionTextClass = 'mobile-glossary__definition-text';\n    $('.' + selectedTermClass).removeClass(selectedTermClass);\n    $(termData.el).addClass(selectedTermClass);\n\n    // Render and show the definition content.\n    $('.' + definitionTermClass).html(termData.selectedTerm);\n    $('.' + definitionTextClass).html(definitionHtml);\n    this.openDefinition();\n  },\n\n  /**\n   * Triggers the close defintion method.\n   */\n  handleEvent_closeDefinition: function() {\n    this.closeDefinition();\n  },\n\n  /**\n   * Closes the definition and opens the terms.\n   */\n  closeDefinition: function() {\n    var termsClass = 'mobile-glossary__terms';\n    var definitionClass = 'mobile-glossary__definition';\n    $('.' + termsClass).addClass(termsClass + '--open');\n    $('.' + definitionClass).removeClass(definitionClass + '--open');\n  },\n\n  /**\n   * Opens the definition and closes the terms.\n   */\n  openDefinition: function() {\n    var termsClass = 'mobile-glossary__terms';\n    var definitionClass = 'mobile-glossary__definition';\n    $('.' + termsClass).removeClass(termsClass + '--open');\n    $('.' + definitionClass).addClass(definitionClass + '--open');\n  }\n};\n\nEM.register(GLOSSARY_EXTRA);\nPOPUP_MANANGER.registerPopup('glossary', GLOSSARY_EXTRA);\n"},function(t,e,n){n(0)(n(145))},function(t,e){t.exports="/* global $, POPUP_MANANGER, TOPIC_RENDERER, EM, OUTPUT_MODE_CHECKER, META_SCREEN_INTERACTIONS */\n/* global ANIMATOR_INTERFACE_2, INT_TRANSITION_TIMER, ISCROLL_INTERFACE, TEMPLATE_MANANGER, DEBUG */\n\nvar HELP_EXTRA = {\n  strObjID: 'The help extra',\n  _strManifestID: 'helpExtra',\n  strObjDescription: 'The extra responsible for displaying the help content',\n\n  _objCurrDOM: null,\n\n  _objHelpData: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _strPopupTemplateID: 'helpPopupC',\n  _strPopupItemTemplateID: 'helpPopupContentItemC',\n  _strContentWrapperID: 'metaContentWrapperL',\n  _strButtonID: 'helpL',\n\n  _htmBaseHelpPopupTemplate: null,\n  _htmBaseHelpContentItemTemplate: null,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  _domAssetReturnFocusItemElement: '',\n  _domCurrInsertionNode: '',\n\n  _objIScrollHandle: null,\n  _intScrollPos: 0,\n\n  _strAnimationAsset: 'help',\n\n  // Legacy help files only contain a limited sub-set of help\n  // fragments and they are often using different keys. If the\n  // initial key isn't found, this table is used to see if the\n  // backup key can be found.\n  _objAlternativeHelpIDs: {\n    'topic-linear-start': 'topic',\n    'topic-tutorial-start': 'topic',\n    'topic-scenario-start': 'topic',\n    'topic-branching-start': 'topic',\n    'topic-assessment-start': 'assessment'\n  },\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this.booPopupShown) {\n      this.hidePopup();\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strContentWrapperID);\n  },\n\n  handleEvent_popupAnimationComplete: function() {\n    // Generic function for all Extras tidyup call\n  },\n\n  popupAnimationComplete: function(helpDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(helpDomElement, '#metaContentWrapperL');\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objPopupData) {\n    EM.trigger('disableSwiping');\n\n    var _htmMetaTopic = TOPIC_RENDERER.renderTopic(_objPopupData._metaTopic);\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      _domWhatNodeToInsertInto.style.display = 'block';\n    }\n\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n    this._domCurrInsertionNode.innerHTML = _htmMetaTopic;\n\n    META_SCREEN_INTERACTIONS.switchToMetaScreen(_objPopupData._objActionData.strFullScreenId);\n\n    /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n    * a global object in config. Then place an object at the top of this class\n    * with overrides. These overrides can then be altered per project with a\n    * config_override.js\n    **/\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      this._booPopupVisible = true;\n\n      var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n      var helpDomElement = this._domCurrInsertionNode;\n      var funComplete = function() {\n        HELP_EXTRA.popupAnimationComplete(helpDomElement);\n      };\n      ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n        duration: INT_TRANSITION_TIMER,\n        complete: funComplete\n      });\n    }\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  hidePopup: function() {\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          HELP_EXTRA.popupAnimationComplete();\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    } else {\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableSwipe');\n  },\n\n  _cleanUpAndHide: function() {\n    if (this._domCurrInsertionNode) {\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n      }\n      this._domCurrInsertionNode.innerHTML = '';\n\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n      this._booPopupVisible = false;\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n    }\n  },\n\n  _getTemplateHTML: function() {\n    this._htmBaseHelpPopupTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strPopupTemplateID\n    ).htmData;\n    this._htmBaseHelpContentItemTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strPopupItemTemplateID\n    ).htmData;\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = [\n      '.helpMetaC [role=\"button\"]',\n      '#closeMetaPopupL'\n    ];\n    return accessibleElements;\n  }\n};\n\nEM.register(HELP_EXTRA);\nPOPUP_MANANGER.registerPopup('help', HELP_EXTRA);\n"},function(t,e,n){n(0)(n(147))},function(t,e){t.exports="/**\n * @title Settings\n * @description To be described.\n *\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\n/* global $, _, EM, CORE, LOADER, POPUP_MANANGER,\n  TEMPLATE_MANANGER, TOPIC_MANAGER,\n  OUTPUT_MODE_CHECKER, ISCROLL_INTERFACE,\n  DEBUG\n */\n\nvar JLR_MENU_EXTRA = {\n  strObjID: 'The JLR Menu extra',\n  strObjDescription:\n    'The extra responsible for displaying the list of topics and allowing quick navigation to those topics', // eslint-disable-line max-len\n\n  _objCurrDOM: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _domCurrInsertionNode: '',\n\n  _strPopupWrapperID: 'jlrTableOfContentsPopupHolder',\n  _strPopupTemplateID: 'tableOfContentsPopupC',\n  _strItemTemplateID: 'jlrToCItem',\n\n  _htmBaseWrapperTemplate: '',\n  _htmBaseItemTemplate: '',\n\n  _strCloseButtonID: 'closeTableOfContentsPopupL',\n\n  _strDisplayElement: 'visibleC',\n  _strHideElement: 'hiddenC',\n\n  _strContentWrapperId: '#pageWrapperL',\n\n  _intAnimationDuration: 500,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  originalHeight: 0,\n  disableMenuButtons: false,\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    var me = this;\n    me._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (me.booPopupShown) {\n      me.hidePopup({\n        booResetSettings: true\n      });\n      POPUP_MANANGER.unlockPopups();\n      me._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_loadTopicObject: function(topicData) {\n    var me = this;\n    setTimeout(function() {\n      me.setMenuButtonState(topicData.strTopicID);\n    }, 100);\n  },\n\n  handleEvent_popupAnimationComplete: function() {},\n\n  handleEvent_swipeLeft: function() {\n    if (this._booPopupVisible) {\n      this._forceClosePopup();\n    }\n  },\n\n  // Explore button\n  handleEvent_toggleJLRMenu: function(buttonData) {\n    if (TOPIC_MANAGER._booNavigationLocked || this.disableMenuButtons) return;\n\n    EM.trigger('preNavigate', 'jlr-menu');\n    EM.trigger('popupButtonClicked', {\n      strPopupID: 'jlr-menu',\n      domReturnFocusItem: buttonData.domReturnFocusItem,\n      strInsertionWrapper: 'jlrTopicMenuItems'\n    });\n\n    return false;\n  },\n\n  // Go to topic\n  handleEvent_tableOfContentAction: function(buttonData) {\n    var me = this;\n    var actionOptions = {};\n\n    if (TOPIC_MANAGER._booNavigationLocked || me.disableMenuButtons) return;\n\n    // Close popup\n    if ($(buttonData.domLink).hasClass('activeItemC')) {\n      me._forceClosePopup();\n    }\n\n    // Get active button id\n    if ($('.jlrMenuBtn.activeItemC').length) {\n      me.currentActiveButton = $('.jlrMenuBtn.activeItemC').attr('id');\n    }\n\n    if ($(buttonData.domLink).attr('id')) {\n      me.newActiveButton = $(buttonData.domLink).attr('id');\n    }\n\n    actionOptions.objActions = [\n      {\n        objParameters: {\n          target_id: buttonData.strTargetID\n        },\n        strActionGroup: 'navigation',\n        strObjectType: 'action',\n        strType: 'internal_link'\n      }\n    ];\n    actionOptions.objOptionalExtraData = {};\n    actionOptions.objOptionalExtraData.domLink = buttonData.domLink;\n\n    // Example feed back for completion of subscreen display.\n    actionOptions.objOptionalExtraData.funTriggerCallBack = function() {\n      me._forceClosePopup.apply(me);\n    };\n\n    EM.trigger('processActions', actionOptions);\n  },\n\n  handleEvent_navigationRendered: function() {\n    var me = this;\n\n    // Make sure the jlr menu is being used before we disable\n    // screen loading when scrolling the screen in continuous scroll mode\n    if (\n      typeof _.find(CORE.objCourseData.arrMetaTopics, {strObjType: 'jlr_table_of_contents'}) !==\n      'undefined'\n    ) {\n      gomo.scrollManager.disableScreenSwitchFromScrolling();\n      var currentTopic = gomo.topicManager.getCurrentTopic();\n      me.setMenuButtonState(currentTopic.strObjID);\n    }\n  },\n\n  popupAnimationComplete: function() {\n    var me = this;\n\n    if (!me._booPopupVisible) {\n      $('.jlrMenuButtons').removeClass('open');\n      $('#tableOfContentsL').removeClass('open');\n      $('.jlrMenuStrap').removeClass('open');\n      me._cleanUpAndHide();\n    }\n\n    setTimeout(function() {\n      me.disableMenuButtons = false;\n      POPUP_MANANGER.unlockPopups();\n    }, 100);\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto) {\n    var me = this;\n\n    // We haven't finished clearing the dom yet\n    if (me._domCurrInsertionNode) return;\n\n    // Buttons are disabled or the popup is visible\n    if (me.disableMenuButtons || me._booPopupVisible) return;\n\n    EM.trigger('disableScreenSwiping');\n    $('.jlrMenuButtons').addClass('open');\n    $('#tableOfContentsL').addClass('open');\n    $('.jlrMenuStrap').addClass('open');\n\n    me._getTemplateHTML();\n    me._domCurrInsertionNode = _domWhatNodeToInsertInto;\n\n    var _htmTableOfContentsPopup = me._createTableOfContentsPopupHTML();\n    me.originalHeight = $('.strapBottom').outerHeight();\n\n    me._domCurrInsertionNode.innerHTML = _htmTableOfContentsPopup;\n    me._domTableOfContents = me._objCurrDOM.getElementById(me._strPopupWrapperID);\n\n    var fullHeight = me.originalHeight + $(me._domTableOfContents).outerHeight();\n\n    me._focusPopup();\n\n    if (me._strCurrOutputModeClass != 'accessibleC') {\n      me._booPopupVisible = true;\n      me.disableMenuButtons = true;\n\n      $('.strapBottom')\n        .removeClass('barDown barUp')\n        .velocity(\n          {\n            height: fullHeight + 'px'\n          },\n          {\n            duration: me._intAnimationDuration,\n            delay: 200,\n            complete: function() {\n              me.popupAnimationComplete();\n            }\n          }\n        );\n    }\n\n    // If already displayed in normal mode,\n    // reset the transform so accessible mode can now be displayed\n    if (me._strCurrOutputModeClass == 'accessibleC') {\n      if (typeof $(me._domCurrInsertionNode).css('transform') !== 'undefined') {\n        $(me._domCurrInsertionNode).css('transform', 'none');\n      }\n    }\n\n    me.booPopupShown = true;\n  },\n\n  hidePopup: function(popupData) {\n    var me = this;\n\n    if (!me.disableMenuButtons) {\n      if (me._strCurrOutputModeClass != 'accessibleC') {\n        if (me._booPopupVisible) {\n          me.disableMenuButtons = true;\n\n          $('.strapBottom')\n            .removeClass('barDown barUp')\n            .velocity(\n              {\n                height: me.originalHeight + 'px'\n              },\n              {\n                duration: me._intAnimationDuration,\n                complete: function() {\n                  me._booPopupVisible = false;\n                  me.popupAnimationComplete();\n                }\n              }\n            );\n        }\n      }\n\n      EM.trigger('enableScreenSwipe');\n    }\n  },\n\n  _forceClosePopup: function() {\n    EM.trigger('closePopup', {\n      strPopupID: 'jlr-menu'\n    });\n  },\n\n  _updateActiveStates: function() {\n    var me = this;\n\n    var $currentActiveButton = $('.jlrMenuBtn.activeItemC');\n    if ($currentActiveButton.length) {\n      $currentActiveButton.removeClass('activeItemC').addClass('inactiveItemC');\n    }\n\n    if (me.newActiveButton && $('#' + me.newActiveButton).length) {\n      $('#' + me.newActiveButton)\n        .removeClass('inactiveItemC')\n        .addClass('activeItemC');\n      me.newActiveButton = null;\n    }\n  },\n\n  _cleanUpAndHide: function() {\n    var me = this;\n    // POPUP_MANANGER.unlockPopups();\n\n    if (me._domCurrInsertionNode) {\n      me._domCurrInsertionNode.innerHTML = '';\n      me._domCurrInsertionNode = null;\n      me.booPopupShown = false;\n      POPUP_MANANGER.postAnimationTidyUp();\n    }\n  },\n\n  _getTemplateHTML: function() {\n    var me = this;\n    me._htmBaseWrapperTemplate = TEMPLATE_MANANGER.getTemplate(me._strPopupTemplateID).htmData;\n    me._htmBaseItemTemplate = TEMPLATE_MANANGER.getTemplate(me._strItemTemplateID).htmData;\n  },\n\n  _createTableOfContentsPopupHTML: function() {\n    var me = this;\n    var _htmTableOfContentsPopup = me._htmBaseWrapperTemplate;\n\n    var _htmItemsList = me._getContentItems();\n    _htmTableOfContentsPopup = _htmTableOfContentsPopup.replace(\n      'XX_CONTENT_ITEMS_XX',\n      _htmItemsList\n    );\n\n    return _htmTableOfContentsPopup;\n  },\n\n  _getContentItems: function() {\n    var me = this;\n    var _htmItemsListings = '';\n    var _arrQuickLaunchTopics = me.getQuickLaunchTopics();\n    var _objCurrentTopicId = TOPIC_MANAGER.getCurrentTopic().strObjID;\n\n    if (typeof _arrQuickLaunchTopics != 'undefined') {\n      var count = 0;\n      while (count < _arrQuickLaunchTopics.length) {\n        var objCurrentTopic = _arrQuickLaunchTopics[count];\n        var _htmCurrItem = me._htmBaseItemTemplate;\n        var topicTitle = '';\n\n        if (typeof objCurrentTopic.titles !== 'undefined') {\n          topicTitle =\n            objCurrentTopic.titles[gomo.translationManager.langCode] ||\n            objCurrentTopic.titles['default'];\n        } else {\n          topicTitle = objCurrentTopic.strTitle;\n        }\n\n        _htmCurrItem = _htmCurrItem.replace(/XX_TABLE_OF_CONTENTS_NAME_XX/g, topicTitle);\n        _htmCurrItem = _htmCurrItem.replace(/XX_SCREEN_ID_XX/g, objCurrentTopic.strTopicID);\n\n        var _strItemClass = 'inactiveItemC';\n        if (objCurrentTopic.strTopicID === _objCurrentTopicId) {\n          _strItemClass = 'activeItemC';\n        }\n        _htmCurrItem = _htmCurrItem.replace(/XX_TABLE_OF_CONTENTS_CLASS_XX/g, _strItemClass);\n\n        _htmItemsListings += _htmCurrItem;\n\n        count++;\n      }\n      return _htmItemsListings;\n    } else {\n      return 'Please select one or more topics in the Portal to quick launch to.';\n    }\n  },\n\n  getQuickLaunchTopics: function() {\n    var me = this;\n    var topics = [];\n\n    if (CORE.objCourseData.objRawData.arrQuickLaunchTopics) {\n      topics = CORE.objCourseData.objRawData.arrQuickLaunchTopics;\n    } else {\n      topics = me._autoGeneratedListOfItems();\n    }\n\n    return topics;\n  },\n\n  _autoGeneratedListOfItems: function() {\n    var arrTopics = CORE.objCourseData.arrContainers;\n    var arrItemList = [];\n    var count = 0;\n    while (count < arrTopics.length) {\n      if (arrTopics[count].strTitle === '') {\n        var topicObject = LOADER.loadTopicData(arrTopics[count].strTopicDataFilename);\n        if (topicObject && topicObject.topic) {\n          topicObject.topic.strTopicID = topicObject.topic.strID;\n          arrItemList.push(topicObject.topic);\n        }\n      } else {\n        arrItemList.push({\n          strTitle: arrTopics[count].strTitle,\n          strTopicID: arrTopics[count].strObjID\n        });\n      }\n      count++;\n    }\n\n    return arrItemList;\n  },\n\n  _focusPopup: function() {\n    var me = this;\n    if (OUTPUT_MODE_CHECKER.isDesktop()) {\n      var _domCloseButton = me._objCurrDOM.getElementById(me._strCloseButtonID);\n      // On occassion, if for example the menu button is pressed whilst the help is appearing,\n      // the close button may not be available at the point this executes...\n      if (_domCloseButton) {\n        _domCloseButton.focus();\n      }\n    } else {\n      var _domTableOfContentsWrapper = me._objCurrDOM.getElementById(me._strPopupWrapperID);\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.parseChildDOMElements(_domTableOfContentsWrapper);\n      }\n    }\n  },\n\n  setMenuButtonState: function(topicID) {\n    var me = this;\n    if (!topicID) return;\n\n    var quickLaunchTopics = me.getQuickLaunchTopics();\n    var launchTopic = _.filter(quickLaunchTopics, function(obj) {\n      return obj.strTopicID == topicID;\n    });\n\n    $('.strapBottom .jlrMenuBtn .activeItemC')\n      .addClass('inactiveItemC');\n\n    $('.strapBottom .' + topicID)\n      .removeClass('inactiveItemC')\n      .addClass('activeItemC');\n\n    if (launchTopic.length) {\n      $('#tableOfContentsL, .jlrMenuStrap').addClass('selectedLaunch');\n    } else {\n      $('#tableOfContentsL, .jlrMenuStrap').removeClass('selectedLaunch');\n    }\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  }\n};\n\nEM.register(JLR_MENU_EXTRA);\nPOPUP_MANANGER.registerPopup('jlr-menu', JLR_MENU_EXTRA);\n"},function(t,e,n){n(0)(n(149))},function(t,e){t.exports="/* globals OUTPUT_MODE_CHECKER, POPUP_MANANGER, EM, ANIMATOR_INTERFACE_2, INT_TRANSITION_TIMER,\nTEMPLATE_MANANGER, CORE, DEBUG, ISCROLL_INTERFACE, $ */\n\n/**\n * @title The language selector extra\n * @description The extra responsible for displaying the list of languages and allowing quick\n * navigation to those translations\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\nvar LANGUAGE_SELECTOR_EXTRA = {\n  strObjID: 'The Language Selector extra',\n  strObjDescription:\n    'The extra responsible for displaying the list of languages and allowing' +\n    'quick navigation to those translations',\n\n  _objCurrDOM: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _domCurrInsertionNode: '',\n\n  _strPopupWrapperID: 'languageSelectorPopupHolderL',\n  _strPopupTemplateID: 'languageSelectorPopupC',\n  _strButtonID: 'languageSelectorL',\n  _strItemTemplateID: 'languageSelectorItemC',\n  _strItemTemplateIDActive: 'languageSelectorItemActiveC',\n\n  _htmBaseWrapperTemplate: '',\n  _htmBaseItemTemplate: '',\n\n  _strDisplayElement: 'visibleC',\n  _strHideElement: 'hiddenC',\n\n  _strContentWrapperId: '#pageWrapperL',\n\n  _intAnimationDuration: 500,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  popupLocaleTitle: 'LANGUAGE_SELECTOR_POPUP_TITLE',\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this.booPopupShown) {\n      this.hidePopup({\n        booResetSettings: true\n      });\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strPopupWrapperID);\n  },\n\n  handleEvent_popupAnimationComplete: function() {},\n\n  handleEvent_swipeLeft: function() {\n    if (this._booPopupVisible) {\n      this._forceClosePopup();\n    }\n  },\n\n  handleEvent_languageSelectorAction: function(_objButtonData) {\n    var _objActionOptions = {};\n    _objActionOptions.objActions = [\n      {\n        objParameters: {\n          languageId: _objButtonData.strTargetID\n        },\n        strActionGroup: 'interaction',\n        strObjectType: 'action',\n        strType: 'setLanguage'\n      }\n    ];\n    _objActionOptions.objOptionalExtraData = {};\n    _objActionOptions.objOptionalExtraData.domLink = _objButtonData.domLink;\n\n    // Example feed back for completion of subscreen display.\n    _objActionOptions.objOptionalExtraData.funTriggerCallBack = function() {\n      gomo.translationManager.updateContentTracking();\n      LANGUAGE_SELECTOR_EXTRA._forceClosePopup();\n    };\n\n    // We need something like this which can work at the 'extras' level to disable interactions\n    // until the json is loaded\n    // EM.trigger(\"toggleBlanking\", {'strState':\"ON\", 'objWhatDOM':_objButtonData.domLink});\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  popupAnimationComplete: function(langDomElement) {\n    if (!this._booPopupVisible) {\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(langDomElement, '#languageSelectorPopupHolderL');\n      // Apply iscroll\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        var langsHolder = $('#languageSelectorPopupHolderL');\n        if (langsHolder.length) {\n          ISCROLL_INTERFACE.recycleScroller(langsHolder[0]);\n          ISCROLL_INTERFACE.parseChildDOMElements(langsHolder[0]);\n        }\n      }\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objPopupData) {\n    EM.trigger('disableScreenSwiping');\n\n    this._getTemplateHTML();\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n\n    var htmLanguageSelectorPopup = this._createLanguageSelectorPopupHTML();\n    this._domCurrInsertionNode.innerHTML = htmLanguageSelectorPopup;\n\n    if (this._strCurrOutputModeClass != 'accessibleC') {\n      this._booPopupVisible = true;\n\n      if (\n        this._strCurrOutputModeClass != 'accessibleC' &&\n        OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n      ) {\n        this._booPopupVisible = true;\n\n        var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n        var langDomElement = this._domCurrInsertionNode;\n        var funComplete = function() {\n          LANGUAGE_SELECTOR_EXTRA.popupAnimationComplete(langDomElement);\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    }\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  hidePopup: function(_objPopupData) {\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          LANGUAGE_SELECTOR_EXTRA.popupAnimationComplete();\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    } else {\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableScreenSwipe');\n  },\n\n  _forceClosePopup: function() {\n    // We need something like this which can work at the 'extras' level to re enable interactions\n    // until the json is loaded\n    // EM.trigger(\"toggleBlanking\", {'strState':\"OFF\", 'objWhatDOM':_objButtonData.domLink});\n    EM.trigger('closePopup', {\n      strPopupID: 'languageSelector'\n    });\n  },\n\n  _cleanUpAndHide: function() {\n    POPUP_MANANGER.unlockPopups();\n    if (this._domCurrInsertionNode) {\n      this._domCurrInsertionNode.innerHTML = '';\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n      POPUP_MANANGER.postAnimationTidyUp();\n    }\n  },\n\n  _getTemplateHTML: function() {\n    this._htmBaseWrapperTemplate = TEMPLATE_MANANGER.getTemplate(this._strPopupTemplateID).htmData;\n    this._htmBaseItemTemplate = TEMPLATE_MANANGER.getTemplate(this._strItemTemplateID).htmData;\n    this._htmBaseItemTemplateActive = TEMPLATE_MANANGER.getTemplate(\n      this._strItemTemplateIDActive\n    ).htmData;\n  },\n\n  _createLanguageSelectorPopupHTML: function() {\n    var htmLanguageSelectorPopup = this._htmBaseWrapperTemplate;\n    var _htmItemsList = this._getContentItems();\n    htmLanguageSelectorPopup = htmLanguageSelectorPopup.replace(\n      'XX_LANGUAGE_SELECTOR_ITEMS_XX',\n      _htmItemsList\n    );\n\n    return htmLanguageSelectorPopup;\n  },\n\n  _getContentItems: function() {\n    var _htmItemsListings = '';\n    var languages = null;\n\n    if (\n      CORE.objCourseData.objRawData &&\n      CORE.objCourseData.objRawData.arrLangs &&\n      CORE.objCourseData.objRawData.arrLangs.langs\n    ) {\n      languages = CORE.objCourseData.objRawData.arrLangs.langs;\n\n      // Set the default language and change it if it's not found\n      var currentLanguage = CORE.objCourseData.objRawData.arrLangs['default'];\n\n      if (\n        gomo &&\n        gomo.translationManager &&\n        gomo.translationManager.langCode &&\n        gomo.translationManager.langCode != 'default'\n      ) {\n        currentLanguage = gomo.translationManager.langCode;\n      }\n    }\n\n    if (languages) {\n      // Sort languages alphabetically by title.\n      languages.sort(function(langA, langB) {\n        var langTitleA = langA.title.toUpperCase();\n        var langTitleB = langB.title.toUpperCase();\n        if (langTitleA < langTitleB) {\n          return -1;\n        }\n        if (langTitleA > langTitleB) {\n          return 1;\n        }\n        return 0;\n      });\n      var count = 0;\n      while (count < languages.length) {\n        var language = languages[count];\n        var _htmCurrItem = this._htmBaseItemTemplate;\n\n        var _strItemClass = 'inactiveItemC';\n        if (currentLanguage === language.id) {\n          _strItemClass = 'activeItemC';\n          _htmCurrItem = this._htmBaseItemTemplateActive;\n        }\n\n        _htmCurrItem = _htmCurrItem.replace(/XX_LANGUAGE_NAME_XX/g, language.title);\n        _htmCurrItem = _htmCurrItem.replace(/XX_LANG_CODE_XX/g, language.id);\n        _htmCurrItem = _htmCurrItem.replace(/XX_LANGUAGE_SELECTOR_CLASS_XX/g, _strItemClass);\n\n        _htmItemsListings += _htmCurrItem;\n\n        count++;\n      }\n\n      return _htmItemsListings;\n    } else {\n      return 'Please include more than one language to populate this selector.';\n    }\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = [\n      '.languageSelectorItemC',\n      '#closeLanguageSelectorPopupL'\n    ];\n    return accessibleElements;\n  }\n};\n\nEM.register(LANGUAGE_SELECTOR_EXTRA);\nPOPUP_MANANGER.registerPopup('languageSelector', LANGUAGE_SELECTOR_EXTRA);\n"},function(t,e,n){n(0)(n(151))},function(t,e){t.exports="/* globals POPUP_MANANGER, EM, TOPIC_RENDERER, OUTPUT_MODE_CHECKER, META_SCREEN_INTERACTIONS,\nANIMATOR_INTERFACE_2, INT_TRANSITION_TIMER, ISCROLL_INTERFACE, DEBUG, TEMPLATE_MANANGER, _, $ */\nvar RESOURCES_EXTRA = {\n  strObjID: 'The resources extra',\n  _strManifestID: 'resourcesExtra',\n  strObjDescription: 'The extra responsible for displaying the resources content',\n\n  _objCurrDOM: null,\n\n  _objResourcesData: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _strPopupTemplateID: 'resourcesPopupC',\n  _strPopupItemTemplateID: 'resourcesPopupContentItemC',\n  _strContentWrapperID: 'metaContentWrapperL',\n  _strButtonID: 'resourcesL',\n\n  _htmBaseResourcesPopupTemplate: null,\n  _htmBaseResourcesContentItemTemplate: null,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  _domAssetReturnFocusItemElement: '',\n  _domCurrInsertionNode: '',\n\n  _objIScrollHandle: null,\n  _intScrollPos: 0,\n\n  _strAnimationAsset: 'resources',\n\n  // Legacy resources files only contain a limited sub-set of resources\n  // fragments and they are often using different keys. If the\n  // initial key isn't found, this table is used to see if the\n  // backup key can be found.\n  _objAlternativeResourcesIDs: {\n    'topic-linear-start': 'topic',\n    'topic-tutorial-start': 'topic',\n    'topic-scenario-start': 'topic',\n    'topic-branching-start': 'topic',\n    'topic-assessment-start': 'assessment'\n  },\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this.booPopupShown) {\n      this.hidePopup();\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strContentWrapperID);\n  },\n\n  handleEvent_popupAnimationComplete: function() {\n    // Generic function for all Extras tidyup call\n  },\n\n  popupAnimationComplete: function(resourcesDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(resourcesDomElement, '#metaContentWrapperL');\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objPopupData) {\n    EM.trigger('disableSwiping');\n\n    var _htmMetaTopic = TOPIC_RENDERER.renderTopic(_objPopupData._metaTopic);\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      _domWhatNodeToInsertInto.style.display = 'block';\n    }\n\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n    this._domCurrInsertionNode.innerHTML = _htmMetaTopic;\n\n    // Check that the screen created when resources initialises hasn't been removed\n    var initialScreenExists =\n      typeof _objPopupData._metaTopic.findScreen(_objPopupData._objActionData.strFullScreenId) !=\n      'undefined';\n    // Check that the resources topic has screens\n    var hasScreensInArray = _objPopupData._metaTopic.arrScreens.length > 0;\n    // If the initial screen has been removed but the topic still has screens set\n    // the strFullScreenId to the ID in the first screen in the topics screen array.\n    if (!initialScreenExists && hasScreensInArray) {\n      var firstScreen = _.first(_objPopupData._metaTopic.arrScreens);\n\n      _objPopupData._objActionData.strFullScreenId = firstScreen.strObjID;\n    }\n\n    META_SCREEN_INTERACTIONS.switchToMetaScreen(_objPopupData._objActionData.strFullScreenId);\n\n    /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n    * a global object in config. Then place an object at the top of this class\n    * with overrides. These overrides can then be altered per project with a\n    * config_override.js\n    **/\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      this._booPopupVisible = true;\n\n      var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n      var resourcesDomElement = this._domCurrInsertionNode;\n      var funComplete = function() {\n        RESOURCES_EXTRA.popupAnimationComplete(resourcesDomElement);\n      };\n      ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n        duration: INT_TRANSITION_TIMER,\n        complete: funComplete\n      });\n    }\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  hidePopup: function() {\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          RESOURCES_EXTRA.popupAnimationComplete();\n        };\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n          duration: INT_TRANSITION_TIMER,\n          complete: funComplete\n        });\n      }\n    } else {\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableSwipe');\n  },\n\n  _cleanUpAndHide: function() {\n    if (this._domCurrInsertionNode) {\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n      }\n      this._domCurrInsertionNode.innerHTML = '';\n\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n      this._booPopupVisible = false;\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n    }\n  },\n\n  _getTemplateHTML: function() {\n    this._htmBaseResourcesPopupTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strPopupTemplateID\n    ).htmData;\n    this._htmBaseResourcesContentItemTemplate = TEMPLATE_MANANGER.getTemplate(\n      this._strPopupItemTemplateID\n    ).htmData;\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = [\n      '.resourcesMetaC [role=\"button\"]',\n      '.resourcesMetaC #closeMetaPopupL'\n    ];\n    return accessibleElements;\n  }\n};\n\nEM.register(RESOURCES_EXTRA);\nPOPUP_MANANGER.registerPopup('resources', RESOURCES_EXTRA);\n"},function(t,e,n){n(0)(n(153))},function(t,e){t.exports="/* globals POPUP_MANANGER, EM, DEBUG, OUTPUT_MODE_CHECKER, ANIMATOR_INTERFACE_2,\nINT_TRANSITION_TIMER, TEMPLATE_MANANGER, ISCROLL_INTERFACE, $, CORE, VARIABLES_HOLDER,\nTOPIC_MANAGER, SCREEN_INTERACTIONS, CONTENT_TRACKING, LogManager, CONCISE_SEARCH_LAYOUT */\n/**\n * @title Search popup\n * @description Creates a popup which allows the user to search for content within the course and\n * then navigate to it.\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\nvar SEARCH_EXTRA = {\n  strObjID: 'The Search extra',\n  _strManifestID: 'searchExtra',\n  strObjDescription: 'The extra responsible for displaying the search field and returned content',\n\n  _objCurrDOM: null,\n  _objCurrSearchedScreen: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _strPopupTemplateID: 'searchPopupC',\n  _strPopupItemTemplateID: 'searchPopupContentItemC',\n  _strPopupWrapperID: 'searchPopupHolderL',\n  _strButtonID: 'searchL',\n  _strSearchItemId: 'searchItemC',\n  _strSearchResultId: 'searchResultsL',\n\n  concisePopupTemplateID: 'conciseSearchPopupC',\n  concisePopupItemTemplateID: 'conciseSearchPopupContentItemC',\n  conciseSearchItemId: 'conciseSearchItemC',\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  _booPreloadedContent: false,\n  _previewStringLength: 150,\n\n  _domAssetReturnFocusItemElement: '',\n  _domCurrInsertionNode: '',\n\n  _objIScrollHandle: null,\n  _intScrollPos: 0,\n\n  _strAnimationAsset: 'search',\n\n  sendStatementAfter: 1000, // milliseconds\n  statementTimeout: null,\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this.booPopupShown) {\n      this.hidePopup();\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strPopupWrapperID);\n  },\n\n  handleEvent_popupAnimationComplete: function() {\n    // Generic function for all Extras tidyup call\n  },\n\n  handleEvent_searchInputField: function(el) {\n    var searchTerm = $(el).val();\n\n    if (searchTerm) {\n      clearTimeout(this.statementTimeout);\n      if (this._preloadSearchContent) {\n        this._searchContent(searchTerm);\n      } else {\n        var errorMessage = 'Search content not loaded. SEARCH.handleEvent_searchInputFeild()';\n        if (LogManager) {\n          LogManager.add('TEXT', errorMessage);\n        }\n      }\n    } else {\n      $('#searchItemsResultL').html('');\n      $('#searchItemsInnerWrapperL').html('');\n    }\n  },\n\n  handleEvent_searchItemSelect: function(_objButtonData) {\n    var _objActionOptions = {};\n    _objActionOptions.objActions = [\n      {\n        objParameters: {target_id: _objButtonData.strTargetID},\n        strActionGroup: 'navigation',\n        strObjectType: 'action',\n        strType: 'internal_link'\n      }\n    ];\n    _objActionOptions.objOptionalExtraData = {};\n    _objActionOptions.objOptionalExtraData.domLink = _objButtonData.domLink;\n\n    var insertionNode = this._domCurrInsertionNode;\n    POPUP_MANANGER.hidePopup({strPopupID: 'search', domToClose: insertionNode, forceClose: true});\n\n    POPUP_MANANGER.unlockPopups();\n    this._cleanUpAndHide();\n\n    SCREEN_INTERACTIONS.returnFocusToScreen();\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  popupAnimationComplete: function(searchDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(searchDomElement, '#searchPopupHolderL');\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto, _objPopupData) {\n    EM.trigger('disableSwiping');\n\n    this._preloadSearchContent();\n\n    var templateId = CONCISE_SEARCH_LAYOUT ? this.concisePopupTemplateID : this._strPopupTemplateID;\n    var _htmSearch = TEMPLATE_MANANGER.getTemplate(templateId).htmData;\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      _domWhatNodeToInsertInto.style.display = 'block';\n    }\n\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n    this._domCurrInsertionNode.innerHTML = _htmSearch;\n\n    /* REFACTOR NOTE: put the default animator settings (pre _objAnimateData)into\n    * a global object in config. Then place an object at the top of this class\n    * with overrides. These overrides can then be altered per project with a\n    * config_override.js\n    **/\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      this._booPopupVisible = true;\n\n      var _strTransition = 'gomo.verticalPopupSlideShowNormal';\n      var searchDomElement = this._domCurrInsertionNode;\n      var funComplete = function() {\n        SEARCH_EXTRA.popupAnimationComplete(searchDomElement);\n      };\n      ANIMATOR_INTERFACE_2.assignRegisteredAnimation(this._domCurrInsertionNode, _strTransition, {\n        duration: INT_TRANSITION_TIMER,\n        complete: funComplete\n      });\n    }\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  hidePopup: function(objPopupData) {\n    if (\n      this._strCurrOutputModeClass != 'accessibleC' &&\n      OUTPUT_MODE_CHECKER.canHandleAnimationType(this._strAnimationAsset)\n    ) {\n      if (this._booPopupVisible || (objPopupData && objPopupData.forceClose)) {\n        this._booPopupVisible = false;\n\n        var _strTransition = 'gomo.verticalPopupSlideHideNormal';\n        var funComplete = function() {\n          SEARCH_EXTRA.popupAnimationComplete();\n        };\n        var domCloseElement = this._domCurrInsertionNode || objPopupData.domToClose;\n        var transitionTimer = INT_TRANSITION_TIMER;\n        if (objPopupData.forceClose) transitionTimer = 0;\n        ANIMATOR_INTERFACE_2.assignRegisteredAnimation(domCloseElement, _strTransition, {\n          duration: transitionTimer,\n          complete: funComplete\n        });\n      }\n    } else {\n      this._cleanUpAndHide();\n    }\n\n    /* REFACTOR NOTE : this needs a cleaner method. Maybe in popupmanager */\n    if (OUTPUT_MODE_CHECKER.booIsIE8()) {\n      this._domCurrInsertionNode.style.display = 'none';\n    }\n\n    EM.trigger('enableSwipe');\n  },\n\n  _searchContent: function(searchTerm) {\n    var searchPrefix = '<span class=\"searchTermC\">';\n    var searchSuffix = '</span>';\n    var searchedFields = 0;\n    var searchedAssets = 0;\n    var searchMatches = 0;\n    var objSearchMatches = {};\n    var indexOfSearch;\n    var topicCount = 0;\n\n    searchTerm = searchTerm.toLowerCase();\n\n    while (topicCount < CORE.objCourseData.arrContainers.length) {\n      var currTopic = CORE.objCourseData.arrContainers[topicCount];\n      // Search Topic Title\n      var topicTitle = currTopic.strTitle;\n      indexOfSearch = topicTitle.toLowerCase().indexOf(searchTerm);\n      if (indexOfSearch != -1) {\n        addSearchMatch(topicTitle, indexOfSearch, currTopic);\n        // Add Item specific data\n        objSearchMatches[currTopic.strObjID].itemType = 'Topic';\n        objSearchMatches[currTopic.strObjID].screenLink = currTopic.strObjID;\n        objSearchMatches[currTopic.strObjID].screenTitle = 'N/A';\n        objSearchMatches[currTopic.strObjID].topicTitle = topicTitle;\n      }\n      searchedFields++;\n\n      var screenCount = 0;\n      while (screenCount < currTopic.arrScreens.length) {\n        var currScreen = currTopic.arrScreens[screenCount];\n        // If content has come from a bank ignore it.\n        if (currScreen.objRawData.booFromContentBank) {\n          break;\n        }\n        // This will be used for subscreen search later if required\n        this._objCurrSearchedScreen = currScreen;\n        // Search Screen Title\n        var screenTitle = currScreen.strTitle;\n        indexOfSearch = screenTitle.toLowerCase().indexOf(searchTerm);\n        if (indexOfSearch != -1) {\n          addSearchMatch(screenTitle, indexOfSearch, currScreen);\n          // Add Item specific data\n          objSearchMatches[currScreen.strObjID].itemType = 'Screen';\n          objSearchMatches[currScreen.strObjID].screenLink = currScreen.strObjID;\n          objSearchMatches[currScreen.strObjID].screenTitle = screenTitle;\n          objSearchMatches[currScreen.strObjID].topicTitle = currScreen.objParent.strTitle;\n        }\n        searchedFields++;\n\n        var assetCount = 0;\n        while (assetCount < currScreen.arrAssets.length) {\n          var currAsset = currScreen.arrAssets[assetCount];\n          // Search Asset\n          if (currAsset.arrSearchableFields && currAsset.booIsDisplayed) {\n            var assetSearchedFields = 0;\n            while (assetSearchedFields < currAsset.arrSearchableFields.length) {\n              var assetFieldName = currAsset.arrSearchableFields[assetSearchedFields];\n              var assetContent = this._getFieldValue(assetFieldName, currAsset.objRawData);\n              indexOfSearch = assetContent.toLowerCase().indexOf(searchTerm);\n              if (indexOfSearch != -1 && !objSearchMatches[currAsset.strObjID]) {\n                addSearchMatch(assetContent, indexOfSearch, currAsset);\n                // Add Item specific data\n                objSearchMatches[currAsset.strObjID].itemType = currAsset.strAssetType;\n                objSearchMatches[currAsset.strObjID].screenLink = currAsset.objParent.strObjID;\n                objSearchMatches[currAsset.strObjID].screenTitle = currAsset.objParent.strTitle;\n                objSearchMatches[currAsset.strObjID].topicTitle =\n                  currAsset.objParent.objParent.strTitle;\n              }\n              searchedFields++;\n              assetSearchedFields++;\n            }\n          }\n          searchedAssets++;\n          assetCount++;\n        }\n        screenCount++;\n      }\n      topicCount++;\n    }\n\n    /**\n     * Add matched search result content to the search results.\n     * @param {String} strContent\n     * @param {Number} indexOfSearch\n     * @param {Object} currItem\n     */\n    function addSearchMatch(strContent, indexOfSearch, currItem) {\n      var objSearchConfig = SEARCH_EXTRA._getSearchConfig(indexOfSearch, strContent);\n      objSearchMatches[currItem.strObjID] = {};\n      objSearchMatches[currItem.strObjID].searchNumber = searchMatches + 1;\n      objSearchMatches[currItem.strObjID].result = strContent.slice(\n        objSearchConfig.sliceStart,\n        objSearchConfig.sliceEnd\n      );\n      objSearchMatches[currItem.strObjID].result =\n        objSearchConfig.itemPrefix +\n        objSearchMatches[currItem.strObjID].result +\n        objSearchConfig.itemSuffix;\n      objSearchMatches[currItem.strObjID].result = objSearchMatches[\n        currItem.strObjID\n      ].result.replace(new RegExp(searchTerm, 'gi'), searchPrefix + searchTerm + searchSuffix);\n      searchMatches++;\n    }\n\n    var objSearchFeedback = {\n      searchMatches: searchMatches,\n      searchedFields: searchedFields,\n      searchedAssets: searchedAssets\n    };\n\n    this.sendStatement(searchTerm, searchMatches);\n\n    this._updateResults(objSearchMatches, objSearchFeedback);\n    this._objCurrSearchedScreen = null;\n  },\n\n  _getSearchConfig: function(indexOfSearch, strContent) {\n    var sliceStart = indexOfSearch - this._previewStringLength / 2;\n    var sliceEnd = indexOfSearch + this._previewStringLength / 2;\n    var itemPrefix = '...';\n    var itemSuffix = '...';\n\n    if (sliceStart <= 0) {\n      sliceStart = 0;\n      itemPrefix = '';\n    }\n\n    if (strContent.length <= sliceEnd) {\n      itemSuffix = '';\n    }\n\n    return {\n      sliceStart: sliceStart,\n      sliceEnd: sliceEnd,\n      itemPrefix: itemPrefix,\n      itemSuffix: itemSuffix\n    };\n  },\n\n  _getFieldValue: function(assetFieldName, objRawData) {\n    var fieldValue = '';\n\n    searchForValue(assetFieldName, objRawData);\n\n    /**\n     * Search for value within the course\n     * @param {String} assetFieldName\n     * @param {Object} objRawData\n     * @return {String} strContent\n     */\n    function searchForValue(assetFieldName, objRawData) {\n      var arrObjPath;\n      var firstPath;\n      var newFieldName;\n      if (assetFieldName.indexOf('#') != -1 || assetFieldName.indexOf('.') != -1) {\n        if (\n          (assetFieldName.indexOf('.') != -1 &&\n            assetFieldName.indexOf('.') < assetFieldName.indexOf('#')) ||\n          assetFieldName.indexOf('#') == -1\n        ) {\n          arrObjPath = assetFieldName.split('.');\n          firstPath = arrObjPath[0];\n          newFieldName = assetFieldName.replace(firstPath + '.', '');\n          var newRawObj = objRawData[firstPath];\n\n          return searchForValue(newFieldName, newRawObj);\n        }\n        if (\n          (assetFieldName.indexOf('#') != -1 &&\n            assetFieldName.indexOf('#') < assetFieldName.indexOf('.')) ||\n          assetFieldName.indexOf('.') == -1\n        ) {\n          arrObjPath = assetFieldName.split('#');\n          firstPath = arrObjPath[0];\n          newFieldName = assetFieldName.replace(firstPath + '#.', '');\n\n          var strContent = '';\n          var arrCount = 0;\n          while (arrCount < objRawData.length) {\n            strContent += searchForValue(newFieldName, objRawData[arrCount]) + ' ';\n            arrCount++;\n          }\n          fieldValue = strContent;\n          return strContent;\n        }\n      } else {\n        if (assetFieldName == 'SUBSCREEN') {\n          return SEARCH_EXTRA._getSubscreenValue(objRawData);\n        } else {\n          return (fieldValue = objRawData[assetFieldName]);\n        }\n      }\n    }\n    // convert unicode\n    var regEx = /&#([\\d\\w]{5});/gi;\n    var fieldValueClean = fieldValue.replace(regEx, function(match, grp) {\n      return String.fromCharCode(parseInt(0 + grp, 16));\n    });\n    // remove special characters\n    regEx = /&([\\d\\w]{4});/gi;\n    fieldValueClean = fieldValueClean.replace(regEx, '');\n\n    fieldValueClean = unescape(fieldValueClean);\n    fieldValueClean = this._removeFormattedHtml(fieldValueClean);\n    return fieldValueClean;\n  },\n\n  // This should be in the asset or extra renderer, but they're being refactored at the moment.\n  _removeFormattedHtml: function(_strWhatText) {\n    if (window['VARIABLES_HOLDER']) {\n      _strWhatText = VARIABLES_HOLDER.parseHTMLForVariableMarkup(_strWhatText);\n    }\n\n    if (_strWhatText) {\n      // Clean up required characters for string replace\n      _strWhatText = _strWhatText.replace(/&#x0027;/g, '');\n      _strWhatText = _strWhatText.replace(/&#x0022;/g, '');\n\n      // bold format\n      _strWhatText = _strWhatText.replace(/\\[b\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/b\\]/g, '');\n\n      // italic format\n      _strWhatText = _strWhatText.replace(/\\[i\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/i\\]/g, '');\n\n      // bold and italic\n      _strWhatText = _strWhatText.replace(/\\[bi\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/bi\\]/g, '');\n\n      // underline format\n      _strWhatText = _strWhatText.replace(/\\[u\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/u\\]/g, '');\n\n      // list format\n      _strWhatText = _strWhatText.replace(/\\[ul\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/ul\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[ol\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/ol\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[li\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/li\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[hrule\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[sub\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/sub\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[sup\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/sup\\]/g, '');\n\n      // br format\n      _strWhatText = _strWhatText.replace(/\\n/g, '');\n      _strWhatText = _strWhatText.replace(/\\r/g, '');\n\n      // BB Markup lists\n      _strWhatText = _strWhatText.replace(/\\[list=1\\]((.|\\n)*?)\\[\\/list\\](<br[/]?>)?/gi, '');\n      _strWhatText = _strWhatText.replace(/\\[list\\]((.|\\n)*?)\\[\\/list\\](<br[/]?>)?/gi, '');\n      _strWhatText = _strWhatText.replace(/\\[\\*\\]/gi, '');\n      _strWhatText = _strWhatText.replace(/<ul>\\s<\\/li>/gi, '');\n      _strWhatText = _strWhatText.replace(/<ol>\\s<\\/li>/gi, '');\n      _strWhatText = _strWhatText.replace(/<ul><br[/]?>/gi, '');\n      _strWhatText = _strWhatText.replace(/<ol><br[/]?>/gi, '');\n\n      // Multi action link format\n      _strWhatText = _strWhatText.replace(\n        /\\[link type=[\"']([^\"]+?)[\"'] name=[\"']([^\"]+?)[\"']\\]/g,\n        ''\n      );\n      _strWhatText = _strWhatText.replace(\n        /\\[link type=&quot;([^\"]+?)&quot; name=&quot;([^\"]+?)&quot;\\]/g,\n        ''\n      );\n      _strWhatText = _strWhatText.replace(/\\[\\/link\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[actionset=([^\\]]+)\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/actionset\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[\\/link\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[Step \\d+\\]/gi, '');\n\n      // red format\n      _strWhatText = _strWhatText.replace(/\\[red\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/red\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[redb\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/redb\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[redi\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/redi\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[redbi\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/redbi\\]/g, '');\n\n      _strWhatText = _strWhatText.replace(/\\[font type=[\"']([^\"]+?)[\"']\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[\\/font\\]/g, '');\n      _strWhatText = _strWhatText.replace(/\\[img\\]([^[]+)\\[\\/img\\]/g, '');\n    }\n    return _strWhatText;\n  },\n\n  _getSubscreenValue: function(objRawData) {\n    var _objCurrSubScreen = null;\n\n    if (objRawData.arrActions) {\n      var countActions = 0;\n      while (countActions < objRawData.arrActions.length) {\n        if (\n          objRawData.arrActions[countActions].objParameters &&\n          objRawData.arrActions[countActions].objParameters.strSubScreenID\n        ) {\n          var _strWhatSubScreenID =\n            objRawData.arrActions[countActions].objParameters.strSubScreenID;\n          var count = 0;\n          while (count < this._objCurrSearchedScreen.arrSubScreens.length) {\n            if (\n              _strWhatSubScreenID.indexOf(\n                this._objCurrSearchedScreen.arrSubScreens[count].strObjID\n              ) > -1\n            ) {\n              _objCurrSubScreen = this._objCurrSearchedScreen.arrSubScreens[count];\n              break;\n            }\n            count++;\n          }\n          break;\n        }\n        countActions++;\n      }\n    }\n\n    if (_objCurrSubScreen) {\n      var assetContent = '';\n      var assetCount = 0;\n      while (assetCount < _objCurrSubScreen.arrAssets.length) {\n        var currAsset = _objCurrSubScreen.arrAssets[assetCount];\n        // Search Asset\n        if (currAsset.arrSearchableFields && currAsset.booIsDisplayed) {\n          var assetSearchedFields = 0;\n          while (assetSearchedFields < currAsset.arrSearchableFields.length) {\n            var assetFieldName = currAsset.arrSearchableFields[assetSearchedFields];\n            assetContent += this._getFieldValue(assetFieldName, currAsset.objRawData);\n\n            assetSearchedFields++;\n          }\n        }\n        assetCount++;\n      }\n      return assetContent;\n    } else {\n      return '';\n    }\n  },\n\n  _preloadSearchContent: function() {\n    var topicCount = 0;\n    while (topicCount < CORE.objCourseData.arrContainers.length) {\n      var currTopic = CORE.objCourseData.arrContainers[topicCount];\n      var _objWhatTopicObject = CORE.objCourseData.findTopic(currTopic.strObjID);\n      if (_objWhatTopicObject == false) {\n        this._debug('Selected Topic isn\\'t loaded in this Player.');\n        return;\n      }\n      TOPIC_MANAGER.silentlyAddData(_objWhatTopicObject);\n      topicCount++;\n    }\n    this._booPreloadedContent = true;\n  },\n\n  _updateResults: function(objSearchMatches, objResultFeedback) {\n    var _htmSearchResult =\n      CONCISE_SEARCH_LAYOUT ? false: TEMPLATE_MANANGER.getTemplate(this._strSearchResultId).htmData;\n\n    var searchItemTempalteId =\n      CONCISE_SEARCH_LAYOUT ? this.conciseSearchItemId : this._strSearchItemId;\n    var _htmSearchItem = TEMPLATE_MANANGER.getTemplate(searchItemTempalteId).htmData;\n\n    var _htmSearchMatches = '';\n    for (var searchMatch in objSearchMatches) {\n      if (Object.prototype.hasOwnProperty.call(objSearchMatches, searchMatch)) {\n        _htmSearchMatches += _htmSearchItem;\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_NUMBER_XX',\n          objSearchMatches[searchMatch].searchNumber\n        );\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_TOPIC_TITLE_XX',\n          objSearchMatches[searchMatch].topicTitle\n        );\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_SCREEN_TITLE_XX',\n          objSearchMatches[searchMatch].screenTitle\n        );\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_TYPE_XX',\n          objSearchMatches[searchMatch].itemType\n        );\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_CONTENT_XX',\n          objSearchMatches[searchMatch].result\n        );\n        _htmSearchMatches = _htmSearchMatches.replace(\n          'XX_SEARCH_ITEM_TARGET_ID_XX',\n          objSearchMatches[searchMatch].screenLink\n        );\n      }\n    }\n\n    if (_htmSearchResult) {\n      _htmSearchResult = _htmSearchResult.replace(\n        'XX_SEARCH_MATCHES_XX',\n        objResultFeedback.searchMatches\n      );\n      $('#searchItemsResultL').html(_htmSearchResult);\n    }\n\n    $('#searchItemsInnerWrapperL').html(_htmSearchMatches);\n    $('.search-popup').removeClass('search-popup--no-results');\n\n    gomo.tabManager.refreshTabIndexes('popup', $('#searchPopupHolderL'));\n  },\n\n  _cleanUpAndHide: function() {\n    if (this._domCurrInsertionNode) {\n      if (typeof ISCROLL_INTERFACE != 'undefined') {\n        ISCROLL_INTERFACE.recycleScroller(this._domCurrInsertionNode);\n      }\n      this._domCurrInsertionNode.innerHTML = '';\n      // this._domCurrInsertionNode.style.height = \"auto\";\n\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n      this._booPopupVisible = false;\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n    }\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = [\n      '#searchInputL',\n      '.searchItemTitleC',\n      '#closeSearchPopupL'\n    ];\n    return accessibleElements;\n  },\n\n  sendStatement: function(term, noOfResults) {\n    var courseId = CORE.objCourseData.strObjID;\n    var currentScreen = gomo.screenManager.getCurrentScreenData();\n    var statement = {\n      type: 'searched',\n      activity: {\n        id: courseId,\n        title: term,\n        type: 'search'\n      },\n      result: {\n        response: term\n      },\n      resultExtention: {\n        id: 'search',\n        value: noOfResults\n      },\n      referrer: {\n        id: currentScreen.strObjID,\n        title: currentScreen.strTitle,\n        type: 'page'\n      },\n      parent: 'course/' + courseId\n    };\n\n    // Send statement after no keypresses have happened for a few milliseconds\n    this.statementTimeout = setTimeout(function() {\n      CONTENT_TRACKING.interaction(statement);\n    }, this.sendStatementAfter);\n  }\n};\n\nEM.register(SEARCH_EXTRA);\nPOPUP_MANANGER.registerPopup('search', SEARCH_EXTRA);\n"},function(t,e,n){n(0)(n(155))},function(t,e){t.exports="/* globals POPUP_MANANGER, EM, DEBUG, ANIMATOR_INTERFACE_2, TEMPLATE_MANANGER, $, CORE,\nTOPIC_MANAGER, LOADER, TOC_SLIDE_ANIMATION */\n\n/**\n * @title Settings\n * @description To be described.\n *\n *\n * @author GoMo\n * @version 2.0 17/12/12\n */\n\nvar TABLE_OF_CONTENTS_EXTRA = {\n  strObjID: 'The Table of Contents extra',\n  strObjDescription:\n    'Displays a list of topics and allows quick navigation to those topics',\n\n  _objCurrDOM: null,\n\n  _strCurrOutputModeClass: 'graphicalC',\n\n  _domCurrInsertionNode: '',\n\n  _strPopupWrapperID: 'tableOfContentsPopupHolderL',\n  _strPopupTemplateID: 'tableOfContentsPopupC',\n  _strButtonID: 'tableOfContentsL',\n  _strItemTemplateID: 'tableOfContentsItemC',\n\n  _htmBaseWrapperTemplate: '',\n  _htmBaseItemTemplate: '',\n\n  _strDisplayElement: 'visibleC',\n  _strHideElement: 'hiddenC',\n\n  _strContentWrapperId: '#pageWrapperL',\n\n  _intAnimationDuration: 500,\n\n  booPopupShown: false,\n  _booPopupVisible: false,\n\n  handleEvent_primeDOMReferences: function(_objWhatDOM) {\n    this._objCurrDOM = _objWhatDOM;\n  },\n\n  handleEvent_outputModeChanged: function(_objOutputChangeData) {\n    this._strCurrOutputModeClass = _objOutputChangeData['strNewOutputMode'];\n    if (this.booPopupShown) {\n      this.hidePopup({booResetSettings: true});\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    }\n  },\n\n  handleEvent_navigationRendered: function() {\n    $('#' + this._strButtonID).attr('aria-controls', this._strPopupWrapperID);\n  },\n\n  handleEvent_popupAnimationComplete: function() {},\n\n  handleEvent_swipeLeft: function() {\n    if (this._booPopupVisible) {\n      this._forceClosePopup();\n    }\n  },\n\n  handleEvent_tableOfContentAction: function(_objButtonData) {\n    var _objActionOptions = {};\n    _objActionOptions.objActions = [\n      {\n        objParameters: {target_id: _objButtonData.strTargetID},\n        strActionGroup: 'navigation',\n        strObjectType: 'action',\n        strType: 'internal_link'\n      }\n    ];\n    _objActionOptions.objOptionalExtraData = {};\n    _objActionOptions.objOptionalExtraData.domLink = _objButtonData.domLink;\n\n    // Example feed back for completion of subscreen display.\n    _objActionOptions.objOptionalExtraData.funTriggerCallBack = function() {\n      TABLE_OF_CONTENTS_EXTRA._forceClosePopup();\n    };\n\n    EM.trigger('processActions', _objActionOptions);\n  },\n\n  popupAnimationComplete: function(tocDomElement) {\n    if (!this._booPopupVisible) {\n      POPUP_MANANGER.unlockPopups();\n      this._cleanUpAndHide();\n    } else {\n      gomo.tabManager.focusModalContent(tocDomElement, tocDomElement);\n    }\n  },\n\n  showPopup: function(_domWhatNodeToInsertInto) {\n    EM.trigger('disableScreenSwiping');\n\n    this._getTemplateHTML();\n    this._domCurrInsertionNode = _domWhatNodeToInsertInto;\n\n    var _htmTableOfContentsPopup = this._createTableOfContentsPopupHTML();\n    this._domCurrInsertionNode.innerHTML = _htmTableOfContentsPopup;\n    this._domTableOfContents = this._objCurrDOM.getElementById(this._strPopupWrapperID);\n\n    if (this._strCurrOutputModeClass != 'accessibleC') {\n      this._booPopupVisible = true;\n\n      // Popup animation\n      var _objOptions = {};\n\n      _objOptions.startPoint = this._domTableOfContents.clientWidth * -1;\n      _objOptions.duration = this._intAnimationDuration;\n      var tocDomElement = this._domTableOfContents;\n      _objOptions.complete = function() {\n        TABLE_OF_CONTENTS_EXTRA.popupAnimationComplete(tocDomElement);\n      };\n\n      ANIMATOR_INTERFACE_2.animateHorizontalSide(this._domCurrInsertionNode, _objOptions);\n\n      // Page animation\n      _objOptions = {};\n\n      _objOptions.endPoint = this._domTableOfContents.clientWidth;\n      _objOptions.duration = this._intAnimationDuration;\n\n      if (!TOC_SLIDE_ANIMATION) {\n        ANIMATOR_INTERFACE_2.animateHorizontalSide(this._strContentWrapperId, _objOptions);\n      }\n    }\n\n    // If already displayed in normal mode, reset the transform so accessible mode can be displayed\n    if (this._strCurrOutputModeClass == 'accessibleC') {\n      if (typeof $(this._domCurrInsertionNode).css('transform') !== 'undefined') {\n        $(this._domCurrInsertionNode).css('transform', 'none');\n      }\n    }\n\n    this.booPopupShown = true;\n    $('#' + this._strButtonID).attr('aria-expanded', true);\n    EM.trigger('showPopup');\n  },\n\n  hidePopup: function(_objPopupData) {\n    if (this._strCurrOutputModeClass != 'accessibleC') {\n      if (this._booPopupVisible) {\n        this._booPopupVisible = false;\n\n        // Popup animation\n        var _objOptions = {};\n\n        _objOptions.endPoint = this._domTableOfContents.clientWidth * -1;\n        _objOptions.duration = this._intAnimationDuration;\n        _objOptions.complete = function() {\n          TABLE_OF_CONTENTS_EXTRA.popupAnimationComplete();\n        };\n\n        ANIMATOR_INTERFACE_2.animateHorizontalSide(this._domCurrInsertionNode, _objOptions);\n\n        // Page animation\n        _objOptions = {};\n\n        _objOptions.startPoint = this._domTableOfContents.clientWidth;\n        _objOptions.duration = this._intAnimationDuration;\n\n        if (!TOC_SLIDE_ANIMATION) {\n          ANIMATOR_INTERFACE_2.animateHorizontalSide(this._strContentWrapperId, _objOptions);\n        }\n      }\n    } else {\n      this._cleanUpAndHide();\n    }\n    EM.trigger('enableScreenSwipe');\n  },\n\n  _forceClosePopup: function() {\n    EM.trigger('closePopup', {strPopupID: 'tableOfContents'});\n  },\n\n  _cleanUpAndHide: function() {\n    POPUP_MANANGER.unlockPopups();\n    if (this._domCurrInsertionNode) {\n      this._domCurrInsertionNode.innerHTML = '';\n      this._domCurrInsertionNode = null;\n      this.booPopupShown = false;\n      $('#' + this._strButtonID).attr('aria-expanded', false);\n      POPUP_MANANGER.postAnimationTidyUp();\n    }\n  },\n\n  _getTemplateHTML: function() {\n    this._htmBaseWrapperTemplate = TEMPLATE_MANANGER.getTemplate(this._strPopupTemplateID).htmData;\n    this._htmBaseItemTemplate = TEMPLATE_MANANGER.getTemplate(this._strItemTemplateID).htmData;\n  },\n\n  _createTableOfContentsPopupHTML: function() {\n    var _htmTableOfContentsPopup = this._htmBaseWrapperTemplate;\n\n    _htmTableOfContentsPopup = _htmTableOfContentsPopup.replace(\n      'XX_TABLE_OF_CONTENTS_POPUP_TITLE_XX',\n      'Contents'\n    );\n    var _htmItemsList = this._getContentItems();\n    _htmTableOfContentsPopup = _htmTableOfContentsPopup.replace(\n      'XX_CONTENT_ITEMS_XX',\n      _htmItemsList\n    );\n\n    return _htmTableOfContentsPopup;\n  },\n\n  _getContentItems: function() {\n    var _htmItemsListings = '';\n    var _arrQuickLaunchTopics = [];\n    if (CORE.objCourseData.objRawData.arrQuickLaunchTopics) {\n      _arrQuickLaunchTopics = CORE.objCourseData.objRawData.arrQuickLaunchTopics;\n    } else {\n      _arrQuickLaunchTopics = this._autoGeneratedListOfItems();\n    }\n    var _objCurrentTopicId = TOPIC_MANAGER.getCurrentTopic().strObjID;\n\n    if (typeof _arrQuickLaunchTopics != 'undefined') {\n      var count = 0;\n      while (count < _arrQuickLaunchTopics.length) {\n        var objCurrentTopic = _arrQuickLaunchTopics[count];\n        var _htmCurrItem = this._htmBaseItemTemplate;\n        var topicTitle = '';\n\n        if (typeof objCurrentTopic.titles !== 'undefined') {\n          topicTitle =\n            objCurrentTopic.titles[gomo.translationManager.langCode] ||\n            objCurrentTopic.titles['default'];\n        } else {\n          topicTitle = objCurrentTopic.strTitle;\n        }\n\n        _htmCurrItem = _htmCurrItem.replace(/XX_TABLE_OF_CONTENTS_NAME_XX/g, topicTitle);\n        _htmCurrItem = _htmCurrItem.replace(/XX_SCREEN_ID_XX/g, objCurrentTopic.strTopicID);\n\n        var _strItemClass = 'inactiveItemC';\n        if (objCurrentTopic.strTopicID === _objCurrentTopicId) {\n          _strItemClass = 'activeItemC';\n        }\n        _htmCurrItem = _htmCurrItem.replace(/XX_TABLE_OF_CONTENTS_CLASS_XX/g, _strItemClass);\n\n        _htmItemsListings += _htmCurrItem;\n\n        count++;\n      }\n      return _htmItemsListings;\n    } else {\n      return 'Please select one or more topics in the Portal to quick launch to.';\n    }\n  },\n\n  _autoGeneratedListOfItems: function() {\n    var arrTopics = CORE.objCourseData.arrContainers;\n    var arrItemList = [];\n    var count = 0;\n    while (count < arrTopics.length) {\n      if (arrTopics[count].strTitle === '') {\n        var topicObject = LOADER.loadTopicData(arrTopics[count].strTopicDataFilename);\n        if (topicObject && topicObject.topic) {\n          topicObject.topic.strTopicID = topicObject.topic.strID;\n          arrItemList.push(topicObject.topic);\n        }\n      } else {\n        arrItemList.push({\n          strTitle: arrTopics[count].strTitle,\n          strTopicID: arrTopics[count].strObjID\n        });\n      }\n      count++;\n    }\n\n    return arrItemList;\n  },\n\n  debug: function(strMessage, intPriority, objCallerObject, booCalleeChain) {\n    if (DEBUG) {\n      DEBUG.lert(strMessage, intPriority, objCallerObject, booCalleeChain);\n    }\n  },\n\n  /**\n   * Return all elements within this asset that should be included in the tab list.\n   * @return {Array} The elements we want to include in the tab list.\n   */\n  getAccessibleElements: function() {\n    var accessibleElements = [\n      '.tableOfContentsItemC',\n      '#closeTableOfContentsPopupL'\n    ];\n    return accessibleElements;\n  }\n};\n\nEM.register(TABLE_OF_CONTENTS_EXTRA);\nPOPUP_MANANGER.registerPopup('tableOfContents', TABLE_OF_CONTENTS_EXTRA);\n"}]);